'use strict';

System.register('app.js', ['docgen/docgen.routes.js', 'quotes/quotes.routes.js', 'assets/assets.routes.js', 'subscriptions/subscriptions.routes.js', 'products/products.routes.js', 'favorites/favorites.routes.js', 'common/core/AppContext.js', 'common/core/sb-i18n/I18n.js', 'common/core/sb-router/Router.js', 'common/forms/sb-rte/dialog/RichTextEditorDialog.js', 'common/common.js', 'quotes/quotes.js', 'products/products.js', 'favorites/favorites.js', 'assets/assets.js', 'subscriptions/subscriptions.js'], function (_export, _context) {
	var docgen, quotes, assets, subscriptions, products, favorites, AppContext, I18n, Router, RichTextEditorDialog, _createClass, App;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_docgenDocgenRoutesJs) {
			docgen = _docgenDocgenRoutesJs;
		}, function (_quotesQuotesRoutesJs) {
			quotes = _quotesQuotesRoutesJs;
		}, function (_assetsAssetsRoutesJs) {
			assets = _assetsAssetsRoutesJs;
		}, function (_subscriptionsSubscriptionsRoutesJs) {
			subscriptions = _subscriptionsSubscriptionsRoutesJs;
		}, function (_productsProductsRoutesJs) {
			products = _productsProductsRoutesJs;
		}, function (_favoritesFavoritesRoutesJs) {
			favorites = _favoritesFavoritesRoutesJs;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbI18nI18nJs) {
			I18n = _commonCoreSbI18nI18nJs.I18n;
		}, function (_commonCoreSbRouterRouterJs) {
			Router = _commonCoreSbRouterRouterJs.Router;
		}, function (_commonFormsSbRteDialogRichTextEditorDialogJs) {
			RichTextEditorDialog = _commonFormsSbRteDialogRichTextEditorDialogJs.RichTextEditorDialog;
		}, function (_commonCommonJs) {}, function (_quotesQuotesJs) {}, function (_productsProductsJs) {}, function (_favoritesFavoritesJs) {}, function (_assetsAssetsJs) {}, function (_subscriptionsSubscriptionsJs) {}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('App', App = function () {
				function App() {
					_classCallCheck(this, App);
				}

				_createClass(App, null, [{
					key: 'init',
					value: function init(pageContainer, dbName, settingsObj, urls) {

						var r = {};
						r[docgen.PREFIX] = docgen.ROUTES;
						r[quotes.PREFIX] = quotes.ROUTES;
						r[products.PREFIX] = products.ROUTES;
						r[favorites.PREFIX] = favorites.ROUTES;
						r[assets.PREFIX] = assets.ROUTES;
						r[subscriptions.PREFIX] = subscriptions.ROUTES;

						pageContainer.allRoutes = r;

						RichTextEditorDialog.setBaseUrl(urls.tinymce);

						return Promise.all([AppContext.init(settingsObj), App._initIntlLocale(urls.intl, settingsObj.locale)]);
					}
				}, {
					key: '_initIntlLocale',
					value: function _initIntlLocale(url, locale) {

						return new Promise(function (res, rej) {
							var xhr = new XMLHttpRequest();
							xhr.open('GET', url + '/locale-data/json/' + locale + '.json');

							xhr.onerror = function (e) {
								rej(new Error('Cannot get locale data: ' + e));
							};

							xhr.ontimeout = function (e) {
								rej(new Error('Timeout for locale data'));
							};

							xhr.onload = function () {
								if (xhr.responseText) {
									try {
										var data = JSON.parse(xhr.responseText);
										I18n.addLocaleData(data);
										if (Intl && Intl.__addLocaleData) {
											Intl.__addLocaleData(JSON.parse(xhr.responseText));
										}
										res(data);
									} catch (e) {
										rej(new Error('Cannot parse locale data'));
									}
								} else {
									rej(new Error('Cannot understand locale data: ' + xhr.statusText));
								}
							};

							xhr.send();
						});
					}
				}]);

				return App;
			}());

			_export('App', App);
		}
	};
});

"use strict";

System.register("labels_en.js", [], function (_export, _context) {
  var LABELS;
  return {
    setters: [],
    execute: function () {
      _export("LABELS", LABELS = { "Apply": "Apply", "Asset Selection": "Asset Selection", "Cancel": "Cancel", "Clear Fields": "Clear Fields", "Filter": "Filter", "Select": "Select", "numResults": "{0} Results", "Save": "Save", "Edit Description": "Edit Description", "Popup": "Popup", "Quote Template": "Quote Template", "Add Products": "Add Products", "Delete": "Delete", "Favorite Lookup": "Favorite Lookup", "Share": "Share", "Select & Add More": "Select & Add More", "Share Favorites": "Share Favorites", "showAvailableUpgrades": "This feature has products available for upgrade, click the Show Available Upgrades button at the bottom of the feature to select upgrade options.", "No visible options in feature": "No visible options in feature '{0}'", "Add Options": "Add Options", "Add": "Add", "Configure Products": "Configure Products", "Alert": "Alert", "Continue": "Continue", "Product Selection": "Product Selection", "Guided Selling": "Guided Selling", "Favorites": "Favorites", "Product Filter": "Product Filter", "Suggest": "Suggest", "Custom Segments": "Custom Segments", "Discount Schedule Editor": "Discount Schedule Editor", "Update": "Update", "Add to Favorites": "Add to Favorites", "Favorite Name": "Favorite Name", "Choose Price Book": "Choose Price Book", "Quote Total": "Quote Total", "Remove From Favorites": "Remove From Favorites", "Standard Products": "Standard Products", "Segmented Products": "Segmented Products", "Add To Favorite": "Add To Favorite", "Renew Subscriptions": "Renew Subscriptions", "Subtotal": "Subtotal", "emptyLinesMsg": "This group has no line items. Click on Add Products button or drag lines from other groups.", "mobileEmptyLinesMsg": "This group has no line items. Click on Add Products button to add a product.", "invalidPricebookEntry": "There is not a valid price book entry for this line item.", "missingOpportunityLineItem": "This product will not sync to the opportunity because a valid pricebook entry does not exist.", "Edit Quote": "Edit Quote", "emptyGroupedQuoteMsg": "This quote has no line items. Click on Add Group button to select products.", "emptyQuoteMsg": "This quote has no line items. Click on Add Products button to select products.", "Subscription Selection": "Subscription Selection" });

      _export("LABELS", LABELS);
    }
  };
});

'use strict';

System.register('org.local.js', [], function (_export, _context) {
  var settings;
  return {
    setters: [],
    execute: function () {
      _export('settings', settings = { developerPrefix: 'SBQQ', isMultiCurrencyOrg: false, calculateImmediately: false, locale: 'en-US', language: 'en', defaultCurrency: 'USD', currencySymbol: '', currencyDecimalScale: 2, fullName: 'Admin User', userName: 'admin-user@steelbrick.com', userId: '0XXX1', device: '', isOAuth: true });

      _export('settings', settings);
    }
  };
});

"use strict";

System.register("ajax/ajax.js", [], function (_export, _context) {
	return {
		setters: [],
		execute: function () {
			if (typeof window !== 'undefined' && window) {
				window.SB = window.SB || {};
				window.SB.ajax = require("./../calc/Utils/ApexUtils.js");
			}
		}
	};
});

"use strict";

System.register("assets/assets.js", [], function (_export, _context) {
  return {
    setters: [],
    execute: function () {}
  };
});

'use strict';

System.register('assets/assets.routes.js', [], function (_export, _context) {
	var PREFIX, ROUTES;
	return {
		setters: [],
		execute: function () {
			_export('PREFIX', PREFIX = '/asset');

			_export('PREFIX', PREFIX);

			_export('ROUTES', ROUTES = {
				'/lookup': { comp: 'sb-asset-lookup', mod: 'assets/selection/routes/sb-asset-lookup/AssetLookup.js' },
				'/upgrade': { comp: 'sb-asset-upgrade', mod: 'assets/upgrade/routes/sb-asset-upgrade/AssetUpgrade.js' }
			});

			_export('ROUTES', ROUTES);
		}
	};
});

'use strict';

System.register('common/Util.js', [], function (_export, _context) {
	var _createClass, Util, frame;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Util', Util = function () {
				function Util() {
					_classCallCheck(this, Util);
				}

				_createClass(Util, null, [{
					key: 'pad',
					value: function pad(n, width, z) {
						z = z || '0';
						n = n + '';
						return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
					}
				}, {
					key: 'toIsoDate',
					value: function toIsoDate(d) {
						d = typeof d === 'number' ? new Date(d) : d;
						return d.getUTCFullYear() + '-' + Util.pad(d.getUTCMonth() + 1, 2) + '-' + Util.pad(d.getUTCDate(), 2) + 'T' + Util.pad(d.getUTCHours(), 2) + ':' + Util.pad(d.getUTCMinutes(), 2) + ':' + Util.pad(d.getUTCSeconds(), 2) + 'Z';
					}
				}, {
					key: 'notifyTopObjects',
					value: function notifyTopObjects(ctxComponent, object, strProp) {
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = Object.keys(object)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var prop = _step.value;

								ctxComponent.notifyPath(strProp + '.' + prop, object[prop]);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'arithmeticOperatorConversion',
					value: function arithmeticOperatorConversion(fieldValue, filterValue, operator) {
						if (filterValue.toLowerCase() === 'true') {
							filterValue = true;
						} else if (filterValue.toLowerCase() === 'false') {
							filterValue = false;
						}
						switch (operator) {
							case 'equals':
								var val = fieldValue === filterValue;
								return val;
							case 'not equals':
								return fieldValue != filterValue;
							case 'less than':
								return fieldValue < filterValue;
							case 'less or equals':
								return fieldValue <= filterValue;
							case 'greater than':
								return fieldValue > filterValue;
							case 'greater or equals':
								return fieldValue >= filterValue;
							case 'starts with':
								fieldValue = fieldValue ? fieldValue : '';
								return fieldValue.toLowerCase().startsWith(filterValue.toLowerCase());
							case 'ends with':
								fieldValue = fieldValue ? fieldValue : '';
								return fieldValue.toLowerCase().endsWith(filterValue.toLowerCase());
							case 'contains':
								fieldValue = fieldValue ? fieldValue : '';
								return fieldValue.toLowerCase().includes(filterValue.toLowerCase());
						}
					}
				}]);

				return Util;
			}());

			_export('Util', Util);

			Util.Map = Map;
			if (!Map || !Map.prototype.get || !Map.prototype.set) {
				frame = document.createElement('iframe');

				document.body.appendChild(frame);
				Util.Map = frame.contentWindow.Map;
				frame.parentNode.removeChild(frame);
			}
		}
	};
});

'use strict';

System.register('common/common.js', ['common/behaviors/DeviceBehavior.js', 'common/behaviors/LookupBehavior.js', 'common/core/sb-i18n/I18n.js', 'common/core/sb-loading-spinner/LoadingSpinner.js', 'common/core/sb-page-container/PageContainer.js', 'common/core/sb-toast/Toast.js', 'common/core/sb-page-header/PageHeader.js', 'common/data/sb-service/Service.js', 'common/filter/searcher/Searcher.js', 'common/forms/sb-field/Field.js', 'common/forms/sb-typeahead/Typeahead.js', 'common/forms/sb-lookup/Lookup.js', 'common/forms/sb-lookup-dialog/LookupDialog.js', 'common/forms/sb-datepicker/Datepicker.js', 'common/forms/sb-discount/Discount.js', 'common/forms/sb-pagination/Pagination.js', 'common/forms/sb-rte/dialog/RichTextEditorDialog.js', 'common/forms/sb-rte/RichTextEditor.js', 'common/layout/sb-actions/Actions.js', 'common/forms/sb-input/Input.js', 'common/forms/sb-select/Select.js', 'common/forms/sb-textarea/Textarea.js', 'common/forms/sb-checkbox/Checkbox.js', 'common/forms/sb-multi-lookup/MultiLookup.js', 'common/layout/sb-div/Div.js', 'common/layout/sb-drawer/Drawer.js', 'common/layout/sb-field-item/FieldItem.js', 'common/layout/sb-field-table/FieldTable.js', 'common/layout/sb-group/Group.js', 'common/layout/sb-html/Html.js', 'common/layout/sb-side-panel/SidePanel.js', 'common/layout/sb-swipe-container/SwipeContainer.js', 'common/layout/sb-table-cell/TableCell.js', 'common/layout/sb-table-cell-select/TableCellSelect.js', 'common/layout/sb-table-header/TableHeader.js', 'common/layout/sb-table-row/TableRow.js', 'common/layout/sb-tabs/Tabs.js', 'common/layout/sb-badge/Badge.js', 'common/layout/sb-dialog/Dialog.js', 'common/layout/sb-popup/Popup.js', 'common/layout/sb-lookup-layout/LookupLayout.js', 'common/layout/sb-filter-layout/FilterLayout.js', 'common/layout/sb-filter-item/FilterItem.js', 'common/services/sb-line-editor-read/LineEditorReader.js', 'common/services/sb-line-editor-cache-save/LineEditorCacheSaver.js', 'common/services/sb-job-checker/JobChecker.js', 'common/services/sb-field-md/FieldMetadata.js', 'common/services/sb-search-model-load/SearchModelLoader.js', 'common/services/sb-search-model-select/SearchModelSelector.js', 'common/data/sb-describe/Describe.js'], function (_export, _context) {
	var HOLD_THRESHOLD, holdTimer;
	return {
		setters: [function (_commonBehaviorsDeviceBehaviorJs) {}, function (_commonBehaviorsLookupBehaviorJs) {}, function (_commonCoreSbI18nI18nJs) {}, function (_commonCoreSbLoadingSpinnerLoadingSpinnerJs) {}, function (_commonCoreSbPageContainerPageContainerJs) {}, function (_commonCoreSbToastToastJs) {}, function (_commonCoreSbPageHeaderPageHeaderJs) {}, function (_commonDataSbServiceServiceJs) {}, function (_commonFilterSearcherSearcherJs) {}, function (_commonFormsSbFieldFieldJs) {}, function (_commonFormsSbTypeaheadTypeaheadJs) {}, function (_commonFormsSbLookupLookupJs) {}, function (_commonFormsSbLookupDialogLookupDialogJs) {}, function (_commonFormsSbDatepickerDatepickerJs) {}, function (_commonFormsSbDiscountDiscountJs) {}, function (_commonFormsSbPaginationPaginationJs) {}, function (_commonFormsSbRteDialogRichTextEditorDialogJs) {}, function (_commonFormsSbRteRichTextEditorJs) {}, function (_commonLayoutSbActionsActionsJs) {}, function (_commonFormsSbInputInputJs) {}, function (_commonFormsSbSelectSelectJs) {}, function (_commonFormsSbTextareaTextareaJs) {}, function (_commonFormsSbCheckboxCheckboxJs) {}, function (_commonFormsSbMultiLookupMultiLookupJs) {}, function (_commonLayoutSbDivDivJs) {}, function (_commonLayoutSbDrawerDrawerJs) {}, function (_commonLayoutSbFieldItemFieldItemJs) {}, function (_commonLayoutSbFieldTableFieldTableJs) {}, function (_commonLayoutSbGroupGroupJs) {}, function (_commonLayoutSbHtmlHtmlJs) {}, function (_commonLayoutSbSidePanelSidePanelJs) {}, function (_commonLayoutSbSwipeContainerSwipeContainerJs) {}, function (_commonLayoutSbTableCellTableCellJs) {}, function (_commonLayoutSbTableCellSelectTableCellSelectJs) {}, function (_commonLayoutSbTableHeaderTableHeaderJs) {}, function (_commonLayoutSbTableRowTableRowJs) {}, function (_commonLayoutSbTabsTabsJs) {}, function (_commonLayoutSbBadgeBadgeJs) {}, function (_commonLayoutSbDialogDialogJs) {}, function (_commonLayoutSbPopupPopupJs) {}, function (_commonLayoutSbLookupLayoutLookupLayoutJs) {}, function (_commonLayoutSbFilterLayoutFilterLayoutJs) {}, function (_commonLayoutSbFilterItemFilterItemJs) {}, function (_commonServicesSbLineEditorReadLineEditorReaderJs) {}, function (_commonServicesSbLineEditorCacheSaveLineEditorCacheSaverJs) {}, function (_commonServicesSbJobCheckerJobCheckerJs) {}, function (_commonServicesSbFieldMdFieldMetadataJs) {}, function (_commonServicesSbSearchModelLoadSearchModelLoaderJs) {}, function (_commonServicesSbSearchModelSelectSearchModelSelectorJs) {}, function (_commonDataSbDescribeDescribeJs) {}],
		execute: function () {
			HOLD_THRESHOLD = 1000;

			if (Polymer) {
				holdTimer = null;


				Polymer.Gestures.register({
					name: 'hold',
					deps: ['mousedown', 'mouseup', 'touchstart', 'touchend'],
					flow: {
						start: ['mousedown', 'touchstart'],
						end: ['mouseup', 'touchend']
					},
					emits: ['hold'],
					mouseup: function mouseup(e) {
						return this.up(e);
					},
					touchend: function touchend(e) {
						return this.up(e.changedTouches[0], e);
					},
					up: function up(e) {
						clearTimeout(holdTimer);
						return false;
					},
					mousedown: function mousedown(e) {
						return this.down(e);
					},
					touchstart: function touchstart(e) {
						return this.down(e.changedTouches[0], e);
					},
					down: function down(e, preventer) {
						holdTimer = setTimeout(function () {
							Polymer.Gestures.fire(Polymer.Gestures.findOriginalTarget(e), 'hold', {
								x: e.clientX,
								y: e.clientY,
								sourceEvent: e,
								preventer: preventer
							});
						}, HOLD_THRESHOLD);
						return false;
					}
				});
			}
		}
	};
});

'use strict';

System.register('docgen/docgen.routes.js', [], function (_export, _context) {
	var PREFIX, ROUTES;
	return {
		setters: [],
		execute: function () {
			_export('PREFIX', PREFIX = '/docgen');

			_export('PREFIX', PREFIX);

			_export('ROUTES', ROUTES = {
				'/preview': { comp: 'sb-docgen-preview', mod: 'docgen/sb-docgen-preview/DocgenPreview.js' }
			});

			_export('ROUTES', ROUTES);
		}
	};
});

'use strict';

System.register('favorites/favorites.js', ['favorites/sb-favorite-lookup/FavoriteLookup.js', 'favorites/sb-favorite-share-dialog/FavoriteShareDialog.js'], function (_export, _context) {
  return {
    setters: [function (_favoritesSbFavoriteLookupFavoriteLookupJs) {}, function (_favoritesSbFavoriteShareDialogFavoriteShareDialogJs) {}],
    execute: function () {}
  };
});

'use strict';

System.register('favorites/favorites.routes.js', [], function (_export, _context) {
	var PREFIX, ROUTES;
	return {
		setters: [],
		execute: function () {
			_export('PREFIX', PREFIX = '/favorite');

			_export('PREFIX', PREFIX);

			_export('ROUTES', ROUTES = {
				'/lookup': { comp: 'sb-favorite-lookup', mod: 'favorites/sb-favorite-lookup/FavoriteLookup.js' }
			});

			_export('ROUTES', ROUTES);
		}
	};
});

'use strict';

System.register('products/products.js', ['products/config/attribute/sb-attribute-item/AttributeItem.js', 'products/config/attribute/sb-attribute-table/AttributeTable.js', 'products/config/bundles/sb-product-bundles-layout/ProductBundlesLayout.js', 'products/config/bundles/sb-product-bundles-filter-item/ProductBundlesFilterItem.js', 'products/config/feature/sb-product-feature/ProductFeature.js', 'products/config/feature/sb-product-feature-layout/ProductFeatureLayout.js', 'products/config/feature/sb-product-feature-category-list/ProductFeatureCategoryList.js', 'products/config/feature/sb-product-feature-list/ProductFeatureList.js', 'products/config/option/sb-product-option-table/ProductOptionTable.js', 'products/config/option/sb-option-cell/OptionCell.js', 'products/config/routes/services/sb-pc-product-load/ProductLoader.js', 'products/config/routes/services/sb-pc-option-save/OptionSaver.js', 'products/config/routes/services/sb-product-rules-invoke/ProductRulesInvoker.js', 'products/config/routes/services/sb-pc-option-configure/OptionConfigurator.js', 'products/config/actions/sb-custom-actions/CustomActions.js', 'products/localization/LocalizeFields.js', 'products/resources/sb-product-alert/ProductAlert.js'], function (_export, _context) {
  return {
    setters: [function (_productsConfigAttributeSbAttributeItemAttributeItemJs) {}, function (_productsConfigAttributeSbAttributeTableAttributeTableJs) {}, function (_productsConfigBundlesSbProductBundlesLayoutProductBundlesLayoutJs) {}, function (_productsConfigBundlesSbProductBundlesFilterItemProductBundlesFilterItemJs) {}, function (_productsConfigFeatureSbProductFeatureProductFeatureJs) {}, function (_productsConfigFeatureSbProductFeatureLayoutProductFeatureLayoutJs) {}, function (_productsConfigFeatureSbProductFeatureCategoryListProductFeatureCategoryListJs) {}, function (_productsConfigFeatureSbProductFeatureListProductFeatureListJs) {}, function (_productsConfigOptionSbProductOptionTableProductOptionTableJs) {}, function (_productsConfigOptionSbOptionCellOptionCellJs) {}, function (_productsConfigRoutesServicesSbPcProductLoadProductLoaderJs) {}, function (_productsConfigRoutesServicesSbPcOptionSaveOptionSaverJs) {}, function (_productsConfigRoutesServicesSbProductRulesInvokeProductRulesInvokerJs) {}, function (_productsConfigRoutesServicesSbPcOptionConfigureOptionConfiguratorJs) {}, function (_productsConfigActionsSbCustomActionsCustomActionsJs) {}, function (_productsLocalizationLocalizeFieldsJs) {}, function (_productsResourcesSbProductAlertProductAlertJs) {}],
    execute: function () {}
  };
});

'use strict';

System.register('products/products.routes.js', [], function (_export, _context) {
	var PREFIX, ROUTES;
	return {
		setters: [],
		execute: function () {
			_export('PREFIX', PREFIX = '/product');

			_export('PREFIX', PREFIX);

			_export('ROUTES', ROUTES = {
				'/dl': { comp: 'sb-dynamic-lookup', mod: 'products/config/routes/sb-dynamic-lookup/DynamicLookup.js' },
				'/lookup': { comp: 'sb-product-lookup', mod: 'products/selection/routes/sb-product-lookup/ProductLookup.js' },
				'/ol': { comp: 'sb-option-lookup', mod: 'products/config/routes/sb-option-lookup/OptionLookup.js' },
				'/pc': { comp: 'sb-product-config', mod: 'products/config/routes/sb-product-config/ProductConfig.js' },
				'/search': { comp: 'sb-product-search', mod: 'products/prototype/sb-product-search/ProductSearch.js' }
			});

			_export('ROUTES', ROUTES);
		}
	};
});

"use strict";

System.register("subscriptions/subscriptions.js", [], function (_export, _context) {
  return {
    setters: [],
    execute: function () {}
  };
});

'use strict';

System.register('subscriptions/subscriptions.routes.js', [], function (_export, _context) {
	var PREFIX, ROUTES;
	return {
		setters: [],
		execute: function () {
			_export('PREFIX', PREFIX = '/subscription');

			_export('PREFIX', PREFIX);

			_export('ROUTES', ROUTES = {
				'/lookup': { comp: 'sb-subscription-lookup', mod: 'subscriptions/selection/routes/sb-subscription-lookup/SubscriptionLookup.js' }
			});

			_export('ROUTES', ROUTES);
		}
	};
});

'use strict';

System.register('quotes/quotes.js', ['quotes/pages/sb-line-editor/LineEditor.js', 'quotes/sb-le-custom-action-services/LECustomActionServices.js', 'quotes/md/sb-le-field-md/LEFieldMD.js', 'quotes/layout/sb-le-group/LEGroup.js', 'quotes/tables/sb-standard-lines/StandardLines.js', 'quotes/tables/sb-segmented-lines/SegmentedLines.js', 'quotes/layout/sb-segmented-line-details/SegmentedLineDetails.js', 'quotes/layout/sb-segmented-detail-row/SegmentedDetailRow.js', 'quotes/layout/sb-le-table-row/LETableRow.js', 'quotes/layout/sb-le-table-cell/LETableCell.js', 'quotes/layout/sb-ds-table-cell/DSTableCell.js', 'quotes/layout/sb-ds-tiers/DSTiers.js', 'quotes/layout/sb-le-table-header/LETableHeader.js', 'quotes/layout/sb-le-table-header-cell/LETableHeaderCell.js', 'quotes/layout/sb-le-footer/LEFooter.js', 'quotes/layout/sb-le-group-layout/LEGroupLayout.js', 'quotes/layout/sb-field-set-table-item/FieldSetTableItem.js', 'quotes/layout/sb-field-set-table/FieldSetTable.js', 'quotes/layout/sb-line-editor-tabs/sb-quote-tabs/QuoteTabs.js', 'quotes/layout/sb-line-editor-tabs/sb-group-tabs/GroupTabs.js', 'quotes/layout/sb-custom-action/CustomAction.js', 'quotes/layout/sb-le-summary-row/LESummaryRow.js', 'quotes/layout/sb-le-summary-row/sb-le-summary-cell/LESummaryCell.js', 'quotes/dialogs/sb-favorite-dialog/FavoriteDialog.js', 'quotes/dialogs/sb-custom-segment-dialog/CustomSegmentDialog.js', 'quotes/layout/sb-cse-table-cell/CSETableCell.js', 'quotes/dialogs/sb-pricebook-dialog/PricebookDialog.js', 'quotes/models/DragDropModel.js', 'quotes/dialogs/sb-discount-schedule-dialog/DiscountScheduleDialog.js'], function (_export, _context) {
  return {
    setters: [function (_quotesPagesSbLineEditorLineEditorJs) {}, function (_quotesSbLeCustomActionServicesLECustomActionServicesJs) {}, function (_quotesMdSbLeFieldMdLEFieldMDJs) {}, function (_quotesLayoutSbLeGroupLEGroupJs) {}, function (_quotesTablesSbStandardLinesStandardLinesJs) {}, function (_quotesTablesSbSegmentedLinesSegmentedLinesJs) {}, function (_quotesLayoutSbSegmentedLineDetailsSegmentedLineDetailsJs) {}, function (_quotesLayoutSbSegmentedDetailRowSegmentedDetailRowJs) {}, function (_quotesLayoutSbLeTableRowLETableRowJs) {}, function (_quotesLayoutSbLeTableCellLETableCellJs) {}, function (_quotesLayoutSbDsTableCellDSTableCellJs) {}, function (_quotesLayoutSbDsTiersDSTiersJs) {}, function (_quotesLayoutSbLeTableHeaderLETableHeaderJs) {}, function (_quotesLayoutSbLeTableHeaderCellLETableHeaderCellJs) {}, function (_quotesLayoutSbLeFooterLEFooterJs) {}, function (_quotesLayoutSbLeGroupLayoutLEGroupLayoutJs) {}, function (_quotesLayoutSbFieldSetTableItemFieldSetTableItemJs) {}, function (_quotesLayoutSbFieldSetTableFieldSetTableJs) {}, function (_quotesLayoutSbLineEditorTabsSbQuoteTabsQuoteTabsJs) {}, function (_quotesLayoutSbLineEditorTabsSbGroupTabsGroupTabsJs) {}, function (_quotesLayoutSbCustomActionCustomActionJs) {}, function (_quotesLayoutSbLeSummaryRowLESummaryRowJs) {}, function (_quotesLayoutSbLeSummaryRowSbLeSummaryCellLESummaryCellJs) {}, function (_quotesDialogsSbFavoriteDialogFavoriteDialogJs) {}, function (_quotesDialogsSbCustomSegmentDialogCustomSegmentDialogJs) {}, function (_quotesLayoutSbCseTableCellCSETableCellJs) {}, function (_quotesDialogsSbPricebookDialogPricebookDialogJs) {}, function (_quotesModelsDragDropModelJs) {}, function (_quotesDialogsSbDiscountScheduleDialogDiscountScheduleDialogJs) {}],
    execute: function () {}
  };
});

'use strict';

System.register('quotes/quotes.routes.js', [], function (_export, _context) {
	var PREFIX, ROUTES;
	return {
		setters: [],
		execute: function () {
			_export('PREFIX', PREFIX = '/quote');

			_export('PREFIX', PREFIX);

			_export('ROUTES', ROUTES = {
				'/le': { comp: 'sb-line-editor', mod: 'quotes/pages/sb-line-editor/LineEditor.js' }
			});

			_export('ROUTES', ROUTES);
		}
	};
});

'use strict';

System.register('common/behaviors/DeviceBehavior.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, totalTime, totalComponents, currentTime, deviceClasses, checkPerformance, quiet, DeviceBehavior;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			totalTime = 0;
			totalComponents = 0;
			currentTime = void 0;
			deviceClasses = void 0;
			checkPerformance = false;
			quiet = true;

			_export('DeviceBehavior', DeviceBehavior = function () {
				function DeviceBehavior() {
					_classCallCheck(this, DeviceBehavior);
				}

				_createClass(DeviceBehavior, [{
					key: 'ready',
					value: function ready() {
						if (checkPerformance) this.startPerformanceCheck();

						var deviceNodes = Polymer.dom(this.root).querySelectorAll('*[device]') || [];
						var deviceClasses = this.getDeviceClasses();
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = deviceClasses[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var deviceClass = _step.value;

								this.toggleClass(deviceClass, true, this);
								var _iteratorNormalCompletion2 = true;
								var _didIteratorError2 = false;
								var _iteratorError2 = undefined;

								try {
									for (var _iterator2 = deviceNodes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
										var deviceNode = _step2.value;

										this.toggleClass(deviceClass, true, deviceNode);
									}
								} catch (err) {
									_didIteratorError2 = true;
									_iteratorError2 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion2 && _iterator2.return) {
											_iterator2.return();
										}
									} finally {
										if (_didIteratorError2) {
											throw _iteratorError2;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						this['deviceClasses'] = deviceClasses.join(' ');

						if (checkPerformance) this.stopPerformanceCheck(this);

						if (!quiet && deviceNodes.length === 0) console.warn(this.tagName.toLowerCase() + '.html is missing an element with the device attribute');
					}
				}, {
					key: 'getDeviceClasses',
					value: function getDeviceClasses() {
						if (deviceClasses) return deviceClasses;

						if (AppContext.isPhone) deviceClasses = ['--phone', '--mobile'];else if (AppContext.isTablet) deviceClasses = ['--tablet', '--mobile'];else deviceClasses = ['--desktop'];

						return deviceClasses;
					}
				}, {
					key: 'startPerformanceCheck',
					value: function startPerformanceCheck() {
						currentTime = performance.now();
					}
				}, {
					key: 'stopPerformanceCheck',
					value: function stopPerformanceCheck() {
						var time = performance.now() - currentTime;
						totalTime += time;
						totalComponents++;
						if (time > 1) console.warn('total (' + totalTime.toFixed(2) + 'ms) | current (' + time.toFixed(2) + 'ms) | totalComponents (' + totalComponents + ') | component (' + this.tagName.toLowerCase() + ')');else console.log('total (' + totalTime.toFixed(2) + 'ms) | current (' + time.toFixed(2) + 'ms) | totalComponents (' + totalComponents + ') | component (' + this.tagName.toLowerCase() + ')');
					}
				}]);

				return DeviceBehavior;
			}());

			_export('DeviceBehavior', DeviceBehavior);

			window.CommonBehaviors = window.CommonBehaviors || {};
			window.CommonBehaviors.DeviceBehavior = DeviceBehavior.prototype;
		}
	};
});

'use strict';

System.register('common/behaviors/LookupBehavior.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, LookupBehavior;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LookupBehavior', LookupBehavior = function () {
				function LookupBehavior() {
					_classCallCheck(this, LookupBehavior);
				}

				_createClass(LookupBehavior, [{
					key: 'ready',
					value: function ready() {
						this.handleProductsLoadServerResponse();
						this.handleHideSearchFilterIfNoSearchColumnsDisplayed();
						this.bindFilterEnterCallBacks();
					}
				}, {
					key: 'handleHideSearchFilterIfNoSearchColumnsDisplayed',
					value: function handleHideSearchFilterIfNoSearchColumnsDisplayed() {
						this.addEventListener('no-displayed-filters', function () {
							this.removeFilter();
						}.bind(this));
					}
				}]);

				return LookupBehavior;
			}());

			_export('LookupBehavior', LookupBehavior);

			window.CommonBehaviors = window.CommonBehaviors || {};
			window.CommonBehaviors.LookupBehavior = LookupBehavior.prototype;
		}
	};
});

'use strict';

System.register('common/core/AppContext.js', [], function (_export, _context) {
	var _createClass, labels, org, md, user, device, i18n, sb, AppContext;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			labels = {};
			org = {};
			md = {};
			user = {};
			device = {};
			i18n = {};
			sb = window ? window.sb || {} : {};

			sb.ui = sb.ui || {};
			sb.common = sb.common || {};
			sb.common.core = sb.common.core || {};
			window.sb = sb;

			_export('AppContext', AppContext = function () {
				function AppContext() {
					_classCallCheck(this, AppContext);
				}

				_createClass(AppContext, [{
					key: 'user',
					get: function get() {
						return user;
					}
				}, {
					key: 'labels',
					get: function get() {
						return labels;
					}
				}, {
					key: 'org',
					get: function get() {
						return org;
					}
				}], [{
					key: 'init',
					value: function init(settingsObj) {
						AppContext.buildUserAndOrgFromSettings(settingsObj);
						AppContext.device = 'desktop';

						if (navigator.userAgent.match(/Tablet|iPad|iPod/i) && !navigator.userAgent.match(/Tablet PC/i) || navigator.userAgent.match(/Android/i) && !navigator.userAgent.match(/Mobi/i)) {
							AppContext.device = 'tablet';
						} else if (navigator.userAgent.match(/Mobi/i)) {
							AppContext.device = 'phone';
						}

						var i18nClass = null;
						return new Promise(function (resolve, reject) {
							System.import('common/core/sb-i18n/I18n.js').then(function (n) {
								i18nClass = n.I18n;
								System.import('labels_en.js').then(function (m) {
									var userLabels = m.LABELS;
									if (sb.labels) {
										userLabels = window.sb.labels;
									}

									labels = userLabels;
									var ret = { labels: userLabels, user: user };

									if (i18nClass) i18n = new i18nClass(ret);

									resolve(ret);
								}).catch(function (e) {
									reject(e);
								});
							});
						});
					}
				}, {
					key: 'buildUserAndOrgFromSettings',
					value: function buildUserAndOrgFromSettings(settingsObj) {
						if (!settingsObj) return;

						AppContext.user = {
							lang: settingsObj.language,
							locale: settingsObj.locale,
							id: settingsObj.userId,
							fullname: settingsObj.fullName,
							username: settingsObj.userName,
							device: settingsObj.device,
							hasQuoteEditPermission: settingsObj.hasQuoteEditPermission
						};

						AppContext.org = {
							prefix: settingsObj.developerPrefix !== undefined ? settingsObj.developerPrefix : 'SBQQ',
							isMultiCurrencyOrg: settingsObj.isMultiCurrencyOrg,
							calculateImmediately: settingsObj.calculateImmediately,
							defaultCurrency: settingsObj.defaultCurrency,
							currencySymbol: settingsObj.currencySymbol,
							currencyDecimalScale: settingsObj.currencyDecimalScale,
							quantityScale: settingsObj.quantityScale,
							isOAuth: settingsObj.isOAuth,
							orgUrl: settingsObj.orgUrl,
							siteUrl: settingsObj.siteUrl,
							apiVersion: 39
						};
					}
				}, {
					key: 'isIE',
					value: function isIE() {
						var ua = window.navigator.userAgent;

						return ua.indexOf('MSIE ') >= 0 || ua.indexOf('Trident/') >= 0;
					}
				}, {
					key: 'isChrome',
					value: function isChrome() {
						var ua = window.navigator.userAgent;
						return ua.indexOf('Chrome') >= 0;
					}
				}, {
					key: 'isFirefox',
					value: function isFirefox() {
						var ua = window.navigator.userAgent;
						return ua.indexOf('Firefox') >= 0;
					}
				}, {
					key: 'isSafari',
					value: function isSafari() {
						var ua = window.navigator.userAgent;
						return ua.indexOf('Safari') >= 0 && ua.indexOf('Chrome') < 0;
					}
				}, {
					key: 'properties',
					get: function get() {
						return {
							app: {
								type: Object,
								value: function value() {
									return {
										user: user,
										labels: labels,
										org: org,
										deviceContext: {
											isDesktop: AppContext.isDesktop,
											isTablet: AppContext.isTablet,
											isPhone: AppContext.isPhone,
											isMobile: AppContext.isPhone || AppContext.isTablet
										}
									};
								}
							},

							i18n: {
								type: Object,
								value: function value() {
									return i18n;
								}
							}
						};
					}
				}, {
					key: 'user',
					get: function get() {
						return user;
					},
					set: function set(obj) {
						user = obj;
					}
				}, {
					key: 'labels',
					get: function get() {
						return labels;
					}
				}, {
					key: 'org',
					get: function get() {
						return org;
					},
					set: function set(obj) {
						org = obj;
					}
				}, {
					key: 'device',
					get: function get() {
						return device;
					},
					set: function set(obj) {
						device = obj;
					}
				}, {
					key: 'isDesktop',
					get: function get() {
						return user.device ? user.device === 'desktop' : device === 'desktop';
					}
				}, {
					key: 'isTablet',
					get: function get() {
						return user.device ? user.device === 'tablet' : device === 'tablet';
					}
				}, {
					key: 'isPhone',
					get: function get() {
						return user.device ? user.device === 'phone' : device === 'phone';
					}
				}, {
					key: 'apiVersion',
					get: function get() {
						return AppContext.org.apiVersion;
					},
					set: function set(version) {
						AppContext.org.apiVersion = version;
					}
				}, {
					key: 'apiVersionString',
					get: function get() {
						return AppContext.org.apiVersion + '.0';
					}
				}]);

				return AppContext;
			}());

			_export('AppContext', AppContext);

			sb.common.core.AppContext = AppContext.prototype;
		}
	};
});

'use strict';

System.register('common/core/Navigator.js', [], function (_export, _context) {
	var _createClass, Navigator;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Navigator', Navigator = function () {
				function Navigator() {
					_classCallCheck(this, Navigator);
				}

				_createClass(Navigator, null, [{
					key: 'nav',
					value: function nav(url, queryParams, pathParams, newWin, component) {
						var u = url,
						    pLen = pathParams ? pathParams.length : 0,
						    pKeys = queryParams ? Object.keys(queryParams) : [],
						    kLen = pKeys.length;

						if (pathParams) {
							for (var i = 0; i < pLen; i++) {
								if (pathParams[i] != null && pathParams[i] != undefined && pathParams[i] != '') u += '/' + encodeURIComponent(pathParams[i]);
							}
						}

						for (var _i = 0; _i < kLen; _i++) {
							u += _i == 0 ? '?' : '&';
							u += encodeURIComponent(pKeys[_i]) + '=' + encodeURIComponent(queryParams[pKeys[_i]]);
						}

						component.fire('iron-signal', { name: 'sb-navigation-changed', data: { url: url, location: u } });
						window.location.hash = u;
					}
				}]);

				return Navigator;
			}());

			_export('Navigator', Navigator);
		}
	};
});

'use strict';

System.register('common/core/Page.js', ['common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js', 'common/core/Navigator.js'], function (_export, _context) {
	var PageContainer, AppContext, Navigator, _createClass, sb, SIZE_S, SIZE_M, SIZE_L, SIZE_XL, Page;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreNavigatorJs) {
			Navigator = _commonCoreNavigatorJs.Navigator;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			sb = window ? window.sb || {} : {};

			sb.ui = sb.ui || {};
			sb.common = sb.common || {};
			sb.common.core = sb.common.core || {};
			window.sb = sb;

			_export('SIZE_S', SIZE_S = 'S');

			_export('SIZE_S', SIZE_S);

			_export('SIZE_M', SIZE_M = 'M');

			_export('SIZE_M', SIZE_M);

			_export('SIZE_L', SIZE_L = 'L');

			_export('SIZE_L', SIZE_L);

			_export('SIZE_XL', SIZE_XL = 'XL');

			_export('SIZE_XL', SIZE_XL);

			_export('Page', Page = function (_AppContext) {
				_inherits(Page, _AppContext);

				function Page() {
					_classCallCheck(this, Page);

					return _possibleConstructorReturn(this, (Page.__proto__ || Object.getPrototypeOf(Page)).apply(this, arguments));
				}

				_createClass(Page, [{
					key: 'nav',
					value: function nav(url, queryParams, pathParams, newWin) {
						Navigator.nav(url, queryParams, pathParams, newWin, this);
					}
				}], [{
					key: 'properties',
					get: function get() {
						return Polymer.Base.extend({
							ctx: {
								type: Object,
								value: function value() {
									return {};
								}
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						}, AppContext.properties);
					}
				}]);

				return Page;
			}(AppContext));

			_export('Page', Page);

			sb.common.core.Page = Page.prototype;
		}
	};
});

"use strict";

System.register("common/forms/DependentPicklistBuilder.js", [], function (_export, _context) {
    var _createClass, DependentPicklistBuilder;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export("DependentPicklistBuilder", DependentPicklistBuilder = function () {
                function DependentPicklistBuilder(controlledPicklist, controllingValue) {
                    _classCallCheck(this, DependentPicklistBuilder);

                    this.controlledPicklist = controlledPicklist;
                    this.controllingValue = controllingValue;
                }

                _createClass(DependentPicklistBuilder, [{
                    key: "build",
                    value: function build() {
                        var options = this.controlledPicklist.picklistValues;
                        var validOptions = [];
                        options.forEach(function (option) {
                            if (this._testBit(atob(option.validFor), this._getControllingValueIndex(this.controllingValue))) {
                                validOptions.push(option);
                            }
                        }.bind(this));
                        return validOptions;
                    }
                }, {
                    key: "_getControllingValueIndex",
                    value: function _getControllingValueIndex(value) {
                        var controllingOptions = this.controlledPicklist.controllingField.picklistValues;
                        for (var i = 0, l = controllingOptions.length; i < l; i++) {
                            if (controllingOptions[i].value == value) {
                                return i;
                            }
                        }
                        return -1;
                    }
                }, {
                    key: "_testBit",
                    value: function _testBit(validFor, controllingValueIndex) {
                        var byteToCheck = Math.floor(controllingValueIndex / 8);
                        var bit = 7 - controllingValueIndex % 8;
                        return (Math.pow(2, bit) & validFor.charCodeAt(byteToCheck)) >> bit == 1;
                    }
                }]);

                return DependentPicklistBuilder;
            }());

            _export("DependentPicklistBuilder", DependentPicklistBuilder);
        }
    };
});

'use strict';

System.register('common/forms/Locale.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, Locale, COMMA_DECIMAL_LOCALES;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Locale', Locale = function () {
				function Locale() {
					_classCallCheck(this, Locale);
				}

				_createClass(Locale, null, [{
					key: 'get',
					value: function get() {
						return AppContext.user ? AppContext.user.locale || 'en-US' : 'en-US';
					}
				}, {
					key: 'isCommaDecimal',
					value: function isCommaDecimal(locale) {
						return COMMA_DECIMAL_LOCALES.indexOf(locale || Locale.get()) !== -1;
					}
				}]);

				return Locale;
			}());

			_export('Locale', Locale);

			_export('COMMA_DECIMAL_LOCALES', COMMA_DECIMAL_LOCALES = ['bg-BG', 'ca-ES', 'hr-HR', 'cs-CZ', 'da-DK', 'nl-AW', 'nl-BE', 'nl-NL', 'nl-SR', 'et-EE', 'fi-FI', 'fr-BE', 'fr-CA', 'fr-KM', 'fr-FR', 'fr-GN', 'fr-HT', 'fr-LU', 'fr-MR', 'fr-MC', 'fr-WF', 'de-AT', 'de-DE', 'de-LU', 'el-GR', 'hu-HU', 'in-ID', 'it-IT', 'lv-LV', 'lt-LT', 'pl-PL', 'pt-AO', 'pt-BR', 'pt-CV', 'pt-MZ', 'pt-PT', 'pt-ST', 'ro-MD', 'ro-RO', 'ru-RU', 'sr-BA', 'sr-RS', 'sr-CS', 'sk-SK', 'sl-SI', 'es-AR', 'es-BO', 'es-CL', 'es-CO', 'es-CU', 'es-EC', 'es-PY', 'es-PE', 'es-ES', 'es-UY', 'es-VE', 'sv-SE', 'tr-TR', 'uk-UA', 'vi-VN']);

			_export('COMMA_DECIMAL_LOCALES', COMMA_DECIMAL_LOCALES);
		}
	};
});

'use strict';

System.register('common/forms/NumberFormatter.js', ['common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js', 'common/forms/Locale.js'], function (_export, _context) {
	var PageContainer, AppContext, Locale, _createClass, NumberFormatter;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonFormsLocaleJs) {
			Locale = _commonFormsLocaleJs.Locale;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('NumberFormatter', NumberFormatter = function () {
				function NumberFormatter(editable, metadata, i18n, type, viewport) {
					_classCallCheck(this, NumberFormatter);

					this.editable = editable;
					this.metadata = metadata;
					this.i18n = i18n;
					this.type = type;
					this.viewport = viewport || PageContainer.getViewport();
					this.appContext = AppContext;
				}

				_createClass(NumberFormatter, [{
					key: 'format',
					value: function format(value, allowCurrency) {
						var opts = {};
						if (this.metadata.scale != undefined && this.metadata.scale >= 0) {
							opts.minimumFractionDigits = this.metadata.scale;
							opts.maximumFractionDigits = this.metadata.scale;
						}

						if (this.type === 'currency' && allowCurrency) this._setCurrencyFormatOptions(opts);

						if (this.editable && this.isMobile() && !Locale.isCommaDecimal()) opts.useGrouping = false;

						if (this.isNil(value)) return null;

						try {
							var formattedValue = this.i18n.format(value, opts);
							if (formattedValue === 'NaN') throw new Error(value + ' is not a number');
							return formattedValue;
						} catch (err) {
							return value;
						}
					}
				}, {
					key: 'isNil',
					value: function isNil(value) {
						return value === undefined || value === null || value === '' || isNaN(value);
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: '_setCurrencyFormatOptions',
					value: function _setCurrencyFormatOptions(opts) {
						opts.style = 'currency';
						if (this.appContext.org.isMultiCurrencyOrg) {
							opts.currency = this.metadata && this.metadata.CurrencyIsoCode ? this.metadata.CurrencyIsoCode : this.appContext.org.defaultCurrency;
							opts.currencyDisplay = 'code';
						} else {
							opts.currencyDisplay = 'symbol';
							if (!this.appContext.org.currencySymbol) {
								opts.currency = this.appContext.org.defaultCurrency;
							} else {
								opts.currency = 'XXX';
							}
						}
					}
				}]);

				return NumberFormatter;
			}());

			_export('NumberFormatter', NumberFormatter);
		}
	};
});

'use strict';

System.register('common/forms/NumberParser.js', ['common/forms/Locale.js'], function (_export, _context) {
	var Locale, _createClass, NumberParser;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsLocaleJs) {
			Locale = _commonFormsLocaleJs.Locale;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('NumberParser', NumberParser = function () {
				function NumberParser(locale) {
					_classCallCheck(this, NumberParser);

					this.locale = locale || Locale.get();
					this.isCommaDecimalLocale = Locale.isCommaDecimal(this.locale);
				}

				_createClass(NumberParser, [{
					key: 'parse',
					value: function parse(numberStr) {
						if (typeof numberStr !== 'string') return numberStr;
						numberStr = this.removeUnusualSeparators(numberStr);

						numberStr = this.removeNonDecimalCommas(numberStr);

						numberStr = this.removeDecimalSepartors(numberStr);

						numberStr = this.replaceCommaDecimalWithPeriod(numberStr);

						return parseFloat(numberStr);
					}
				}, {
					key: 'removeUnusualSeparators',
					value: function removeUnusualSeparators(numberStr) {
						return numberStr.replace(new RegExp('[\\\s]+', 'g'), '').replace(new RegExp("'", 'g'), '');
					}
				}, {
					key: 'removeNonDecimalCommas',
					value: function removeNonDecimalCommas(numberStr) {
						return !this.isCommaDecimalLocale ? numberStr.replace(new RegExp(',', 'g'), '') : numberStr;
					}
				}, {
					key: 'removeDecimalSepartors',
					value: function removeDecimalSepartors(numberStr) {
						return this.isCommaDecimalLocale ? numberStr.replace(new RegExp('[.]', 'g'), '') : numberStr;
					}
				}, {
					key: 'replaceCommaDecimalWithPeriod',
					value: function replaceCommaDecimalWithPeriod(numberStr) {
						return this.isCommaDecimalLocale ? numberStr.replace(new RegExp(',', 'g'), '.') : numberStr;
					}
				}]);

				return NumberParser;
			}());

			_export('NumberParser', NumberParser);
		}
	};
});

'use strict';

System.register('common/oauth/OAuth.js', ['common/oauth/oauth.local.js'], function (_export, _context) {
    var OAUTH_KEY, OAUTH_SECRET, _createClass, url, oauth2, OAuth;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [function (_commonOauthOauthLocalJs) {
            OAUTH_KEY = _commonOauthOauthLocalJs.OAUTH_KEY;
            OAUTH_SECRET = _commonOauthOauthLocalJs.OAUTH_SECRET;
        }],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            url = 'http://localhost:' + location.port + '/common/oauth';
            oauth2 = {
                clientId: OAUTH_KEY,
                clientSecret: OAUTH_SECRET,
                redirectUri: url + '/callback',
                proxyUrl: 'https://brick-rest-proxy.herokuapp.com/proxy/'
            };

            _export('OAuth', OAuth = function () {
                function OAuth(tokens) {
                    _classCallCheck(this, OAuth);

                    if (!oauth2.clientId || !oauth2.clientSecret) throw Error(this._getNoOAuthClientKeyMessage());

                    var storeTokens = jsforce.browser.Client.prototype._storeTokens.bind(jsforce.browser);
                    jsforce.browser.Client.prototype._storeTokens = function (params) {
                        storeTokens(params);
                        localStorage.setItem(this._prefix + '_refresh_token', params.refresh_token);
                    }.bind(jsforce.browser);

                    var removeTokens = jsforce.browser.Client.prototype._removeTokens.bind(jsforce.browser);
                    jsforce.browser.Client.prototype._removeTokens = function () {
                        removeTokens();
                        localStorage.removeItem(this._prefix + '_refresh_token');
                    }.bind(jsforce.browser);

                    var getTokens = jsforce.browser.Client.prototype._getTokens.bind(jsforce.browser);
                    jsforce.browser.Client.prototype._getTokens = function () {
                        var tokens = getTokens();
                        if (tokens) tokens.refreshToken = localStorage.getItem(this._prefix + '_refresh_token');
                        return tokens;
                    }.bind(jsforce.browser);

                    var isLoggedIn = jsforce.browser.Client.prototype.isLoggedIn.bind(jsforce.browser);
                    jsforce.browser.Client.prototype.isLoggedIn = function () {
                        if (!isLoggedIn()) return false;
                        return this.connection.refreshToken;
                    }.bind(jsforce.browser);

                    (function () {
                        localStorage.setItem(this._prefix + '_issued_at', new Date().getTime());
                        document.cookie = this._prefix + '_loggedin=true;';
                    }).bind(jsforce.browser)();

                    if (tokens) jsforce.browser._storeTokens(tokens);

                    jsforce.browser.init(oauth2);
                }

                _createClass(OAuth, [{
                    key: 'login',
                    value: function login() {
                        jsforce.browser.login();
                    }
                }, {
                    key: 'getConnection',
                    value: function getConnection() {
                        if (!jsforce.browser.isLoggedIn()) return Promise.reject('Please login before establishing a connection at http://localhost:' + location.port + '/common/oauth');

                        return new Promise(function (resolve, reject) {
                            jsforce.browser.once('connect', function (conn) {
                                var createRequestParams = conn.apex._createRequestParams.bind(conn.apex);
                                conn.apex._createRequestParams = function (method, path, body) {
                                    var params = createRequestParams(method, path, body);
                                    params.headers = params.headers || {};
                                    params.headers['X-Authorization'] = conn.refreshToken;
                                    return params;
                                };
                                resolve(conn);
                            });
                            jsforce.browser.init(oauth2);
                        });
                    }
                }, {
                    key: '_getNoOAuthClientKeyMessage',
                    value: function _getNoOAuthClientKeyMessage() {
                        return 'Need to add a \'.env.json\' file in the CPQ dir whose contents contains the Consumer Key and Consumer Secret of the Salesforce CPQ Connected App, and then execute a gulp compile.\n' + '{"oauth_key": "<Consumer Key>, "oauth_secret": "<Consumer Secret>"}';
                    }
                }, {
                    key: 'encodeTokenUrl',
                    value: function encodeTokenUrl() {
                        var tokens = jsforce.browser._getTokens();
                        var refreshToken = tokens.refreshToken;
                        var orgUrl = encodeURIComponent(tokens.instanceUrl);
                        var id = encodeURIComponent(tokens.userInfo.url);
                        return url + '?rt=' + refreshToken + '&org=' + orgUrl + '&id=' + id;
                    }
                }, {
                    key: 'accessToken',
                    set: function set(accessToken) {
                        localStorage.setItem(jsforce.browser._prefix + '_access_token', accessToken);
                    }
                }, {
                    key: 'tokens',
                    get: function get() {
                        return jsforce.browser._getTokens();
                    },
                    set: function set(tokens) {
                        jsforce.browser._storeTokens(tokens);
                    }
                }], [{
                    key: 'decodeTokenUrl',
                    value: function decodeTokenUrl(url) {
                        if (!url) return;
                        var refreshToken = OAuth._getParameterByName('rt', url);
                        var orgUrl = OAuth._getParameterByName('org', url);
                        var id = OAuth._getParameterByName('id', url);
                        if (refreshToken && orgUrl && id) return { refresh_token: refreshToken, instance_url: orgUrl, id: id, access_token: 'xyz', issued_at: new Date().getTime() };
                    }
                }, {
                    key: '_getParameterByName',
                    value: function _getParameterByName(name, url) {
                        name = name.replace(/[\[\]]/g, "\\$&");
                        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                            results = regex.exec(url);
                        if (!results) return null;
                        if (!results[2]) return '';
                        return decodeURIComponent(results[2].replace(/\+/g, " "));
                    }
                }]);

                return OAuth;
            }());

            _export('OAuth', OAuth);
        }
    };
});

'use strict';

System.register('common/oauth/oauth.local.js', [], function (_export, _context) {
  var OAUTH_KEY, OAUTH_SECRET;
  return {
    setters: [],
    execute: function () {
      _export('OAUTH_KEY', OAUTH_KEY = 'undefined');

      _export('OAUTH_KEY', OAUTH_KEY);

      _export('OAUTH_SECRET', OAUTH_SECRET = 'undefined');

      _export('OAUTH_SECRET', OAUTH_SECRET);
    }
  };
});

'use strict';

System.register('common/relationship/RelationshipFieldManager.js', ['common/forms/sb-lookup/map/LookupNameMapper.js'], function (_export, _context) {
	var LookupNameMapper, _createClass, RelationshipFieldManager;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbLookupMapLookupNameMapperJs) {
			LookupNameMapper = _commonFormsSbLookupMapLookupNameMapperJs.LookupNameMapper;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RelationshipFieldManager', RelationshipFieldManager = function () {
				function RelationshipFieldManager(field, record) {
					_classCallCheck(this, RelationshipFieldManager);

					this.field = field;
					this.record = record;
				}

				_createClass(RelationshipFieldManager, [{
					key: 'hasRelationship',
					value: function hasRelationship() {
						return !!this.getRelationship();
					}
				}, {
					key: 'getRelationship',
					value: function getRelationship() {
						var relationshipField = RelationshipFieldManager.getRelationshipField(this.field);
						if (!relationshipField) return;

						if (typeof this.record === 'function') return this.record(relationshipField);

						return this.record[relationshipField];
					}
				}, {
					key: 'getRelationshipName',
					value: function getRelationshipName(nameField) {
						var relationship = this.getRelationship();
						if (!relationship) return;

						var name = nameField || this._getLookupName(relationship);
						return relationship[name];
					}
				}, {
					key: 'addRelationshipName',
					value: function addRelationshipName(id, display, tableName) {
						var relationship = this.buildRelationship(id, display, tableName);
						if (!relationship.value.Id) {
							relationship.value = null;
						}
						if (!relationship) return;

						if (typeof this.record === 'function') return this.record(relationship.field, relationship.value);

						this.record[relationship.field] = relationship.value;
					}
				}, {
					key: 'buildRelationship',
					value: function buildRelationship(id, display, tableName) {
						var relationshipField = RelationshipFieldManager.getRelationshipField(this.field);
						if (!relationshipField) return;

						var relationship = this.getRelationship() || {};
						var nameField = new LookupNameMapper(tableName).getNameField();

						relationship.Id = id;
						relationship[nameField] = display;
						return { value: relationship, field: relationshipField };
					}
				}, {
					key: '_getLookupName',
					value: function _getLookupName(relationship) {
						var relationshipTable = relationship.attributes ? relationship.attributes.type : '';
						return new LookupNameMapper(relationshipTable).getNameField();
					}
				}], [{
					key: 'getRelationshipField',
					value: function getRelationshipField(idField, tableName) {
						var relationshipField = void 0;
						if (idField.endsWith('__c')) relationshipField = idField.replace(/__c$/, '__r');else if (idField.endsWith('Id')) relationshipField = idField.substring(0, idField.length - 2);

						if (!relationshipField || !tableName) return relationshipField;

						var nameField = new LookupNameMapper(tableName).getNameField();
						return relationshipField + '.' + nameField;
					}
				}]);

				return RelationshipFieldManager;
			}());

			_export('RelationshipFieldManager', RelationshipFieldManager);
		}
	};
});

"use strict";

System.register("common/signal/AbstractFocusSignaler.js", [], function (_export, _context) {
	var _createClass, AbstractFocusSignaler;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export("AbstractFocusSignaler", AbstractFocusSignaler = function () {
				function AbstractFocusSignaler(element, focusEvents, blurEvents) {
					_classCallCheck(this, AbstractFocusSignaler);

					this.element = element;
					this.focusEvents = focusEvents;
					this.blurEvents = blurEvents;
				}

				_createClass(AbstractFocusSignaler, [{
					key: "signalOnFocus",
					value: function signalOnFocus(signalName, unregister) {
						this.fireFocusSignal = this.fireFocusSignal || this._fireSignal.bind(this, signalName, true);
						this.fireBlurSignal = this.fireBlurSignal || this._fireSignal.bind(this, signalName, false);

						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.focusEvents[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var focusEvent = _step.value;

								this.element.removeEventListener(focusEvent, this.fireFocusSignal);
								if (!unregister) this.element.addEventListener(focusEvent, this.fireFocusSignal);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = this.blurEvents[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var blurEvent = _step2.value;

								this.element.removeEventListener(blurEvent, this.fireBlurSignal);
								if (!unregister) this.element.addEventListener(blurEvent, this.fireBlurSignal);
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}
					}
				}, {
					key: "fireSignal",
					value: function fireSignal(signalName, focused) {
						this._fireSignals(signalName, focused);

						var lastSignaler = this._getLastSignaler();
						if (lastSignaler === this) return;

						if (lastSignaler) lastSignaler._fireSignals(signalName, false);

						this._setLastSignaler();
					}
				}, {
					key: "getSignalTargets",
					value: function getSignalTargets() {
						return [];
					}
				}, {
					key: "disable",
					value: function disable() {
						this._toggleDisabled(true);
					}
				}, {
					key: "enable",
					value: function enable() {
						this._toggleDisabled(false);
					}
				}, {
					key: "_fireSignal",
					value: function _fireSignal(signalName, focused) {
						if (!this._isDisabled()) this.fireSignal(signalName, focused);
					}
				}, {
					key: "_fireSignals",
					value: function _fireSignals(signalName, focused) {
						var targets = this.getSignalTargets();
						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = targets[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var target = _step3.value;

								target.fire(signalName, { focused: focused, signaler: this });
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}
					}
				}, {
					key: "_getLastSignaler",
					value: function _getLastSignaler() {
						return window && window.signaler ? window.signaler.last : null;
					}
				}, {
					key: "_isDisabled",
					value: function _isDisabled() {
						return window && window.signaler && window.signaler.disabled;
					}
				}, {
					key: "_setLastSignaler",
					value: function _setLastSignaler() {
						var signaler = window.signaler || {};
						signaler.last = this;
						window.signaler = signaler;
					}
				}, {
					key: "_toggleDisabled",
					value: function _toggleDisabled(disabled) {
						var signaler = window.signaler || {};
						signaler.disabled = disabled;
						window.signaler = signaler;
					}
				}]);

				return AbstractFocusSignaler;
			}());

			_export("AbstractFocusSignaler", AbstractFocusSignaler);
		}
	};
});

'use strict';

System.register('common/signal/RowFocusSignaler.js', ['common/signal/AbstractFocusSignaler.js'], function (_export, _context) {
	var AbstractFocusSignaler, _createClass, RowFocusSignaler;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonSignalAbstractFocusSignalerJs) {
			AbstractFocusSignaler = _commonSignalAbstractFocusSignalerJs.AbstractFocusSignaler;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RowFocusSignaler', RowFocusSignaler = function (_AbstractFocusSignale) {
				_inherits(RowFocusSignaler, _AbstractFocusSignale);

				function RowFocusSignaler(row, groupId, cellName, rowId) {
					_classCallCheck(this, RowFocusSignaler);

					var _this = _possibleConstructorReturn(this, (RowFocusSignaler.__proto__ || Object.getPrototypeOf(RowFocusSignaler)).call(this, row, ['focus', 'tap', 'mouseenter'], ['mouseleave']));

					_this.groupId = groupId;
					_this.cellName = cellName;
					_this.rowId = rowId;
					return _this;
				}

				_createClass(RowFocusSignaler, [{
					key: 'getSignalTargets',
					value: function getSignalTargets() {
						if (this.fields) return this.fields;

						var group = this.element.$$('#' + this.groupId);
						if (!group) return [];

						this.fields = [];
						var cells = Polymer.dom(group.root).querySelectorAll(this.cellName);
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = cells[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var cell = _step.value;

								this.fields.push(cell.$$('sb-field'));
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return this.fields;
					}
				}, {
					key: 'toggleRowFocus',
					value: function toggleRowFocus(signal) {
						if (signal.detail.focused && !this.element.focused) {
							this.element.focused = true;
							if (this.rowId) this.element.toggleClass('focused', true, this.element.$$('#' + this.rowId));
						} else if (!signal.detail.focused && this.element.focused) {
							this.element.focused = false;
							if (this.rowId) this.element.toggleClass('focused', false, this.element.$$('#' + this.rowId));
						}
					}
				}]);

				return RowFocusSignaler;
			}(AbstractFocusSignaler));

			_export('RowFocusSignaler', RowFocusSignaler);
		}
	};
});

'use strict';

System.register('docgen/sb-docgen-preview/DocgenPreview.js', ['../../common/core/Page.js'], function (_export, _context) {
	var Page, _createClass, templates, DocgenPreview;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			templates = [{ name: 't1', title: 'My Favorite Template' }, { name: 't2', title: 'Okay Template' }, { name: 't3', title: 'Super Template' }, { name: 't4', title: 'Nasty Template' }, { name: 't5', title: 'Don\'t Go Here' }];

			_export('DocgenPreview', DocgenPreview = function (_Page) {
				_inherits(DocgenPreview, _Page);

				function DocgenPreview() {
					_classCallCheck(this, DocgenPreview);

					return _possibleConstructorReturn(this, (DocgenPreview.__proto__ || Object.getPrototypeOf(DocgenPreview)).apply(this, arguments));
				}

				_createClass(DocgenPreview, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-docgen-preview';
						this.properties = Polymer.Base.extend({
							obj: {
								type: Object,
								value: function value() {
									return {};
								}
							},
							templates: {
								type: Array,
								value: function value() {
									return templates;
								}
							}
						}, Page.properties);
					}
				}, {
					key: 'cancel',
					value: function cancel() {
						this.nav('/entities/quote/detail?id=' + this.ctx.params.id);
					}
				}, {
					key: 'preview',
					value: function preview() {
						this.nav('/docgen/preview?id=' + this.ctx.params.id);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page];
					}
				}]);

				return DocgenPreview;
			}(Page));

			_export('DocgenPreview', DocgenPreview);

			Polymer(DocgenPreview);
		}
	};
});

'use strict';

System.register('favorites/sb-favorite-lookup/FavoriteLookup.js', ['common/core/Page.js', 'common/core/Navigator.js', 'common/data/format/DataBuilder.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, Navigator, DataBuilder, ErrorFormatter, _createClass, FavoriteLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonCoreNavigatorJs) {
			Navigator = _commonCoreNavigatorJs.Navigator;
		}, function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FavoriteLookup', FavoriteLookup = function (_Page) {
				_inherits(FavoriteLookup, _Page);

				function FavoriteLookup() {
					_classCallCheck(this, FavoriteLookup);

					return _possibleConstructorReturn(this, (FavoriteLookup.__proto__ || Object.getPrototypeOf(FavoriteLookup)).apply(this, arguments));
				}

				_createClass(FavoriteLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-favorite-lookup';
						this.properties = Polymer.Base.extend({
							lineEditorModel: Object,
							favoriteModel: Object,
							selectedFavorites: {
								type: Object,
								value: {}
							},
							actions: {
								type: Array,
								value: []
							},
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							error: {
								type: Array,
								value: []
							},
							qId: String,
							groupKey: Number,
							isMobile: Boolean
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.qId = this.qId || this.ctx.params.qId;
						this.aId = this.aId || this.ctx.params.aId;
						this.groupKey = parseInt(this.groupKey || this.ctx.params.groupKey) || null;
						this.isMobile = this._isMobileViewport();

						this.$.le.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
						}.bind(this));

						this.$.md.addEventListener('md-changed', function (e) {
							this._setMetaData(e.detail.value.fields);
						}.bind(this));

						this.$.fm.addEventListener('response-changed', function () {
							this._setSelected();
						}.bind(this));

						this.$.addFavorite.addEventListener('response-changed', function (e) {
							this.lineEditorModel.quote = e.detail.value;
							this._toggleSelected();
							if (!this.addMore) Navigator.nav('#', { qId: this.qId }, ['quote', 'le'], false, this);

							this.$.header.selected = false;
							this.addMore = false;
						}.bind(this));

						this.addEventListener('favorite-shared', function (e) {
							this.$.shareFavorites.addEventListener('response-changed', function () {
								this._toggleSelected();
							}.bind(this));

							var model = new DataBuilder().addQuote('quoteJSON', this.le.quote).add('favIds', Object.keys(this.selectedFavorites)).add('groupIds', e.detail.groups).add('userIds', e.detail.users).build();

							this.$.shareFavorites.model = model;
						}.bind(this));

						this._handleOneFavoriteSelected();
						this._handleAllFavoritesSelected();
					}
				}, {
					key: '_setMetaData',
					value: function _setMetaData(fields) {
						this.cols = this.favoriteModel.resultFieldNames;
						var model = {};
						var colsDisplay = {};
						var fieldLabels = [];
						var numFields = fields.length;
						for (var i = 0; i < numFields; i++) {
							var field = fields[i];
							model[field.name] = { type: field.type };
							colsDisplay[field.name] = field.label;
							fieldLabels.push(field.label);
						}
						this.model = model;
						this.primaryMobileCols = ['Name', 'SBQQ__Description__c'];
						this.colsDisplay = colsDisplay;
						this.fieldLabels = fieldLabels;
					}
				}, {
					key: '_setSelected',
					value: function _setSelected() {
						this.favoriteModel.favorites.forEach(function (favorite) {
							favorite.selected = false;
						});
					}
				}, {
					key: '_handleOneFavoriteSelected',
					value: function _handleOneFavoriteSelected() {
						this.addEventListener('selection-changed', function (e) {
							var record = e.detail;
							var selected = record.selected;
							var recordId = record.Id;

							if (selected) this.selectedFavorites[recordId] = record;else delete this.selectedFavorites[recordId];
						}.bind(this));
					}
				}, {
					key: '_handleAllFavoritesSelected',
					value: function _handleAllFavoritesSelected() {
						this.addEventListener('header-selection-changed', function (e) {
							var selected = e.detail.selected;

							if (selected) {
								this._toggleSelected(true);
								this.favoriteModel.favorites.forEach(function (favorite) {
									this.selectedFavorites[favorite.record.Id] = favorite.record;
								}.bind(this));
							} else {
								this._toggleSelected(false);
								this.selectedFavorites = {};
							}
						}.bind(this));
					}
				}, {
					key: '_toggleSelected',
					value: function _toggleSelected(bool) {
						var selected = bool ? bool : false;
						this.$.header.selected = selected;
						var rows = Polymer.dom(this.$.tbody).querySelectorAll('sb-table-row');
						if (rows && rows.length > 0) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var row = _step.value;

									row.selected = selected;
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}
					}
				}, {
					key: '_removeSelections',
					value: function _removeSelections() {
						this.selectedFavorites = {};
						this._setSelected();
					}
				}, {
					key: '_isMobileViewport',
					value: function _isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'onDeleteFavorite',
					value: function onDeleteFavorite() {
						var model = new DataBuilder().addQuote('quoteJSON', this.le.quote).add('favIds', Object.keys(this.selectedFavorites)).build();

						this.$.deleteFavorite.model = model;
					}
				}, {
					key: 'toggleAddProducts',
					value: function toggleAddProducts() {
						this._toggleSelected();
						var params = { qId: this.qId };
						if (this.groupKey != null) params.groupKey = this.groupKey;
						if (this.aId) params.aId = this.aId;
						Navigator.nav('#', params, ['product', 'lookup'], false, this);
					}
				}, {
					key: 'onShareFavorite',
					value: function onShareFavorite() {
						if (Object.keys(this.selectedFavorites).length === 0) {
							this.error = ["Please select at least one favorite to share."];
							return;
						}
						this.$.shareFavorite.$.dialog.toggle();
					}
				}, {
					key: 'onSelect',
					value: function onSelect() {
						var model = new DataBuilder().addQuote('quoteJSON', this.le.quote).add('groupKey', this.groupKey).add('favIds', Object.keys(this.selectedFavorites)).build();

						this.$.addFavorite.model = model;
					}
				}, {
					key: 'onSelectMore',
					value: function onSelectMore() {
						this.addMore = true;
						this.onSelect();
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						Navigator.nav('#', { qId: this.qId }, ['quote', 'le'], false, this);
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (this.errors.validations && this.errors.validations.length > 0) {
							this.error = this.errors.validations;
							return;
						}

						if (!this.errors[0]) return;
						this.error = new ErrorFormatter(this.errors).truncate();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}]);

				return FavoriteLookup;
			}(Page));

			_export('FavoriteLookup', FavoriteLookup);

			Polymer(FavoriteLookup);
		}
	};
});

'use strict';

System.register('favorites/sb-favorite-share-dialog/FavoriteShareDialog.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, FavoriteShareDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FavoriteShareDialog', FavoriteShareDialog = function () {
				function FavoriteShareDialog() {
					_classCallCheck(this, FavoriteShareDialog);
				}

				_createClass(FavoriteShareDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-favorite-share-dialog';
						this.properties = {
							favdUsers: {
								type: Array,
								value: []
							},
							favdGroups: {
								type: Array,
								value: []
							},
							favoriteCallback: {
								type: Function,
								value: function value() {
									return this._favoriteCallbackFunction.bind(this);
								}
							},
							iconMap: {
								type: Object,
								value: {
									User: 'sf-icon-user',
									Group: 'sf-icon-groups'
								}
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('sb-cancel-share-fav', this.onCancel);
						if (this.viewport && this.viewport.isMobile()) this.toggleClass('mobile', true, this.$.dialog);
					}
				}, {
					key: '_favoriteCallbackFunction',
					value: function _favoriteCallbackFunction(searchValue) {
						return new Promise(function (resolve, reject) {
							if (searchValue.length < 2) {
								this.viewport.isMobile() ? this.$.multilookup.updateTable([]) : resolve([]);
								return;
							}

							this.$.service.uid = '';
							this.$.service.context = searchValue;
							this.$.multilookup.menuItemLabels = ['label'];

							this.$.service.addEventListener('response-changed', function (e) {
								var results = this._parseResults(e.detail.value);
								if (this.viewport.isMobile()) {
									this.$.multilookup.updateTable(results);
								} else {
									resolve(results);
								}
							}.bind(this));
							this.$.service.addEventListener('error-changed', function (e) {
								reject(e.detail.value);
							}.bind(this));
						}.bind(this));
					}
				}, {
					key: '_parseResults',
					value: function _parseResults(results) {
						var groups = results.groups,
						    numGroups = groups.length,
						    users = results.users,
						    numUsers = users.length;

						for (var i = 0; i < numGroups; i++) {
							groups[i].type = 'Group';
							groups[i].label = 'Group - ' + groups[i].Name;
						}

						for (var j = 0; j < numUsers; j++) {
							users[j].type = 'User';
							users[j].label = 'User - ' + users[j].Name;
						}
						return users.concat(groups);
					}
				}, {
					key: 'onShare',
					value: function onShare() {
						var selected = this.$.multilookup.selectedIdsByItems,
						    items = Object.keys(selected).map(function (k) {
							return selected[k];
						}),
						    numItems = items.length;

						for (var i = 0; i < numItems; i++) {
							var type = items[i].type === 'Group' ? 'favdGroups' : 'favdUsers';
							this.push(type, items[i].Id);
						}

						this.fire('favorite-shared', { groups: this.favdGroups, users: this.favdUsers });

						this.$.dialog.toggle();
						this._clearFavdLists();
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.$.dialog.toggle();
					}
				}, {
					key: '_clearFavdLists',
					value: function _clearFavdLists() {
						this.set('favdUsers', []);
						this.set('favdGroups', []);
						this.$.multilookup.clear();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return FavoriteShareDialog;
			}());

			_export('FavoriteShareDialog', FavoriteShareDialog);

			Polymer(FavoriteShareDialog);
		}
	};
});

'use strict';

System.register('products/localization/LocalizeFields.js', [], function (_export, _context) {
	var _createClass, LocalizeFields;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LocalizeFields', LocalizeFields = function () {
				function LocalizeFields(prefix) {
					_classCallCheck(this, LocalizeFields);

					this.prefix = prefix;
				}

				_createClass(LocalizeFields, [{
					key: 'localizeSearchModel',
					value: function localizeSearchModel(searchModel) {
						var localizedProducts = searchModel.localizationByFieldByProductId;
						if (!localizedProducts) return searchModel;

						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = searchModel.results[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var result = _step.value;

								var localizedFields = localizedProducts[result.record.Product2Id];
								if (localizedFields) {
									for (var field in localizedFields) {
										var localizedValue = this.getLocalizedValue(localizedFields[field].record);
										if (!localizedValue) continue;
										result.record.Product2[field] = localizedValue;
									}
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return searchModel;
					}
				}, {
					key: 'localizeProduct',
					value: function localizeProduct(product) {
						if (!product.localizationByFieldByProductId) {
							return product;
						}
						var localized = product.localizationByFieldByProductId[product.record.Id];
						if (localized && localized.Name) {
							var localizedFeatureName = this.getLocalizedValue(localized.Name.record);
							if (localizedFeatureName) {
								if (!product.untranslatedRecord) product.untranslatedRecord = { Name: JSON.parse(JSON.stringify(product.record.Name)) };
								product.record.Name = localizedFeatureName;
							}
						}

						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = product.options[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var option = _step2.value;

								var untranslatedRecord = {};
								for (var field in option.localizationByFieldName) {
									var localizedOptionField = null;

									if (field.indexOf('__c') === -1) continue;
									var _localized = option.localizationByFieldName[field];
									if (_localized) localizedOptionField = this.getLocalizedValue(_localized.record);

									if (field === 'Description__c') field = 'ProductDescription__c';
									if (field.replace('__c', '') !== _localized.record[this.prefix + 'APIName__c'].replace('__c', '') || field === _localized.record[this.prefix + 'APIName__c'].replace(this.prefix, '')) field = this.prefix + field;

									untranslatedRecord[field] = option.record[field];
									if (localizedOptionField && option.record[field]) option.record[field] = JSON.parse(JSON.stringify(localizedOptionField));else if (localizedOptionField && option.record[this.prefix + field]) option.record[this.prefix + field] = JSON.parse(JSON.stringify(localizedOptionField));
								}

								if (!option.untranslatedRecord) option.untranslatedRecord = untranslatedRecord;
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = product.features[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var feature = _step3.value;

								if (!feature.untranslatedRecord) feature.untranslatedRecord = { Name: JSON.parse(JSON.stringify(feature.record.Name)) };
								var localizationByFieldName = feature.localizationByFieldName;
								if (localizationByFieldName) {
									if (localizationByFieldName.Name) {
										var _localized2 = localizationByFieldName.Name;
										var localizedValue = this.getLocalizedValue(_localized2.record);
										if (localizedValue) feature.record.Name = localizedValue;
									}
								}
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						return product;
					}
				}, {
					key: 'getLocalizedValue',
					value: function getLocalizedValue(record) {
						return record[this.prefix + 'Text__c'] || record[this.prefix + 'TextArea__c'] || record[this.prefix + 'LongTextArea__c'] || record[this.prefix + 'RichTextArea__c'];
					}
				}]);

				return LocalizeFields;
			}());

			_export('LocalizeFields', LocalizeFields);
		}
	};
});

'use strict';

System.register('quotes/models/Constants.js', [], function (_export, _context) {
	return {
		setters: [],
		execute: function () {
			function Constants(prefix) {
				this.QUOTE = prefix + 'Quote__c';
				this.QUOTE_LINE = prefix + 'QuoteLine__c';
				this.QUOTE_LINE_GROUP = prefix + 'QuoteLineGroup__c';

				this.ACCOUNT_FIELD = prefix + 'Account__r';
				this.ACCOUNT_ID_FIELD = prefix + 'Account__c';
				this.ACTION_FIELD = prefix + 'Action__c';
				this.ADDITIONAL_DISCOUNT_AMOUNT_FIELD = prefix + 'AdditionalDiscountAmount__c';
				this.ADDITIONAL_DISCOUNT_FIELD = prefix + 'AdditionalDiscount__c';
				this.ADDITIONAL_DISCOUNT_RATE_FIELD = prefix + 'Discount__c';
				this.ADDITIONAL_QUANTITY_FIELD = prefix + 'AdditionalQuantity__c';
				this.BATCH_QUANTITY = prefix + 'BatchQuantity__c';
				this.BUNDLE_FIELD = prefix + 'Bundle__c';
				this.BUNDLED_FIELD = prefix + 'Bundled__c';
				this.BUNDLED_QUANTITY_FIELD = prefix + 'BundledQuantity__c';
				this.CLASS_FIELD = prefix + 'Class__c';
				this.COMPONENT_DISCOUNTED_BY_PACKAGE_FIELD = prefix + 'ComponentDiscountedByPackage__c';
				this.COMPONENT_LIST_TOTAL_FIELD = prefix + 'ComponentListTotal__c';
				this.COMPONENT_SUBSCRIPTION_SCOPE_FIELD = prefix + 'ComponentSubscriptionScope__c';
				this.COMPONENT_VISIBILITY_FIELD = prefix + 'ComponentVisibility__c';
				this.CONDITIONS_MET_FIELD = prefix + 'ConditionsMet__c';
				this.COST_EDITABLE_FIELD = prefix + 'CostEditable__c';
				this.CUSTOM_ACTION_CONDITIONS_FIELD = prefix + 'Custom_Action_Conditions__r';
				this.CUSTOMER_AMOUNT_FIELD = prefix + 'CustomerAmount__c';
				this.CUSTOMER_PRICE_FIELD = prefix + 'CustomerPrice__c';
				this.DEFAULT_SUBSCRIPTION_TERM_FIELD = prefix + 'DefaultSubscriptionTerm__c';
				this.DEFAULT_FIELD = prefix + 'Default__c';
				this.DESCRIPTION_FIELD = prefix + 'Description__c';
				this.DIMENSION_FIELD = prefix + 'Dimension__r';
				this.DISCOUNT_AMOUNT_FIELD = prefix + 'DiscountAmount__c';
				this.DISCOUNT_SCHEDULE_FIELD = prefix + 'DiscountSchedule__c';
				this.DISCOUNT_SCHEDULE_TYPE_FIELD = prefix + 'DiscountScheduleType__c';
				this.DISCOUNT_TIER_FIELD = prefix + 'DiscountTier__c';
				this.DISCOUNT_TIERS_FIELD = prefix + 'DiscountTiers__r';
				this.DISCOUNT_UNIT_FIELD = prefix + 'DiscountUnit__c';
				this.DISTRIBUTOR_DISCOUNT_FIELD = prefix + 'DistributorDiscount__c';
				this.DISTRIBUTOR_DISCOUNT_FIELD = prefix + 'DistributorDiscount__c';
				this.EFFECTIVE_QUANTITY = prefix + 'EffectiveQuantity__c';
				this.END_DATE_FIELD = prefix + 'EndDate__c';
				this.EVENT_HANDLER_NAME_FIELD = prefix + 'EventHandlerName__c';
				this.EXISTING_FIELD = prefix + 'Existing__c';
				this.FAVORITE_ID_FIELD = prefix + 'Favorite__c';
				this.FIELD_FIELD = prefix + 'Field__c';
				this.FILTER_VALUE_FIELD = prefix + 'FilterValue__c';
				this.GROUP_LINE_ITEMS_FIELD = prefix + 'LineItemsGrouped__c';
				this.ICON_CLASS_FIELD = prefix + 'IconClass__c';
				this.LABEL_FIELD = prefix + 'Label__c';
				this.LIST_PRICE_FIELD = prefix + 'ListPrice__c';
				this.LOCATION_FIELD = prefix + 'Location__c';
				this.LONG_TEXT_AREA_FIELD = prefix + 'LongTextArea__c';
				this.LOWER_BOUND_FIELD = prefix + 'LowerBound__c';
				this.MARKUP_AMOUNT_FIELD = prefix + 'MarkupAmount__c';
				this.MARKUP_FIELD = prefix + 'Markup__c';
				this.MARKUP_RATE_FIELD = prefix + 'MarkupRate__c';
				this.NET_AMOUNT_FIELD = prefix + 'NetAmount__c';
				this.NET_PRICE_FIELD = prefix + 'NetPrice__c';
				this.NET_TOTAL_FIELD = prefix + 'NetTotal__c';
				this.NON_DISCOUNTABLE_FIELD = prefix + 'NonDiscountable__c';
				this.NON_PARTNER_DISCOUNTABLE_FIELD = prefix + 'NonPartnerDiscountable__c';
				this.NUMBER_FIELD = prefix + 'Number__c';
				this.OPERATOR_FIELD = prefix + 'Operator__c';
				this.OPPORTUNITY_FIELD = prefix + 'Opportunity2__r';
				this.OPPORTUNITY_ID_FIELD = prefix + 'Opportunity2__c';
				this.OPTION_LEVEL_FIELD = prefix + 'OptionLevel__c';
				this.OPTION_TYPE_FIELD = prefix + 'OptionType__c';
				this.OPTIONAL_FIELD = prefix + 'Optional__c';
				this.ORIGINAL_SCHEDULE_FIELD = prefix + 'OriginalDiscountSchedule__c';
				this.OVERRIDE_BEHAVIOR_FIELD = prefix + 'OverrideBehavior__c';
				this.PAGE_FIELD = prefix + 'Page__c';
				this.PARENT_CUSTOM_ACTION_FIELD = prefix + 'ParentCustomAction__c';
				this.PARTNER_DISCOUNT_FIELD = prefix + 'PartnerDiscount__c';
				this.PARTNER_PRICE_FIELD = prefix + 'PartnerPrice__c';
				this.PRICE_EDITABLE_FIELD = prefix + 'PriceEditable__c';
				this.PRICEBOOK_ID_FIELD = prefix + 'PricebookId__c';
				this.PRICING_METHOD_EDITABLE_FIELD = prefix + 'PricingMethodEditable__c';
				this.PRICING_METHOD_FIELD = prefix + 'PricingMethod__c';
				this.PRIMARY_FIELD = prefix + 'Primary__c';
				this.BRAND_BUTTON_FIELD = prefix + 'BrandButton__c';
				this.PRIOR_QUANTITY_FIELD = prefix + 'PriorQuantity__c';
				this.PRODUCT = prefix + 'Product__c';
				this.PRODUCT_CODE_FIELD = prefix + 'ProductCode__c';
				this.PRODUCT_NAME_FIELD = prefix + 'ProductName__c';
				this.PRORATE_MULTIPLIER_FIELD = prefix + 'ProrateMultiplier__c';
				this.QUANTITY_FIELD = prefix + 'Quantity__c';
				this.QUOTE_PROCESS_FIELD = prefix + 'QuoteProcess__c';
				this.QUOTE_PROCESS_ID_FIELD = prefix + 'QuoteProcessId__c';
				this.REGULAR_PRICE_FIELD = prefix + 'RegularPrice__c';
				this.RENEWAL_CHECKBOX = prefix + 'Renewal__c';
				this.RENEWED_ASSET_ID_FIELD = prefix + 'RenewedAsset__c';
				this.REQUIRED_BY_FIELD = prefix + 'RequiredBy__c';
				this.RICH_TEXT_AREA_FIELD = prefix + 'RichTextArea__c';
				this.SEGMENT_INDEX_FIELD = prefix + 'SegmentIndex__c';
				this.SEGMENT_KEY_FIELD = prefix + 'SegmentKey__c';
				this.SEGMENT_LABEL_FIELD = prefix + 'SegmentLabel__c';
				this.SOURCE_FIELD = prefix + 'Source__c';
				this.SPECIAL_PRICE_FIELD = prefix + 'SpecialPrice__c';
				this.START_DATE_FIELD = prefix + 'StartDate__c';
				this.SUBSCRIBED_ASSET_IDS_FIELD = prefix + 'SubscribedAssetIds__c';
				this.SUBSCRIPTION_BASE_FIELD = prefix + 'SubscriptionBase__c';
				this.SUBSCRIPTION_PRICING_FIELD = prefix + 'SubscriptionPricing__c';
				this.SUBSCRIPTION_SCOPE_FIELD = prefix + 'SubscriptionScope__c';
				this.SUBSCRIPTION_TERM_FIELD = prefix + 'SubscriptionTerm__c';
				this.TARGET_OBJECT_FIELD = prefix + 'TargetObject__c';
				this.TEXT_FIELD = prefix + 'Text__c';
				this.TEXT_AREA_FIELD = prefix + 'TextArea__c';
				this.TYPE_FIELD = prefix + 'Type__c';
				this.UNIT_COST_FIELD = prefix + 'UnitCost__c';
				this.UPGRADE_CONVERSION_RATE = prefix + 'UpgradeConversionRate__c';
				this.UPGRADED_ASSET_FIELD = prefix + 'UpgradedAsset__c';
				this.UPGRADED_QUANTITY = prefix + 'UpgradedQuantity__c';
				this.UPGRADED_SUBSCRIPTION_FIELD = prefix + 'UpgradedSubscription__c';
				this.UPLIFT_FIELD = prefix + 'Uplift__c';
				this.UPPER_BOUND_FIELD = prefix + 'UpperBound__c';
				this.URL_TARGET_FIELD = prefix + 'URLTarget__c';
				this.URL_FIELD = prefix + 'URL__c';
				this.RETURN_URL_FIELD = prefix + 'ReturnURL__c';
				this.USE_PRICE_FOR_AMOUNT_FIELD = prefix + 'UsePriceForAmount__c';
				this.USER_DEFINED_FIELD = prefix + 'UserDefined__c';

				this.CUSTOM_VALUE = 'Custom';

				this.QUANTITY_FIELDS = new Set([this.ADDITIONAL_QUANTITY_FIELD, this.BATCH_QUANTITY, this.BUNDLED_QUANTITY_FIELD, this.EFFECTIVE_QUANTITY, this.PRIOR_QUANTITY_FIELD, this.QUANTITY_FIELD, this.UPGRADED_QUANTITY]);
				this.UNIT_PRICE_FIELDS = new Set([this.ADDITIONAL_DISCOUNT_FIELD, this.CUSTOMER_PRICE_FIELD, this.LIST_PRICE_FIELD, this.MARKUP_AMOUNT_FIELD, this.NET_PRICE_FIELD, this.PARTNER_PRICE_FIELD, this.REGULAR_PRICE_FIELD, this.SPECIAL_PRICE_FIELD, this.UNIT_COST_FIELD]);
			}

			_export('Constants', Constants);
		}
	};
});

'use strict';

System.register('quotes/models/CustomActionModel.js', ['common/Util.js'], function (_export, _context) {
	var Util, _createClass, CustomActionModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonUtilJs) {
			Util = _commonUtilJs.Util;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('CustomActionModel', CustomActionModel = function () {
				function CustomActionModel(editorModel, customAction, customActionModelsByParentId, renderLocation) {
					_classCallCheck(this, CustomActionModel);

					this.editorModel = editorModel;
					this.record = customAction;
					this.customActionModelsByParentId = customActionModelsByParentId;
					this.renderLocation = renderLocation;
					this.model;

					if (this.record) {
						this.icon = this.record[this.editorModel.constants.ICON_CLASS_FIELD];
						this.class = this.icon ? this.icon : '';
						this.caClass = this.record[this.editorModel.constants.CLASS_FIELD];
						this.location = this.record[this.editorModel.constants.LOCATION_FIELD];
						this.eventHandlerName = this.record[this.editorModel.constants.EVENT_HANDLER_NAME_FIELD];
						this.label = this.record[this.editorModel.constants.LABEL_FIELD];
						this.title = this.icon ? this.record[this.editorModel.constants.LABEL_FIELD] : null;
						this.type = this.record[this.editorModel.constants.TYPE_FIELD];
						this.isSeparator = this.type === 'Separator';
						this.primary = this.record[this.editorModel.constants.BRAND_BUTTON_FIELD];
						this.urlTarget = this.record[this.editorModel.constants.URL_TARGET_FIELD];
						this.url = this.record[this.editorModel.constants.URL_FIELD];
					}

					if (this.renderLocation === 'Line') {
						this.class = this.class + ' ' + this.eventHandlerName + ' lineAction';
					}
				}

				_createClass(CustomActionModel, [{
					key: 'isHidden',
					value: function isHidden(model) {
						if (model) {
							this.model = model;
						}
						if (this.model && !this._customActionsConditionsMet) {
							return true;
						}
						if (this.renderLocation === 'Line' && this.model) {
							if (!this.model) {
								return false;
							}
							switch (this.eventHandlerName) {
								case "onAddToFavorites":
									return this.model.favorite || this.model.component || this.model.existing;
								case "onRemoveFromFavorites":
									return !this.model.favorite || this.model.existing;
								case "onDeleteLine":
									return this.model.component || this.model.existing;
								case "onCloneLine":
									return this.model.component;
								case "onReconfigureLine":
									return !(this.model.lineVO.parentItemKey == null && this.model.configurable);
								case "onResegmentLine":
									return !this.model.lineVO.productHasDimensions || this.model.segmented || this.model.existing || this.model.bundle;
								case "onDesegmentLine":
									return !this.model.lineVO.productHasDimensions || !this.model.segmented || this.model.existing || this.model.bundle;
								case "showDSModal":
									return !this.model.getField(this.editorModel.constants.DISCOUNT_SCHEDULE_FIELD);
							}
						} else {
							if (this.renderLocation === 'Quote' && this.location === 'Quote/Group' && this.editorModel.quoteModel.grouped) return true;
							switch (this.eventHandlerName) {
								case "onUngroup":
									return !this.editorModel.quoteModel.grouped;
								case "updateLineOptional":
									if (!this.editorModel.toggleOptionalShown) {
										return true;
									} else {
										return this.caClass === 'optionalAllBtn' === this.editorModel.quoteModel.allOptional;
									}
								case "onRenewSubscriptions":
									return !this.editorModel.data.settings.renewSubscriptionsButtonRendered || this.editorModel.quoteModel.isAmendment;
								case "onUpgradeAssets":
									return !this.editorModel.data.settings.upgradeAssetsButtonRendered;
								case "onDeleteLines":
									return !this.editorModel.data.settings.multiLineDeleteEnabled;
							}
						}
						return false;
					}
				}, {
					key: '_customActionsConditionsMet',
					get: function get() {
						var _this = this;

						var constants = this.editorModel.constants;
						if (!this.record || !this.record[constants.CUSTOM_ACTION_CONDITIONS_FIELD]) {
							return true;
						}

						var evaluateCondition = function evaluateCondition(condition) {
							if (condition[constants.TARGET_OBJECT_FIELD] === 'Product') {
								if (!_this.model.productVO) return true;
								return Util.arithmeticOperatorConversion(_this.model.productVO.record[condition[constants.FIELD_FIELD]], condition[constants.FILTER_VALUE_FIELD], condition[constants.OPERATOR_FIELD]);
							}

							if (condition[constants.TARGET_OBJECT_FIELD] === 'Quote') {
								return Util.arithmeticOperatorConversion(_this.editorModel.quoteModel.quoteVO.record[condition[constants.FIELD_FIELD]], condition[constants.FILTER_VALUE_FIELD], condition[constants.OPERATOR_FIELD]);
							}
							return true;
						};

						var meetAllConditions = this.record[constants.CONDITIONS_MET_FIELD] !== 'Any';
						var conditions = this.record[constants.CUSTOM_ACTION_CONDITIONS_FIELD].records;

						for (var i = 0, l = conditions.length; i < l; i++) {
							if (evaluateCondition(conditions[i])) {
								if (!meetAllConditions) return true;
							} else {
								if (meetAllConditions) return false;
							}
						};

						return meetAllConditions;
					}
				}, {
					key: 'hasMenu',
					get: function get() {
						if (!this.children) {
							this.children = this.customActionModelsByParentId ? this.customActionModelsByParentId[this.record.Id] : null;
						}
						if (this.type === "Menu" && this.children && this.children.length > 0) {
							for (var i = 0, l = this.children.length; i < l; i++) {
								if (!this.children[i].isHidden(this.model)) return true;
							}
						}
						return false;
					}
				}, {
					key: 'default',
					get: function get() {
						var isDefault = this.record[this.editorModel.constants.DEFAULT_FIELD];
						this.record[this.editorModel.constants.DEFAULT_FIELD] = false;
						return isDefault;
					}
				}, {
					key: 'customActionId',
					get: function get() {
						return this.record.Id;
					}
				}]);

				return CustomActionModel;
			}());

			_export('CustomActionModel', CustomActionModel);
		}
	};
});

"use strict";

System.register("quotes/models/DiscountTierModel.js", [], function (_export, _context) {
	var DiscountTierModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_export("DiscountTierModel", DiscountTierModel = function DiscountTierModel(discountTierRecord, discountScheduleRecord) {
				_classCallCheck(this, DiscountTierModel);

				this.template = discountTierRecord;
				this.discountSchedule = discountScheduleRecord;
				this.selected = false;
				this.hidden = false;
				this.disabled = false;
				this.tiers = [];
			});

			_export("DiscountTierModel", DiscountTierModel);
		}
	};
});

'use strict';

System.register('quotes/models/DiscountTiersValidator.js', [], function (_export, _context) {
	var _createClass, DiscountTiersValidator;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DiscountTiersValidator', DiscountTiersValidator = function () {
				function DiscountTiersValidator(discountSchedule, editorModel) {
					_classCallCheck(this, DiscountTiersValidator);

					this.schedule = discountSchedule;
					this.editorModel = editorModel;
					this.constants = editorModel.constants;
					this.unitPriceScale = editorModel.data.settings.priceScale;
					this.isMultiCurrencyOrg = editorModel.data.settings.isMultiCurrencyOrg;
				}

				_createClass(DiscountTiersValidator, [{
					key: 'validate',
					value: function validate(rows) {
						var errors = new Map();
						var lastTier = null;
						var label = this.editorModel.data.customLabels;
						var schedule = this.schedule;
						rows.forEach(function (row) {
							var error = null;
							var number = row.template[this.constants.NUMBER_FIELD];
							var lowerBound = row.template[this.constants.LOWER_BOUND_FIELD];
							var upperBound = row.template[this.constants.UPPER_BOUND_FIELD];
							var lastUpperBound = lastTier != null ? lastTier[this.constants.UPPER_BOUND_FIELD] : null;
							var discountUnit = schedule[this.constants.DISCOUNT_UNIT_FIELD];
							var discount = row.template[this.constants.ADDITIONAL_DISCOUNT_RATE_FIELD];

							delete row.template.Price;
							if (lowerBound == null) {
								error = this.formatLabel(label.msg_missing_lower_bound_tier, [number]);
							} else if (lastTier != null && lowerBound != lastUpperBound) {
								error = this.formatLabel(label.msg_unequal_lower_upper_bounds_tier, [number]);
							} else if (discount == null && (discountUnit == null || discountUnit.toUpperCase() === 'PERCENT')) {
								error = this.formatLabel(label.msg_missing_discount_tier, [number]);
							} else if (upperBound != null && upperBound != "" && upperBound <= lowerBound) {
								error = this.formatLabel(label.msg_upper_greater_tier, [number]);
							} else if (discountUnit && discountUnit.toUpperCase() === 'AMOUNT') {
								row.tiers.forEach(function (tier) {
									if (this.discountFormatted(tier) === null) {
										if (this.isMultiCurrencyOrg) {
											error = this.formatLabel(label.msg_missing_discount_amount_tier_currency, [number, row.CurrencyIsoCode]);
										} else {
											error = this.formatLabel(label.msg_missing_discount_amount_tier, [number]);
										}
									}
								}.bind(this));
							} else if (upperBound != null && upperBound != "" && upperBound <= lowerBound) {
								error = this.formatLabel(label.msg_upper_greater_tier, [number]);
							}
							if (error != null) {
								errors.set(Number(number), error);
							}
							lastTier = row.template;
						}.bind(this));
						return errors;
					}
				}, {
					key: 'discountFormatted',
					value: function discountFormatted(tier) {
						return tier[this.constants.DISCOUNT_AMOUNT_FIELD] == null ? null : Number(tier[this.constants.DISCOUNT_AMOUNT_FIELD]).toFixed(this.unitPriceScale);
					}
				}, {
					key: 'formatLabel',
					value: function formatLabel(label, args) {
						for (var i = 0, l = args.length; i < l; i++) {
							label = label.replace('{' + i + '}', args[i].toString());
						}
						return label;
					}
				}]);

				return DiscountTiersValidator;
			}());

			_export('DiscountTiersValidator', DiscountTiersValidator);
		}
	};
});

'use strict';

System.register('quotes/models/DragDropModel.js', [], function (_export, _context) {
    var _createClass, topBorderHighlightClass, bottomBorderHighlightClass, DEFAULT_GHOST_X_OFFSET, DEFAULT_GHOST_Y_OFFSET, dragging, DragDropModel;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    function _pauseEvent(e) {
        if (e.stopPropagation) e.stopPropagation();
        if (e.preventDefault) e.preventDefault();
        return false;
    }

    function _addTopBorderClass(node) {
        node.classList.add(topBorderHighlightClass);
    }

    function _addBottomBorderClass(node) {
        node.classList.add(bottomBorderHighlightClass);
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            topBorderHighlightClass = 'droppableTopBorder';
            bottomBorderHighlightClass = 'droppableBottomBorder';
            DEFAULT_GHOST_X_OFFSET = 60;
            DEFAULT_GHOST_Y_OFFSET = 23;
            dragging = false;

            _export('DragDropModel', DragDropModel = function () {
                function DragDropModel(host, keepBundle, draggable, validTargets, dragFunc, trackFunc, dropFunc, ghostXOffset, ghostYOffset) {
                    _classCallCheck(this, DragDropModel);

                    this.host = host;
                    this.keepBundleTogether = keepBundle;
                    this.draggable = draggable;
                    this.validTargets = validTargets;
                    this.sourceElement;
                    this.hoverOver;
                    this.placeHolderComp = null;
                    this.ghostField;
                    this.targetClass;
                    this.dropBefore;
                    this.usePlaceholder;
                    this.highlightTargetPosition;
                    this.highlightableElements = [];
                    this.enableHighLight;
                    this.lineEditor = document.body.querySelector('sb-page-container') ? Polymer.dom(document.body.querySelector('sb-page-container').root).querySelector('sb-line-editor') : document.body.querySelector('sb-line-editor');
                    this.linesByParentKey = this.lineEditor && this.lineEditor.editorModel ? this.lineEditor.editorModel.quoteModel.linesByParentItemKey : null;
                    this.standardLinesByParentKey = this.lineEditor && this.lineEditor.editorModel ? this.lineEditor.editorModel.quoteModel.standardLinesByParentItemKey : null;
                    this.segmentedLinesByParentKey = this.lineEditor && this.lineEditor.editorModel ? this.lineEditor.editorModel.quoteModel.segmentedLinesByParentItemKey : null;

                    this.ghost = null;
                    this.ghostXOffset = ghostXOffset == null ? DEFAULT_GHOST_X_OFFSET : ghostXOffset;
                    this.ghostYOffset = ghostYOffset == null ? DEFAULT_GHOST_Y_OFFSET : ghostYOffset;

                    this.handleDrag = dragFunc;
                    this.handleTrack = trackFunc;
                    this.handleDrop = dropFunc;
                }

                _createClass(DragDropModel, [{
                    key: '_onTrack',
                    value: function _onTrack(e) {
                        var mouseX = e.detail.x,
                            mouseY = e.detail.y;

                        _pauseEvent(e);
                        switch (e.detail.state) {
                            case 'start':
                                if (Math.abs(e.detail.dx) < 9 && Math.abs(e.detail.dy) < 4) return;
                                dragging = true;

                                this.lineEditor.toggleClass('disable-selection', true);

                                this.sourceElement = Polymer.dom(e).localTarget;
                                var sourceBox = this.sourceElement.getBoundingClientRect();
                                this.sourceWidth = sourceBox.width;
                                this.sourceHeight = sourceBox.height;
                                this.handleDrag(this.sourceElement, e);
                                this._appendGhostImage(mouseX, mouseY);

                                break;

                            case 'track':
                                if (!dragging) return;

                                try {
                                    this._moveGhost(mouseX, mouseY);

                                    var hoverOverComp = Polymer.dom(e).event.detail.hover();
                                    if (this.draggable === 'sb-le-table-row' && (hoverOverComp.id === 'panel' || hoverOverComp.classList.contains('nav-item'))) {
                                        this._hideGhost();
                                    } else {
                                        this._showGhost();
                                    }

                                    this.handleTrack(hoverOverComp);
                                    this.host.debounce('Cursor flipping', function () {
                                        var _this = this;

                                        Polymer.RenderStatus.afterNextRender(this.lineEditor, function () {
                                            if (!_this.hoverOver || Object.keys(_this.hoverOver).length == 0) {
                                                _this.lineEditor.toggleClass('dropCursor', false);
                                                _this._removePlaceholder();
                                            } else {
                                                if (hoverOverComp !== _this.previousHoverOverComp) {
                                                    _this.lineEditor.toggleClass('dropCursor', true);
                                                }
                                                _this.previousHoverOverComp = _this.hoverOver.comp;
                                            }
                                        });
                                    }.bind(this), 15);

                                    if (!this.hoverOver || Object.keys(this.hoverOver).length == 0) {
                                        this._removeHighlightHover(this.previousHoverOverComp);
                                        return;
                                    }

                                    this.host.debounce('Apply Placeholder', function () {
                                        this._removePlaceholder();
                                        if (this.usePlaceholder && this.hoverOver && Object.keys(this.hoverOver).length != 0) {
                                            this._usePlaceholder(mouseX, mouseY);
                                        }
                                    }.bind(this), 22);

                                    if (this.enableHighLight) {
                                        this._removeHighlightHover(this.previousHoverOverComp);
                                        this._highlightHover(this.hoverOver.comp);
                                    }
                                } catch (e) {
                                    this.sourceElement.toggleAttribute ? this.sourceElement.toggleAttribute('hidden', false) : this.sourceElement.removeAttribute('hidden');
                                    this._removeGhost();
                                    this._removePlaceholder();
                                    this.lineEditor.toggleClass('dropCursor', false);
                                }

                                break;

                            case 'end':
                                if (!dragging) return;

                                this._removePlaceholder();
                                this._removeGhost();

                                if (this.hoverOver) {
                                    this.handleDrop(this.sourceElement, this.hoverOver.comp, this.targetClass, this.dropBefore);
                                    this._removeHighlightHover(this.hoverOver.comp);
                                } else {
                                    this.handleDrop(this.sourceElement, null, this.targetClass, this.dropBefore);
                                }

                                this.lineEditor.toggleClass('dropCursor', false);
                                this.sourceElement = null;
                                this.previousHoverOverComp = null;
                                this.hoverOver = {};
                                dragging = false;

                                this.lineEditor.toggleClass('disable-selection', false);
                                break;
                        }
                    }
                }, {
                    key: '_appendGhostImage',
                    value: function _appendGhostImage(x, y) {
                        var ghostElement = this._clonePolymerElement(this.sourceElement);
                        var loadingSpinner = ghostElement.querySelector('.loadingSpinner');
                        if (loadingSpinner) loadingSpinner.remove();

                        ghostElement.hidden = false;
                        var gX = x - this.ghostXOffset + 'px';
                        var gY = y - this.ghostYOffset + 'px';
                        this.ghost.style.width = this.sourceWidth + 'px';
                        this.ghost.style.height = this.sourceHeight + 'px';
                        this.ghost.style.left = gX;
                        this.ghost.style.top = gY;
                        this.ghost.style.visibility = 'visible';
                        this.ghost.appendChild(ghostElement);
                    }
                }, {
                    key: '_moveGhost',
                    value: function _moveGhost(x, y) {
                        var gX = x - this.ghostXOffset + 'px',
                            gY = y - this.ghostYOffset + 'px';

                        this.ghost.style.left = gX;
                        this.ghost.style.top = gY;
                    }
                }, {
                    key: '_removeGhost',
                    value: function _removeGhost() {
                        this.ghost.innerHTML = '';
                        this.ghost.style.left = '';
                        this.ghost.style.top = '';
                        this.ghost.style.width = '';
                        this.ghost.style.height = '';
                        this.ghost.style.visibility = 'hidden';
                    }
                }, {
                    key: '_hideGhost',
                    value: function _hideGhost() {
                        this.ghost.style.visibility = 'hidden';
                    }
                }, {
                    key: '_showGhost',
                    value: function _showGhost() {
                        this.ghost.style.visibility = 'visible';
                    }
                }, {
                    key: '_findTableRowValidTarget',
                    value: function _findTableRowValidTarget(el) {
                        if (!el) return null;
                        if (this._ifParentIsValidTarget(el) && !el.classList.contains('tfoot') && el.id !== 'header' && el.localName !== 'template' && el.localName !== 'sb-le-summary-row') {
                            return el;
                        }
                        if (el.domHost) {
                            return this._findTableRowValidTarget(el.domHost);
                        } else if (el.host) {
                            return this._findTableRowValidTarget(el.host);
                        } else if (el.parentNode) {
                            return this._findTableRowValidTarget(el.parentNode);
                        } else {
                            return null;
                        }
                    }
                }, {
                    key: '_updateMDQTableRowHoverOverObject',
                    value: function _updateMDQTableRowHoverOverObject(drag, hover) {
                        if (hover.lineModel.dimensionType !== drag.lineModel.dimensionType) {
                            this.hoverOver = null;
                        } else if (!this.keepBundleTogether) {
                            this.hoverOver = { "comp": hover, "phLoc": 'both' };
                        } else if (drag.lineModel.component && hover.lineModel.groupModel.groupKey !== drag.lineModel.groupModel.groupKey) {
                            this.hoverOver = null;
                        } else {
                            this.hoverOver = { "comp": hover, "phLoc": 'both' };
                        }
                    }
                }, {
                    key: '_findSidePanelGroupValidTarget',
                    value: function _findSidePanelGroupValidTarget(el) {
                        if (this._ifParentIsValidTarget(el)) {
                            return el;
                        } else if (el.id === 'panel') {
                            var navItems = el.querySelectorAll('.nav-item');
                            return navItems[navItems.length - 1];
                        }
                        return null;
                    }
                }, {
                    key: '_updateTableRowHoverOverObject',
                    value: function _updateTableRowHoverOverObject(hoverElement, last) {
                        if (!hoverElement) {
                            return;
                        }
                        if (hoverElement.id === 'placeholder') {
                            hoverElement = hoverElement.ref === 'before' ? hoverElement.previousElementSibling : hoverElement.nextElementSibling;
                        }
                        if (!this.keepBundleTogether) {
                            this.hoverOver = { "comp": hoverElement, "phLoc": 'both' };
                        } else if (hoverElement.lineModel) {
                            var lineKey = hoverElement.lineModel.lineVO.key;
                            if (!isComponent(this.sourceElement)) {
                                if (!this.standardLinesByParentKey[lineKey] && !hoverElement.lineModel.component) {
                                    this.hoverOver = { "comp": hoverElement, "phLoc": 'both' };
                                } else if (hoverElement.lineModel.bundle && !hoverElement.lineModel.component) {
                                    this.hoverOver = { "comp": hoverElement, "phLoc": 'before' };
                                } else {
                                    this.hoverOver = null;
                                    return;
                                }
                            } else if (isComponent(this.sourceElement)) {
                                if (ifLineElementsShareParent(hoverElement, this.sourceElement) && ifLineElementsAreParentChild(hoverElement, hoverElement.nextElementSibling)) {
                                    this.hoverOver = { "comp": hoverElement, "phLoc": 'before' };
                                } else if (ifLineElementsShareParent(hoverElement, this.sourceElement)) {
                                    this.hoverOver = { "comp": hoverElement, "phLoc": 'both' };
                                } else {
                                    this.hoverOver = null;
                                    return;
                                }
                            }
                        } else if (hoverElement.classList.contains('tfoot')) {
                            this.hoverOver = null;
                        } else {
                            this.hoverOver = null;
                        }
                    }
                }, {
                    key: '_findParentCustomElement',
                    value: function _findParentCustomElement(el, value, selector) {
                        if (!el) return null;
                        switch (selector) {
                            case 'id':
                                if (el.id === value) {
                                    return el;
                                }
                                break;
                            case 'class':
                                if (el.classList.contains(value)) {
                                    return el;
                                }
                                break;
                            case 'nodeName':
                                if (el.nodeName === value) {
                                    return el;
                                }
                                break;
                        }

                        if (el.rootNode) {
                            return this._findParentCustomElement(el.rootNode, value, selector);
                        } else if (el.host) {
                            return this._findParentCustomElement(el.host, value, selector);
                        } else if (el.parentNode) {
                            return this._findParentCustomElement(el.parentNode, value, selector);
                        } else {
                            return null;
                        }
                    }
                }, {
                    key: '_highlightHover',
                    value: function _highlightHover(selected) {
                        this.host.toggleClass('hoverover', true, selected);
                    }
                }, {
                    key: '_ifParentIsValidTarget',
                    value: function _ifParentIsValidTarget(element) {
                        if (!element || !element.parentElement) return false;
                        var classArr = Array.from(element.parentElement.classList);
                        for (var i = 0, len = classArr.length; i < len; i++) {
                            if (this.validTargets.has(classArr[i])) {
                                this.targetClass = classArr[i];
                                return true;
                            }
                        }
                        return false;
                    }
                }, {
                    key: '_removePlaceholder',
                    value: function _removePlaceholder() {
                        if (this.placeHolderComp && this.placeHolderComp.parentElement) {
                            this.placeHolderComp.parentElement.removeChild(this.placeHolderComp);
                            this.placeHolderComp = null;
                        }
                    }
                }, {
                    key: '_removeHighlightHover',
                    value: function _removeHighlightHover(selected) {
                        var _this2 = this;

                        if (!selected || !selected.parentNode) return;
                        Polymer.dom(selected.parentNode).querySelectorAll(selected.localName).forEach(function (node) {
                            _this2.host.toggleClass('hoverover', false, node);
                        });
                    }
                }, {
                    key: '_highlightDroppableBorder',
                    value: function _highlightDroppableBorder(x, y) {
                        var boundBox = this.hoverOver.comp.getBoundingClientRect(),
                            midHeight = boundBox.top + boundBox.height / 2,
                            results = this.highlightableElements;

                        switch (this.hoverOver.phLoc) {

                            case 'both':
                                if (y < midHeight) {
                                    for (var m = 0, l = results.length; m < l; m++) {
                                        removeTopBottomBorderClass(results[m]);
                                        _addTopBorderClass(results[m]);
                                    }
                                    this.dropBefore = true;
                                } else if (y > midHeight) {
                                    for (var _m = 0, _l = results.length; _m < _l; _m++) {
                                        removeTopBottomBorderClass(results[_m]);
                                        _addBottomBorderClass(results[_m]);
                                    }
                                    this.dropBefore = false;
                                }
                                break;
                            case 'before':
                                for (var _m2 = 0, _l2 = results.length; _m2 < _l2; _m2++) {
                                    removeTopBottomBorderClass(results[_m2]);
                                    _addTopBorderClass(results[_m2]);
                                }
                                this.dropBefore = true;
                                break;
                            case 'after':
                                for (var _m3 = 0, _l3 = results.length; _m3 < _l3; _m3++) {
                                    removeTopBottomBorderClass(results[_m3]);
                                    _addBottomBorderClass(results[_m3]);
                                }
                                this.dropBefore = false;
                                break;
                        }
                    }
                }, {
                    key: '_removeHighlightDroppableBorder',
                    value: function _removeHighlightDroppableBorder(elements) {
                        if (!elements) {
                            return;
                        }

                        for (var m = 0, l = elements.length; m < l; m++) {
                            removeTopBottomBorderClass(elements[m]);
                        }
                    }
                }, {
                    key: '_usePlaceholder',
                    value: function _usePlaceholder(mouseX, mouseY) {
                        if (this.hoverOver && this.hoverOver.comp !== this.placeHolderComp) {
                            var boundBox = this.hoverOver.comp.getBoundingClientRect(),
                                midHeight = boundBox.top + boundBox.height / 2;
                            if (!this.placeHolderComp) {
                                this.placeHolderComp = this.host.create(this.draggable);
                                this.placeHolderComp.setAttribute('id', 'placeholder');
                                this.placeHolderComp.$$ ? this.placeHolderComp.toggleClass('placeholder', true, this.placeHolderComp.$$('.tr')) : null;
                                for (var x in this.sourceElement.properties) {
                                    if (x === 'data') {
                                        continue;
                                    }
                                    try {
                                        this.placeHolderComp[x] = this.sourceElement[x];
                                    } catch (e) {};
                                }
                                this.placeHolderComp['data'] = this.sourceElement['data'];
                                this.placeHolderComp.style.width = boundBox.width + 'px';
                                this.placeHolderComp.style.height = boundBox.height + 'px';
                                this.placeHolderComp.style.backgroundColor = '#d8dde6';
                            }

                            switch (this.hoverOver.phLoc) {
                                case 'both':
                                    if (mouseY < midHeight) {
                                        Polymer.dom(this.targetHost.root).querySelector('.' + this.targetClass).appendChild(this.placeHolderComp);
                                        this.hoverOver.comp.parentElement.insertBefore(this.placeHolderComp, this.hoverOver.comp);
                                        this.placeHolderComp.setAttribute('ref', 'after');
                                        this.dropBefore = true;
                                    } else if (mouseY > midHeight) {
                                        Polymer.dom(this.targetHost.root).querySelector('.' + this.targetClass).appendChild(this.placeHolderComp);
                                        this.hoverOver.comp.parentElement.insertBefore(this.placeHolderComp, this.hoverOver.comp.nextElementSibling);
                                        this.placeHolderComp.setAttribute('ref', 'before');
                                        this.dropBefore = false;
                                    }
                                    break;

                                case 'before':
                                    Polymer.dom(this.host.root).querySelector('.' + this.targetClass).appendChild(this.placeHolderComp);
                                    this.hoverOver.comp.parentElement.insertBefore(this.placeHolderComp, this.hoverOver.comp);
                                    this.placeHolderComp.setAttribute('ref', 'after');
                                    this.dropBefore = true;
                                    break;

                                case 'after':
                                    Polymer.dom(this.host.root).querySelector('.' + this.targetClass).appendChild(this.placeHolderComp);
                                    this.hoverOver.comp.parentElement.insertBefore(this.placeHolderComp, this.hoverOver.comp.nextElementSibling);
                                    this.placeHolderComp.setAttribute('ref', 'before');
                                    this.dropBefore = false;
                                    break;
                            }
                        } else if (this.hoverOver && this.hoverOver.comp === this.placeHolderComp) {
                            if (!this.placeHolderComp.hasAttribute('ref')) return;
                            if (this.placeHolderComp.getAttribute('ref') === 'before') {
                                this.hoverOver.comp = this.hoverOver.comp.previousElementSibling;
                                this.dropBefore = false;
                            } else if (this.placeHolderComp.getAttribute('ref') === 'after') {
                                this.hoverOver.comp = this.hoverOver.comp.nextElementSibling;
                                this.dropBefore = true;
                            }
                        }
                    }
                }, {
                    key: '_clonePolymerElement',
                    value: function _clonePolymerElement(node) {
                        var clonedElement = node.cloneNode(true);
                        for (var x in node.properties) {
                            if (x === 'data') {
                                continue;
                            }
                            try {
                                clonedElement[x] = node[x];
                            } catch (e) {};
                        }
                        clonedElement['data'] = node['data'];
                        return clonedElement;
                    }
                }]);

                return DragDropModel;
            }());

            _export('DragDropModel', DragDropModel);

            function removeTableRowBorderClass(rowComp) {
                var tds = [];
                tds = Array.from(Polymer.dom(rowComp.root).querySelector('.tr').getElementsByClassName('td'));
                for (var m = 0, l = tds.length; m < l; m++) {
                    removeTopBottomBorderClass(tds[m]);
                }
            }

            _export('removeTableRowBorderClass', removeTableRowBorderClass);

            function removeTopBottomBorderClass(node) {
                if (node.classList.contains(topBorderHighlightClass)) {
                    node.classList.remove(topBorderHighlightClass);
                }
                if (node.classList.contains(bottomBorderHighlightClass)) {
                    node.classList.remove(bottomBorderHighlightClass);
                }
            }

            _export('removeTopBottomBorderClass', removeTopBottomBorderClass);

            function isComponent(el) {
                if (!el || !el.lineModel) return;
                return el.lineModel.component;
            }

            _export('isComponent', isComponent);

            function ifLineElementsShareParent(eL1, eL2) {
                if (!eL1.lineModel || !eL2.lineModel) return;
                return eL1.lineModel.lineVO.parentItemKey === eL2.lineModel.lineVO.parentItemKey;
            }

            _export('ifLineElementsShareParent', ifLineElementsShareParent);

            function ifLineElementsAreParentChild(eL1, eL2) {
                if (!eL1.lineModel || !eL2.lineModel) return;
                return eL1.lineModel.lineVO.key === eL2.lineModel.lineVO.parentItemKey;
            }

            _export('ifLineElementsAreParentChild', ifLineElementsAreParentChild);
        }
    };
});

'use strict';

System.register('quotes/models/EditorModel.js', ['quotes/models/QuoteModel.js', 'quotes/models/Constants.js', 'quotes/models/CustomActionModel.js'], function (_export, _context) {
	var QuoteModel, Constants, CustomActionModel, _createClass, EditorModel, _createFieldsetMap, _createFieldsetList, _isToggleOptionalShown, _initCustomActions;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsQuoteModelJs) {
			QuoteModel = _quotesModelsQuoteModelJs.QuoteModel;
		}, function (_quotesModelsConstantsJs) {
			Constants = _quotesModelsConstantsJs.Constants;
		}, function (_quotesModelsCustomActionModelJs) {
			CustomActionModel = _quotesModelsCustomActionModelJs.CustomActionModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('EditorModel', EditorModel = function () {
				function EditorModel(data, md, lineEditor) {
					_classCallCheck(this, EditorModel);

					this.data = data;
					this.md = md;
					this.fieldsetMap = _createFieldsetMap(this.data, this.md);
					this.constants = new Constants(data.developerPrefix);
					this.deviceContext = lineEditor ? lineEditor.app.deviceContext : {};
					this.fieldNameSet = lineEditor ? lineEditor.fieldNameSet : {};

					this.md.fieldsMap[this.data.quoteLineObjectName][this.constants.SUBSCRIPTION_SCOPE_FIELD].required = true;

					this.actionsOnTheLeft = data.settings.actionsColumnPlacement === 'Left';
					this.createQuoteModel(data.quote);
					this.summarized = data.quote.summaries && Object.keys(data.quote.summaries).length > 0;

					this.standardPrimaryMobileCols = [];
					this.segmentedPrimaryMobileCols = [];
					this.segmentedDetailsPrimaryMobileCols = [];

					this.toggleOptionalShown = _isToggleOptionalShown(this);

					if (lineEditor && lineEditor.editorModel) {
						this.customActionsByLocation = lineEditor.editorModel.customActionsByLocation;
						this.customActionsByLocationMobile = lineEditor.editorModel.customActionsByLocationMobile;
						this.groupMobileMenuButtonAction = lineEditor.editorModel.groupMobileMenuButtonAction;
					} else {
						_initCustomActions(data.customActions, this);
					}
					this.quoteCustomActions = this.deviceContext.isMobile ? this.customActionsByLocationMobile.Quote : this.customActionsByLocation.Quote;
					this.lineCustomActions = this.deviceContext.isMobile ? this.customActionsByLocationMobile.Line : this.customActionsByLocation.Line;
					this.styleQuoteAndGroupActionButtons();
					this.communityPrefix = this._getCommunityPrefix();
				}

				_createClass(EditorModel, [{
					key: 'createQuoteModel',
					value: function createQuoteModel(quote) {
						this.quoteModel = new QuoteModel(quote, this);
					}
				}, {
					key: 'styleQuoteAndGroupActionButtons',
					value: function styleQuoteAndGroupActionButtons() {
						var _this = this;

						var styleActionButtons = function styleActionButtons(location) {
							var first = true;
							var actions = _this.customActionsByLocation[location];
							var lastCustomAction = actions[0];
							for (var i = 0, l = actions.length; i < l; i++) {
								if (actions[i].isHidden(_this.quoteModel)) {
									continue;
								}
								actions[i].first = first;
								if (actions[i].isSeparator) {
									first = true;
									lastCustomAction.last = true;
								} else {
									first = false;
									lastCustomAction = actions[i];
									lastCustomAction.last = false;
								}
							}
							if (lastCustomAction) {
								lastCustomAction.last = true;
							}
						};
						styleActionButtons('Quote');
						styleActionButtons('Group');
					}
				}, {
					key: '_getCommunityPrefix',
					value: function _getCommunityPrefix() {
						var path = document.location.pathname;
						var idx = path.indexOf('/apex');
						if (idx < 0) {
							return '';
						}
						return path.substring(0, idx);
					}
				}]);

				return EditorModel;
			}());

			_export('EditorModel', EditorModel);

			_createFieldsetMap = function _createFieldsetMap(data, md) {
				var fieldsetList = _createFieldsetList(data.developerPrefix);
				var fieldsetMap = {};
				fieldsetList.forEach(function (fieldset) {
					if (!data[fieldset.name]) {
						fieldsetMap[fieldset.name] = data[fieldset.name];
						return;
					}
					fieldsetMap[fieldset.name] = [];
					data[fieldset.name].forEach(function (field) {
						if (md.fieldsMap[fieldset.table][field]) {
							fieldsetMap[fieldset.name].push(field);
						};
					});
				});
				return fieldsetMap;
			};

			_createFieldsetList = function _createFieldsetList(prefix) {
				return [{ table: prefix + 'QuoteLine__c', name: 'lineFieldNames' }, { table: prefix + 'QuoteLine__c', name: 'lineFieldNamesTablet' }, { table: prefix + 'QuoteLine__c', name: 'lineFieldNamesPhone' }, { table: prefix + 'QuoteLine__c', name: 'multiSegmentLineFieldNames' }, { table: prefix + 'QuoteLine__c', name: 'multiSegmentLineSummaryFieldNames' }, { table: prefix + 'DiscountTier__c', name: 'discountScheduleModalFieldNames' }, { table: prefix + 'Quote__c', name: 'quoteFieldNames' }, { table: prefix + 'QuoteLineGroup__c', name: 'groupFieldNames' }];
			};

			_isToggleOptionalShown = function _isToggleOptionalShown(editorModel) {
				var containsOptional_Field = function containsOptional_Field(lineFieldNames) {
					for (var i = 0, l = lineFieldNames.length; i < l; i++) {
						if (lineFieldNames[i] === editorModel.constants.OPTIONAL_FIELD) return true;
					}
				};
				return containsOptional_Field(editorModel.fieldsetMap.lineFieldNames) || containsOptional_Field(editorModel.fieldsetMap.multiSegmentLineFieldNames);
			};

			_initCustomActions = function _initCustomActions(customActions, editorModel) {
				editorModel.defaultCustomActions = [];
				var validLocations = ['Quote', 'Group', 'Line'];
				var customActionsByLocation = { 'Quote': [], 'Group': [], 'Line': [] };
				var customActionsByLocationMobile = { 'Quote': [], 'Group': [], 'Line': [] };
				var customActionsByParentId = { 'Quote': {}, 'Group': {}, 'Line': {} };
				var addGroupCustomActionModel = void 0;

				var addToLocation = function addToLocation(customAction, location) {
					if (validLocations.indexOf(location) === -1) return;

					var customActionModel = new CustomActionModel(editorModel, customAction, customActionsByParentId[location], location);
					if (!customActionModel.isSeparator) {
						customActionsByLocationMobile[location].push(customActionModel);
					}

					if (customActionModel.default) {
						editorModel.defaultCustomActions.push(customActionModel);
					}

					if (customActionModel.eventHandlerName === 'onAddGroup') {
						addGroupCustomActionModel = customActionModel;
					}

					if (customAction[editorModel.constants.PARENT_CUSTOM_ACTION_FIELD]) {
						var parentId = customAction[editorModel.constants.PARENT_CUSTOM_ACTION_FIELD];
						var childCustomActions = customActionsByParentId[location][parentId];
						if (childCustomActions) {
							childCustomActions.push(customActionModel);
						} else customActionsByParentId[location][parentId] = [customActionModel];
					} else {
						customActionsByLocation[location].push(customActionModel);
					}
				};

				for (var i = 0, l = customActions.length; i < l; i++) {
					var location = customActions[i][editorModel.constants.LOCATION_FIELD];
					if (location === 'Quote/Group') {
						addToLocation(customActions[i], 'Quote');
						addToLocation(customActions[i], 'Group');
					} else if (location && location !== 'Configurator') addToLocation(customActions[i], location);
				}

				editorModel.customActionsByLocation = customActionsByLocation;
				editorModel.customActionsByLocationMobile = customActionsByLocationMobile;
				editorModel.groupMobileMenuButtonAction = new CustomActionModel(editorModel);
				editorModel.groupMobileMenuButtonAction.children = customActionsByLocationMobile.Group;

				if (editorModel.data.settings.solutionGroupsEnabled && editorModel.data.solutionGroups.length > 0 && addGroupCustomActionModel) {
					var solutionGroups = editorModel.data.solutionGroups;
					var addGroupChildren = customActionsByParentId.Quote[addGroupCustomActionModel.record.Id] || [];
					addGroupCustomActionModel.type = 'Menu';
					for (var j = 0, sgL = solutionGroups.length; j < sgL; j++) {
						var solutionGroupAction = new CustomActionModel(editorModel, solutionGroups[j]);
						solutionGroupAction.type = 'Solution Group';
						solutionGroupAction.eventHandlerName = 'onAddGroup';
						solutionGroupAction.label = solutionGroups[j].Name;
						addGroupChildren.push(solutionGroupAction);
					}
					addGroupCustomActionModel.children = addGroupChildren;
				}
			};
		}
	};
});

'use strict';

System.register('quotes/models/GroupModel.js', ['quotes/models/LineModel.js'], function (_export, _context) {
	var LineModel, _createClass, GroupModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsLineModelJs) {
			LineModel = _quotesModelsLineModelJs.LineModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('GroupModel', GroupModel = function () {
				function GroupModel(groupVO, quoteModel) {
					_classCallCheck(this, GroupModel);

					this.groupVO = groupVO;
					this.groupKey = groupVO.key;
					this.quoteModel = quoteModel;

					this.standardLines = [];
					this.segmentedLines = [];
					this.dimensions = [];
					this.dimensionsMap = {};
					this.segmentedLinesByDimension = {};
					this.segmentedLinesBySegmentKey = {};
					this.segmentedLineKeysBySegmentKey = {};
					this.standardSubscriptionScopeEditable = false;
					this.segmentedSubscriptionScopeEditable = false;
					this.groupObjectName = this.constants.QUOTE_LINE_GROUP;
					this.summaries = this.quoteModel.grouped ? this.groupVO.summaries : this.quoteModel.quoteVO.summaries;
					this.multiSegmentColumnTotals = this.groupVO.multiSegmentColumnTotals ? this.groupVO.multiSegmentColumnTotals : this.quoteModel.quoteVO.multiSegmentColumnTotals;
					this.netMultiSegmentTotal = this.groupVO.netMultiSegmentTotal ? this.groupVO.netMultiSegmentTotal : this.quoteModel.quoteVO.netMultiSegmentTotal;
					this.hasVisibleStandardLines = false;
					this.hasVisibleSegmentedLines = {};
				}

				_createClass(GroupModel, [{
					key: 'addLine',
					value: function addLine(lineVO) {
						var lineModel = new LineModel(lineVO, this);
						this.quoteModel.lineModelsByKey[lineModel.lineVO.key] = lineModel;
						if (!lineModel.segmented) {
							this._addStandardLine(lineModel);
						} else {
							this._addSegmentedLine(lineModel);
						}
						if (lineModel.lineVO.parentItemKey && (!lineModel.segmented || lineModel.segmented && lineModel.segments)) {
							this.addToLinesByParentItemKey(lineModel);
						}
					}
				}, {
					key: '_addStandardLine',
					value: function _addStandardLine(lineModel) {
						if (lineModel.visible) {
							this.hasVisibleStandardLines = true;
						}
						this.quoteModel.indexByGroupKey[lineModel.lineVO.parentGroupKey].indexByLineKey[lineModel.lineVO.key] = this.standardLines.length;
						this.standardLines.push(lineModel);
						if (lineModel.subscriptionScopeEditable && this.quoteModel.grouped) this.standardSubscriptionScopeEditable = true;
					}
				}, {
					key: '_addSegmentedLine',
					value: function _addSegmentedLine(lineModel) {
						var lineVO = lineModel.lineVO,
						    lineRecord = lineVO.record,
						    lineKey = lineVO.key,
						    segmentKey = lineRecord[this.constants.SEGMENT_KEY_FIELD],
						    segmentLabel = lineRecord[this.constants.SEGMENT_LABEL_FIELD],
						    dimension = this.quoteVO.multiSegmentKeys ? this.quoteVO.multiSegmentKeys[segmentKey] : null;

						if (this.segmentedLinesBySegmentKey[segmentKey]) {
							this.quoteModel.indexByGroupKey[this.groupKey].indexByLineKey[lineKey] = this.segmentedLinesBySegmentKey[segmentKey].segments.length;

							lineModel.segmentedLineKey = this.segmentedLineKeysBySegmentKey[segmentKey];
							this.segmentedLinesBySegmentKey[segmentKey].segments.push(lineModel);
							this.segmentedLinesBySegmentKey[segmentKey].segmentsByLabel[segmentLabel] = lineModel;
						} else {
							if (lineModel.visible && !this.hasVisibleSegmentedLines[dimension]) {
								this.hasVisibleSegmentedLines[dimension] = true;
							}
							var firstSegment = new LineModel(lineVO, this);
							this.setDimensionProperties(dimension);
							lineModel.addToSegmentsArray(firstSegment);
							lineModel.addToSegmentsByLabel(segmentLabel, lineModel);
							this.quoteModel.indexByGroupKey[this.groupKey].indexByLineKey[lineKey] = lineModel.segments.length - 1;
							firstSegment.segmentedLineKey = this.segmentedLineKeysBySegmentKey[segmentKey];
							this.segmentedLines.push(lineModel);
							if (dimension) {
								this.quoteModel.indexByGroupKey[this.groupKey].indexBySegmentKey[segmentKey] = this.segmentedLinesByDimension[dimension].length;
								this.segmentedLinesByDimension[dimension].push(lineModel);
								this.segmentedLinesBySegmentKey[segmentKey] = lineModel;
								lineModel.dimensionType = dimension;
							}
						}

						if (lineModel.subscriptionScopeEditable && this.quoteModel.grouped) this.segmentedSubscriptionScopeEditable = true;
					}
				}, {
					key: 'removeDimensionProperties',
					value: function removeDimensionProperties(dim) {
						if (!dim) {
							return;
						}
						if (this.segmentedLinesByDimension[dim] && this.segmentedLinesByDimension[dim].length === 0) {
							delete this.segmentedLinesByDimension[dim];

							if (this.dimensionsMap[dim]) {
								delete this.dimensionsMap[dim];
							}
							this.dimensions.splice(this.dimensions.indexOf(dim), 1);
						}
					}
				}, {
					key: 'setDimensionProperties',
					value: function setDimensionProperties(dim) {
						if (!dim) {
							return;
						}
						if (!this.dimensionsMap[dim]) {
							this.dimensionsMap[dim] = true;
							this.dimensions.push(dim);
						}
						if (!this.segmentedLinesByDimension[dim]) {
							this.segmentedLinesByDimension[dim] = [];
						}
					}
				}, {
					key: 'addToLinesByParentItemKey',
					value: function addToLinesByParentItemKey(lineModel) {
						var map = this.quoteModel.linesByParentItemKey,
						    stdMap = this.quoteModel.standardLinesByParentItemKey,
						    mdqMap = this.quoteModel.segmentedLinesByParentItemKey,
						    parentItemKey = lineModel.lineVO.parentItemKey;
						if (parentItemKey) {
							if (!map[parentItemKey]) {
								map[parentItemKey] = [];
							}
							map[parentItemKey].push(lineModel);
							if (!lineModel.segmented) {
								if (!stdMap[parentItemKey]) {
									stdMap[parentItemKey] = [];
								}
								stdMap[parentItemKey].push(lineModel);
							} else {
								if (!mdqMap[parentItemKey]) {
									mdqMap[parentItemKey] = [];
								}
								mdqMap[parentItemKey].push(lineModel);
							}
						}
					}
				}, {
					key: 'cloneLine',
					value: function cloneLine(line, parentItemKey) {
						var newLineVO = JSON.parse(JSON.stringify(line.lineVO));
						newLineVO.record = JSON.parse(JSON.stringify(line.lineVO.record));
						var clone = new LineModel(newLineVO, line.groupModel);
						clone.lineVO.parentItemKey = parentItemKey ? parentItemKey : null;
						if (clone.segmented && !line.segmentedLineKey) {
							clone.segments = [];
							clone.segmentsByLabel = {};
						}
						clone.lineVO.record.Id = null;
						clone.lineVO.record[this.constants.REQUIRED_BY_FIELD] = null;

						clone.lineVO.record[this.constants.SOURCE_FIELD] = line.lineVO.record['Id'];

						if (line.editorModel.quoteModel.quoteVO.record[this.constants.TYPE_FIELD] === 'Amendment') {
							clone.lineVO.record[this.constants.EXISTING_FIELD] = false;
							clone.lineVO.record[this.constants.RENEWAL_CHECKBOX] = false;
							clone.lineVO.record[this.constants.UPGRADED_ASSET_FIELD] = null;
							clone.lineVO.record[this.constants.UPGRADED_SUBSCRIPTION_FIELD] = null;
							clone.lineVO.record[this.constants.NET_TOTAL_FIELD] = null;
							clone.lineVO.record[this.constants.PRIOR_QUANTITY_FIELD] = null;
							clone.lineVO.record[this.constants.RENEWED_ASSET_ID_FIELD] = null;
							clone.lineVO.record[this.constants.SUBSCRIBED_ASSET_IDS_FIELD] = null;

							clone.existing = false;
							clone.removable = !clone.component && !clone.existing;

							if (!clone.component) {
								clone.discountEditable = true;
							}
						}
						clone.lineVO.key = ++clone.editorModel.quoteModel.quoteVO.nextKey;
						return clone;
					}
				}, {
					key: 'cloneSegmentedLine',
					value: function cloneSegmentedLine(line, parentItemKey) {
						var clone = this.cloneLine(line, parentItemKey);
						clone.lineVO.segmentKey = new Date().getTime();
						var multiSegmentRowTotals = this.quoteModel.quoteVO.multiSegmentRowTotals;
						if (multiSegmentRowTotals) {
							multiSegmentRowTotals[clone.lineVO.segmentKey] = multiSegmentRowTotals[line.lineVO.record[this.constants.SEGMENT_KEY_FIELD]];
						}

						this.segmentedLinesBySegmentKey[clone.lineVO.segmentKey] = clone;
						this.quoteVO.multiSegmentKeys[clone.lineVO.segmentKey] = clone.lineVO.dimensionType;

						for (var i = 0, l = line.segments.length; i < l; i++) {
							var clonedSegment = this.cloneLine(line.segments[i]);
							clonedSegment.lineVO.record[this.constants.SEGMENT_KEY_FIELD] = clone.lineVO.segmentKey;
							clonedSegment.lineVO.parentItemKey = clone.lineVO.parentItemKey;
							clonedSegment.segmentedLineKey = clone.lineVO.key;
							if (clone.segments) {
								clone.segments.push(clonedSegment);
							}
							if (clone.segmentsByLabel) {
								var label = clonedSegment.lineVO.record[this.constants.SEGMENT_LABEL_FIELD];
								clone.segmentsByLabel[label] = clonedSegment;
							}
						}
						clone.dimensionType = line.dimensionType;

						return clone;
					}
				}, {
					key: '_groupHasStandardProducts',
					value: function _groupHasStandardProducts() {
						this.hasVisibleStandardLines = false;
						for (var j = 0, l = this.standardLines.length; j < l; j++) {
							if (this.standardLines[j].visible) {
								this.hasVisibleStandardLines = true;
								break;
							}
						}
						return this.hasVisibleStandardLines;
					}
				}, {
					key: '_groupHasSegmentedProducts',
					value: function _groupHasSegmentedProducts() {
						var dimensions = Object.keys(this.hasVisibleSegmentedLines);
						var result = false;
						for (var s in this.segmentedLinesByDimension) {
							this.hasVisibleSegmentedLines[s] = false;
							for (var k = 0, l = this.segmentedLinesByDimension[s].length; k < l; k++) {
								if (this.segmentedLinesByDimension[s][k].visible) {
									this.hasVisibleSegmentedLines[s] = true;
									result = true;
									break;
								}
							}
						}
						return result;
					}
				}, {
					key: '_updateStandardSubscriptionScopeEditable',
					value: function _updateStandardSubscriptionScopeEditable(removedLine) {
						for (var j = 0, l = this.standardLines.length; j < l; j++) {
							if (this.standardLines[j].visible && this.standardLines[j].subscriptionScopeEditable && this.standardLines[j] !== removedLine) {
								this.standardSubscriptionScopeEditable = true;
								return;
							}
						}
						this.standardSubscriptionScopeEditable = false;
					}
				}, {
					key: '_updateSegmentedSubscriptionScopeEditable',
					value: function _updateSegmentedSubscriptionScopeEditable(removedLine) {
						for (var j = 0, l = this.segmentedLines.length; j < l; j++) {
							if (this.segmentedLines[j].visible && this.segmentedLines[j].subscriptionScopeEditable && this.segmentedLines[j] !== removedLine) {
								this.segmentedSubscriptionScopeEditable = true;
								return;
							}
						}
						this.segmentedSubscriptionScopeEditable = false;
					}
				}, {
					key: 'renumberStandardIndexes',
					value: function renumberStandardIndexes() {
						for (var i = 0, l = this.standardLines.length; i < l; i++) {
							this.quoteModel.indexByGroupKey[this.groupKey].indexByLineKey[this.standardLines[i].lineVO.key] = i;
						}
					}
				}, {
					key: 'renumberSegmentedIndexes',
					value: function renumberSegmentedIndexes() {
						for (var j = 0, d = this.dimensions.length; j < d; j++) {
							var dimension = this.dimensions[j];
							var lineItems = this.segmentedLinesByDimension[dimension];
							for (var k = 0, length = lineItems.length; k < length; k++) {
								var segmentKey = lineItems[k].lineVO.record[this.constants.SEGMENT_KEY_FIELD];
								this.quoteModel.indexByGroupKey[this.groupKey].indexBySegmentKey[segmentKey] = k;
								var segments = lineItems[k].segments;
								for (var m = 0, len = segments.length; m < len; m++) {
									this.quoteModel.indexByGroupKey[this.groupKey].indexByLineKey[segments[m].lineVO.key] = m;
								}
							}
						}
					}
				}, {
					key: 'editorModel',
					get: function get() {
						return this.quoteModel.editorModel;
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.quoteModel.editorModel.constants;
					}
				}, {
					key: 'quoteVO',
					get: function get() {
						return this.quoteModel.quoteVO;
					}
				}, {
					key: 'serviceModel',
					get: function get() {
						return {
							keys: [this.groupVO.key],
							favIds: [this.groupVO.record[this.editorModel.constants.FAVORITE_ID_FIELD]]
						};
					}
				}]);

				return GroupModel;
			}());

			_export('GroupModel', GroupModel);
		}
	};
});

'use strict';

System.register('quotes/models/JSQCNotifier.js', [], function (_export, _context) {
	var _createClass, JSQCNotifier;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('JSQCNotifier', JSQCNotifier = function () {
				function JSQCNotifier(lineEditorComponent) {
					_classCallCheck(this, JSQCNotifier);

					this.lineEditorComponent = lineEditorComponent;
					this.editorModel = this.lineEditorComponent.editorModel;
					this.indexByGroupKey = this.editorModel.quoteModel.indexByGroupKey;
					this.fieldNameSet = this.lineEditorComponent.editorModel.fieldNameSet;
					this.fieldNameSet.add('multiSegmentRowTotals');
					this.fieldNameSet.add('multiSegmentColumnTotals');
					this.fieldNameSet.add('netMultiSegmentTotal');
					this.fieldNameSet.add('summaries');
					this.fieldNameSet.add('fieldVisibility');
					this.fieldNameSet.add('fieldEditability');
					this.constants = this.editorModel.constants;
					this.pathsToNotify = {};
					this.originalPathValues = {};
					this.pathsToSet = {};

					this.groupModels = this.editorModel.quoteModel.lineGroups;
					this.quoteVO = this.editorModel.quoteModel.quoteVO;
				}

				_createClass(JSQCNotifier, [{
					key: 'notify',
					value: function notify(root, path, value, modelVO, previous) {
						var groupIndex = void 0;
						var lineIndex = void 0;

						if (!this.fieldNameSet.has(path.split('.').pop())) {
							return;
						}
						if (root == 'QuoteModel') {
							this.notifyPath('editorModel.quoteModel.quoteVO.' + path, value, previous, root);

							if (path == 'multiSegmentRowTotals') {
								for (var i = 0, l = this.groupModels.length; i < l; i++) {
									var dimensions = this.groupModels[i].dimensions;
									for (var j = 0, length = dimensions.length; j < length; j++) {
										for (var k = 0, len = this.groupModels[i].segmentedLinesByDimension[dimensions[j]].length; k < len; k++) {
											var segmentKey = this.groupModels[i].segmentedLinesByDimension[dimensions[j]][k].lineVO.record[this.constants.SEGMENT_KEY_FIELD];

											this.notifyPath('groupModels.' + i + '.segmentedLinesByDimension.' + dimensions[j] + '.' + k + '.total', value[segmentKey], previous, root);
										}
									}
								}
							}
							if (modelVO.grouped) {
								return;
							}
							var _groupIndex = this.indexByGroupKey[this.groupModels[0].groupVO.key].index;
							this.notifySpecificPath(_groupIndex, path, modelVO, value, previous, root);
						} else if (root == 'QuoteLineGroupModel') {
							if (this.indexByGroupKey[modelVO.key] != null && this.indexByGroupKey[modelVO.key].index != null) {
								groupIndex = this.indexByGroupKey[modelVO.key].index;
								this.notifyPath('groupModels.' + groupIndex + '.groupVO.' + path, value, previous, root);
								this.notifySpecificPath(groupIndex, path, modelVO, value, previous, root);
							}
						} else if (root == 'QuoteLineModel') {
							groupIndex = this.indexByGroupKey[modelVO.parentGroupKey].index;
							lineIndex = this.indexByGroupKey[modelVO.parentGroupKey].indexByLineKey[modelVO.key];

							if (modelVO.record[this.constants.SEGMENT_KEY_FIELD]) {
								var dimensionType = modelVO.parentQuote.multiSegmentKeys[modelVO.record[this.constants.SEGMENT_KEY_FIELD]];
								var segmentIndex = this.indexByGroupKey[modelVO.parentGroupKey].indexBySegmentKey[modelVO.record[this.constants.SEGMENT_KEY_FIELD]];
								this.notifyPath('groupModels.' + groupIndex + '.segmentedLinesByDimension.' + dimensionType + '.' + segmentIndex + '.segments.' + lineIndex + '.lineVO.' + path, value, previous, root);
								if (path == 'record.' + [this.constants.NET_TOTAL_FIELD]) {
									this.notifyPath('groupModels.' + groupIndex + '.segmentedLinesByDimension.' + dimensionType + '.' + segmentIndex + '.' + modelVO.record[this.constants.SEGMENT_LABEL_FIELD].replace(/\W/g, ''), value, previous, root);
								}
							} else {
								this.notifyPath('groupModels.' + groupIndex + '.standardLines.' + lineIndex + '.lineVO.' + path, value, previous, root);
							}
						}
					}
				}, {
					key: 'notifySpecificPath',
					value: function notifySpecificPath(groupIndex, path, modelVO, value, previous, root) {
						if (path != 'multiSegmentColumnTotals' && path != 'netMultiSegmentTotal' && path != 'summaries') {
							return;
						}

						if (path == 'summaries') {
							this.set('groupModels.' + groupIndex + '.summaries', value, previous, root);
							return;
						}

						var dimensions = modelVO.localizedMultiSegmentColumns ? Object.keys(modelVO.localizedMultiSegmentColumns) : Object.keys(modelVO.multiSegmentColumnTotals);

						for (var i = 0, dimensionsLength = dimensions.length; i < dimensionsLength; i++) {
							var columns = path == 'netMultiSegmentTotal' ? modelVO.netMultiSegmentTotal[dimensions[i]] : modelVO.multiSegmentColumnTotals[dimensions[i]];
							if (path == 'netMultiSegmentTotal') {
								this.set('groupModels.' + groupIndex + '.netMultiSegmentTotal.' + dimensions[i], value[dimensions[i]], previous, root);
							} else {
								var columnKeys = Object.keys(columns);
								for (var j = 0, columnsLength = columnKeys.length; j < columnsLength; j++) {
									this.set('groupModels.' + groupIndex + '.multiSegmentColumnTotals.' + dimensions[i] + '.' + columnKeys[j], value[dimensions[i]][columnKeys[j]], previous, root);
								}
							}
						}
					}
				}, {
					key: 'notifyPath',
					value: function notifyPath(path, value, previous, root) {
						if (!this.originalPathValues.hasOwnProperty(path)) this.originalPathValues[path] = previous;
						this.pathsToNotify[path] = { value: value, root: root };
					}
				}, {
					key: 'set',
					value: function set(path, value, previous, root) {
						if (!this.originalPathValues.hasOwnProperty(path)) this.originalPathValues[path] = previous;
						this.pathsToSet[path] = { value: value, root: root };
					}
				}]);

				return JSQCNotifier;
			}());

			_export('JSQCNotifier', JSQCNotifier);
		}
	};
});

'use strict';

System.register('quotes/models/LineModel.js', [], function (_export, _context) {
	var _createClass, LineModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LineModel', LineModel = function () {
				function LineModel(lineVO, groupModel) {
					_classCallCheck(this, LineModel);

					this.lineVO = lineVO;
					this.groupModel = groupModel;
					this.selected = false;
					this.expandedIconClass = this._getExpansionClass();
					this.visible = this.isVisibleInLineEditor();

					if (this.lineVO.record[this.fieldNames.PRICING_METHOD_FIELD] == null) {
						this.lineVO.record[this.fieldNames.PRICING_METHOD_FIELD] = 'List';
					}
				}

				_createClass(LineModel, [{
					key: 'getFieldMD',
					value: function getFieldMD(fieldName) {
						return this.editorModel.md.fieldsMap[this.editorModel.data.quoteLineObjectName][fieldName];
					}
				}, {
					key: 'getField',
					value: function getField(fieldName) {
						return this.lineVO.record[fieldName];
					}
				}, {
					key: '_getExpansionClass',
					value: function _getExpansionClass() {
						if (this.segmented) {
							return this.lineVO.expanded ? 'sf-icon-down' : 'sf-icon-right';
						} else {
							return '';
						}
					}
				}, {
					key: 'isEditable',
					value: function isEditable(fieldName) {
						var field = this.getFieldMD(fieldName);

						if (!field) {
							return false;
						}

						if (field.name == this.fieldNames.QUANTITY_FIELD || field.name == this.fieldNames.ADDITIONAL_QUANTITY_FIELD) {
							return field.updateable && this.quantityEditable;
						} else if (field.name == this.fieldNames.LIST_PRICE_FIELD) {
							return field.updateable && this.listPriceEditable;
						} else if (field.name == this.fieldNames.ADDITIONAL_DISCOUNT_FIELD) {
							return this.discountable && this.discountEditable;
						} else if (field.name == this.fieldNames.PARTNER_DISCOUNT_FIELD) {
							return !this.nonPartnerDiscountable;
						} else if (field.name == this.fieldNames.DISTRIBUTOR_DISCOUNT_FIELD) {
							return this.discountEditable;
						} else if (field.name == this.fieldNames.UPLIFT_FIELD) {
							return field.updateable && this.lineVO.upliftable;
						} else if (field.name == this.fieldNames.UNIT_COST_FIELD) {
							return field.updateable && this.unitCostEditable;
						} else if (field.name == this.fieldNames.CUSTOMER_PRICE_FIELD) {
							return field.updateable && this.pricingMethodCustom;
						} else if (field.name == this.fieldNames.PRICING_METHOD_FIELD) {
							return field.updateable && !this.pricingMethodDisabled;
						} else if (field.name == this.fieldNames.MARKUP_FIELD) {
							return !this.bundled && this.pricingMethodCost && this.discountEditable;
						} else if (field.name == this.fieldNames.NET_PRICE_FIELD) {
							return false;
						} else if (field.name == this.fieldNames.PARTNER_PRICE_FIELD) {
							return false;
						} else if (field.name == this.fieldNames.DESCRIPTION_FIELD) {
							return !this.descriptionLocked;
						} else if (field.name == this.fieldNames.PACKAGE_PRODUCT_CODE_FIELD) {
							return false;
						} else if (field.name == this.fieldNames.PRORATED_LIST_PRICE_FIELD) {
							return false;
						} else if (field.name == this.fieldNames.REGULAR_PRICE_FIELD) {
							return false;
						} else if (field.name == this.fieldNames.START_DATE_FIELD || field.name == this.fieldNames.END_DATE_FIELD) {
							return this.subscription;
						}

						if (this.lineVO.fieldEditability && this.lineVO.fieldEditability[fieldName] != null) {
							return this.lineVO.fieldEditability[fieldName];
						}

						return !!field && field.updateable;
					}
				}, {
					key: 'isFieldRendered',
					value: function isFieldRendered(fieldName, isMobile) {
						if (this.lineVO.fieldVisibility && this.lineVO.fieldVisibility[fieldName] != null) {
							return this.lineVO.fieldVisibility[fieldName];
						}

						var field = this.getFieldMD(fieldName);
						if (field && field.name == this.fieldNames.SUBSCRIPTION_TERM_FIELD) {
							return this.subscription;
						} else if (field && field.extraTypeInfo === 'richtextarea') {
							return !isMobile || this.lineVO.record[fieldName] && isMobile;
						}
						return true;
					}
				}, {
					key: 'isVisibleInLineEditor',
					value: function isVisibleInLineEditor() {
						var visible = this.lineVO.componentVisibility == null || this.lineVO.componentVisibility == '' || this.lineVO.componentVisibility == 'Always' || this.lineVO.componentVisibility == 'Editor Only';
						if (visible && this.renewedAssetId != null && this.editorModel.data.settings.renewedAssetsHiddenWhenEditing) {
							return false;
						}
						return visible;
					}
				}, {
					key: 'addToSegmentsArray',
					value: function addToSegmentsArray(lineModel) {
						if (!this.segments) {
							this.segments = [];
						}
						this.segments.push(lineModel);
					}
				}, {
					key: 'removeFromSegmentsArray',
					value: function removeFromSegmentsArray(lineModel) {
						this.segments.splice(this.segments.indexOf(lineModel), 1);
						if (this.segments.length === 0) {
							delete this.segments;
						}
					}
				}, {
					key: 'addToSegmentsByLabel',
					value: function addToSegmentsByLabel(segmentLabel, lineModel) {
						if (!this.segmentsByLabel) {
							this.segmentsByLabel = {};
						}
						this.segmentsByLabel[segmentLabel] = lineModel;
					}
				}, {
					key: 'removeFromSegmentsByLabel',
					value: function removeFromSegmentsByLabel(segmentLabel) {
						if (this.segmentsByLabel[segmentLabel]) {
							delete this.segmentsByLabel[segmentLabel];
						}
						if (Object.keys(this.segmentsByLabel).length == 0) {
							delete this.segmentsByLabel;
						}
					}
				}, {
					key: 'editorModel',
					get: function get() {
						return this.groupModel.quoteModel.editorModel;
					}
				}, {
					key: 'fieldNames',
					get: function get() {
						return this.editorModel.constants;
					}
				}, {
					key: 'component',
					get: function get() {
						return this.lineVO.record[this.fieldNames.OPTION_LEVEL_FIELD] != null && this.lineVO.dimensionType == null;
					}
				}, {
					key: 'subscription',
					get: function get() {
						return this.lineVO.record[this.fieldNames.SUBSCRIPTION_PRICING_FIELD] != null;
					}
				}, {
					key: 'dynamicSubscription',
					get: function get() {
						return this.lineVO.record[this.fieldNames.SUBSCRIPTION_PRICING_FIELD] == 'Percent Of Total';
					}
				}, {
					key: 'dynamic',
					get: function get() {
						return this.lineVO.record[this.fieldNames.SUBSCRIPTION_PRICING_FIELD] == 'Percent Of Total' || this.lineVO.record[this.fieldNames.PRICING_METHOD_FIELD] == 'Percent Of Total';
					}
				}, {
					key: 'subscriptionScopeEditable',
					get: function get() {
						return this.dynamic && this.lineVO.record[this.fieldNames.COMPONENT_SUBSCRIPTION_SCOPE_FIELD] == null && this.lineVO.record[this.fieldNames.SUBSCRIBED_ASSET_IDS_FIELD] == null;
					}
				}, {
					key: 'rootPackage',
					get: function get() {
						return (this.bundle || this.lineVO.productPullIns && (this.lineVO.productPullIns.hasConfiguration || this.lineVO.productPullIns.hasConfigurationAttributes)) && !this.component;
					}
				}, {
					key: 'legacySupport',
					get: function get() {
						return !(this.lineVO.record[this.fieldNames.RENEWAL_CHECKBOX] == true && this.lineVO.record[this.fieldNames.EXISTING_FIELD] != true && this.lineVO.record[this.fieldNames.PRIOR_QUANTITY_FIELD] == null) || this.editorModel.data.settings.renewalQuotesWithoutAssetsAllowed;
					}
				}, {
					key: 'quantityEditable',
					get: function get() {
						return (this.lineVO.record[this.fieldNames.BUNDLED_QUANTITY_FIELD] == null || !this.component) && this.legacySupport && this.lineVO.productQuantityEditable || this.lineVO.quantityEditable == true;
					}
				}, {
					key: 'costEditable',
					get: function get() {
						return this.lineVO.record[this.fieldNames.COST_EDITABLE_FIELD] == true;
					}
				}, {
					key: 'unitCostEditable',
					get: function get() {
						return this.costEditable && !this.bundled && !this.dynamic;
					}
				}, {
					key: 'pricingMethodList',
					get: function get() {
						return this.lineVO.record[this.fieldNames.PRICING_METHOD_FIELD] == 'List';
					}
				}, {
					key: 'pricingMethodCustom',
					get: function get() {
						return this.lineVO.record[this.fieldNames.PRICING_METHOD_FIELD] == 'Custom';
					}
				}, {
					key: 'pricingMethodCost',
					get: function get() {
						return this.lineVO.record[this.fieldNames.PRICING_METHOD_FIELD] == 'Cost';
					}
				}, {
					key: 'pricingMethodDisabled',
					get: function get() {
						return this.dynamicSubscription || this.bundled || !this.lineVO.record[this.fieldNames.PRICING_METHOD_EDITABLE_FIELD];
					}
				}, {
					key: 'bundled',
					get: function get() {
						return this.lineVO.record[this.fieldNames.BUNDLED_FIELD] == true;
					}
				}, {
					key: 'bundle',
					get: function get() {
						return this.lineVO.record[this.fieldNames.BUNDLE_FIELD] == true;
					}
				}, {
					key: 'nonDiscountable',
					get: function get() {
						return this.lineVO.record[this.fieldNames.NON_DISCOUNTABLE_FIELD] == true;
					}
				}, {
					key: 'nonPartnerDiscountable',
					get: function get() {
						return this.lineVO.record[this.fieldNames.NON_PARTNER_DISCOUNTABLE_FIELD] == true;
					}
				}, {
					key: 'componentDiscountedByPackage',
					get: function get() {
						return this.lineVO.record[this.fieldNames.COMPONENT_DISCOUNTED_BY_PACKAGE_FIELD] == true;
					}
				}, {
					key: 'discountable',
					get: function get() {
						return !this.bundled && !this.nonDiscountable && !this.pricingMethodCustom && !this.componentDiscountedByPackage;
					}
				}, {
					key: 'discountEditable',
					get: function get() {
						return this.groupModel.quoteModel.quoteVO.record[this.fieldNames.TYPE_FIELD] != 'Amendment' || !this.lineVO.record[this.fieldNames.EXISTING_FIELD];
					}
				}, {
					key: 'removable',
					get: function get() {
						return this.lineVO.record[this.fieldNames.OPTION_LEVEL_FIELD] == null && (this.groupModel.quoteModel.quoteVO.record[this.fieldNames.TYPE_FIELD] != 'Amendment' || this.groupModel.quoteModel.quoteVO.record[this.fieldNames.TYPE_FIELD] == 'Amendment' && !this.lineVO.record[this.fieldNames.EXISTING_FIELD]);
					}
				}, {
					key: 'configurable',
					get: function get() {
						return this.rootPackage && !this.lineVO.reconfigurationDisabled && this.lineVO.configurationType != 'Disabled' && (this.lineVO.configurationEvent == null || this.lineVO.configurationEvent == 'Always' || this.lineVO.configurationEvent == 'Edit');
					}
				}, {
					key: 'listPriceEditable',
					get: function get() {
						return this.lineVO.record[this.fieldNames.PRICE_EDITABLE_FIELD] && !this.bundled && !this.dynamicSubscription && this.pricingMethodList;
					}
				}, {
					key: 'segmented',
					get: function get() {
						return this.lineVO.record[this.fieldNames.SEGMENT_KEY_FIELD] != null;
					}
				}, {
					key: 'favorite',
					get: function get() {
						return !this.component && this.lineVO.record[this.fieldNames.FAVORITE_ID_FIELD] != null;
					}
				}, {
					key: 'existing',
					get: function get() {
						return this.lineVO.record[this.fieldNames.EXISTING_FIELD];
					}
				}, {
					key: 'descriptionLocked',
					get: function get() {
						return this.lineVO.descriptionLocked;
					}
				}, {
					key: 'serviceModel',
					get: function get() {
						var keys = [];

						if (this.segments) {
							for (var i = 0, segmentsLength = this.segments.length; i < segmentsLength; i++) {
								keys.push(this.segments[i].lineVO.key);
							}
						} else keys.push(this.lineVO.key);

						return {
							keys: keys,
							segmentKey: this.getField(this.fieldNames.SEGMENT_KEY_FIELD),
							segmented: this.segmented,
							updateCustomSegments: false,
							favIds: [this.getField(this.fieldNames.FAVORITE_ID_FIELD)],
							scheduleId: this.getField(this.fieldNames.DISCOUNT_SCHEDULE_FIELD)

						};
					}
				}]);

				return LineModel;
			}());

			_export('LineModel', LineModel);
		}
	};
});

'use strict';

System.register('quotes/models/MDQSegmentHelper.js', [], function (_export, _context) {
	var _createClass, MDQSegmentHelper;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('MDQSegmentHelper', MDQSegmentHelper = function () {
				function MDQSegmentHelper(editorModel, groupModelsByKey) {
					_classCallCheck(this, MDQSegmentHelper);

					this.MONTHLY_DIM = 'Month';
					this.YEARLY_DIM = 'Year';
					this.QUARTERLY_DIM = 'Quarter';
					this.editorModel = editorModel;
					this.groupModelsByKey = groupModelsByKey;
					this.prefix = editorModel.developerPrefix;
					this.START_DATE_FIELD = this.prefix + 'StartDate__c';
					this.END_DATE_FIELD = this.prefix + 'EndDate__c';
					this.SUBSCRIPTION_TERM_FIELD = this.prefix + 'SubscriptionTerm__c';
					this.LINES_GROUPED_FIELD = this.prefix + 'LineItemsGrouped__c';
					this.SEGMENT_KEY_FIELD = this.prefix + 'SegmentKey__c';
					this.SEGMENT_INDEX_FIELD = this.prefix + 'SegmentIndex__c';
					this.SEGMENT_LABEL_FIELD = this.prefix + 'SegmentLabel__c';
					this.FIRST_SEGMENT_END_DATE_FIELD = this.prefix + 'FirstSegmentTermEndDate__c';
					this.TYPE_FIELD = this.prefix + 'Type__c';
					this.EXISTING_FIELD = this.prefix + 'Existing__c';

					this._segmentsChanged = false;
				}

				_createClass(MDQSegmentHelper, [{
					key: 'updateSegments',
					value: function updateSegments() {
						var quote = this.editorModel.quote;
						if (this._hasMultiSegmentLines(quote)) {
							if (quote.grouped || quote.record[this.LINES_GROUPED_FIELD]) {
								quote.lineItemGroups.forEach(function (group) {
									this._adjustSegments(quote, group);
								}, this);
							} else {
								this._adjustSegments(quote, null);
							}
						}
						return this._segmentsChanged;
					}
				}, {
					key: '_hasMultiSegmentLines',
					value: function _hasMultiSegmentLines(obj) {
						var lineCount = obj.lineItems.length;
						for (var i = 0; i < lineCount; i++) {
							if (obj.lineItems[i].record[this.SEGMENT_KEY_FIELD] != null) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: '_adjustSegments',
					value: function _adjustSegments(quote, group) {
						var term = this._calculateSubscriptionTerm(quote, group);
						var lines = group ? quote.lineItems.filter(function (line) {
							return line.parentGroupKey === group.key;
						}) : quote.lineItems;

						this._calculateSegmentDeltasAndModifySegments(quote, group, lines, term, this.YEARLY_DIM);
						this._calculateSegmentDeltasAndModifySegments(quote, group, lines, term, this.MONTHLY_DIM);
						this._calculateSegmentDeltasAndModifySegments(quote, group, lines, term, this.QUARTERLY_DIM);
					}
				}, {
					key: '_calculateSubscriptionTerm',
					value: function _calculateSubscriptionTerm(quote, group) {
						var startDateFieldValue = group ? group.record[this.START_DATE_FIELD] || quote.record[this.START_DATE_FIELD] : quote.record[this.START_DATE_FIELD];
						var endDateFieldValue = group ? group.record[this.END_DATE_FIELD] || quote.record[this.END_DATE_FIELD] : quote.record[this.END_DATE_FIELD];
						var subscriptionTermValue = group && group.record[this.SUBSCRIPTION_TERM_FIELD] != null ? group.record[this.SUBSCRIPTION_TERM_FIELD] : quote.record[this.SUBSCRIPTION_TERM_FIELD];

						var startDate = startDateFieldValue ? new Date(startDateFieldValue) : null;
						var endDate = endDateFieldValue ? new Date(endDateFieldValue) : null;
						var firstSegEndDateFieldValue = quote.record[this.FIRST_SEGMENT_END_DATE_FIELD];
						var firstSegEndDate = firstSegEndDateFieldValue ? new Date(firstSegEndDateFieldValue) : null;

						if (firstSegEndDate) {
							startDate = startDate ? startDate : new Date();
							if (!endDate) {
								endDate = new Date(startDate.getTime());
								if (this.editorModel.settings.subscriptionTermUnitIsDay) {
									endDate.setUTCDate(endDate.getUTCDate() + subscriptionTermValue - 1);
								} else {
									SB.addMonths(endDate, subscriptionTermValue);
									endDate.setUTCDate(endDate.getUTCDate() - 1);
								}
							}
							var firstSegPlusOneDay = new Date(firstSegEndDate.getTime());
							firstSegPlusOneDay.setUTCDate(firstSegPlusOneDay.getUTCDate() + 1);
							endDate.setDate(endDate.getDate() + 1);
							if (this.editorModel.settings.subscriptionTermUnitIsDay) {
								return SB.daysBetween(firstSegPlusOneDay, endDate);
							} else {
								return SB.monthsBetweenRoundPartialUp(firstSegPlusOneDay, endDate);
							}
						} else if (startDate && endDate) {
							endDate.setDate(endDate.getDate() + 1);
							if (this.editorModel.settings.subscriptionTermUnitIsDay) {
								return SB.daysBetween(startDate, endDate);
							} else {
								return SB.monthsBetweenRoundPartialUp(startDate, endDate);
							}
						} else {
							return subscriptionTermValue;
						}
					}
				}, {
					key: '_calculateSegmentDeltasAndModifySegments',
					value: function _calculateSegmentDeltasAndModifySegments(quote, group, lines, term, dimType) {
						var segmentDeltasBySegmentKey = this._calculateSegmentDeltas(quote, lines, term, dimType);
						if (segmentDeltasBySegmentKey.size != 0) {
							this._modifySegmentsBasedOnDelta(quote, group, segmentDeltasBySegmentKey, dimType);
						}
					}
				}, {
					key: '_calculateSegmentDeltas',
					value: function _calculateSegmentDeltas(quote, lines, term, dimType) {
						var termIsDay = this.editorModel.settings.subscriptionTermUnitIsDay;

						term = term == null ? termIsDay ? 365 : 12 : term;

						var segmentCountsBySegmentKey = mapSegmentCountsBySegmentKeys.bind(this)();
						var trueSegmentCount = determineDesiredNumberOfSegments.bind(this)();
						var segmentDeltasBySegmentKey = new Map();
						segmentCountsBySegmentKey.forEach(function (currentSegCount, segKey) {
							segmentDeltasBySegmentKey.set(segKey, trueSegmentCount - currentSegCount);
						});
						return segmentDeltasBySegmentKey;

						function mapSegmentCountsBySegmentKeys() {
							var segmentCountsBySegmentKey = new Map();
							var lineCount = lines.length;
							for (var i = 0; i < lineCount; i++) {
								var line = lines[i];
								if (line.dimensionType == dimType) {
									var lineSegKey = line.record[this.SEGMENT_KEY_FIELD];
									var currentSegCount = segmentCountsBySegmentKey.get(lineSegKey) || 0;
									segmentCountsBySegmentKey.set(lineSegKey, currentSegCount + 1);
								}
							}
							return segmentCountsBySegmentKey;
						}

						function determineDesiredNumberOfSegments() {
							var trueSegmentCount = 0;
							var firstSegEndDateFieldValue = quote.record[this.FIRST_SEGMENT_END_DATE_FIELD];
							var firstSegEndDate = firstSegEndDateFieldValue ? new Date(firstSegEndDateFieldValue) : null;

							if (firstSegEndDate) {
								trueSegmentCount = 1;

								var firstSegPlusOneDay = new Date(firstSegEndDate.getTime());
								firstSegPlusOneDay.setUTCDate(firstSegPlusOneDay.getUTCDate() + 1);
							}

							if (termIsDay) {
								var termStartDate = firstSegPlusOneDay ? firstSegPlusOneDay : new Date(this.editorModel.quote.record[this.START_DATE_FIELD]);
								var quoteEndDate = this.editorModel.quote.record[this.END_DATE_FIELD] ? new Date(this.editorModel.quote.record[this.END_DATE_FIELD]) : new Date(termStartDate.setUTCDate(termStartDate.getUTCDate() + term));
								term = SB.monthsBetween(termStartDate, quoteEndDate);
								termStartDate.setUTCMonth(termStartDate.getUTCMonth() + term);
								termStartDate.setUTCDate(termStartDate.getUTCDate() - 1);

								if (termStartDate < quoteEndDate) {
									term += 1;
								}
							}

							switch (dimType) {
								case this.YEARLY_DIM:
									trueSegmentCount += Math.ceil(term / 12);
									break;
								case this.QUARTERLY_DIM:
									trueSegmentCount += Math.ceil(term / 3);
									break;
								case this.MONTHLY_DIM:
									trueSegmentCount += term;
							}
							return trueSegmentCount;
						}
					}
				}, {
					key: '_modifySegmentsBasedOnDelta',
					value: function _modifySegmentsBasedOnDelta(quote, group, deltaMap, dimType) {
						deltaMap.forEach(function (delta, segmentKey) {
							var lastSegment = this._getLastSegmentFromQuote(quote, segmentKey, dimType);

							var noDelta = delta === 0;
							var amendmentLine = quote.record[this.TYPE_FIELD] === 'Amendment' && lastSegment.record[this.EXISTING_FIELD];

							var lastSegStartDateFieldValue = lastSegment.record[this.START_DATE_FIELD];
							var lastSegEndDateFieldValue = lastSegment.record[this.END_DATE_FIELD];

							var lastSegStartDate = lastSegStartDateFieldValue ? new Date(lastSegStartDateFieldValue) : null;
							var lastSegEndDate = lastSegEndDateFieldValue ? new Date(lastSegEndDateFieldValue) : null;
							var startDateBeforeEndDate = lastSegEndDate >= lastSegStartDate;
							if (noDelta || amendmentLine) {
								return;
							} else if (delta > 0 && startDateBeforeEndDate) {
								this._segmentsChanged = true;
								for (var i = 1; i <= delta; i++) {
									var newSegmentVO = this._createNewSegment(quote, lastSegment, i);
									quote.lineItems.push(newSegmentVO);
									if (this.groupModelsByKey) {
										this.groupModelsByKey[newSegmentVO.parentGroupKey].addLine(newSegmentVO);
									}
								}
							} else if (delta < 0) {
								this._segmentsChanged = true;

								for (var _i = 0; _i > delta; _i--) {
									var _lastSegment = this._getLastSegmentFromQuote(quote, segmentKey, dimType);
									this._removeSegment(quote, _lastSegment);
									if (this.groupModelsByKey) {
										var line = this.groupModelsByKey[_lastSegment.parentGroupKey].segmentedLinesBySegmentKey[segmentKey];
										line.segments.splice(line.segments.length - 1, 1);
									}
								}
							}
						}, this);
					}
				}, {
					key: '_getLastSegmentFromQuote',
					value: function _getLastSegmentFromQuote(quote, segmentKey, dimType) {
						var lineItem = null;
						var maxIndex = null;
						quote.lineItems.forEach(function (line) {
							if (line.record[this.SEGMENT_KEY_FIELD] === segmentKey && line.dimensionType === dimType) {
								var index = line.record[this.SEGMENT_INDEX_FIELD];
								if (index != null && (maxIndex == null || maxIndex < index)) {
									maxIndex = index;
									lineItem = line;
								}
							}
						}, this);
						return lineItem;
					}
				}, {
					key: '_createNewSegment',
					value: function _createNewSegment(quote, sourceSegment, offset) {
						var clone = JSON.parse(JSON.stringify(sourceSegment));

						clone.key = ++quote.nextKey;
						clone.record.Id = null;

						clone.record[this.SEGMENT_KEY_FIELD] = sourceSegment.record[this.SEGMENT_KEY_FIELD];
						clone.record[this.SEGMENT_INDEX_FIELD] = sourceSegment.record[this.SEGMENT_INDEX_FIELD] + offset;
						var whitespace = clone.record[this.SEGMENT_INDEX_FIELD] < 10 ? '  ' : ' ';
						clone.record[this.SEGMENT_LABEL_FIELD] = sourceSegment.dimensionType + whitespace + clone.record[this.SEGMENT_INDEX_FIELD];
						return clone;
					}
				}, {
					key: '_removeSegment',
					value: function _removeSegment(quote, segmentToRemove) {
						var lineCount = quote.lineItems.length;
						for (var i = 0; i < lineCount; i++) {
							var line = quote.lineItems[i];
							if (line.key === segmentToRemove.key) {
								quote.lineItems = quote.lineItems.slice(0, i).concat(quote.lineItems.slice(i + 1, lineCount));
								if (quote.deletedLineIds && line.record && line.record.Id) {
									quote.deletedLineIds.push(line.record.Id);
								}
								return;
							}
						}
					}
				}]);

				return MDQSegmentHelper;
			}());

			_export('MDQSegmentHelper', MDQSegmentHelper);
		}
	};
});

'use strict';

System.register('quotes/models/QuoteMessenger.js', [], function (_export, _context) {
	var _createClass, QuoteMessenger;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('QuoteMessenger', QuoteMessenger = function () {
				function QuoteMessenger(editorModel, targetRecord) {
					_classCallCheck(this, QuoteMessenger);

					this.editorModel = editorModel;
					this.targetRecord = targetRecord;
				}

				_createClass(QuoteMessenger, [{
					key: 'getRequest',
					value: function getRequest() {
						var message = {
							target: this.targetRecord,
							quote: this.editorModel.quoteModel.quoteVO.record,
							lines: [],
							actions: []
						};

						return message;
					}
				}, {
					key: 'getResponse',
					value: function getResponse(message) {
						if (!message) return;

						switch (message.actions[0].toLowerCase().replace(' ', '')) {
							case 'save':
								return { lines: message.lines, action: 'save' };
								break;
							case 'quicksave':
								return { lines: message.lines, action: 'quicksave' };
								break;
							case 'reload':
								return { lines: message.lines, action: 'reload' };
								break;
							case 'none':
							default:
								return { lines: message.lines, action: 'none' };
						}
					}
				}]);

				return QuoteMessenger;
			}());

			_export('QuoteMessenger', QuoteMessenger);
		}
	};
});

'use strict';

System.register('quotes/models/QuoteModel.js', ['quotes/models/GroupModel.js', 'quotes/models/LineModel.js'], function (_export, _context) {
	var GroupModel, LineModel, _createClass, QuoteModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsGroupModelJs) {
			GroupModel = _quotesModelsGroupModelJs.GroupModel;
		}, function (_quotesModelsLineModelJs) {
			LineModel = _quotesModelsLineModelJs.LineModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('QuoteModel', QuoteModel = function () {
				function QuoteModel(quoteVO, editorModel) {
					_classCallCheck(this, QuoteModel);

					this.quoteVO = quoteVO;
					this.editorModel = editorModel;

					this.grouped = quoteVO.record[this.editorModel.constants.GROUP_LINE_ITEMS_FIELD];

					this.groupsByKey = {};
					this.lineModelsByKey = {};
					this.indexByGroupKey = {};
					this.lineGroups = [];

					this.linesByParentItemKey = {};
					this.standardLinesByParentItemKey = {};
					this.segmentedLinesByParentItemKey = {};

					this.allOptional = true;

					this.isPrimary = this.quoteVO.record["SBQQ__Primary__c"];
					this.isAmendment = this.quoteVO.record[this.editorModel.constants.TYPE_FIELD] === 'Amendment';
					this.isRenewal = this.quoteVO.record[this.editorModel.constants.TYPE_FIELD] === 'Renewal';

					if (this.grouped && this.quoteVO.lineItemGroups.length == 0) {
						var groupRecord = { Name: 'Group' + 1 };
						var groupVO = { key: ++this.quoteVO.nextKey, record: groupRecord, multiSegmentColumns: {}, localizedMultiSegmentColumns: {} };
						var group = new GroupModel(groupVO, this);
						this.quoteVO.lineItemGroups.push(groupVO);
						this.groupsByKey[group.groupVO.key] = group;
						this.indexByGroupKey[group.groupVO.key] = { index: Object.keys(this.indexByGroupKey).length, indexByLineKey: {}, indexBySegmentKey: {} };
						var _lineVOs = this.quoteVO.lineItems;
						for (var _i = 0; _i < _lineVOs.length; _i++) {
							var lineVO = _lineVOs[_i];
							lineVO.parentGroupKey = group.groupVO.key;
						}
					}

					var groups = this.grouped ? this.quoteVO.lineItemGroups : [{ key: null, record: {} }];
					for (var i = 0, len = groups.length; i < len; i++) {
						var groupModel = new GroupModel(groups[i], this);
						this.lineGroups.push(groupModel);
						this.groupsByKey[groupModel.groupVO.key] = groupModel;
						this.indexByGroupKey[groupModel.groupVO.key] = { index: i, indexByLineKey: {}, indexBySegmentKey: {} };
					}

					var lineVOs = this.quoteVO.lineItems;
					for (var j = 0, l = lineVOs.length; j < l; j++) {
						var _lineVO = lineVOs[j];
						if (!_lineVO.record[this.editorModel.constants.OPTIONAL_FIELD]) {
							this.allOptional = false;
						}
						this.groupsByKey[_lineVO.parentGroupKey].addLine(_lineVO);
					}
				}

				_createClass(QuoteModel, [{
					key: 'renumberIndexes',
					value: function renumberIndexes(deepRenumber) {
						for (var i = 0, l = this.lineGroups.length; i < l; i++) {
							var groupKey = this.lineGroups[i].groupKey;
							this.indexByGroupKey[groupKey].index = i;
							if (deepRenumber) {
								this.lineGroups[i].renumberStandardIndexes();
								this.lineGroups[i].renumberSegmentedIndexes();
							}
						}
					}
				}]);

				return QuoteModel;
			}());

			_export('QuoteModel', QuoteModel);
		}
	};
});

'use strict';

System.register('quotes/models/SortLinesHandler.js', ['quotes/models/Constants.js'], function (_export, _context) {
    var Constants, _createClass, SortLinesHandler;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [function (_quotesModelsConstantsJs) {
            Constants = _quotesModelsConstantsJs.Constants;
        }],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export('SortLinesHandler', SortLinesHandler = function () {
                function SortLinesHandler(prefix) {
                    _classCallCheck(this, SortLinesHandler);

                    this.constants = new Constants(prefix);
                }

                _createClass(SortLinesHandler, [{
                    key: 'sortLineItems',
                    value: function sortLineItems(lines, lineSortField) {
                        lines.sort(function (a, b) {
                            a.lineSortValue = a.record[lineSortField];
                            b.lineSortValue = b.record[lineSortField];
                            if (a.lineSortValue != null && b.lineSortValue != null && a.lineSortValue != b.lineSortValue) {
                                var difference = a.lineSortValue - b.lineSortValue;
                                if (difference === difference) {
                                    return difference;
                                } else {
                                    return a.lineSortValue < b.lineSortValue ? -1 : 1;
                                }
                            } else if (a.lineSortValue == b.lineSortValue) {
                                var aSecondary = a.record[this.constants.SEGMENT_INDEX_FIELD];
                                var bSecondary = b.record[this.constants.SEGMENT_INDEX_FIELD];
                                if (aSecondary == bSecondary) {
                                    return a.record[this.constants.NUMBER_FIELD] - b.record[this.constants.NUMBER_FIELD];
                                } else if (aSecondary == null) {
                                    return -1;
                                } else if (bSecondary == null) {
                                    return 1;
                                } else {
                                    return aSecondary - bSecondary;
                                }
                            } else if (a.lineSortValue == null) {
                                return -1;
                            } else if (b.lineSortValue == null) {
                                return 1;
                            } else {
                                return a.record[this.constants.NUMBER_FIELD] - b.record[this.constants.NUMBER_FIELD];
                            }
                        }.bind(this));
                        return lines;
                    }
                }]);

                return SortLinesHandler;
            }());

            _export('SortLinesHandler', SortLinesHandler);
        }
    };
});

"use strict";

System.register("quotes/precaching/IdConverter.js", [], function (_export, _context) {
	var CONVERSION_TABLE;

	function convertTo18(id) {
		if (!id) {
			return null;
		} else if (id.length === 18) {
			return id;
		} else if (id.length === 15) {
			var part1 = convertToDigit(id.slice(0, 5));
			var part2 = convertToDigit(id.slice(5, 10));
			var part3 = convertToDigit(id.slice(10, 15));
			return id + part1 + part2 + part3;
		} else {
			return null;
		}
	}

	function reverseString(str) {
		return str.split("").reverse().join("");
	}

	function replaceWithBinary(string) {
		var res = string.replace(/[^A-Z]/g, "0");
		return res.replace(/[A-Z]/g, "1");
	}

	function convertToDigit(seg) {
		return CONVERSION_TABLE[replaceWithBinary(reverseString(seg))];
	}
	return {
		setters: [],
		execute: function () {
			module.exports = convertTo18;

			CONVERSION_TABLE = {
				"00000": "A",
				"00001": "B",
				"00010": "C",
				"00011": "D",
				"00100": "E",
				"00101": "F",
				"00110": "G",
				"00111": "H",
				"01000": "I",
				"01001": "J",
				"01010": "K",
				"01011": "L",
				"01100": "M",
				"01101": "N",
				"01110": "O",
				"01111": "P",
				"10000": "Q",
				"10001": "R",
				"10010": "S",
				"10011": "T",
				"10100": "U",
				"10101": "V",
				"10110": "W",
				"10111": "X",
				"11000": "Y",
				"11001": "Z",
				"11010": "0",
				"11011": "1",
				"11100": "2",
				"11101": "3",
				"11110": "4",
				"11111": "5"
			};
		}
	};
});

"use strict";

System.register("quotes/precaching/JSQCPrecacheWorker.js", [], function (_export, _context) {
	function getRunnerConstructor(sequence) {
		var requiredModulesBySequence = {
			'PriceRuleSequence': require('./PrecacheSequenceRunners/PriceRuleSequenceRunner.js'),
			'MetadataSequence': require('./PrecacheSequenceRunners/MetadataSequenceRunner.js'),
			'OptionSequence': require('./PrecacheSequenceRunners/OptionSequenceRunner.js'),
			'DiscountAndAccountSequence': require('./PrecacheSequenceRunners/DiscountScheduleSequenceRunner.js'),
			'ProductSequence': require('./PrecacheSequenceRunners/ProductSequenceRunner.js'),
			'RelatedRecordSequence': require('./PrecacheSequenceRunners/RelatedRecordSequenceRunner.js')
		};
		return requiredModulesBySequence[sequence] || null;
	}

	function getArgumentList(sequence, apex, data, resultPoster) {
		var result = [apex, data.prefix, resultPoster];

		switch (sequence) {
			case 'PriceRuleSequence':
				return result.concat([data.accountId]);
			case 'MetadataSequence':
				return result.concat([data.referencedFieldMap]);
			case 'DiscountAndAccountSequence':
				return result.concat([data.quote, data.accountId]);
			case 'RelatedRecordSequence':
				return result.concat([data.quote, data.lookupFieldMap, data.referencedFieldMap]);
			case 'ProductSequence':
			case 'OptionSequence':
				return result.concat([data.quote, data.referencedFields]);
			default:
				return null;
		}
	}

	function apexFactory(client) {
		function read(prefix, provider, uid) {
			return new Promise(function (resolve, reject) {
				client.read(prefix, provider, uid).then(function (res) {
					resolve(res);
				}, function (err) {
					reject(err.message || err);
				});
			});
		}

		function load(prefix, provider, uid, context) {
			return new Promise(function (resolve, reject) {
				client.load(prefix, provider, uid || '', context).then(function (res) {
					resolve(res);
				}, function (err) {
					reject(err.message || err);
				});
			});
		}

		function setOptions(opts) {
			client.setOptions(opts);
		}

		function md(mdType, mdItems) {
			var promiseArray = [];
			var promisesNeeded = Math.ceil(mdItems.length / 10);
			for (var i = 0; i < promisesNeeded; i++) {
				promiseArray.push(client.md(mdType, mdItems.slice(i * 10, (i + 1) * 10)));
			}

			return Promise.all(promiseArray).then(function (dataArray) {
				var combinedDataArray = [];
				dataArray.forEach(function (arr) {
					if (arr != null) {
						if (arr.length == null) {
							arr = [arr];
						}
						combinedDataArray = combinedDataArray.concat(arr);
					}
				});
				return combinedDataArray;
			});
		}

		return {
			read: read,
			load: load,
			md: md,
			setOptions: setOptions
		};
	}
	return {
		setters: [],
		execute: function () {
			self.addEventListener('message', function (e) {
				var startTime = new Date().getTime();

				importScripts("//cdnjs.cloudflare.com/ajax/libs/jsforce/1.7.0/jsforce.min.js");
				importScripts("https://www.promisejs.org/polyfills/promise-7.0.4.min.js");

				var conn = new jsforce.Connection({
					oauth2: new jsforce.OAuth2({ clientId: true, clientSecret: true }),
					accessToken: e.data.accessToken,
					refreshToken: '',
					instanceUrl: e.data.siteUrl
				});

				var client = require('./PrecacheRestClient.js')(conn, e.data.orgUrl, e.data.siteUrl);

				var apex = apexFactory(client);

				var precacheSequence = e.data.precacheSequence;
				var runnerConstructor = getRunnerConstructor(precacheSequence);
				if (!runnerConstructor) {
					self.postMessage({ failure: true, sequence: precacheSequence, msg: 'Unrecognized sequence' });
					close();
				}
				var argumentList = getArgumentList(precacheSequence, apex, e.data, self.postMessage);
				var runner = runnerConstructor.apply(null, argumentList);
				runner.executeSequence().then(function () {
					close();
				});
			});
		}
	};
});

'use strict';

System.register('quotes/precaching/JSQCPrecacheWorkerManager.js', ['quotes/models/Constants.js', 'common/data/client/RemoteOAuth.js'], function (_export, _context) {
	var Constants, RemoteOAuth, _createClass, JSQCPrecacheWorkerManager;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsConstantsJs) {
			Constants = _quotesModelsConstantsJs.Constants;
		}, function (_commonDataClientRemoteOAuthJs) {
			RemoteOAuth = _commonDataClientRemoteOAuthJs.RemoteOAuth;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('JSQCPrecacheWorkerManager', JSQCPrecacheWorkerManager = function () {
				function JSQCPrecacheWorkerManager(data) {
					_classCallCheck(this, JSQCPrecacheWorkerManager);

					this.data = data;
					this.orgUrl = this.data.settings.orgUrl;
					this.siteUrl = this.data.settings.siteUrl;
					this.prefix = this.data.developerPrefix ? 'SBQQ' : '';
					this.constants = new Constants(this.data.developerPrefix);
					this.filePath = this.siteUrl + '/resource/' + new Date().getTime() + '/' + this.data.developerPrefix + 'PrecacherUI2';
				}

				_createClass(JSQCPrecacheWorkerManager, [{
					key: 'beginPrecaching',
					value: function beginPrecaching() {
						var self = this;
						this._getAccessToken().then(function (accessToken) {
							self.accessToken = accessToken;
							self._spoolWorkers();
						}, function (err) {
							console.log('Could not get access token');
						});
					}
				}, {
					key: '_getAccessToken',
					value: function _getAccessToken() {
						var oauth = new RemoteOAuth(this.prefix);
						return oauth.getAccessTokenBypassingCache();
					}
				}, {
					key: '_spoolWorkers',
					value: function _spoolWorkers() {
						var accountId = this.data.quote.record[this.constants.ACCOUNT_ID_FIELD];
						var settings = this.data.settings;
						var quote = this.data.quote;
						var referencedFieldMap = this.data.settings.referencedFieldMap;

						var priceRuleWorker = this._createWorker();
						var priceRuleContext = this._createWorkerContext('PriceRuleSequence', new Map([['accountId', accountId]]));
						priceRuleWorker.postMessage(priceRuleContext);

						var metadataWorker = this._createWorker();
						var metadataContext = this._createWorkerContext('MetadataSequence', new Map([['referencedFieldMap', referencedFieldMap]]));
						metadataWorker.postMessage(metadataContext);

						var discountWorker = this._createWorker();
						var discountContext = this._createWorkerContext('DiscountAndAccountSequence', new Map([['accountId', accountId], ['quote', quote]]));
						discountWorker.postMessage(discountContext);

						var relatedRecordWorker = this._createWorker();
						var lookupFieldMap = {
							quoteLookups: settings.quoteLookups || {},
							groupLookups: settings.groupLookups || {},
							lineLookups: function () {
								var allLineLookups = settings.lineLookups || {};
								var nonstandardLineLookups = {};
								var fieldPrefix = settings.developerPrefix || '';
								for (var key in allLineLookups) {
									if (key !== fieldPrefix + 'Product__c' && key !== fieldPrefix + 'ProductOption__c') {
										nonstandardLineLookups[key] = allLineLookups[key];
									}
								}
								return nonstandardLineLookups;
							}()
						};
						var relatedRecordContext = this._createWorkerContext('RelatedRecordSequence', new Map([['quote', quote], ['referencedFieldMap', referencedFieldMap], ['lookupFieldMap', lookupFieldMap]]));
						relatedRecordWorker.postMessage(relatedRecordContext);

						var productWorker = this._createWorker();
						var productContext = this._createWorkerContext('ProductSequence', new Map([['quote', quote], ['referencedFields', settings.referencedFieldMap['Product2']]]));
						productWorker.postMessage(productContext);

						var fieldPrefix = settings.developerPrefix || '';
						var optionWorker = this._createWorker();
						var optionContext = this._createWorkerContext('OptionSequence', new Map([['quote', quote], ['referencedFields', settings.referencedFieldMap[fieldPrefix + 'ProductOption__c']]]));
						optionWorker.postMessage(optionContext);
					}
				}, {
					key: '_createWorkerContext',
					value: function _createWorkerContext(sequence, extrasMap) {
						var baseContext = {
							orgUrl: this.orgUrl,
							siteUrl: this.siteUrl,
							accessToken: this.accessToken,
							precacheSequence: sequence,
							prefix: this.prefix
						};
						if (extrasMap && extrasMap.size != 0) {
							extrasMap.forEach(function (val, key) {
								baseContext[key] = val;
							});
						}
						return baseContext;
					}
				}, {
					key: '_createWorker',
					value: function _createWorker() {
						var wrkr = new Worker(this.filePath);
						var precachingFn = this._precache;
						wrkr.addEventListener('message', function (e) {
							if (e.data.successful) {
								precachingFn(e.data.provider, e.data.uid, e.data.results);
							} else if (e.data.failure) {
								console.error('Main thread received failure from precache sequence ' + e.data.sequence + ': ' + e.data.msg);
							} else if (e.data.err) {
								console.error('Main thread received error from precache sequence ' + e.data.sequence + ': ' + e.data.msg);
							}
						});
						return wrkr;
					}
				}, {
					key: '_precache',
					value: function _precache(provider, uid, results) {
						if (SB && SB.JSQCPrecacher) {
							var precacher = new SB.JSQCPrecacher();
							precacher.precacheValue(provider, uid, results);
						}
					}
				}]);

				return JSQCPrecacheWorkerManager;
			}());

			_export('JSQCPrecacheWorkerManager', JSQCPrecacheWorkerManager);
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheRestClient.js', [], function (_export, _context) {
	function restClient(conn, orgUrl, siteUrl) {
		var proxy = restProxy(conn, orgUrl, siteUrl);

		function read(prefix, provider, uid) {
			var endpoint = getEndpoint(prefix);
			return new Promise(function (resolve, reject) {
				proxy.get(endpoint + '?reader=' + provider + '&uid=' + uid).then(function (res) {
					resolve(parse(res));
				}, function (err) {
					reject(err);
				});
			});
		}

		function load(prefix, provider, uid, context) {
			var endpoint = getEndpoint(prefix);
			var body = JSON.stringify({ context: JSON.stringify(context) });
			return new Promise(function (resolve, reject) {
				proxy.patch(endpoint + '?loader=' + provider + '&uid=' + uid, body).then(function (res) {
					resolve(parse(res));
				}, function (err) {
					reject(err);
				});
			});
		}

		function md(mdType, mdItems) {
			return new Promise(function (resolve, reject) {
				proxy.md(mdType, mdItems).then(function (res) {
					resolve(res);
				}, function (err) {
					reject(err);
				});
			});
		}

		function setOptions(opts) {}

		function getEndpoint(prefix) {
			var endpoint = '/ServiceRouter';
			return prefix ? '/' + prefix + endpoint : endpoint;
		}

		function parse(obj) {
			try {
				return JSON.parse(obj);
			} catch (e) {
				return obj;
			}
		}

		return {
			read: read,
			load: load,
			md: md,
			setOptions: setOptions
		};
	}

	function restProxy(conn, orgUrl, siteUrl) {

		function get(endpoint) {
			return send(endpoint, 'GET');
		}

		function patch(endpoint, body) {
			return send(endpoint, 'PATCH', body);
		}

		function md(mdType, mdItems) {
			return conn.metadata.read(mdType, mdItems);
		}

		function send(endpoint, method, body) {
			var params = {
				url: siteUrl != '' ? siteUrl + '/services/apexrest' + endpoint : '/services/proxy',
				method: method,
				headers: {
					'SalesforceProxy-Endpoint': orgUrl + '/services/apexrest' + endpoint,
					'Content-Type': 'application/json'
				}
			};

			if (body) params.body = body;

			return conn.request(params);
		}

		return {
			get: get,
			patch: patch,
			md: md
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = restClient;
		}
	};
});

'use strict';

System.register('quotes/sb-le-custom-action-services/LECustomActionServices.js', ['common/core/Navigator.js', 'quotes/models/GroupModel.js', 'common/data/client/OAuthClient.js', 'quotes/models/JSQCNotifier.js', 'quotes/models/SortLinesHandler.js', 'quotes/models/QuoteMessenger.js', 'common/data/format/JsonFormatter.js', 'quotes/models/MDQSegmentHelper.js', 'common/relationship/RelationshipFieldManager.js', 'common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js'], function (_export, _context) {
	var Navigator, GroupModel, OAuthClient, JSQCNotifier, SortLinesHandler, QuoteMessenger, JsonFormatter, MDQSegmentHelper, RelationshipFieldManager, PageContainer, AppContext, _createClass, LECustomActionServices;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreNavigatorJs) {
			Navigator = _commonCoreNavigatorJs.Navigator;
		}, function (_quotesModelsGroupModelJs) {
			GroupModel = _quotesModelsGroupModelJs.GroupModel;
		}, function (_commonDataClientOAuthClientJs) {
			OAuthClient = _commonDataClientOAuthClientJs.OAuthClient;
		}, function (_quotesModelsJSQCNotifierJs) {
			JSQCNotifier = _quotesModelsJSQCNotifierJs.JSQCNotifier;
		}, function (_quotesModelsSortLinesHandlerJs) {
			SortLinesHandler = _quotesModelsSortLinesHandlerJs.SortLinesHandler;
		}, function (_quotesModelsQuoteMessengerJs) {
			QuoteMessenger = _quotesModelsQuoteMessengerJs.QuoteMessenger;
		}, function (_commonDataFormatJsonFormatterJs) {
			JsonFormatter = _commonDataFormatJsonFormatterJs.JsonFormatter;
		}, function (_quotesModelsMDQSegmentHelperJs) {
			MDQSegmentHelper = _quotesModelsMDQSegmentHelperJs.MDQSegmentHelper;
		}, function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LECustomActionServices', LECustomActionServices = function () {
				function LECustomActionServices() {
					_classCallCheck(this, LECustomActionServices);
				}

				_createClass(LECustomActionServices, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-custom-action-services';
						this.properties = {
							editorModel: Object,
							eventDetail: Object,
							response: {
								type: Object,
								notify: true
							},
							error: {
								notify: true
							}
						};
					}
				}, {
					key: '_executeServiceAction',
					value: function _executeServiceAction(eventHandlerName, pseudoServiceModel) {
						var serviceModel = pseudoServiceModel || (this.eventDetail && this.eventDetail.model ? this.eventDetail.model.serviceModel : null);
						if (this.editorModel) {
							if (this._usesClientCalculator()) this.sortLines(this.editorModel.quoteModel.quoteVO, false);

							this.editorModel.quoteModel.quoteVO.lineItems = this._reorderLineItems();
							this._reorderGroups();
						}
						var quoteVO = this.editorModel ? this.editorModel.quoteModel.quoteVO : this.data.quote;
						if (serviceModel) {
							this.$[eventHandlerName].model = undefined;
							serviceModel.quoteJSON = new JsonFormatter(true).format(quoteVO);
							this.$[eventHandlerName].model = serviceModel;
						} else {
							this.$[eventHandlerName].model = undefined;
							this.$[eventHandlerName].model = new JsonFormatter(true).format(quoteVO);
						}
					}
				}, {
					key: '_reorderLineItems',
					value: function _reorderLineItems() {
						var lineItems = [];
						var groupModels = this.editorModel.quoteModel.lineGroups;
						for (var i = 0, numOfGroups = groupModels.length; i < numOfGroups; i++) {
							var groupModel = groupModels[i];
							for (var j = 0, numOfDimensions = groupModel.dimensions.length; j < numOfDimensions; j++) {
								var dim = groupModel.dimensions[j],
								    segmentedLines = groupModel.segmentedLinesByDimension[dim];
								for (var k = 0, numOfLines = segmentedLines.length; k < numOfLines; k++) {
									var segments = segmentedLines[k].segments;
									for (var m = 0, numOfSegments = segments.length; m < numOfSegments; m++) {
										lineItems.push(segments[m].lineVO);
									}
								}
							}

							for (var n = 0, len = groupModel.standardLines.length; n < len; n++) {
								lineItems.push(groupModel.standardLines[n].lineVO);
							}
						}
						return lineItems;
					}
				}, {
					key: '_reorderGroups',
					value: function _reorderGroups() {
						var groupModels = this.domHost.groupModels;
						for (var i = 0; i < groupModels.length; i++) {
							groupModels[i].groupVO.record[this.editorModel.constants.NUMBER_FIELD] = i + 1;
						}
					}
				}, {
					key: '_saveFavorite',
					value: function _saveFavorite(e) {
						this._executeServiceAction('favoriteLinesService', { keys: e.detail.keys, favName: e.detail.name, groupKey: e.detail.groupKey });
					}
				}, {
					key: '_executeCustomAction',
					value: function _executeCustomAction() {
						var action = this.eventDetail.customAction;
						if (action.url && action.urlTarget) {
							this._executeCustomURLAction(action.url, action.urlTarget, this.eventDetail.model);
						} else if (typeof this[action.eventHandlerName] == "function") {
							this[action.eventHandlerName]();
						} else {
							this._executeServiceAction(this.eventDetail.customAction.eventHandlerName);
						}
					}
				}, {
					key: '_executeCustomURLAction',
					value: function _executeCustomURLAction(url, target, model) {
						if (model.quoteVO) this.model = model.quoteVO;else if (model.lineVO) this.model = model.lineVO;else if (model.groupVO) this.model = model.groupVO;

						var parsedURL = this._parseURL(url, this.model);
						if (target === 'Popup') this._handlePopup(parsedURL, this.model.record);else this._navigateToURL(parsedURL);
					}
				}, {
					key: '_handleCalculateResponse',
					value: function _handleCalculateResponse() {
						var response = this.calculateResponse;
						if (response) {
							if (response.jobId != null) {
								this._onJobChecker(response);
							} else {
								this._updateQuote(response);
							}
						}
					}
				}, {
					key: '_updateQuote',
					value: function _updateQuote(quoteVO) {
						this.domHost.updateQuote(quoteVO);
					}
				}, {
					key: '_checkForGuidedMessages',
					value: function _checkForGuidedMessages() {
						if (this.saverResponse.guidedMessages && this.saverResponse.guidedMessages.length > 0) {
							this.domHost.handleProductRuleAlertModal('saveService', this.saverResponse.guidedMessages);
							this.showSpinner = false;
						} else {
							this.navigateToReturnUrl(true);
						}
					}
				}, {
					key: 'navigateToReturnUrl',
					value: function navigateToReturnUrl(args) {
						if (args && this.saverResponse && this.saverResponse.messages && this.saverResponse.messages.length > 0) {
							if (this.showSpinner) this.showSpinner = false;
							this.domHost.errors = this.saverResponse.messages;
							return;
						}
						var sobjectId = this.editorModel.quoteModel.quoteVO.record.Id;
						var returnUrl = this.eventDetail.customAction.record ? this.eventDetail.customAction.record[this.editorModel.constants.RETURN_URL_FIELD] : null;
						if (returnUrl) {
							returnUrl = this._parseURL(returnUrl, this.editorModel.quoteModel.quoteVO, this.editorModel.quoteModel);
							if ((returnUrl.length == 15 || returnUrl.length == 18) && returnUrl.match(/^[a-zA-Z0-9]*$/)) {
								sobjectId = returnUrl;
								returnUrl = null;
							}
						}
						if (this._isLightningExperience() && !returnUrl) {
							if (PageContainer.getViewport().isMobile() === true) this._navigateToURL('#/sObject/' + this.prefix + 'Quote__c/home');else sforce.one.navigateToSObject(sobjectId);
							return;
						}

						returnUrl = returnUrl || this.editorModel.communityPrefix + '/' + sobjectId;

						if (window.parent) {
							window.parent.location.href = returnUrl;
						} else {
							window.location.href = returnUrl;
						}
					}
				}, {
					key: '_reloadEditor',
					value: function _reloadEditor() {
						this.domHost.destampGroups();
						this.domHost.md = undefined;

						Polymer.RenderStatus.afterNextRender(this, function () {
							this.domHost.rawData = this.quoteEditorModelResponse;
							if (this.quoteEditorModelResponse.guidedMessages && this.quoteEditorModelResponse.guidedMessages.length > 0) {
								this.domHost.handleProductRuleAlertModal('quickSaveService', this.quoteEditorModelResponse);
							}
							this.showSpinner = false;
						});
					}
				}, {
					key: '_handleToggleGroupResponse',
					value: function _handleToggleGroupResponse() {
						this.domHost.set('editorModel.quoteModel.quoteVO', this.toggleGroupResponse);
						if (this.domHost.$$('#quoteTabs')) this.domHost.$$('#quoteTabs').destroyTabs();

						var quoteModel = this.editorModel.quoteModel;

						var lineItemGroups = quoteModel.quoteVO.lineItemGroups;
						if (!quoteModel.grouped) {
							if (this.eventDetail.customAction.type === 'Solution Group') {
								this._extendSolutionGroupRecord(lineItemGroups[0].record);
							};
							this.set('editorModel.quoteModel.grouped', true);
							this.set('editorModel.quoteModel.quoteVO.lineItemGroups', quoteModel.quoteVO.lineItemGroups);
						} else {
							this.domHost.set('editorModel.quoteModel.grouped', false);

							this.domHost.rightSideButton = false;

							this.fire('iron-signal', { name: 'close-group-panel' });
							for (var i = 0; i < this.domHost.groupModels.length; i++) {
								this.domHost.set('groupModels.' + i + '.groupVO', {});
							}
						}
						this._updateQuote(quoteModel.quoteVO);
						if (this.domHost.viewport.isMobile()) {
							this.domHost.buildQuoteTabs();
						}
						this.domHost.quoteHasNoLines();
					}
				}, {
					key: '_handlePopupResponse',
					value: function _handlePopupResponse() {
						var lines = this.popupResponse.lines;
						switch (this.popupResponse.action) {
							case 'save':
								this.onSave();
								break;
							case 'quicksave':
								this.onQuickSave();
								break;
							case 'reload':
								location.reload();
								break;
							case 'none':
							default:
						}
					}
				}, {
					key: '_handlePopup',
					value: function _handlePopup(url, record) {
						var popup = this.$.popup;
						popup.url = url;
						popup.messenger = new QuoteMessenger(this.editorModel, record);
						popup.open();
					}
				}, {
					key: '_parseURL',
					value: function _parseURL(url, targetModel, quoteModel) {
						var parsedURL = url.replace(/{!(.*?)}/g, function (match, value) {
							var record = void 0;
							var splitValues = value.split('.');
							var objectName = splitValues[0];
							if (objectName == 'SBQQ__Quote__c' || objectName == 'SBQQ__Quote__r' || objectName == 'Quote__c' || objectName == 'Quote__r') {
								record = quoteModel.quoteVO.record;
								splitValues.shift();
							} else if (objectName == 'SBQQ__Group__c' || objectName == 'SBQQ__Group__r' || objectName == 'Group__c' || objectName == 'Group__r') {
								record = quoteModel.groupsByKey[this.model.parentGroupKey].groupVO.record;
								splitValues.shift();
							} else {
								record = targetModel.record;
							}

							for (var i = 0; i < splitValues.length; i++) {
								if (i == splitValues.length - 1) return record[splitValues[i]];else record = record[splitValues[i]];
							}
						}.bind(this));

						return parsedURL;
					}
				}, {
					key: '_navigateToURL',
					value: function _navigateToURL(url) {
						if (this._isLightningExperience()) sforce.one.navigateToURL(url);else window.location.href = url;
					}
				}, {
					key: '_isLightningExperience',
					value: function _isLightningExperience() {
						return typeof sforce != 'undefined' && sforce && !!sforce.one;
					}
				}, {
					key: 'onFlagCalculate',
					value: function onFlagCalculate(showSpinner, updateQuoteRequired) {
						this.domHost.errors = null;
						if (this._usesClientCalculator()) {
							this._jsqcCalculate(showSpinner).then(function (res) {
								if (updateQuoteRequired || res.updateQuoteRequired) {
									this.data.quote.calculationRequired = false;
									this._updateQuote(res.value);
									return;
								}

								if (this.data.quote.calculationRequired) {
									this.data.quote.calculationRequired = false;
									if (res.value.lineSortField && res.value.lineSortField != this.data.developerPrefix + 'Number__c') {
										res.value.lineItems = new SortLinesHandler(this.data.developerPrefix).sortLineItems(res.value.lineItems, res.value.lineSortField);
									}
									this.domHost._createEditorModel();
									return;
								}

								var sortRequired = res.value.lineSortField && res.value.lineSortField == this.editorModel.constants.NUMBER_FIELD;
								this.domHost.updateAfterJSQC(this.notifier, sortRequired);

								this.sortLines(res.value, true);
							}.bind(this), function (rej) {
								if (this.editorModel !== undefined) {
									this.domHost.error = rej;
									return;
								}

								this.$.alertModal.displayContinueButton = false;
								this.$.alertModal.cancelCB = function () {
									location.reload();
								}.bind(this);
								this.$.alertModal.alerts = [rej.message];
							}.bind(this));
						} else {
							this.$.calculateService.model = undefined;
							this.$.calculateService.background = showSpinner === false;
							this._executeServiceAction('calculateService');
						}
					}
				}, {
					key: 'onSave',
					value: function onSave() {
						this.showSpinner = true;
						this.$.saveService.background = true;
						this._save('saveService');
					}
				}, {
					key: 'onQuickSave',
					value: function onQuickSave() {
						this.$.quickSaveService.uid = this.editorModel.quoteModel.quoteVO.record.Id.substring(0, 15);
						this.showSpinner = true;
						this.$.quickSaveService.background = true;
						this._save('quickSaveService');
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.showSpinner = true;
						this.navigateToReturnUrl();
					}
				}, {
					key: 'onAddProducts',
					value: function onAddProducts() {
						this._navigateToLookup('product');
					}
				}, {
					key: 'onAddFavorites',
					value: function onAddFavorites() {
						this._navigateToLookup('favorite');
					}
				}, {
					key: 'onDeleteLines',
					value: function onDeleteLines() {
						this._executeServiceAction('onDeleteLine', { keys: this._retrieveKeysOfSelected() });
					}
				}, {
					key: 'onAddGroup',
					value: function onAddGroup(selectedSolutionGroup) {
						if (this.editorModel.quoteModel.grouped) {
							this._addGroup();
						} else {
							this._executeServiceAction('onAddGroup');
						}
					}
				}, {
					key: 'onResetDiscounts',
					value: function onResetDiscounts() {
						var groupKey = void 0,
						    constants = this.editorModel.constants;

						if (this.eventDetail.model.groupKey) {
							groupKey = this.eventDetail.model.groupKey;
							var group = this.editorModel.quoteModel.groupsByKey[groupKey];

							for (var i = 0, x = group.standardLines.length; i < x; i++) {
								var standardLineVO = group.standardLines[i].lineVO;
								standardLineVO.record[constants.ADDITIONAL_DISCOUNT_AMOUNT_FIELD] = null;
								standardLineVO.record[constants.ADDITIONAL_DISCOUNT_RATE_FIELD] = null;
							}

							for (var j = 0, y = group.dimensions.length; j < y; j++) {
								var dim = group.dimensions[j],
								    segmentedLines = group.segmentedLinesByDimension[dim];
								for (var k = 0, z = segmentedLines.length; k < z; k++) {
									var segmentedLine = segmentedLines[k];
									for (var l = 0, w = segmentedLine.segments.length; l < w; l++) {
										var segmentLineVO = segmentedLine.segments[l].lineVO;
										segmentLineVO.record[constants.ADDITIONAL_DISCOUNT_AMOUNT_FIELD] = null;
										segmentLineVO.record[constants.ADDITIONAL_DISCOUNT_RATE_FIELD] = null;
									}
								}
							}
						} else {
							var lineItems = this.editorModel.quoteModel.quoteVO.lineItems;
							for (var m = 0, len = lineItems.length; m < len; m++) {
								lineItems[m].record[constants.ADDITIONAL_DISCOUNT_AMOUNT_FIELD] = null;
								lineItems[m].record[constants.ADDITIONAL_DISCOUNT_RATE_FIELD] = null;
							}
						}
						this.fire('iron-signal', { name: 'reset-discount-clicked', data: { groupKey: groupKey } });
					}
				}, {
					key: 'updateLineOptional',
					value: function updateLineOptional() {
						var groupKey = void 0;
						if (this.eventDetail.model.groupKey) {
							groupKey = this.eventDetail.model.groupKey;
						}
						this.editorModel.quoteModel.allOptional = this.eventDetail.customAction.caClass === 'optionalAllBtn';
						this.editorModel.styleQuoteAndGroupActionButtons();
						this.notifyPath('editorModel.quoteModel.allOptional', this.editorModel.quoteModel.allOptional);
						this.fire('iron-signal', { name: 'toggle-optional-clicked', data: { toggleOptionalBoolean: this.editorModel.quoteModel.allOptional, groupKey: groupKey } });
					}
				}, {
					key: 'onUpgradeAssets',
					value: function onUpgradeAssets() {
						this._navigateToLookup('asset');
					}
				}, {
					key: 'onRenewSubscriptions',
					value: function onRenewSubscriptions() {
						this._navigateToLookup('subscription');
					}
				}, {
					key: 'onDeleteGroup',
					value: function onDeleteGroup() {
						if (confirm('All lines will also be deleted. Are you sure you want to delete this group?')) this._executeServiceAction('onDeleteGroup');
					}
				}, {
					key: 'onReconfigureLine',
					value: function onReconfigureLine() {
						Navigator.nav('#', { lineKey: this.eventDetail.model.lineVO.key,
							qId: this.editorModel.quoteModel.quoteVO.record.Id,
							ignoreCache: true }, ['product', 'pc'], false, this);
					}
				}, {
					key: 'onAddToFavorites',
					value: function onAddToFavorites() {
						this._openDialog('favDialog');
					}
				}, {
					key: 'onRemoveFromFavorites',
					value: function onRemoveFromFavorites() {
						if (this.eventDetail.customAction.location === "Line") {
							if (!confirm('Are you sure you want to remove the favorite?')) return;
						} else {
							if (!confirm('All lines will be removed from favorites. Are you sure you want to remove this group from favorites?')) return;
						}
						this._executeServiceAction('onRemoveFromFavorites');
					}
				}, {
					key: 'onCloneLine',
					value: function onCloneLine() {
						var _this = this;

						var originalLine = this.eventDetail.model;
						var clonedLines = [];
						var clonedSegmentedLines = { Year: { lines: [] }, Quarter: { lines: [] }, Month: { lines: [] }, Custom: { lines: [] } };
						var groupIndex = this.editorModel.quoteModel.indexByGroupKey[this.eventDetail.model.lineVO.parentGroupKey].index || 0;
						var groupModel = this.eventDetail.model.groupModel;
						var groupModels = this.domHost.groupModels;

						var _addParentAndAllChildLineItems = function _addParentAndAllChildLineItems(line, parentItemKey) {
							var clone = void 0;
							if (line.segmented) {
								clone = groupModels[groupIndex].cloneSegmentedLine(line, parentItemKey);
								clonedSegmentedLines[clone.dimensionType].lines.push(clone);
								clonedSegmentedLines[clone.dimensionType].key = line.lineVO.key;
							} else {
								clone = groupModels[groupIndex].cloneLine(line, parentItemKey);
								clonedLines.push(clone);
							}
							groupModels[groupIndex].addToLinesByParentItemKey(clone);
							if (line.bundle) {
								if (groupModels[groupIndex].quoteModel.linesByParentItemKey[line.lineVO.key]) {
									var components = groupModels[groupIndex].quoteModel.linesByParentItemKey[line.lineVO.key];
									for (var i = 0, l = components.length; i < l; i++) {
										_addParentAndAllChildLineItems(components[i], clone.lineVO.key);
									}
								}
							}
						};

						var _addClonedLines = function _addClonedLines() {
							if (clonedLines.length > 0) {
								var idx = void 0;
								var i = void 0,
								    len = groupModels[groupIndex].standardLines.length;
								for (i = 0; i < len; i++) {
									if (originalLine.lineVO.key === groupModels[groupIndex].standardLines[i].lineVO.key) {
										idx = i + 1;
										break;
									}
								}

								if (originalLine.bundle) {
									if (!_this.editorModel.data.settings.bundleKeptTogether) {
										idx = len;
									} else {
										for (var j = i; j < len; j++) {
											if (!groupModels[groupIndex].standardLines[j].component && groupModels[groupIndex].standardLines[j].lineVO.key !== originalLine.lineVO.key) {
												idx = j;
												break;
											} else {
												idx = len;
											}
										}
									}
								}

								for (var k = 0, l = clonedLines.length; k < l; k++) {
									var clonedLine = clonedLines[k];
									_this.domHost.splice('groupModels.' + groupIndex + '.standardLines', idx, 0, clonedLine);

									groupModels[groupIndex].quoteModel.quoteVO.lineItems.push(clonedLine.lineVO);
									_this.editorModel.quoteModel.lineModelsByKey[clonedLine.lineVO.key] = clonedLine;
									idx++;
								}
							}
						};

						var _addClonedSegmentedLines = function _addClonedSegmentedLines() {
							for (var dimension in clonedSegmentedLines) {
								if (!(clonedSegmentedLines[dimension].lines.length > 0)) {
									continue;
								}

								var idx = 0;
								var segmentedLinesToSplice = clonedSegmentedLines[dimension].lines;
								var segmentedLines = groupModels[groupIndex].segmentedLinesByDimension[dimension];
								var lastSegmentedLineKey = clonedSegmentedLines[dimension].key;
								for (var i = 0, l = segmentedLines.length; i < l; i++) {
									if (segmentedLines[i].lineVO.key === lastSegmentedLineKey) {
										idx = i + 1;
										break;
									}
								}

								for (var j = 0, _l = segmentedLinesToSplice.length; j < _l; j++) {
									var segmentedLineModelToSplice = segmentedLinesToSplice[j];
									_this.domHost.splice('groupModels.' + groupIndex + '.segmentedLinesByDimension.' + dimension, idx + j, 0, segmentedLineModelToSplice);

									_this.domHost.push('groupModels.' + groupIndex + '.segmentedLines', segmentedLineModelToSplice);

									for (var k = 0; k < segmentedLineModelToSplice.segments.length; k++) {
										groupModels[groupIndex].quoteModel.quoteVO.lineItems.push(segmentedLineModelToSplice.segments[k].lineVO);
										_this.editorModel.quoteModel.lineModelsByKey[segmentedLineModelToSplice.segments[k].lineVO.key] = segmentedLineModelToSplice.segments[k];
									}
								}
							}
						};

						_addParentAndAllChildLineItems(originalLine);
						_addClonedLines();
						_addClonedSegmentedLines();
						this.domHost.renumber();

						this.editorModel.quoteModel.renumberIndexes(true);
					}
				}, {
					key: '_usesClientCalculator',
					value: function _usesClientCalculator() {
						return this.data.settings.usesClientCalculator;
					}
				}, {
					key: '_jsqcCalculate',
					value: function _jsqcCalculate(showSpinner) {
						this.showSpinner = showSpinner || showSpinner == null ? true : this.showSpinner;
						return new Promise(function (resolve, reject) {
							if (SB && SB.JSQC) {
								var res = {};
								var settings = this.data.settings;
								var oauthClient = new OAuthClient(this.app.org.prefix);
								this.notifier = !this.data.quote.calculationRequired && this.domHost.editorModel ? new JSQCNotifier(this.domHost) : null;
								settings.displayedLookupMap = this.getDisplayedLookupNames(this.data);
								var mdqHelper = this.editorModel ? new MDQSegmentHelper(this.data, this.editorModel.quoteModel.groupsByKey) : new MDQSegmentHelper(this.data, null);
								var segmentsChanged = mdqHelper.updateSegments();
								if (segmentsChanged && !this.data.quote.calculationRequired) {
									res.updateQuoteRequired = true;
									this.notifier = null;
								}
								var qc = new SB.JSQC(settings, this.data.quote, this.notifier);

								var connectionPromiseArray = [oauthClient.getConnection(), oauthClient.getConnection()];
								Promise.all(connectionPromiseArray).then(function (connections) {
									qc.setConnection(connections[0]);
									qc.setCustomerOnlyConnection(connections[1]);
									var promise = qc.onCalc();
									promise.then(function (successQuote) {
										this.showSpinner = showSpinner || showSpinner == null ? false : this.showSpinner;
										res.value = successQuote;
										resolve(res);
									}.bind(this), function (err) {
										this.showSpinner = showSpinner || showSpinner == null ? false : this.showSpinner;
										reject({ message: err.message || err });
									}.bind(this));
								}.bind(this), function (err) {
									reject({ message: err.message || err });
								}.bind(this));
							} else {
								reject({ message: "ERROR: Could not find the Client-Side Calculator" });
							}
						}.bind(this));
					}
				}, {
					key: 'getDisplayedLookupNames',
					value: function getDisplayedLookupNames(data) {
						var results = { 'line': [], 'group': [], 'quote': [] };

						var lineFields = data.settings.lineLookups ? Object.keys(data.settings.lineLookups) : [];
						var groupFields = data.settings.groupLookups ? Object.keys(data.settings.groupLookups) : [];
						var quoteFields = data.settings.quoteLookups ? Object.keys(data.settings.quoteLookups) : [];

						lineFields.forEach(function (field) {
							results.line.push(RelationshipFieldManager.getRelationshipField(field));
						});

						groupFields.forEach(function (field) {
							results.group.push(RelationshipFieldManager.getRelationshipField(field));
						});

						quoteFields.forEach(function (field) {
							results.quote.push(RelationshipFieldManager.getRelationshipField(field));
						});

						return results;
					}
				}, {
					key: '_onJobChecker',
					value: function _onJobChecker(job) {
						job.jobType = 'QuoteCalculator';
						this.$.jobchecker.useSpinner = !this.$.calculateService.background;
						this.$.jobchecker.data = job;
					}
				}, {
					key: '_jobCompleted',
					value: function _jobCompleted() {
						if (this.$.jobchecker.result.payload != null) {
							var quote = JSON.parse(this.$.jobchecker.result.payload);
							quote.backgroundCalculatePending = false;
							if (this.saveServiceAfterBackgroundCalc) {
								this.editorModel.createQuoteModel(quote);
								this._executeServiceAction(this.saveServiceAfterBackgroundCalc);
								this.saveServiceAfterBackgroundCalc = null;
								return;
							}
							this.domHost.updateQuote(quote);
						}
					}
				}, {
					key: '_save',
					value: function _save(saveService) {
						if (this.editorModel.data.settings.usesClientCalculator) {
							this._jsqcCalculate(false).then(function (res) {
								this._executeServiceAction(saveService);
							}.bind(this), function (rej) {
								this.domHost.error = rej;
							}.bind(this));
						} else {
							if (this.editorModel.data.settings.usesBackgroundCalculator) {
								this.saveServiceAfterBackgroundCalc = saveService;
								this.onFlagCalculate(false);
							} else {
								this._executeServiceAction(saveService);
							}
						}
					}
				}, {
					key: '_navigateToLookup',
					value: function _navigateToLookup(lookupName) {
						this.domHost.errors = null;
						var queryParams = {
							qId: this.editorModel.quoteModel.quoteVO.record.Id,
							aId: this.eventDetail.customAction.customActionId
						};
						if (this.eventDetail.model && this.eventDetail.model.groupKey) queryParams.groupKey = this.eventDetail.model.groupKey;

						Navigator.nav('#', queryParams, [lookupName, 'lookup'], false, this);
					}
				}, {
					key: '_retrieveKeysOfSelected',
					value: function _retrieveKeysOfSelected() {
						var keys = [];
						var groupModels = this.editorModel.quoteModel.lineGroups;
						for (var i = 0, gmLength = groupModels.length; i < gmLength; i++) {
							var standardLines = groupModels[i].standardLines;
							for (var j = 0, standardLinesLength = standardLines.length; j < standardLinesLength; j++) {
								if (standardLines[j].selected && !standardLines[j].component) keys.push(standardLines[j].lineVO.key);
							}
							var segmentedLines = groupModels[i].segmentedLines;
							for (var _j = 0, segmentedLinesLength = segmentedLines.length; _j < segmentedLinesLength; _j++) {
								if (segmentedLines[_j].selected && !segmentedLines[_j].component) {
									var segments = segmentedLines[_j].segments;
									for (var k = 0, segmentsLength = segments.length; k < segmentsLength; k++) {
										keys.push(segments[k].lineVO.key);
									}
								}
							}
						}
						return keys;
					}
				}, {
					key: '_addGroup',
					value: function _addGroup() {
						var constants = this.editorModel.constants;
						var quoteModel = this.editorModel.quoteModel;
						var groupRecord = { Name: 'Group' + (quoteModel.lineGroups.length + 1) };

						groupRecord[constants.QUOTE_PROCESS_FIELD] = this.editorModel.data.defaultQuoteProcessId;
						groupRecord[constants.ACCOUNT_FIELD] = quoteModel.quoteVO.record[constants.ACCOUNT_FIELD];

						if (this.eventDetail.customAction.type === 'Solution Group') {
							this._extendSolutionGroupRecord(groupRecord);
						}

						var groupVO = { key: ++quoteModel.quoteVO.nextKey, record: groupRecord, multiSegmentColumns: {}, localizedMultiSegmentColumns: {} };
						var group = new GroupModel(groupVO, quoteModel);

						quoteModel.quoteVO.lineItemGroups.push(groupVO);
						quoteModel.groupsByKey[group.groupVO.key] = group;
						var indexByGroupKey = quoteModel.indexByGroupKey;
						indexByGroupKey[group.groupVO.key] = { index: Object.keys(indexByGroupKey).length, indexByLineKey: {}, indexBySegmentKey: {} };

						this.domHost.push('groupModels', group);
						for (var i = 0; i < quoteModel.quoteVO.lineItemGroups.length; i++) {
							quoteModel.quoteVO.lineItemGroups[i].record[constants.NUMBER_FIELD] = i + 1;
						}
						this.domHost.rightSideButton = quoteModel.lineGroups.length > 1 && this.editorModel.quoteModel.grouped;
						this.domHost.notifyPath('editorModel.quoteModel.lineGroups.length', this.editorModel.quoteModel.lineGroups.length);

						if (quoteModel.lineGroups.length == 2) {
							this.fire('iron-signal', { name: 'group-panel-created' });
						}

						this.domHost.quoteHasNoLines();
					}
				}, {
					key: '_extendSolutionGroupRecord',
					value: function _extendSolutionGroupRecord(groupRecord) {
						groupRecord.Name = this.eventDetail.customAction.record.Name;
						groupRecord[this.editorModel.constants.DESCRIPTION_FIELD] = this.eventDetail.customAction.record[this.editorModel.constants.DESCRIPTION_FIELD];
					}
				}, {
					key: '_openDialog',
					value: function _openDialog(dialogName) {
						var favDialog = this.$[dialogName];
						if (this.eventDetail.customAction.location === "Line") {
							favDialog.favoritedLine = this.eventDetail.model.serviceModel.keys;
						} else {
							var groupLines = [].concat(this.eventDetail.model.standardLines).concat(this.eventDetail.model.segmentedLines);
							if (groupLines.length == 0) {
								this.domHost.errors = ['Please select a group with one or more lines to favorite.'];
								return;
							} else {
								favDialog.favoritedGroup = this.eventDetail.model.groupKey;
								favDialog.groupLines = groupLines;
							}
						}
						favDialog.$.dialog.toggle();
					}
				}, {
					key: 'sortLines',
					value: function sortLines(quote, notify) {
						var lineSortField = quote.lineSortField;
						if (!quote.lineSortField || lineSortField == this.editorModel.constants.NUMBER_FIELD) {
							return;
						}
						this.fire('iron-signal', { name: 'sort-lines-required', data: { lineSortField: lineSortField, notify: notify } });
					}
				}, {
					key: '_clearDirtyFields',
					value: function _clearDirtyFields() {
						if (PageContainer.getViewport().isDesktop()) this.fire('iron-signal', { name: 'sb-quote-quick-save' });
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'sb-favorite-saved': '_saveFavorite',
							'job-completed': '_jobCompleted'
						};
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_executeCustomAction(eventDetail)', '_handleCalculateResponse(calculateResponse)', '_checkForGuidedMessages(saverResponse)', '_reloadEditor(quoteEditorModelResponse)', '_clearDirtyFields(quoteEditorModelResponse)', '_updateQuote(quoteVOResponse)', '_handleToggleGroupResponse(toggleGroupResponse)', '_handlePopupResponse(popupResponse)'];
					}
				}, {
					key: 'prefix',
					get: function get() {
						if (this.app === undefined) return;

						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}]);

				return LECustomActionServices;
			}());

			_export('LECustomActionServices', LECustomActionServices);

			Polymer(LECustomActionServices);
		}
	};
});

'use strict';

System.register('quotes/sb-line-sort/QuoteLineSort.js', ['../layout/sb-le-table-cell/Localizer.js'], function (_export, _context) {
    var Localizer, sortByField, lookupNameField, developerPrefix, constants;

    function depthFirstTraversal(tree, id, byOrder, callback) {
        var children = tree[id];
        if (!children) return;

        if (byOrder === '') {
            children.sort(sortLinesAscByKey.bind(this));
        } else if (byOrder === 'asc') {
            children.sort(sortLinesAscByField.bind(this));
        } else if (byOrder === 'desc') {
            children.sort(sortLinesDescByField.bind(this));
        }

        for (var i = 0; i < children.length; i++) {
            callback(children[i]);
            depthFirstTraversal(tree, children[i].lineVO.key, byOrder, callback);
        }
    }

    function makeLineItemsTree(arr) {
        var tree = {};
        for (var i = 0; i < arr.length; i++) {
            if (arr[i].lineVO.parentItemKey == null) {
                arr[i].lineVO.parentItemKey = 0;
            }

            if (!tree[arr[i].lineVO.parentItemKey]) {
                tree[arr[i].lineVO.parentItemKey] = [];
            }
            tree[arr[i].lineVO.parentItemKey].push(arr[i]);
        }
        return tree;
    }

    function sortLinesAscByKey(a, b) {
        return a.lineVO.key - b.lineVO.key;
    }

    function sortLinesAscByField(a, b) {
        var A = lookupNameField && a.lineVO.record[sortByField] ? a.lineVO.record[sortByField][lookupNameField] : a.lineVO.record[sortByField];
        var B = lookupNameField && b.lineVO.record[sortByField] ? b.lineVO.record[sortByField][lookupNameField] : b.lineVO.record[sortByField];
        var isABundled = void 0;
        var isBBundled = void 0;
        if (sortByField === constants.LIST_PRICE_FIELD) {
            isABundled = a.lineVO.record[constants.BUNDLED_FIELD];
            isBBundled = b.lineVO.record[constants.BUNDLED_FIELD];
        } else if (a.groupModel.quoteVO.localizationByFieldByProductId && Object.keys(a.groupModel.quoteVO.localizationByFieldByProductId).length > 0) {
            var aLocalizedValue = Localizer.getLocalizedValue(a, sortByField, lookupNameField);
            var bLocalizedValue = Localizer.getLocalizedValue(b, sortByField, lookupNameField);
            A = aLocalizedValue || A;
            B = bLocalizedValue || B;
        }
        A = updateFieldFormat(A, isABundled);
        B = updateFieldFormat(B, isBBundled);
        if (A == B) {
            return 0;
        } else if (A < B) {
            return -1;
        } else if (A > B) {
            return 1;
        } else if (A == null) {
            return -1;
        } else if (B == null) {
            return 1;
        } else {
            return 0;
        }
    }

    function sortLinesDescByField(a, b) {
        var A = lookupNameField && a.lineVO.record[sortByField] ? a.lineVO.record[sortByField][lookupNameField] : a.lineVO.record[sortByField];
        var B = lookupNameField && b.lineVO.record[sortByField] ? b.lineVO.record[sortByField][lookupNameField] : b.lineVO.record[sortByField];
        var isABundled = void 0;
        var isBBundled = void 0;
        if (sortByField === constants.LIST_PRICE_FIELD) {
            isABundled = a.lineVO.record[constants.BUNDLED_FIELD];
            isBBundled = b.lineVO.record[constants.BUNDLED_FIELD];
        } else if (a.groupModel.quoteVO.localizationByFieldByProductId && Object.keys(a.groupModel.quoteVO.localizationByFieldByProductId).length > 0) {
            var aLocalizedValue = Localizer.getLocalizedValue(a, sortByField, lookupNameField);
            var bLocalizedValue = Localizer.getLocalizedValue(b, sortByField, lookupNameField);
            A = aLocalizedValue || A;
            B = bLocalizedValue || B;
        }
        A = updateFieldFormat(A, isABundled);
        B = updateFieldFormat(B, isBBundled);
        if (A == B) {
            return 0;
        } else if (A > B) {
            return -1;
        } else if (A < B) {
            return 1;
        } else if (A == null) {
            return 1;
        } else if (B == null) {
            return -1;
        } else {
            return 0;
        }
    }

    function reorderLineNumbers(lowestVisibleNumber, lowestInvisibleNumber, array) {
        if (array.length > 0) {
            var indexByGroupKey = array[0].groupModel.quoteModel.indexByGroupKey;
            var groupKey = array[0].lineVO.parentGroupKey;
        }
        for (var i = 0; i < array.length; i++) {
            var lineKey = array[i].lineVO.key;
            if (array[i].lineVO.record[constants.SEGMENT_KEY_FIELD]) {
                indexByGroupKey[groupKey].indexBySegmentKey[array[i].lineVO.record[constants.SEGMENT_KEY_FIELD]] = i;
            } else {
                indexByGroupKey[groupKey].indexByLineKey[lineKey] = i;
            }
            if (array[i].visible) {
                array[i].lineVO.record[constants.NUMBER_FIELD] = lowestVisibleNumber;
                lowestVisibleNumber++;
            } else {
                array[i].lineVO.record[constants.NUMBER_FIELD] = lowestInvisibleNumber;
                lowestInvisibleNumber++;
            }
        }
        return array;
    }

    function updateFieldFormat(field, isBundled) {
        if (isBundled) {
            field = 0;
        }
        if (typeof field === 'string') {
            field.toUpperCase();
        } else if (typeof field === 'undefined') {
            field = null;
        }
        return field;
    }

    function getStartingNumbers(arr) {
        var lowestVisibleNumber = void 0;
        var lowestInvisibleNumber = void 0;
        arr.forEach(function (line) {
            var lineNumber = line.lineVO.record[constants.NUMBER_FIELD];

            if (line.visible) {
                lowestVisibleNumber = !lowestVisibleNumber || lineNumber < lowestVisibleNumber ? lineNumber : lowestVisibleNumber;
            } else {
                lowestInvisibleNumber = !lowestInvisibleNumber || lineNumber < lowestInvisibleNumber ? lineNumber : lowestInvisibleNumber;
            }
        }.bind(this));
        return { lowestVisibleNumber: lowestVisibleNumber, lowestInvisibleNumber: lowestInvisibleNumber };
    }

    return {
        setters: [function (_layoutSbLeTableCellLocalizerJs) {
            Localizer = _layoutSbLeTableCellLocalizerJs.Localizer;
        }],
        execute: function () {
            sortByField = void 0;
            lookupNameField = void 0;
            developerPrefix = void 0;
            constants = void 0;
            function depthFirstLineItemsTreeSort(arr, field, byOrder, keepBundle, nameField) {
                var i = 0;
                constants = arr[0].editorModel.constants;
                var bundleKeptTogether = keepBundle;
                sortByField = arr[0].segmented && !arr[0].lineVO.record[field] ? constants.NET_TOTAL_FIELD : field;
                lookupNameField = nameField;
                var startingNumbers = getStartingNumbers(arr);

                if (bundleKeptTogether) {
                    var tree = makeLineItemsTree(arr);
                    depthFirstTraversal(tree, 0, byOrder, function (node) {
                        arr[i++] = node;
                    });
                } else {
                    if (byOrder === 'asc') {
                        arr.sort(sortLinesAscByField.bind(this));
                    } else if (byOrder === 'desc') {
                        arr.sort(sortLinesDescByField.bind(this));
                    } else if (byOrder === '') {
                        arr.sort(sortLinesAscByKey.bind(this));
                    }
                }

                arr = reorderLineNumbers(startingNumbers.lowestVisibleNumber, startingNumbers.lowestInvisibleNumber, arr);

                return arr;
            }

            _export('depthFirstLineItemsTreeSort', depthFirstLineItemsTreeSort);
        }
    };
});

'use strict';

System.register('common/calculate/asset-upgrade-quantity-calculator/AssetUpgradeQuantityCalculator.js', [], function (_export, _context) {
    var _createClass, AssetUpgradeQuantityCalculator;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export('AssetUpgradeQuantityCalculator', AssetUpgradeQuantityCalculator = function () {
                function AssetUpgradeQuantityCalculator(upgradeHandler) {
                    _classCallCheck(this, AssetUpgradeQuantityCalculator);

                    this.upgradeHandler = upgradeHandler;
                }

                _createClass(AssetUpgradeQuantityCalculator, [{
                    key: 'setQuantitiesByRatio',
                    value: function setQuantitiesByRatio() {
                        var source = void 0;
                        var upgrade = void 0;
                        var isSourceLine = this.upgradeHandler.isSourceLine();

                        if (isSourceLine) {
                            source = this.upgradeHandler.getLine();
                            upgrade = this._getUpgrade(source, null);
                        } else {
                            upgrade = this.upgradeHandler.getLine();
                            source = this._getSource(null, upgrade);
                        }

                        if (!source || !upgrade) {
                            return;
                        }

                        this.upgradeHandler.setSourceAndUpgrade(source, upgrade);
                        this._setAutomaticQuantity(source, upgrade, isSourceLine);
                    }
                }, {
                    key: '_getSource',
                    value: function _getSource(source, upgrade) {
                        return this.upgradeHandler.getSourceOrUpgrade(source, upgrade);
                    }
                }, {
                    key: '_getUpgrade',
                    value: function _getUpgrade(source, upgrade) {
                        return this.upgradeHandler.getSourceOrUpgrade(source, upgrade);
                    }
                }, {
                    key: '_setAutomaticQuantity',
                    value: function _setAutomaticQuantity(source, upgrade, didUserChangeSourceQuantity) {
                        var upgradeRatio = this._getUpgradeRatio(source, upgrade, this.upgradeHandler.getSourceIdField(), this.upgradeHandler.getUpgradeConversionRateField());

                        if (upgradeRatio == null) {
                            return;
                        }

                        var sourceCurrentQty = this.upgradeHandler.getSourceCurrentQuantityField(source);
                        var upgradeCurrentQty = this.upgradeHandler.getUpgradeCurrentQuantityField(upgrade);
                        var sourceRate = upgradeRatio.split(':')[0];
                        var upgradeRate = upgradeRatio.split(':')[1];
                        var sourceQtyAfterUpdate = sourceCurrentQty;
                        var upgradeQtyAfterUpdate = upgradeCurrentQty;
                        var sourcePriorQty = this.upgradeHandler.getSourcePriorQuantity(source);

                        if (sourceCurrentQty < 0) {
                            source.invalidQuantity = sourceCurrentQty;
                            source.validQuantity = 0;
                        } else if (upgradeCurrentQty < 0) {
                            upgrade.invalidQuantity = upgradeCurrentQty;
                            upgrade.validQuantity = 0;
                        }

                        if (this.upgradeHandler.didSourceQuantityChange(didUserChangeSourceQuantity, source, upgrade)) {
                            upgradeQtyAfterUpdate = (sourcePriorQty - sourceCurrentQty) * (upgradeRate / sourceRate);
                        } else if (this.upgradeHandler.didUpgradeQuantityChange(didUserChangeSourceQuantity, source)) {
                            sourceQtyAfterUpdate = sourcePriorQty - upgradeCurrentQty * (sourceRate / upgradeRate);
                        }

                        if (sourceQtyAfterUpdate < 0) {
                            sourceQtyAfterUpdate = 0;
                            if (this.upgradeHandler.isSelected(upgrade)) {
                                upgradeQtyAfterUpdate = sourcePriorQty * (upgradeRate / sourceRate);
                                if (upgradeCurrentQty > upgradeQtyAfterUpdate) {
                                    upgrade.invalidQuantity = upgradeCurrentQty;
                                    upgrade.validQuantity = upgradeQtyAfterUpdate;
                                }
                            }
                        } else if (upgradeQtyAfterUpdate < 0) {
                            upgradeQtyAfterUpdate = 0;
                            if (this.upgradeHandler.isSelected(source)) {
                                sourceQtyAfterUpdate = sourcePriorQty;
                                if (sourceCurrentQty > sourceQtyAfterUpdate) {
                                    source.invalidQuantity = sourceCurrentQty;
                                    source.validQuantity = sourceQtyAfterUpdate;
                                }
                            }
                        }

                        this.upgradeHandler.setUpdatedQuantity(source, upgrade, sourceQtyAfterUpdate, upgradeQtyAfterUpdate);
                    }
                }, {
                    key: '_getUpgradeRatio',
                    value: function _getUpgradeRatio(source, upgrade, sourceIdField, upgradeConversionRateField) {
                        for (var sourceId in upgrade.upgradeSourcesBySourceProductId) {
                            if (sourceId === source.record[sourceIdField]) {
                                return upgrade.upgradeSourcesBySourceProductId[sourceId][upgradeConversionRateField];
                            }
                        }
                    }
                }]);

                return AssetUpgradeQuantityCalculator;
            }());

            _export('AssetUpgradeQuantityCalculator', AssetUpgradeQuantityCalculator);
        }
    };
});

'use strict';

System.register('common/data/cache/Cache.js', [], function (_export, _context) {
	var _createClass, map, Cache;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			map = {};

			_export('Cache', Cache = function () {
				function Cache() {
					_classCallCheck(this, Cache);
				}

				_createClass(Cache, null, [{
					key: 'add',
					value: function add(name, id, object, type, emitter) {
						if (!name || !id || !object) return;

						if (!type) type = 'value';

						if (!map[type]) map[type] = {};

						if (!map[type][name]) {
							map[type][name] = {};
							if (emitter && type == 'value' && name == 'LineEditor') {
								var event = document.createEvent('Event');
								event.initEvent(name + '-cached', true, true);
								document.dispatchEvent(event);
							}
						}

						map[type][name][id] = object;
					}
				}, {
					key: 'get',
					value: function get(name, id, type) {
						if (!name || !id) return null;

						if (!type) type = 'value';

						if (!map[type]) return null;

						if (!map[type][name]) return null;

						return map[type][name][id];
					}
				}, {
					key: 'remove',
					value: function remove(name, id, type) {
						if (!name || !id || !type) return null;

						if (!type) type = 'value';

						if (!map[type]) return;
						if (!map[type][name]) return;

						delete map[type][name][id];
					}
				}]);

				return Cache;
			}());

			_export('Cache', Cache);
		}
	};
});

'use strict';

System.register('common/data/client/OAuthClient.js', ['common/oauth/OAuth.js', 'common/data/client/RemoteOAuth.js'], function (_export, _context) {
	var OAuth, RemoteOAuth, _createClass, OAuthClient;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonOauthOAuthJs) {
			OAuth = _commonOauthOAuthJs.OAuth;
		}, function (_commonDataClientRemoteOAuthJs) {
			RemoteOAuth = _commonDataClientRemoteOAuthJs.RemoteOAuth;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OAuthClient', OAuthClient = function () {
				function OAuthClient(prefix) {
					_classCallCheck(this, OAuthClient);

					this.prefix = prefix;
				}

				_createClass(OAuthClient, [{
					key: 'getConnection',
					value: function getConnection() {
						if (typeof Visualforce !== 'undefined') {
							return new Promise(function (resolve, reject) {
								resolve(new RemoteOAuth(this.prefix).getConnection());
							}.bind(this));
						} else {
							return new OAuth().getConnection();
						}
					}
				}]);

				return OAuthClient;
			}());

			_export('OAuthClient', OAuthClient);
		}
	};
});

'use strict';

System.register('common/data/client/RemoteClient.js', ['common/data/client/RemoteOAuth.js', 'common/data/client/RemoteSession.js', 'common/data/client/RestClient.js'], function (_export, _context) {
	var RemoteOAuth, RemoteSession, RestClient, _createClass, RemoteClient;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataClientRemoteOAuthJs) {
			RemoteOAuth = _commonDataClientRemoteOAuthJs.RemoteOAuth;
		}, function (_commonDataClientRemoteSessionJs) {
			RemoteSession = _commonDataClientRemoteSessionJs.RemoteSession;
		}, function (_commonDataClientRestClientJs) {
			RestClient = _commonDataClientRestClientJs.RestClient;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RemoteClient', RemoteClient = function () {
				function RemoteClient() {
					_classCallCheck(this, RemoteClient);

					this.VF_MAX_INPUT = 1000000 * 1000;
					this._restClient = new RestClient(this._getConnection());
				}

				_createClass(RemoteClient, [{
					key: 'read',
					value: function read(prefix, reader, uid) {
						this.prefix = prefix;
						return this._remote('read', reader, uid);
					}
				}, {
					key: 'load',
					value: function load(prefix, loader, uid, context) {
						this.prefix = prefix;
						var contextString = JSON.stringify(context);
						var uidLen = uid ? uid.length : 0;
						if (contextString.length + uidLen < this.VF_MAX_INPUT) {
							return this._remote('load', loader, uid, contextString);
						} else {
							return this._restClient.load(prefix, loader, uid, context);
						}
					}
				}, {
					key: 'save',
					value: function save(prefix, saver, model) {
						this.prefix = prefix;
						var modelString = typeof model === 'string' ? model : JSON.stringify(model);
						if (modelString.length + saver.length < this.VF_MAX_INPUT) {
							return this._remote('save', saver, modelString);
						} else {
							return this._restClient.save(prefix, saver, model);
						}
					}
				}, {
					key: 'md',
					value: function md(prefix, type, fullNames) {
						return new RemoteOAuth(prefix).getConnection().then(function (conn) {
							return conn.metadata.read(type, fullNames);
						});
					}
				}, {
					key: 'describe',
					value: function describe(sObject) {
						return new RemoteSession(window.sb.vfSessionId).getConnection().describe(sObject);
					}
				}, {
					key: 'query',
					value: function query(soql, version) {
						return new RemoteSession(window.sb.vfSessionId, version).getConnection().query(soql);
					}
				}, {
					key: '_remote',
					value: function _remote(method, provider, input, context) {
						var action = this._getAction() + '.' + method;
						if (context) return new Promise(function (resolve, reject) {
							Visualforce.remoting.Manager.invokeAction(action, provider, input, context, function (obj, event) {
								this._callback(obj, event, resolve, reject);
							}.bind(this), { escape: false });
						}.bind(this));

						return new Promise(function (resolve, reject) {
							Visualforce.remoting.Manager.invokeAction(action, provider, input, function (obj, event) {
								this._callback(obj, event, resolve, reject);
							}.bind(this), { escape: false });
						}.bind(this));
					}
				}, {
					key: '_getConnection',
					value: function _getConnection() {
						if (!this.connection) {
							this.connection = new RemoteSession(window.sb.vfSessionId).getConnection();
						}
						return this.connection;
					}
				}, {
					key: '_getAction',
					value: function _getAction() {
						return this._getPrefix() + 'ServiceRouter';
					}
				}, {
					key: '_getPrefix',
					value: function _getPrefix() {
						return this.prefix ? this.prefix + '.' : '';
					}
				}, {
					key: '_callback',
					value: function _callback(obj, event, resolve, reject) {
						if (!event.status) reject(event.message);else resolve(this._parse(obj));
					}
				}, {
					key: '_parse',
					value: function _parse(obj) {
						try {
							return JSON.parse(obj);
						} catch (e) {
							return obj;
						}
					}
				}]);

				return RemoteClient;
			}());

			_export('RemoteClient', RemoteClient);
		}
	};
});

'use strict';

System.register('common/data/client/RemoteOAuth.js', [], function (_export, _context) {
    var _createClass, RemoteOAuth;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export('RemoteOAuth', RemoteOAuth = function () {
                function RemoteOAuth(prefix) {
                    _classCallCheck(this, RemoteOAuth);

                    this.refreshTokenRemoteAction = 'OAuthExtension.refreshAccessToken';
                    this.getTokenRemoteAction = 'OAuthExtension.getAccessToken';
                    if (prefix) {
                        this.refreshTokenRemoteAction = prefix + '.' + this.refreshTokenRemoteAction;
                        this.getTokenRemoteAction = prefix + '.' + this.getTokenRemoteAction;
                    }

                    jsforce.OAuth2.prototype.refreshToken = function (refreshToken, callback) {
                        Visualforce.remoting.Manager.invokeAction(this.refreshTokenRemoteAction, function (accessToken, event) {
                            this.cacheToken(accessToken);
                            callback(!accessToken ? { message: event.message } : false, { access_token: accessToken, id: '' });
                        }.bind(this));
                    }.bind(this);
                }

                _createClass(RemoteOAuth, [{
                    key: 'getConnection',
                    value: function getConnection() {
                        return this.accessToken.then(function (token) {
                            return new jsforce.Connection({
                                oauth2: new jsforce.OAuth2({ clientId: true, clientSecret: true }),
                                accessToken: token,
                                refreshToken: '',
                                instanceUrl: sb.common.core.AppContext.org.orgUrl
                            });
                        });
                    }
                }, {
                    key: 'getCachedToken',
                    value: function getCachedToken() {
                        if (typeof sessionStorage === 'undefined') return '';

                        return sessionStorage.getItem(this.refreshTokenRemoteAction);
                    }
                }, {
                    key: 'cacheToken',
                    value: function cacheToken(accessToken) {
                        if (typeof sessionStorage === 'undefined') return;

                        sessionStorage.setItem(this.refreshTokenRemoteAction, accessToken);
                    }
                }, {
                    key: 'getAccessTokenBypassingCache',
                    value: function getAccessTokenBypassingCache() {
                        var self = this;
                        return new Promise(function (resolve, reject) {
                            Visualforce.remoting.Manager.invokeAction(self.getTokenRemoteAction, function (accessToken, event) {
                                if (accessToken) {
                                    resolve(accessToken);
                                } else {
                                    reject(event ? event.message : 'Could not get access token');
                                }
                            });
                        });
                    }
                }, {
                    key: 'accessToken',
                    get: function get() {
                        var accessToken = this.getCachedToken();
                        var self = this;
                        if (accessToken) {
                            return Promise.resolve(accessToken);
                        } else {
                            return new Promise(function (resolve, reject) {
                                Visualforce.remoting.Manager.invokeAction(self.getTokenRemoteAction, function (accessToken, event) {
                                    if (accessToken) {
                                        self.cacheToken(accessToken);
                                        resolve(accessToken);
                                    } else {
                                        reject(event ? event.message : 'Could not get access token');
                                    }
                                });
                            });
                        }
                    }
                }]);

                return RemoteOAuth;
            }());

            _export('RemoteOAuth', RemoteOAuth);
        }
    };
});

'use strict';

System.register('common/data/client/RemoteSession.js', [], function (_export, _context) {
	var _createClass, RemoteSession;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RemoteSession', RemoteSession = function () {
				function RemoteSession(sessionId, version) {
					_classCallCheck(this, RemoteSession);

					this.sessionId = sessionId;
					this.version = version || '36.0';
				}

				_createClass(RemoteSession, [{
					key: 'getConnection',
					value: function getConnection() {
						return new jsforce.Connection({
							sessionId: this.sessionId,
							version: this.version,
							instanceUrl: sb.common.core.AppContext.org.orgUrl
						});
					}
				}]);

				return RemoteSession;
			}());

			_export('RemoteSession', RemoteSession);
		}
	};
});

'use strict';

System.register('common/data/client/RestClient.js', ['common/oauth/OAuth.js'], function (_export, _context) {
	var OAuth, _createClass, RestClient;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonOauthOAuthJs) {
			OAuth = _commonOauthOAuthJs.OAuth;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RestClient', RestClient = function () {
				function RestClient(conn) {
					_classCallCheck(this, RestClient);

					if (conn) {
						this.connection = conn;
					}
				}

				_createClass(RestClient, [{
					key: 'read',
					value: function read(prefix, reader, uid) {
						this.prefix = prefix;
						return new Promise(function (resolve, reject) {
							this._getApex().then(function (apex) {
								apex.get(this._getEndpoint() + '?reader=' + reader + '&uid=' + uid).then(function (result) {
									this._handleResult(resolve, reject, result);
								}.bind(this), function (err) {
									reject(err.message || err);
								});
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: 'load',
					value: function load(prefix, loader, uid, context) {
						this.prefix = prefix;
						return new Promise(function (resolve, reject) {
							this._getApex().then(function (apex) {
								apex.patch(this._getEndpoint() + '?loader=' + loader + '&uid=' + uid, {
									context: JSON.stringify(context)
								}).then(function (result) {
									this._handleResult(resolve, reject, result);
								}.bind(this), function (err) {
									reject(err.message || err);
								});
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: 'save',
					value: function save(prefix, saver, model) {
						this.prefix = prefix;
						return new Promise(function (resolve, reject) {
							this._getApex().then(function (apex) {
								apex.post(this._getEndpoint(), {
									saver: saver,
									model: typeof model === 'string' ? model : JSON.stringify(model)
								}).then(function (result) {
									this._handleResult(resolve, reject, result);
								}.bind(this), function (err) {
									reject(err.message || err);
								});
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: 'md',
					value: function md(prefix, type, fullNames) {
						return new Promise(function (resolve, reject) {
							this._getApex().then(function (apex) {
								apex.post(null, {
									saver: 'md.read',
									model: JSON.stringify({
										type: type,
										fullNames: fullNames
									})
								}).then(function (result) {
									this._handleResult(resolve, reject, result);
								}.bind(this), function (err) {
									reject(err.message || err);
								});
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: 'describe',
					value: function describe(sObject) {
						return new Promise(function (resolve, reject) {
							this._getApex().then(function (apex) {
								apex.post(null, {
									saver: 'object.describe',
									model: JSON.stringify({
										name: sObject
									})
								}).then(function (result) {
									this._handleResult(resolve, reject, result);
								}.bind(this), function (err) {
									reject(err.message || err);
								});
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: 'query',
					value: function query(soql) {
						return new Promise(function (resolve, reject) {
							this._getApex().then(function (apex) {
								apex.post(null, {
									saver: 'query',
									model: JSON.stringify({
										soql: soql
									})
								}).then(function (result) {
									this._handleResult(resolve, reject, result);
								}.bind(this), function (err) {
									reject(err.message || err);
								});
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: 'setConnection',
					value: function setConnection(conn) {
						this.connection = conn;
					}
				}, {
					key: '_getApex',
					value: function _getApex() {
						if (this.connection) return Promise.resolve(this.connection.apex);

						if (typeof window === 'undefined') return Promise.reject('Connection not set');

						this.oauth = this.oauth || new OAuth();
						return this._getConnection(this.oauth);
					}
				}, {
					key: '_getConnection',
					value: function _getConnection(oauth) {
						return new Promise(function (resolve, reject) {
							oauth.getConnection().then(function (conn) {
								this.connection = conn;
								resolve(this.connection.apex);
							}.bind(this), function (err) {
								reject(err.message || err);
							});
						}.bind(this));
					}
				}, {
					key: '_getEndpoint',
					value: function _getEndpoint() {
						return this._getPrefix() + '/ServiceRouter';
					}
				}, {
					key: '_getPrefix',
					value: function _getPrefix() {
						return this.prefix ? '/' + this.prefix : '';
					}
				}, {
					key: '_handleResult',
					value: function _handleResult(resolve, reject, result) {
						if (result.proxy) {
							this._handleProxyResult(resolve, reject, result.proxy);
							return;
						}
						resolve(this._parse(result));
					}
				}, {
					key: '_handleProxyResult',
					value: function _handleProxyResult(resolve, reject, proxyResult) {
						if (proxyResult.error) {
							this._handleProxyErrorResult(reject, proxyResult.error);
							return;
						}
						if (this.oauth && proxyResult.accessToken) this.oauth.accessToken = proxyResult.accessToken;

						resolve(this._parse(proxyResult.response));
					}
				}, {
					key: '_handleProxyErrorResult',
					value: function _handleProxyErrorResult(reject, error) {
						console.warn('Service Proxy Exception: ' + this._adjustProxyErrorMessage(error));
						reject(error);
					}
				}, {
					key: '_adjustProxyErrorMessage',
					value: function _adjustProxyErrorMessage(errorMessage) {
						if (errorMessage === 'expired access/refresh token') errorMessage += ' - to authorize go to http://localhost:' + location.port + '/common/oauth';

						return errorMessage;
					}
				}, {
					key: '_parse',
					value: function _parse(obj) {
						try {
							return JSON.parse(obj);
						} catch (e) {
							return obj;
						}
					}
				}]);

				return RestClient;
			}());

			_export('RestClient', RestClient);
		}
	};
});

'use strict';

System.register('common/data/client/ServiceClient.js', ['common/data/client/RemoteClient.js', 'common/data/client/RestClient.js'], function (_export, _context) {
	var RemoteClient, RestClient, _createClass, ServiceClient;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataClientRemoteClientJs) {
			RemoteClient = _commonDataClientRemoteClientJs.RemoteClient;
		}, function (_commonDataClientRestClientJs) {
			RestClient = _commonDataClientRestClientJs.RestClient;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ServiceClient', ServiceClient = function () {
				function ServiceClient() {
					_classCallCheck(this, ServiceClient);

					this.client = typeof Visualforce !== 'undefined' ? new RemoteClient() : new RestClient();
				}

				_createClass(ServiceClient, [{
					key: 'read',
					value: function read(prefix, reader, uid) {
						return this.client.read(prefix, reader, uid);
					}
				}, {
					key: 'load',
					value: function load(prefix, loader, uid, context) {
						return this.client.load(prefix, loader, uid, context);
					}
				}, {
					key: 'save',
					value: function save(prefix, saver, model) {
						return this.client.save(prefix, saver, model);
					}
				}, {
					key: 'md',
					value: function md(prefix, type, fullNames) {
						return this.client.md(prefix, type, fullNames);
					}
				}, {
					key: 'describe',
					value: function describe(prefix, sObject) {
						return this.client.describe(sObject);
					}
				}, {
					key: 'query',
					value: function query(soql, version) {
						return this.client.query(soql, version);
					}
				}, {
					key: 'setConnection',
					value: function setConnection(conn) {
						if (typeof this.client.setConnection === 'function') this.client.setConnection(conn);
					}
				}]);

				return ServiceClient;
			}());

			_export('ServiceClient', ServiceClient);
		}
	};
});

'use strict';

System.register('common/data/format/DataBuilder.js', ['common/data/format/JsonFormatter.js'], function (_export, _context) {
	var JsonFormatter, _createClass, DataBuilder;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatJsonFormatterJs) {
			JsonFormatter = _commonDataFormatJsonFormatterJs.JsonFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DataBuilder', DataBuilder = function () {
				function DataBuilder(pretty) {
					_classCallCheck(this, DataBuilder);

					this.pretty = pretty;
					this.data = {};
				}

				_createClass(DataBuilder, [{
					key: 'addQuote',
					value: function addQuote(key, quote, omitRelationships) {
						return this.addObject(key, quote, true, omitRelationships);
					}
				}, {
					key: 'addObject',
					value: function addObject(key, obj, omitNull, omitRelationships) {
						this.data[key] = obj != null ? new JsonFormatter(omitNull, omitRelationships, this.pretty).format(obj) : obj;
						return this;
					}
				}, {
					key: 'addInt',
					value: function addInt(key, int) {
						try {
							int = parseInt(int);
							if (!isNaN(int)) this.data[key] = int;
							return this;
						} catch (e) {
							return this;
						}
					}
				}, {
					key: 'add',
					value: function add(key, val) {
						this.data[key] = val;
						return this;
					}
				}, {
					key: 'build',
					value: function build() {
						return this.data;
					}
				}]);

				return DataBuilder;
			}());

			_export('DataBuilder', DataBuilder);
		}
	};
});

'use strict';

System.register('common/data/format/ErrorFormatter.js', [], function (_export, _context) {
	var _createClass, ErrorFormatter;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ErrorFormatter', ErrorFormatter = function () {
				function ErrorFormatter(message) {
					_classCallCheck(this, ErrorFormatter);

					this.message = typeof message === 'string' ? message : message[0];
				}

				_createClass(ErrorFormatter, [{
					key: 'truncate',
					value: function truncate() {
						var topLine = this.message.split('\n')[0].split(':');
						if (topLine.length > 1) {
							if (topLine[0].startsWith('System')) return [topLine.splice(1, topLine.length - 1).join(':')];else return [topLine.join(':')];
						} else return topLine;
					}
				}]);

				return ErrorFormatter;
			}());

			_export('ErrorFormatter', ErrorFormatter);
		}
	};
});

'use strict';

System.register('common/data/format/JsonFormatter.js', [], function (_export, _context) {
	var _createClass, JsonFormatter;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('JsonFormatter', JsonFormatter = function () {
				function JsonFormatter(omitNull, omitRelationships, pretty) {
					_classCallCheck(this, JsonFormatter);

					this.omitNull = omitNull;
					this.omitRelationships = omitRelationships;
					this.pretty = pretty;
				}

				_createClass(JsonFormatter, [{
					key: 'format',
					value: function format(obj) {
						if (obj === undefined) return;

						if (obj === null) return JSON.stringify(obj);

						var pretty = this.pretty;
						if (typeof pretty !== 'number') pretty = pretty ? 2 : null;

						return JSON.stringify(obj, this._replacer.bind(this), pretty);
					}
				}, {
					key: '_replacer',
					value: function _replacer(key, value) {
						if (value === undefined || key === '_transient_') return;

						if (this.omitNull && value === null) return;

						if (this.omitRelationships && key.endsWith && key.endsWith('__r')) return;

						if (value === '#Error!') return !this.omitNull ? null : undefined;

						return value;
					}
				}]);

				return JsonFormatter;
			}());

			_export('JsonFormatter', JsonFormatter);
		}
	};
});

'use strict';

System.register('common/data/sb-describe/Describe.js', [], function (_export, _context) {
	var _createClass, Describe;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Describe', Describe = function () {
				function Describe() {
					_classCallCheck(this, Describe);
				}

				_createClass(Describe, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-describe';
						this.properties = {
							objects: Array,
							fields: Array,
							cache: {
								type: String,
								value: 'describe'
							},
							describe: {
								type: Object,
								notify: true
							},
							error: {
								type: Object,
								notify: true
							},
							background: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'describeObjects',
					value: function describeObjects() {
						var ordered = [];
						this.objects.forEach(function (obj) {
							ordered.push(obj);
						});
						this._describe(this.objects).then(function (objects) {
							var md = null;
							var response = { objects: ordered };
							for (var i = 0, l = objects.length; i < l; i++) {
								var obj = objects[i];
								if (!obj) continue;
								md = md || {};
								md[obj.name] = obj;
							}
							if (md) {
								response.md = md;
								this.describe = response;
							}
							this.waiting = false;
						}.bind(this), function (err) {
							this.waiting = false;
							this.error = err || err.message;
						}.bind(this));
					}
				}, {
					key: 'describeFields',
					value: function describeFields() {
						var ordered = [];
						this.fields.forEach(function (field) {
							ordered.push(field);
						});
						var objectFields = {};
						for (var i = 0, l = this.fields.length; i < l; i++) {
							var parts = this.fields[i].split('.'),
							    obj = parts[0],
							    field = parts[1];
							objectFields[obj] = objectFields[obj] || {};
							objectFields[obj][field] = true;
						}

						this._describe(Object.keys(objectFields)).then(function (objects) {
							var md = null;
							var allFields = {};
							var response = { fields: ordered };
							var controlledFields = [];
							for (var _i = 0, _l = objects.length; _i < _l; _i++) {
								var _obj = objects[_i];
								if (!_obj) continue;
								md = md || {};
								var mdFields = objectFields[_obj.name];
								for (var _i2 = 0, _l2 = _obj.fields.length; _i2 < _l2; _i2++) {
									allFields[_obj.name + '.' + _obj.fields[_i2].name] = _obj.fields[_i2];
									if (mdFields[_obj.fields[_i2].name]) {
										md[_obj.name + '.' + _obj.fields[_i2].name] = _obj.fields[_i2];
										_obj.fields[_i2].tableName = _obj.name;
										if (_obj.fields[_i2].controllerName != null) {
											controlledFields.push(_obj.fields[_i2]);
										}
									}
								}
							}

							controlledFields.forEach(function (controlledField) {
								var controllingFieldName = controlledField.tableName + '.' + controlledField.controllerName;
								controlledField.controllingField = allFields[controllingFieldName];
								controlledField.controllingField.controllingPicklist = true;
								md[controllingFieldName] = controlledField.controllingField;
							});

							if (md) {
								response.md = md;
								this.describe = response;
							}
							this.waiting = false;
						}.bind(this), function (err) {
							this.waiting = false;
							this.error = err || err.message;
						}.bind(this));
					}
				}, {
					key: '_describe',
					value: function _describe(objects) {
						this.waiting = true;
						var promises = [];
						for (var i = 0, l = objects.length; i < l; i++) {
							promises.push(this.$.service.describe({ sObject: objects[i] }));
						}return Promise.all(promises);
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['describeObjects(objects)', 'describeFields(fields)'];
					}
				}]);

				return Describe;
			}());

			_export('Describe', Describe);

			Polymer(Describe);
		}
	};
});

'use strict';

System.register('common/data/sb-service/Service.js', ['common/core/AppContext.js', 'common/data/client/ServiceClient.js', 'common/data/cache/Cache.js'], function (_export, _context) {
	var AppContext, ServiceClient, Cache, _createClass, Service;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonDataClientServiceClientJs) {
			ServiceClient = _commonDataClientServiceClientJs.ServiceClient;
		}, function (_commonDataCacheCacheJs) {
			Cache = _commonDataCacheCacheJs.Cache;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Service', Service = function () {
				function Service() {
					_classCallCheck(this, Service);
				}

				_createClass(Service, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-service';
						this.properties = {
							reader: String,
							loader: String,
							saver: String,
							uid: String,
							model: Object,
							context: Object,
							mdType: String,
							mdItems: Array,
							sObject: String,
							soql: String,
							cache: String,
							waiting: {
								type: Boolean,
								notify: true
							},
							response: {
								type: Object,
								notify: true
							},
							error: {
								type: Object,
								notify: true
							},
							client: {
								type: Object,
								value: function value() {
									return new ServiceClient();
								}
							},
							transient: {
								type: Boolean
							},
							background: {
								type: Boolean,
								value: false
							},
							prefix: {
								type: String,
								value: function value() {
									return AppContext.org.prefix ? AppContext.org.prefix : '';
								}
							},
							ignoreCache: {
								type: Boolean,
								value: false
							},
							waitId: String,
							waitFor: String,
							version: String };
					}
				}, {
					key: 'read',
					value: function read(request) {
						Polymer.Base.extend(this, request);
						var promise = this._returnPromiseIfCachedResponse();
						if (promise) return promise;

						return this._response(this.client.read(this.prefix, this.reader, this.uid));
					}
				}, {
					key: 'load',
					value: function load(request) {
						Polymer.Base.extend(this, request);
						var promise = this._returnPromiseIfCachedResponse();
						if (promise) return promise;

						return this._response(this.client.load(this.prefix, this.loader, this.uid, this.context));
					}
				}, {
					key: 'save',
					value: function save(request) {
						Polymer.Base.extend(this, request);
						if (this.transient) return this._response(Promise.resolve(this.model));

						return this._response(this.client.save(this.prefix, this.saver, this.model));
					}
				}, {
					key: 'md',
					value: function md(request) {
						Polymer.Base.extend(this, request);
						var promise = this._returnPromiseIfCachedResponse();
						if (promise) return promise;

						var promiseArray = [];

						for (var i = 0, n = Math.ceil(this.mdItems.length / 10); i < n; i++) {
							promiseArray.push(this.client.md(this.prefix, this.mdType, this.mdItems.slice(i * 10, (i + 1) * 10)));
						}return this._responseAll(promiseArray);
					}
				}, {
					key: 'describe',
					value: function describe(request) {
						Polymer.Base.extend(this, request);
						var promise = this._returnPromiseIfCachedResponse(this.sObject, this._describeResponse);
						if (promise) return promise;

						return this._describeResponse(this.client.describe(this.prefix, this.sObject));
					}
				}, {
					key: '_describeResponse',
					value: function _describeResponse(promise) {
						return this._response(new Promise(function (resolve, reject) {
							Cache.add(this.cache, this.sObject, promise, 'promise');
							promise.then(function (res) {
								this.uid = res ? res.name : null;
								Cache.remove(this.cache, this.sObject, 'promise');
								resolve(res);
							}.bind(this), function (err) {
								reject(err);
							});
						}.bind(this)));
					}
				}, {
					key: 'query',
					value: function query(request) {
						Polymer.Base.extend(this, request);
						var promise = this._returnPromiseIfCachedResponse();
						if (promise) return promise;

						return this._response(this.client.query(this.soql, this.version));
					}
				}, {
					key: '_read',
					value: function _read() {
						if (this._shouldWait(this._read.bind(this))) return;

						this.read().then(function () {}, function (err) {
							console.error(err.message || err);
						});
					}
				}, {
					key: '_load',
					value: function _load() {
						if (this._shouldWait(this._load.bind(this))) return;

						this.load().then(function () {}, function (err) {
							console.error(err.message || err);
						});
					}
				}, {
					key: '_save',
					value: function _save() {
						if (this._shouldWait(this._save.bind(this))) return;

						this.save().then(function () {}, function (err) {
							console.error(err.message || err);
						});
					}
				}, {
					key: '_md',
					value: function _md() {
						if (this._shouldWait(this._md.bind(this))) return;

						this.md().then(function () {}, function (err) {
							console.error(err.message || err);
						});
					}
				}, {
					key: '_describe',
					value: function _describe() {
						if (this._shouldWait(this._describe.bind(this))) return;

						this.describe().then(function () {}, function (err) {
							console.error(err.message || err);
						});
					}
				}, {
					key: '_query',
					value: function _query() {
						if (this._shouldWait(this._query.bind(this))) return;

						this.query().then(function () {}, function (err) {
							console.error(err.message || err);
						});
					}
				}, {
					key: '_spinner',
					value: function _spinner() {
						this.spinner = this.waiting && !this.background;
					}
				}, {
					key: '_shouldWait',
					value: function _shouldWait(request) {
						if (!this.waitFor) return false;

						var waitForPromise = Cache.get('__wait__', this.waitFor, 'promise');
						if (!waitForPromise) return false;

						var waiting = Cache.get('__wait__', this.waitFor, 'waiting') || [];
						waiting.push(request);
						Cache.add('__wait__', this.waitFor, waiting, 'waiting');

						this.waiting = !this.background;
						return true;
					}
				}, {
					key: '_returnPromiseIfCachedResponse',
					value: function _returnPromiseIfCachedResponse(uid, response) {
						if (this.ignoreCache === true) return false;
						uid = uid || this.uid;
						response = response ? response.bind(this) : this._response.bind(this);

						var cachedResponse = Cache.get(this.cache, uid);
						if (cachedResponse) return response(Promise.resolve(cachedResponse));

						var cachedPromise = Cache.get(this.cache, uid, 'promise');
						if (cachedPromise) return response(cachedPromise);

						if (this.transient) return response(Promise.resolve(this.response));

						return null;
					}
				}, {
					key: '_response',
					value: function _response(promise) {
						this.waiting = true;
						var newPromise = new Promise(function (resolve, reject) {
							promise.then(function (res) {
								this.waiting = false;
								if (res) this.response = res;
								Cache.remove(this.cache, this.uid, 'promise');
								resolve(this.response);
								Service.executeWaiting(this.waitId);
							}.bind(this), function (err) {
								this.waiting = false;
								if (err) this.error = this._createError(err);
								Cache.remove(this.cache, this.uid, 'promise');
								reject(this.error);
								Service.executeWaiting(this.waitId);
							}.bind(this));
						}.bind(this));
						Cache.add(this.cache, this.uid, newPromise, 'promise');
						Service.addWaitFor(this.waitId, newPromise);
						return newPromise;
					}
				}, {
					key: '_responseAll',
					value: function _responseAll(promises) {
						this.waiting = true;
						var newPromise = Promise.all(promises).then(function (res) {
							for (var i = 0, l = res.length; i < l; i++) {
								if (res[i].constructor !== Array) res[i] = [res[i]];
							}
							this.waiting = false;
							this.response = [].concat.apply([], res);
							Cache.remove(this.cache, this.uid, 'promise');
							var promise = Promise.resolve(this.response);
							Service.executeWaiting(this.waitId);
							return promise;
						}.bind(this), function (err) {
							this.waiting = false;
							if (err) this.error = this._createError(err);
							Cache.remove(this.cache, this.uid, 'promise');
							var promise = Promise.reject(this.error);
							Service.executeWaiting(this.waitId);
							return promise;
						}.bind(this));
						Cache.add(this.cache, this.uid, newPromise, 'promise');
						Service.addWaitFor(this.waitId, newPromise);
						return newPromise;
					}
				}, {
					key: '_cache',
					value: function _cache() {
						Cache.add(this.cache, this.uid, this.response, 'value', this);
					}
				}, {
					key: '_createError',
					value: function _createError(err) {
						var msg = err.message || err;
						var error = { message: msg };

						var validations;
						if (msg.indexOf('ValidationException: [') != -1 || msg.startsWith('[')) {
							var start = msg.indexOf('[');
							var end = msg.indexOf(']', start) + 1;
							if (end > start) validations = msg.substring(start, end);
						}

						if (validations) {
							try {
								var escapedValidations = validations.replace(/\n/g, "\\n").replace(/\r/g, "\\r");
								var validationsArray = JSON.parse(escapedValidations);
								error.validations = validationsArray;
							} catch (e) {}
						}

						return error;
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'response-changed': '_cache'
						};
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_read(reader, uid, prefix)', '_save(saver, model, prefix)', '_load(loader, uid, context, prefix)', '_md(mdType, mdItems, prefix)', '_describe(sObject, prefix)', '_query(soql)', '_spinner(waiting, background)'];
					}
				}], [{
					key: 'addWaitFor',
					value: function addWaitFor(waitId, promise) {
						Cache.add('__wait__', waitId, promise, 'promise');
					}
				}, {
					key: 'executeWaiting',
					value: function executeWaiting(waitId) {
						Cache.remove('__wait__', waitId, 'promise');

						var waiting = Cache.get('__wait__', waitId, 'waiting');
						if (!waiting) return;

						Cache.remove('__wait__', waitId, 'waiting');
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = waiting[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var w = _step.value;

								w();
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}]);

				return Service;
			}());

			_export('Service', Service);

			Polymer(Service);
		}
	};
});

'use strict';

System.register('common/filter/searcher/Searcher.js', ['common/Util.js', 'common/data/client/ServiceClient.js', 'common/core/AppContext.js', 'common/forms/sb-lookup/map/LookupNameMapper.js'], function (_export, _context) {
	var Util, ServiceClient, AppContext, LookupNameMapper, _createClass, Searcher;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonUtilJs) {
			Util = _commonUtilJs.Util;
		}, function (_commonDataClientServiceClientJs) {
			ServiceClient = _commonDataClientServiceClientJs.ServiceClient;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonFormsSbLookupMapLookupNameMapperJs) {
			LookupNameMapper = _commonFormsSbLookupMapLookupNameMapperJs.LookupNameMapper;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Searcher', Searcher = function () {
				function Searcher(model) {
					_classCallCheck(this, Searcher);

					this.model = model;
					this.searchFilterData = {};
				}

				_createClass(Searcher, [{
					key: 'buildFields',
					value: function buildFields(fields) {
						return fields;
					}
				}, {
					key: 'getSearchTable',
					value: function getSearchTable() {
						return this.model.targetObjectName;
					}
				}, {
					key: 'getGroupKey',
					value: function getGroupKey(filter) {
						if (this.model.hasCustomSearchFilters) return filter.record.Id;else return filter.targetFieldName;
					}
				}, {
					key: 'setDefaultFilterValues',
					value: function setDefaultFilterValues(group, searchFilterModel) {
						var searchFilterData = {};
						var promises = [];
						if (this.model.hasCustomSearchFilters) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = group[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var id = _step.value;
									var _iteratorNormalCompletion2 = true;
									var _didIteratorError2 = false;
									var _iteratorError2 = undefined;

									try {
										for (var _iterator2 = this.model.searchFilters[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
											var filter = _step2.value;

											if (filter.record.Id === id) {
												if (searchFilterModel && this.isLookupType(searchFilterModel[id].model.type)) promises.push(this.queryLookupFilterName(filter.stringValue, searchFilterModel[id].model.referenceTo[0]));
												searchFilterData[id] = {
													value: this.searchFilterData[id] === undefined ? filter.stringValue ? filter.stringValue : '' : this.searchFilterData[id].value,
													field: this.searchFilterData[id] === undefined ? filter.targetFieldName ? filter.targetFieldName : '' : this.searchFilterData[id].field
												};
												break;
											}
										}
									} catch (err) {
										_didIteratorError2 = true;
										_iteratorError2 = err;
									} finally {
										try {
											if (!_iteratorNormalCompletion2 && _iterator2.return) {
												_iterator2.return();
											}
										} finally {
											if (_didIteratorError2) {
												throw _iteratorError2;
											}
										}
									}
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						} else {
							var _iteratorNormalCompletion3 = true;
							var _didIteratorError3 = false;
							var _iteratorError3 = undefined;

							try {
								for (var _iterator3 = group[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
									var _filter = _step3.value;

									searchFilterData[_filter] = { value: this.searchFilterData[_filter] === undefined ? searchFilterModel[_filter].stringValue : this.searchFilterData[_filter].value };
									if (this.searchFilterData[_filter] && this.searchFilterData[_filter].label) searchFilterData[_filter].label = this.searchFilterData[_filter].label;
								}
							} catch (err) {
								_didIteratorError3 = true;
								_iteratorError3 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion3 && _iterator3.return) {
										_iterator3.return();
									}
								} finally {
									if (_didIteratorError3) {
										throw _iteratorError3;
									}
								}
							}
						}

						return new Promise(function (resolve) {
							if (promises.length === 0) {
								this.searchFilterData = this.handleDynamicSearchFilters(searchFilterData);
								resolve(searchFilterData);
							} else {
								Promise.all(promises).then(function (responses) {
									var _iteratorNormalCompletion4 = true;
									var _didIteratorError4 = false;
									var _iteratorError4 = undefined;

									try {
										for (var _iterator4 = responses[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
											var response = _step4.value;

											var record = response.records[0];
											if (!record) continue;
											var name = new LookupNameMapper(record.attributes.type).getNameField();
											for (var _id2 in searchFilterData) {
												var searchFilter = searchFilterData[_id2];
												if (searchFilter.value.substring(0, 15) === record.Id.substring(0, 15)) {
													searchFilter.label = record[name];
													break;
												}
											}
										}
									} catch (err) {
										_didIteratorError4 = true;
										_iteratorError4 = err;
									} finally {
										try {
											if (!_iteratorNormalCompletion4 && _iterator4.return) {
												_iterator4.return();
											}
										} finally {
											if (_didIteratorError4) {
												throw _iteratorError4;
											}
										}
									}

									this.searchFilterData = this.handleDynamicSearchFilters(searchFilterData);
									resolve(searchFilterData);
								}.bind(this));
							}
						}.bind(this));
					}
				}, {
					key: 'handleDynamicSearchFilters',
					value: function handleDynamicSearchFilters(searchFilterData) {
						if (!this.dynamicSearchFilters) return searchFilterData;else {
							var _iteratorNormalCompletion5 = true;
							var _didIteratorError5 = false;
							var _iteratorError5 = undefined;

							try {
								for (var _iterator5 = this.dynamicSearchFilters[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
									var filter = _step5.value;

									if (filter.type === 'Optional Filter' && searchFilterData[filter.targetFieldName]) searchFilterData[filter.targetFieldName].value = filter.stringValue;
								}
							} catch (err) {
								_didIteratorError5 = true;
								_iteratorError5 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion5 && _iterator5.return) {
										_iterator5.return();
									}
								} finally {
									if (_didIteratorError5) {
										throw _iteratorError5;
									}
								}
							}
						}
						return searchFilterData;
					}
				}, {
					key: 'getFilterContext',
					value: function getFilterContext() {
						var searchFilterData = {};
						if (this.model.hasCustomSearchFilters) {
							for (var value in this.searchFilterData) {
								var _iteratorNormalCompletion6 = true;
								var _didIteratorError6 = false;
								var _iteratorError6 = undefined;

								try {
									for (var _iterator6 = this.model.searchFilters[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
										var filter = _step6.value;

										if (value === filter.record.Id && this.searchFilterData[value]) {
											if (this.searchFilterData[value].value === '') searchFilterData[filter.targetFieldName] = null;else searchFilterData[filter.targetFieldName] = this.searchFilterData[value].value;
										}
									}
								} catch (err) {
									_didIteratorError6 = true;
									_iteratorError6 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion6 && _iterator6.return) {
											_iterator6.return();
										}
									} finally {
										if (_didIteratorError6) {
											throw _iteratorError6;
										}
									}
								}
							}
							return searchFilterData;
						} else for (var _value in this.searchFilterData) {
							if (this.searchFilterData[_value].value === '') searchFilterData[_value] = null;else searchFilterData[_value] = this.searchFilterData[_value].value;
						}
						return searchFilterData;
					}
				}, {
					key: 'getAdditionalProperties',
					value: function getAdditionalProperties() {
						if (this.dynamicSearchFilters) {
							var filters = [];
							for (var i = 0, numFilters = this.dynamicSearchFilters.length; i < numFilters; i++) {
								if (this.dynamicSearchFilters[i].type === 'Default Filter') filters.push(JSON.stringify(this.dynamicSearchFilters[i]));
							}return filters;
						}
					}
				}, {
					key: 'clearFields',
					value: function clearFields() {
						var searchFilterData = {};
						for (var filter in this.searchFilterData) {
							searchFilterData[filter] = JSON.parse(JSON.stringify(this.searchFilterData[filter]));
							searchFilterData[filter].value = '';
						}
						return this.searchFilterData = searchFilterData;
					}
				}, {
					key: 'runOnLoad',
					value: function runOnLoad(filterValues) {
						this.searchFilterData = filterValues;
					}
				}, {
					key: 'isLookupType',
					value: function isLookupType(type) {
						return type === 'reference' || type === 'id';
					}
				}, {
					key: 'queryLookupFilterName',
					value: function queryLookupFilterName(id, tableName) {
						var name = new LookupNameMapper(tableName).getNameField();
						var _id = id ? '\'' + id + '\'' : null;
						return new ServiceClient().query(('SELECT Id, ' + name + ' FROM ' + tableName + ' WHERE Id = ').concat(_id));
					}
				}]);

				return Searcher;
			}());

			_export('Searcher', Searcher);
		}
	};
});

'use strict';

System.register('common/core/sb-i18n/I18n.js', ['../AppContext.js', '../../Util.js'], function (_export, _context) {
	var AppContext, Util, _createClass, dateFormatCache, numberFormatCache, localeData, I18n;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_AppContextJs) {
			AppContext = _AppContextJs.AppContext;
		}, function (_UtilJs) {
			Util = _UtilJs.Util;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			dateFormatCache = new Util.Map();
			numberFormatCache = new Util.Map();
			localeData = void 0;

			_export('I18n', I18n = function () {
				function I18n(app) {
					_classCallCheck(this, I18n);

					this.app = app;
				}

				_createClass(I18n, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-i18n';
						this.properties = Polymer.Base.extend({
							locale: {
								type: String,
								notify: false,
								value: function value() {
									return '';
								}
							},

							key: {
								type: String,
								notify: false
							},

							value: {
								type: String,
								value: null
							},

							values: {
								type: Array,
								value: []
							}
						}, AppContext.properties);
					}
				}, {
					key: 'attached',
					value: function attached() {
						this.key = this.key ? this.key : this.innerHTML;
						if (/{[0-9]}/.test(this.innerHTML)) this.innerHTML = '';
					}
				}, {
					key: 'localize',
					value: function localize() {
						this.innerHTML = this.l(this.key, this.value ? [this.value] : this.values);
					}
				}, {
					key: 'l',
					value: function l(key, values) {
						var label = this.labels[key] || key;
						if (/{[0-9]}/.test(label) && values && values.length > 0) label = this._replaceWildcards(label, values);

						return label;
					}
				}, {
					key: '_replaceWildcards',
					value: function _replaceWildcards(label, values) {
						for (var i = 0, l = values.length; i < l; i++) {
							label = label.replace(new RegExp('{[' + i + ']}', 'g'), values[i]);
						}return label;
					}
				}, {
					key: '_getFormat',
					value: function _getFormat(locale, key, isDate) {
						var f = null;
						if (locale && key) {
							var loc = isDate ? dateFormatCache.get(locale) : numberFormatCache.get(locale);
							if (!loc) {
								loc = new Util.Map();
								var c = isDate ? dateFormatCache : numberFormatCache;
								c.set(locale, loc);
							}

							var stringKey = JSON.stringify(key);
							f = loc.get(stringKey);
							if (!f) {
								f = isDate ? new Intl.DateTimeFormat(locale, key) : new Intl.NumberFormat(locale, key);
								loc.set(stringKey, f);
							}
						}
						return f;
					}
				}, {
					key: 'format',
					value: function format(value, options) {
						var v = '',
						    opts = options || {},
						    locale = this.user.locale;

						if (value || value == 0) {
							if (value instanceof Date || opts.date) {
								var fmt = this._getFormat(locale, opts, true);
								if (value instanceof Date) {
									v = fmt.format(value);
								} else if (typeof value == 'number') {
									v = fmt.format(new Date(value));
								} else if (typeof value === 'string') {
									var pos = value.indexOf('T');
									if (pos >= 0) try {
										v = fmt.format(Date.parse(value));
									} catch (e) {
										var parts = value.split('T'),
										    ymd = parts[0].split('-');
										if (ymd && ymd.length == 3) v = fmt.format(new Date(ymd[0], ymd[1] - 1, ymd[2]));
									} else {
										var _ymd = value.split('-');
										if (_ymd && _ymd.length == 3) v = fmt.format(new Date(_ymd[0], _ymd[1] - 1, _ymd[2]));
									}
								}
							} else {
								var _fmt = this._getFormat(locale, opts, false);
								v = _fmt.format(value);
								if (opts.style === 'currency') {
									v = this.additionalCurrencyFormat(opts, v);
								}
							}
						}
						return v;
					}
				}, {
					key: 'additionalCurrencyFormat',
					value: function additionalCurrencyFormat(opts, v) {
						if (opts.currency === 'XXX') {
							return this.org.currencySymbol + v.replace(/[XXX]/g, '');
						} else {
							var containsDash = void 0;
							if (opts.currencyDisplay == 'code') {
								containsDash = v.indexOf('-') > -1;
								if (containsDash) {
									v = v.replace('-', '');
								}
							}

							var additionalContent = containsDash ? ' -' : ' ';
							return v.replace(opts.currency, opts.currency + additionalContent);
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.AppContext];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['localize(key, value, values)'];
					}
				}], [{
					key: 'addLocaleData',
					value: function addLocaleData(d) {
						if (d) localeData = d;
					}
				}, {
					key: 'getLocaleData',
					value: function getLocaleData(locale) {
						return localeData;
					}
				}]);

				return I18n;
			}());

			_export('I18n', I18n);

			Polymer(I18n);
		}
	};
});

'use strict';

System.register('common/core/sb-loading-spinner/LoadingSpinner.js', [], function (_export, _context) {
	var _createClass, LoadingSpinner;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LoadingSpinner', LoadingSpinner = function () {
				function LoadingSpinner() {
					_classCallCheck(this, LoadingSpinner);
				}

				_createClass(LoadingSpinner, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-loading-spinner';
						this.properties = {
							show: {
								type: Boolean,
								value: false
							},
							position: {
								type: String,
								value: 'fixed'
							},
							size: {
								type: String,
								value: 'large'
							}
						};
					}
				}]);

				return LoadingSpinner;
			}());

			_export('LoadingSpinner', LoadingSpinner);

			Polymer(LoadingSpinner);
		}
	};
});

'use strict';

System.register('common/core/sb-page-container/PageContainer.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, bpXS, bpS, bpM, bpL, bpXL, mqXS, mqSOnly, mqMOnly, mqLOnly, mqXL, PageContainer;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			bpXS = 0;
			bpS = 480;
			bpM = 800;
			bpL = 1024;
			bpXL = 1200;
			mqXS = window.matchMedia('screen and (max-width: ' + bpS + 'px)');
			mqSOnly = window.matchMedia('screen and (min-width: ' + (bpS + 1) + 'px) and (max-width: ' + bpM + 'px)');
			mqMOnly = window.matchMedia('screen and (min-width: ' + (bpM + 1) + 'px) and (max-width: ' + bpL + 'px)');
			mqLOnly = window.matchMedia('screen and (min-width: ' + (bpL + 1) + 'px) and (max-width: ' + bpXL + 'px)');
			mqXL = window.matchMedia('screen and (min-width: ' + (bpXL + 1) + 'px)');

			_export('PageContainer', PageContainer = function () {
				function PageContainer() {
					_classCallCheck(this, PageContainer);
				}

				_createClass(PageContainer, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-page-container';
						this.properties = {
							route: String,

							allRoutes: {
								type: Object,
								value: function value() {
									return {};
								},
								observer: '_allRoutesChanged'
							},

							viewport: {
								type: Object,
								observer: '_viewportChanged',
								value: function value() {
									return this._buildViewport(mqXS.matches, mqSOnly.matches, mqMOnly.matches, mqLOnly.matches, mqXL.matches);
								}
							}
						};
					}
				}, {
					key: '_buildViewport',
					value: function _buildViewport(xs, s, m, l, xl) {
						var v = {
							XS: {},
							S: {},
							M: {},
							L: {},
							XL: {},
							current: function current() {
								if (this.XS.only) return { size: 'XS', window: [bpXS, bpS] };
								if (this.S.only) return { size: 'S', window: [bpS + 1, bpM] };
								if (this.M.only) return { size: 'M', window: [bpM + 1, bpL] };
								if (this.L.only) return { size: 'L', window: [bpL + 1, bpXL] };
								if (this.XL.only) return { size: 'XL', window: [bpXL, 10000] };
							},
							isMobile: function isMobile() {
								return this.isPhone() || this.isTablet();
							},
							isPhone: function isPhone() {
								return AppContext.isPhone;
							},
							isTablet: function isTablet() {
								return AppContext.isTablet;
							},
							isDesktop: function isDesktop() {
								return AppContext.isDesktop;
							}
						};

						v.XS.only = xs && !s && !m && !l && !xl;
						v.XS.down = v.XS.only;
						v.XS.up = xs || s || m || l || xl;

						v.S.only = !xs && s && !m && !l && !xl;
						v.S.down = (xs || s) && !m && !l && !xl;
						v.S.up = !xs && (s || m || l || xl);

						v.M.only = !xs && !s && m && !l && !xl;
						v.M.down = (xs || s || m) && !l && !xl;
						v.M.up = !xs && !s && (m || l || xl);

						v.L.only = !xs && !s && !m && l && !xl;
						v.L.down = (xs || s || m || l) && !xl;
						v.L.up = !xs && !s && !m && (l || xl);

						v.XL.only = !xs && !s && !m && !l && xl;
						v.XL.down = true;
						v.XL.up = v.XL.only;

						return v;
					}
				}, {
					key: 'ready',
					value: function ready() {
						this._setupViewportListeners();
					}
				}, {
					key: 'renderPage',
					value: function renderPage(e, detail, sender) {

						if (detail.route.comp && detail.route.comp != '') {
							var ctx = {};
							ctx.params = detail.params;
							ctx.pathParams = detail.pathParams;

							var html = function (detail, ctx) {
								return '<' + detail.route.comp + ' ctx=\'' + JSON.stringify(ctx) + '\'></' + detail.route.comp + '>';
							}.bind(this)(detail, ctx);
							if (detail.route.mod) {
								System.import(detail.route.mod).then(function (m) {
									this.$.content.innerHTML = html;
									this._viewportChanged();
									Polymer.updateStyles();
								}.bind(this)).catch(function (err) {
									console.log(err);
									console.log(err.originalErr);
								});
							} else {
								this.$.content.innerHTML = html;
								Polymer.updateStyles();
							}
						} else {
							this.$.ajax.url = detail.route.view;
							if (this.$.ajax.url) this.$.ajax.go();
						}
					}
				}, {
					key: '_allRoutesChanged',
					value: function _allRoutesChanged(nv) {
						this.$.router.init(nv);
					}
				}, {
					key: '_viewportChanged',
					value: function _viewportChanged() {
						var el = this.$.content.querySelector('*:first-child');
						if (el) el.viewport = this.viewport;

						setTimeout(function () {
							this.fire('iron-signal', { name: 'sb-viewport-changed', data: { viewport: this.viewport } });
						}.bind(this), 10);
					}
				}, {
					key: '_setupViewportListeners',
					value: function _setupViewportListeners() {
						var self = this;
						function build(m) {
							if (m.matches) self.viewport = self._buildViewport(mqXS.matches, mqSOnly.matches, mqMOnly.matches, mqLOnly.matches, mqXL.matches);
						};

						mqXS.addListener(build);
						mqSOnly.addListener(build);
						mqMOnly.addListener(build);
						mqLOnly.addListener(build);
						mqXL.addListener(build);
					}
				}], [{
					key: 'getContainer',
					value: function getContainer() {
						return document.querySelector('#' + PageContainer.domId);
					}
				}, {
					key: 'getViewport',
					value: function getViewport() {
						var container = PageContainer.getContainer();
						return container ? container.viewport : null;
					}
				}]);

				return PageContainer;
			}());

			_export('PageContainer', PageContainer);

			PageContainer.domId = 'sbPageContainer';

			Polymer(PageContainer);
		}
	};
});

'use strict';

System.register('common/core/sb-page-header/PageHeader.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, PageHeader;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('PageHeader', PageHeader = function () {
				function PageHeader() {
					_classCallCheck(this, PageHeader);
				}

				_createClass(PageHeader, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-page-header';
						this.properties = {
							viewport: {
								type: Object,
								observer: '_viewportChanged',
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							showMenu: {
								type: Boolean,
								value: function value() {
									return true;
								}
							},
							menuClosed: {
								type: Boolean,
								value: function value() {
									return true;
								}
							},
							hideFullTitle: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: '_showFullTitle',
					value: function _showFullTitle(e) {
						if (!this.viewport.isMobile()) {
							return;
						}

						if (!this.hideFullTitle && !Polymer.dom(this).children[1].textContent) {
							return;
						}

						this.hideFullTitle = !this.hideFullTitle;

						this.$.fullTitle.innerText = this.hideFullTitle ? Polymer.dom(this).children[1].textContent : "";
						this.$.fullTitle.style.opacity = this.hideFullTitle ? 1 : 0;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: 'navigationChanged',
					value: function navigationChanged() {
						this._closeMenu();
					}
				}, {
					key: '_closeMenu',
					value: function _closeMenu() {
						this.toggleClass('open', false, this.$.buttons);
						this.toggleClass('autoLaunch', false, this.$.buttons);
						setTimeout(function () {
							this.menuClosed = true;
						}.bind(this), 1);
					}
				}, {
					key: '_changeMenu',
					value: function _changeMenu(e) {
						var target = Polymer.dom(e).rootTarget.getAttribute('data-target');
						if (target === "Popup") return;
						this.menuClosed = PageHeader.changeMenu(e, this.menuClosed, this.$.buttons, 'open', this);
						if (this.menuClosed) this.fire('sb-menu-closed');
					}
				}, {
					key: '_viewportChanged',
					value: function _viewportChanged() {
						this.showMenu = this.viewport && !this.viewport.isMobile() && this.viewport.M.up ? false : true;
						if (this.showMenu) this.$.buttons.classList.remove('normal');else this.$.buttons.classList.add('normal');
					}
				}, {
					key: 'openLookupDialog',
					value: function openLookupDialog(e) {
						var lookup = this.$.lookup;
						lookup.invoker = e.detail.lookup;
						lookup.open(e.detail.searchValue);
					}
				}, {
					key: 'openRteDialog',
					value: function openRteDialog(e) {
						var rte = this.$.rte;
						rte.value = e.detail.value;
						rte.rte = e.detail.rte;
						rte.open();
					}
				}, {
					key: 'allowAutoLaunchPopup',
					value: function allowAutoLaunchPopup() {
						if (this.showMenu) {
							this.toggleClass('open', true, this.$.buttons);
							this.toggleClass('autoLaunch', true, this.$.buttons);
							this.menuClosed = false;
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}], [{
					key: 'changeMenu',
					value: function changeMenu(e, menuClosed, targetElement, openClass, toggler) {
						var rect = e.currentTarget.getBoundingClientRect();
						var bs = targetElement.style;
						bs.top = rect.bottom + 2 + 'px';
						bs.right = window.innerWidth - rect.right + 'px';
						toggler.toggleClass(openClass, menuClosed, targetElement);
						return !menuClosed;
					}
				}]);

				return PageHeader;
			}());

			_export('PageHeader', PageHeader);

			Polymer(PageHeader);
		}
	};
});

'use strict';

System.register('common/core/sb-router/Router.js', [], function (_export, _context) {
	var _createClass, private_router, routes, PATH_PARAM_REGEX, Router;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			private_router = void 0;
			routes = void 0;
			PATH_PARAM_REGEX = /:[a-z0-9_$]*/g;

			_export('Router', Router = function () {
				function Router() {
					_classCallCheck(this, Router);
				}

				_createClass(Router, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-router';
						this.properties = {
							autoHash: {
								type: Boolean,
								value: function value() {
									return false;
								}
							},

							route: {
								type: String,
								observer: 'routeChanged'
							},

							router: {
								type: Object,
								readOnly: true,
								value: function value() {
									if (!private_router) {
										private_router = new window.Router();
										private_router.init();
									}
									return private_router;
								}
							}
						};
					}
				}, {
					key: 'init',
					value: function init(allRoutes) {
						var _this = this;

						var modules = Object.keys(allRoutes);

						if (!routes && modules.length) {
							routes = allRoutes;
							var router = this.router,
							    len = modules ? modules.length : 0;

							for (var i = 0; i < len; i++) {
								var mod = modules[i],
								    modulePaths = Object.keys(routes[mod]),
								    pLen = modulePaths ? modulePaths.length : 0;

								var _loop = function _loop(p) {
									var path = modulePaths[p],
									    pathParams = path ? path.match(PATH_PARAM_REGEX) : null,
									    paramNames = [],
									    paramMap = {};

									if (pathParams) {
										paramNames = pathParams.map(function (val, index) {
											var p = val.substring(1);
											paramMap[p] = null;
											return p;
										});
									}

									router.on(mod + path, function (m, p, paramNames, paramMap) {
										var pathParams = JSON.parse(JSON.stringify(paramMap)),
										    params = Array.prototype.slice.call(arguments, 4),
										    paramsLen = params ? params.length : 0;

										for (var j = 0; j < paramsLen; j++) {
											pathParams[paramNames[j]] = params[j];
										}this.routeHandler(m, p, pathParams);
									}.bind(_this, mod, path, paramNames, paramMap));
								};

								for (var p = 0; p < pLen; p++) {
									_loop(p);
								}
							}

							router.on('/*', function () {
								console.log('got an unknown route. need to show 404 here');
							});

							router.on('', function () {
								console.log('Got the <empty> route');
							});
						}
					}
				}, {
					key: 'routeHandler',
					value: function routeHandler(mod, path, params) {
						var hash = window.location.hash.slice(1),
						    pos = hash.indexOf('?'),
						    qsParams = {};

						if (pos >= 0 && hash.length > pos) {
							qsParams = queryString.parse(hash.substring(pos + 1));
						}
						this.fire('sb-route-complete', { mod: mod, path: path, route: routes[mod][path], pathParams: params, params: qsParams });
					}
				}, {
					key: 'routeChanged',
					value: function routeChanged(nv, ov) {
						if (this.autoHash && nv) {
							var same = window.location.hash.slice(1) == this.route;
							window.location.hash = this.route;

							if (same) {
								this.router.dispatch('on', nv);
							}
						}
					}
				}]);

				return Router;
			}());

			_export('Router', Router);

			Polymer(Router);
		}
	};
});

'use strict';

System.register('common/core/sb-toast/Toast.js', [], function (_export, _context) {
    var _typeof, _createClass, Toast;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
            };

            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export('Toast', Toast = function () {
                function Toast() {
                    _classCallCheck(this, Toast);
                }

                _createClass(Toast, [{
                    key: 'beforeRegister',
                    value: function beforeRegister() {
                        this.is = 'sb-toast';
                        this.properties = {
                            messages: {
                                type: Array,
                                notify: true },

                            type: String };
                    }
                }, {
                    key: 'ready',
                    value: function ready() {
                        this.hasMessages = false;
                        this.messagesModel = [];
                        this.repeatHandlers = {};
                    }
                }, {
                    key: 'validation',
                    value: function validation() {
                        if (!this.messages) {
                            this.messagesModel = [];
                            this.hasMessages = false;
                            this.repeatHandlers = {};
                            return;
                        }

                        var errorMsgs = { type: 'error', class: 'slds-theme--error', msgs: [], icon: 'sf-icon-error' };
                        var successMsgs = { type: 'success', class: 'slds-theme--success', msgs: [], icon: 'sf-icon-success' };
                        var warningMsgs = { type: 'warning', class: 'slds-theme--warning', msgs: [], icon: 'sf-icon-warning' };
                        var infoMsgs = { type: 'info', class: '', msgs: [], icon: 'sf-icon-info' };
                        var numMessages = this.messages.length;
                        if (_typeof(this.messages[0]) == 'object') {
                            for (var i = 0; i < numMessages; i++) {
                                var messagesSplit = this.messages[i].msg.split('\n');
                                if (this.messages[i].type == 'error') {
                                    errorMsgs.msgs.push(messagesSplit);
                                } else if (this.messages[i].type == 'warning') {
                                    warningMsgs.msgs.push(messagesSplit);
                                } else if (this.messages[i].type == 'success') {
                                    successMsgs.msgs.push(messagesSplit);
                                } else {
                                    infoMsgs.msgs.push(messagesSplit);
                                }
                            }
                        } else if (typeof this.messages[0] == 'string') {
                            var _messagesSplit = [];
                            for (var _i = 0; _i < numMessages; _i++) {
                                _messagesSplit.push(this.messages[_i].split('\n'));
                            }
                            if (this.type == 'error') {
                                errorMsgs.msgs = _messagesSplit;
                            } else if (this.type == 'success') {
                                successMsgs.msgs = _messagesSplit;
                            } else if (this.type == 'warning') {
                                warningMsgs.msgs = _messagesSplit;
                            } else {
                                infoMsgs.msgs = _messagesSplit;
                            }
                        }

                        if (this.messages && this.messages.length > 0) {
                            this.removeRepeatedMessages(errorMsgs, 'error');
                            if (errorMsgs.msgs.length > 0) {
                                this.push('messagesModel', errorMsgs);
                            }
                            this.removeRepeatedMessages(successMsgs, 'success');
                            if (successMsgs.msgs.length > 0) {
                                this.push('messagesModel', successMsgs);
                            }
                            this.removeRepeatedMessages(successMsgs, 'warning');
                            if (warningMsgs.msgs.length > 0) {
                                this.push('messagesModel', warningMsgs);
                            }
                            this.removeRepeatedMessages(infoMsgs, 'info');
                            if (infoMsgs.msgs.length > 0) {
                                this.push('messagesModel', infoMsgs);
                            }
                            this.hasMessages = true;
                        } else {
                            this.hasMessages = false;
                            this.messages = undefined;
                        }
                    }
                }, {
                    key: 'removeRepeatedMessages',
                    value: function removeRepeatedMessages(messages, type) {
                        if (!this.messagesModel) return;

                        for (var i = 0, l = this.messagesModel.length; i < l; i++) {
                            var msg = this.messagesModel[i];
                            if (type !== msg.type) continue;

                            var repeat = this.isMessageRepeated(msg, messages);
                            if (repeat) messages.msgs = [];
                            this.toggleRepeatClass(type, repeat, i);
                        }
                    }
                }, {
                    key: 'isMessageRepeated',
                    value: function isMessageRepeated(msg1, msg2) {
                        for (var i = 0, l = msg1.msgs.length; i < l; i++) {
                            for (var j = 0, ll = msg1.msgs[i].length; j < ll; j++) {
                                if (msg1.msgs[i][j] !== msg2.msgs[i][j]) return false;
                            }
                        }
                        return true;
                    }
                }, {
                    key: 'toggleRepeatClass',
                    value: function toggleRepeatClass(type, repeat, index) {
                        this.removeAnimationListeners(type, index);
                        var container = this.addAnimationListeners(type, index);
                        this.toggleClass('repeat', repeat, container);
                    }
                }, {
                    key: 'removeAnimationListeners',
                    value: function removeAnimationListeners(type, index) {
                        var id = type + '_' + index;
                        var handler = this.repeatHandlers[id];
                        if (!handler) return;

                        var container = this.$$('#' + id);
                        container.removeEventListener('animationend', handler);
                        container.removeEventListener('webkitAnimationEnd', handler);
                    }
                }, {
                    key: 'addAnimationListeners',
                    value: function addAnimationListeners(type, index) {
                        var id = type + '_' + index;
                        var container = this.$$('#' + id);
                        var handler = this.repeatHandlers[id] || this.removeRepeatClass.bind(this, container);
                        this.repeatHandlers[id] = handler;

                        container.addEventListener('animationend', handler);
                        container.addEventListener('webkitAnimationEnd', handler);
                        return container;
                    }
                }, {
                    key: 'removeRepeatClass',
                    value: function removeRepeatClass(container) {
                        this.toggleClass('repeat', false, container);
                    }
                }, {
                    key: 'closeMessage',
                    value: function closeMessage(e) {
                        var type = e.model.__data__.messages.type;
                        var index = 0;
                        for (var i = 0; i < this.messagesModel.length; i++) {
                            if (this.messagesModel[i].type == type) {
                                delete this.repeatHandlers[type + '_' + index++];
                                this.splice('messagesModel', i, 1);
                                i--;
                            }
                        }
                        if (this.messagesModel.length == 0) {
                            this.hasMessages = false;
                            this.messages = undefined;
                        }
                    }
                }, {
                    key: 'behaviors',
                    get: function get() {
                        return [window.CommonBehaviors.DeviceBehavior];
                    }
                }, {
                    key: 'observers',
                    get: function get() {
                        return ['validation(messages)'];
                    }
                }]);

                return Toast;
            }());

            _export('Toast', Toast);

            Polymer(Toast);
        }
    };
});

'use strict';

System.register('common/forms/sb-checkbox/Checkbox.js', ['common/layout/fields/FieldHider.js'], function (_export, _context) {
	var FieldHider, _createClass, Checkbox;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutFieldsFieldHiderJs) {
			FieldHider = _commonLayoutFieldsFieldHiderJs.FieldHider;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Checkbox', Checkbox = function () {
				function Checkbox() {
					_classCallCheck(this, Checkbox);
				}

				_createClass(Checkbox, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-checkbox';
						this.properties = {
							focusOnAttached: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							value: {
								notify: true
							},
							hide: {
								type: Object,
								observer: 'hideShow'
							}
						};
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.$.checkbox.focus();
					}
				}, {
					key: 'blur',
					value: function blur() {
						this.fire('blur');
					}
				}, {
					key: 'hideShow',
					value: function hideShow() {
						var hider = new FieldHider(this.hide, Polymer.Base);
						hider.applyTo(this.$.checkbox);
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return Checkbox;
			}());

			_export('Checkbox', Checkbox);

			Polymer(Checkbox);
		}
	};
});

'use strict';

System.register('common/forms/sb-datepicker/Datepicker.js', ['common/core/AppContext.js', 'common/core/sb-i18n/I18n.js'], function (_export, _context) {
	var AppContext, I18n, _typeof, _createClass, Datepicker;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbI18nI18nJs) {
			I18n = _commonCoreSbI18nI18nJs.I18n;
		}],
		execute: function () {
			_typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
				return typeof obj;
			} : function (obj) {
				return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
			};

			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Datepicker', Datepicker = function (_AppContext) {
				_inherits(Datepicker, _AppContext);

				function Datepicker() {
					_classCallCheck(this, Datepicker);

					return _possibleConstructorReturn(this, (Datepicker.__proto__ || Object.getPrototypeOf(Datepicker)).apply(this, arguments));
				}

				_createClass(Datepicker, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-datepicker';

						this.properties = Polymer.Base.extend({
							selectedDate: {
								type: Date,
								value: null
							},
							isBlank: {
								type: Boolean,
								value: false
							},
							range: {
								type: Number,
								value: 30
							},
							focusOnAttached: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							i18n: {
								type: Object,
								value: function value() {
									return AppContext.properties.i18n.value();
								}
							}
						}, AppContext.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						var localeData = I18n.getLocaleData();
						this.isActive = false;

						this.weeks = [];
						this.weekDays = localeData && localeData.date ? localeData.date.calendars.gregory.days.short : ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
						this.months = localeData && localeData.date ? localeData.date.calendars.gregory.months.long : ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

						this.year = this.date.getFullYear();
						this.month = this.date.getMonth();
						this.monthName = this.months[this.month].toUpperCase();
						this.day = this.date.getDate();

						this.parseDateTimePattern();
					}
				}, {
					key: 'getDate',
					value: function getDate(date) {
						if ((typeof date === 'undefined' ? 'undefined' : _typeof(date)) != 'object') {
							return new Date(this.year, this.month, date);
						}
						return date.getDate();
					}
				}, {
					key: 'clearDate',
					value: function clearDate() {
						if (this.isBlank) {
							this.$.selectedDate = '';
							this.dateFormatted = '';
						}
					}
				}, {
					key: 'getClass',
					value: function getClass(day) {
						if ((typeof day === 'undefined' ? 'undefined' : _typeof(day)) != 'object') {
							day = new Date(this.year, this.month, day);
						}
						var className = '';
						if (day.getMonth() !== this.month) {
							className += 'notCurrent';
						} else {
							if (day.getFullYear() === this.date.getFullYear() && day.getMonth() === this.date.getMonth() && day.getDate() === this.date.getDate()) {
								className += 'selected';
							}
							if (day.getFullYear() === this.year && day.getMonth() === this.month && day.getDate() === this.date.getDate()) {
								className += ' current';
							}
						}
						return className;
					}
				}, {
					key: 'selectedDateChanged',
					value: function selectedDateChanged() {
						if (this.initialized || this.selectedDate) {
							this._selectedDateChanged(this.selectedDate, this.selectedDate == null);
							return;
						}
						if (this.isBlank) this._selectedDateChanged(new Date(), true, true);else {
							this.selectedDate = new Date();
							this._selectedDateChanged(this.selectedDate);
						}
						this.focus();
					}
				}, {
					key: '_selectedDateChanged',
					value: function _selectedDateChanged(selectedDate, isBlank, internal) {
						this.initialized = true;
						var dateObj = null;

						if (selectedDate && typeof selectedDate === 'string') {
							var pos = selectedDate.indexOf('T'),
							    ymd = void 0;
							if (pos < 0) {
								ymd = selectedDate.split('-');
							} else {
								var parts = selectedDate.split('T');
								ymd = parts[0].split('-');
							}
							if (ymd && ymd.length == 3) {
								dateObj = new Date(ymd[0], ymd[1] - 1, ymd[2]);
							}
						}

						if (!dateObj) {
							dateObj = selectedDate != null ? new Date(selectedDate) : new Date();
						}

						this.date = dateObj;
						this.updateVariables();

						if (!isBlank) try {
							this.dateFormatted = this.date.toLocaleDateString(this.user.locale);
						} catch (e) {
							this.dateFormatted = this.date.toLocaleDateString();
						}
						if (!internal) this.fire('selected-date-changed', { value: selectedDate });
					}
				}, {
					key: 'showCalendar',
					value: function showCalendar() {
						if (this.disabled) return;

						this.ensureProperYearInSelectedAndShowCalendar();
					}
				}, {
					key: 'ensureProperYearInSelectedAndShowCalendar',
					value: function ensureProperYearInSelectedAndShowCalendar() {
						if (this.year === this.date.getFullYear() && this.haveEnsured) this._showCalendar();

						this.haveEnsured = true;
						this.date.getFullYear();
						var years = [];
						var start = this.year - this.range;
						var end = this.year + this.range + 1;
						for (var i = start; i < end; i++) {
							years.push(i);
						}
						if (AppContext.isIE()) {
							if (!this.yearsCreated) {
								this.$.years.remove(0);
								for (var j = 0, len = years.length; j < len; j++) {
									this._createOptionElements(this.$.years, years[j]);
								}
								this.yearsCreated = true;
							}
						} else {
							this.years = years;
						}
						Polymer.RenderStatus.afterNextRender(this, function () {
							this.yearSelection = this.$.years;
							if (this.yearSelection.selectedOptions) {
								this.yearSelection.selectedOptions[0].selected = '';
							}
							this.yearSelection.options[this.range].selected = 'selected';
							this._showCalendar();
						}.bind(this));
					}
				}, {
					key: '_createOptionElements',
					value: function _createOptionElements(select, option) {
						var optionEl = document.createElement('option');
						optionEl.label = option;
						optionEl.value = option;
						select.appendChild(optionEl);
					}
				}, {
					key: '_showCalendar',
					value: function _showCalendar() {
						this.isActive = true;
						this.updateCalendar();
						this.focus();
						this.fire('datepicker-opened', { datepicker: this.$.datePicker, dateContainer: this.$.dateContainer });
					}
				}, {
					key: 'hideCalendar',
					value: function hideCalendar() {
						if (this.isActive) {
							this.isActive = false;
							this.focus();
						}
					}
				}, {
					key: 'findToday',
					value: function findToday() {
						this.selectedDate = new Date();
						this.updateYearPicklist();
						this.updateVariables();
						this.updateCalendar();
						this.focus();
					}
				}, {
					key: 'updateYearPicklist',
					value: function updateYearPicklist() {
						var options = this.yearSelection.options;
						for (var i = 0, l = options.length; i < l; i++) {
							options[i].selected = this.year == options[i].text;
						}
					}
				}, {
					key: 'changeYear',
					value: function changeYear() {
						var selectedYear = parseInt(this.yearSelection.selectedOptions[0].text);
						this.selectedDate = new Date(selectedYear, this.month, this.day);
						this.updateVariables();
						this.updateCalendar();
						this.focus();
					}
				}, {
					key: 'decreaseMonth',
					value: function decreaseMonth() {
						this.selectedDate = new Date(this.year, this.month - 1, this.day);
						this.updateVariables();
						this.updateCalendar();
					}
				}, {
					key: 'increaseMonth',
					value: function increaseMonth() {
						this.selectedDate = new Date(this.year, this.month + 1, this.day);
						this.updateVariables();
						this.updateCalendar();
					}
				}, {
					key: 'selectDay',
					value: function selectDay(e) {
						this.selectedDate = e.model ? e.model.day : this.date;
						this.hideCalendar();
					}
				}, {
					key: 'updateVariables',
					value: function updateVariables() {
						this.year = this.date.getFullYear();
						this.month = this.date.getMonth();
						this.monthName = this.months ? this.months[this.month].toUpperCase() : '';
						this.day = this.date.getDate();
					}
				}, {
					key: 'updateDate',
					value: function updateDate(increment) {
						this.date.setDate(this.date.getDate() + increment);
						this.updateVariables();
						this.updateCalendar();
					}
				}, {
					key: 'updateCalendar',
					value: function updateCalendar() {
						this.weeks = [];
						var firstDay = new Date(this.date.getFullYear(), this.month, 1);
						var index = firstDay.getDay();
						var numOfDays = 6 * 7;
						var week = [];
						var dayIdx = 0;
						for (var i = 0; i < numOfDays; i++) {
							var day = new Date(firstDay);
							day.setDate(firstDay.getDate() + (i - index));
							week[dayIdx] = day;
							dayIdx++;

							if ((i + 1) % 7 === 0 || i + 1 === numOfDays) {
								this.push('weeks', week);
								week = [];
								dayIdx = 0;
							}
						}
					}
				}, {
					key: 'parseDateTimePattern',
					value: function parseDateTimePattern() {
						var dateTimeFormat = I18n.getLocaleData() ? I18n.getLocaleData().date.formats.dateFormats.yMd : 'M/D/YY';

						var dateTimeFormatSimple = dateTimeFormat.replace(new RegExp('[dD]+'), 'D').replace(new RegExp('[mM]+'), 'M').replace(new RegExp('[yY]+'), 'Y');

						this.separator = dateTimeFormatSimple.match(new RegExp('[\/.-]'))[0];

						this.dateTimeElements = dateTimeFormatSimple.split(this.separator);
						this.dateIdx = this.dateTimeElements.indexOf('D');
						this.monthIdx = this.dateTimeElements.indexOf('M');
						this.yearIdx = this.dateTimeElements.indexOf('Y');
					}
				}, {
					key: 'validateInput',
					value: function validateInput() {
						if (this.noblur) return;

						var error = void 0;
						var invalid = false;
						var dateString = this.$.dateInput.value;
						var emptyDate = dateString.trim() === '';
						var localeDate = !emptyDate ? this.getLocaleDate() : '';
						var dateChanged = dateString !== localeDate;

						if (dateChanged) {
							invalid = true;

							var elements = dateString.split(this.separator),
							    day = elements[this.dateIdx],
							    month = elements[this.monthIdx],
							    year = elements[this.yearIdx];

							if (year && year.length == 4 && month && month.length > 0 && month.length <= 2 && day && day.length > 0 && day.length <= 2) {
								day = parseInt(day);
								month = parseInt(month);
								year = parseInt(year);

								if (elements.length && !isNaN(year) && !isNaN(month) && !isNaN(day)) {
									if (year >= this.year - this.range && year <= this.year + this.range) {
										if (month >= 1 && month <= 12) {
											var monthEnd = 31;
											if (month == 2) {
												monthEnd = 28;
												if (year % 4 == 0) {
													if (year % 100 != 0) {
														monthEnd = 29;
													} else {
														if (year % 400 == 0) {
															monthEnd = 29;
														}
													}
												}
											} else {
												if (month == 4 || month == 6 || month == 9 || month == 11) {
													monthEnd = 30;
												}
											}

											if (day >= 1 && day <= monthEnd) {
												invalid = false;
											}
										}
									}
								}

								if (!invalid) {
									this.selectedDate = new Date(year, month - 1, day);
									this.updateVariables();
								}
							}
							if (invalid) {
								error = this.i18n.l('Invalid Date.');
							}
						}
						var hasSelectedDate = _typeof(this.selectedDate) === 'object' || this.selectedDate.trim() !== '';
						if (emptyDate && hasSelectedDate) {
							this.dateFormatted = '';
							this.selectedDate = null;
						}

						this.invalidInput = invalid;
						this.fire('field-change-validated', { error: error });

						this.fire('sb-date-blur');
					}
				}, {
					key: 'navigate',
					value: function navigate(e) {
						if (e.keyCode === 9) {
							this.hideCalendar();
							return;
						}

						switch (e.keyCode) {
							case 13:
								if (this.isActive) this.selectDay(e);else this.validateInput();
								break;
							case 27:
								if (this.isActive) this.hideCalendar();else {
									this.escaped = true;
									this.fire('sb-date-esc', { keyCode: 27 });
								}
								break;
							case 37:
								this.updateDate(-1);
								break;
							case 38:
								this.updateDate(-7);
								break;
							case 39:
								this.updateDate(+1);
								break;
							case 40:
								if (!this.isActive) this.showCalendar();else this.updateDate(+7);
								break;
							default:
								break;
						}
					}
				}, {
					key: 'getLocaleDate',
					value: function getLocaleDate() {
						try {
							return this.date.toLocaleDateString(this.user.locale);
						} catch (e) {
							return this.date.toLocaleDateString();
						}
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.highlight();
						this.$.dateInput.focus();
					}
				}, {
					key: 'highlight',
					value: function highlight() {
						if (this.dateFormatted) this.$.dateInput.setSelectionRange(0, this.dateFormatted.length);
					}
				}, {
					key: 'preventBlur',
					value: function preventBlur() {
						this.noblur = true;
					}
				}, {
					key: 'allowBlur',
					value: function allowBlur() {
						this.noblur = false;
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.AppContext, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['selectedDateChanged(isBlank, selectedDate)'];
					}
				}]);

				return Datepicker;
			}(AppContext));

			_export('Datepicker', Datepicker);

			Polymer(Datepicker);
		}
	};
});

'use strict';

System.register('common/forms/sb-discount/Discount.js', ['common/forms/NumberParser.js'], function (_export, _context) {
	var NumberParser, _createClass, Discount;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsNumberParserJs) {
			NumberParser = _commonFormsNumberParserJs.NumberParser;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Discount', Discount = function () {
				function Discount() {
					_classCallCheck(this, Discount);
				}

				_createClass(Discount, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-discount';
						this.properties = {
							discountDetails: Object,
							focusOnAttached: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							unitChanged: Object,
							numberParser: {
								type: Object,
								value: function value() {
									return new NumberParser();
								}
							},
							formatter: Object,
							displayValue: String,
							original: Object
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						var input = this.$.discount.$.input;
						input.addEventListener('change', this.setDiscountValue.bind(this));
						input.addEventListener('focus', this.focused.bind(this));
						input.addEventListener('blur', this.deferBlur.bind(this));
						input.addEventListener('keydown', this.tabBlur.bind(this, true));

						var select = this.$.discountUnits.$.select;
						select.addEventListener('change', this.convertDiscountValue.bind(this));
						select.addEventListener('focus', this.focused.bind(this));
						select.addEventListener('blur', this.deferBlur.bind(this));
						select.addEventListener('keydown', this.tabBlur.bind(this, false));
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.$.discount.focus();
					}
				}, {
					key: 'focused',
					value: function focused() {
						if (this.blurred) clearTimeout(this.blurred);
					}
				}, {
					key: 'deferBlur',
					value: function deferBlur() {
						if (this.tabBlurred) this.tabBlurred = false;else {
							this.blurred = setTimeout(function () {
								this.blurDiscount(true);
							}.bind(this), 1);
						}
					}
				}, {
					key: 'tabBlur',
					value: function tabBlur(isInput, e) {
						if (e.keyCode === 27 && this.renderReadOnly) {
							this.resetToOriginal();
							return;
						}

						if (e.keyCode !== 9) return;

						this.tabBlurred = true;

						var blurDirection = isInput && e.shiftKey || !isInput && !e.shiftKey;
						if (blurDirection) this.blurDiscount(false);
					}
				}, {
					key: 'blurDiscount',
					value: function blurDiscount(directBlur) {
						if (directBlur) this._blur();else {
							setTimeout(function () {
								this._blur();
							}.bind(this), 10);
						}
					}
				}, {
					key: '_blur',
					value: function _blur() {
						var value = this.$.discount.value !== '' ? this.numberParser.parse(this.$.discount.value) : null;
						this.discountDetails.setDiscountValue(value);
						this.fire('sb-discount-blur');
					}
				}, {
					key: 'setDiscountValue',
					value: function setDiscountValue(e) {
						var oldValue = this.discountDetails.displayValue;

						var value = e.target.value !== '' ? this.numberParser.parse(e.target.value) : null;
						if (oldValue != value) {
							this.discountDetails.setDiscountValue(value);
							this.fire('sb-field-on-change-field');
						}
					}
				}, {
					key: 'convertDiscountValue',
					value: function convertDiscountValue(e) {
						this.discountDetails.convertDiscountValue(e.target.value);
						this.displayValue = undefined;
						this.displayValue = this.formatter.format(this.discountDetails.displayValue);
					}
				}, {
					key: 'resetToOriginal',
					value: function resetToOriginal() {
						this.setDiscountValue({ target: { value: this.original.label } });
						this.convertDiscountValue({ target: { value: this.original.unitValue } });
						this.setDiscountValue({ target: { value: this.original.label } });
						this.convertDiscountValue({ target: { value: this.original.unitValue } });
						this.selectUnit(this.discountDetails.unit);
					}
				}, {
					key: 'selectUnit',
					value: function selectUnit(value) {
						var select = this.$.discountUnits.$.select;
						var options = select.options;
						for (var i = 0, l = options.length; i < l; i++) {
							if (options[i].value === value) {
								select.selectedIndex = i;
								break;
							}
						}
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return Discount;
			}());

			_export('Discount', Discount);

			Polymer(Discount);
		}
	};
});

'use strict';

System.register('common/forms/sb-field/Field.js', ['common/core/AppContext.js', 'common/forms/NumberParser.js', 'common/forms/sb-field/factory/FieldFactory.js', 'common/forms/DependentPicklistBuilder.js'], function (_export, _context) {
	var AppContext, NumberParser, FieldFactory, DependentPicklistBuilder, _createClass, KEY_READ_ONLY, BLUR_READ_ONLY, CHANGE, HIDE_FIELD, REF_DISPLAY, APPLY_FOCUS, Field;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonFormsNumberParserJs) {
			NumberParser = _commonFormsNumberParserJs.NumberParser;
		}, function (_commonFormsSbFieldFactoryFieldFactoryJs) {
			FieldFactory = _commonFormsSbFieldFactoryFieldFactoryJs.FieldFactory;
		}, function (_commonFormsDependentPicklistBuilderJs) {
			DependentPicklistBuilder = _commonFormsDependentPicklistBuilderJs.DependentPicklistBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			KEY_READ_ONLY = 'keyReadOnly';
			BLUR_READ_ONLY = 'blurReadOnly';
			CHANGE = 'change';
			HIDE_FIELD = 'hideField';
			REF_DISPLAY = 'refDisplay';
			APPLY_FOCUS = 'applyFocus';

			_export('Field', Field = function (_AppContext) {
				_inherits(Field, _AppContext);

				function Field() {
					_classCallCheck(this, Field);

					return _possibleConstructorReturn(this, (Field.__proto__ || Object.getPrototypeOf(Field)).apply(this, arguments));
				}

				_createClass(Field, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-field';
						this.properties = Polymer.Base.extend({
							obj: Object,

							property: String,

							md: Object,
							type: {
								type: String,
								computed: 'getType(md)'
							},

							discountDetails: Object,

							refObjects: {
								type: Array,
								value: []
							},
							editing: {
								type: Boolean,
								value: false
							},
							_wasEverEditable: {
								type: Boolean,
								computed: '_setWasEverEditable(editing)'
							},
							disabled: {
								type: Boolean,
								value: false,
								observer: 'disabledChanged'
							},
							hidden: {
								type: Object,
								value: false,
								observer: 'hiddenChanged'
							},
							link: Boolean,
							value: {
								observer: 'valueChanged'
							},
							refDisplay: {
								type: String,
								notify: true
							},
							objAndRefObjects: Object,
							objKey: String,
							refObjectsKey: String,
							refTable: {
								type: String,
								computed: 'computeRefTable(md)'
							},
							readOnly: Boolean,
							renderReadOnly: {
								type: Boolean,
								value: false
							},
							formattedValue: Object,
							originalFormattedValue: String,
							tabindex: {
								type: Boolean,
								computed: 'setTabindex(renderReadOnly, editing, disabled, md)'
							},
							hideFormattedValue: {
								type: Boolean,
								value: false
							},
							focus: {
								type: Boolean,
								value: false,
								observer: 'applyFocus'
							},
							index: Number,
							recordId: {
								type: String,
								value: null,
								observer: 'recordIdChanged'
							},
							numberParser: {
								type: Object,
								value: function value() {
									return new NumberParser();
								}
							},
							preventNumericAlignment: {
								type: Boolean,
								value: false
							},
							signaler: Object,
							record: Object
						}, AppContext.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('sb-row-focus-signal', this.handleRowFocusSignal.bind(this));
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (typeof this.value === 'undefined') return;

						if (!this.property) return;

						if (this.obj) {
							if (this.isInternalObject) this.obj[this.property] = this.value;
							return;
						}

						var obj = {};
						this.isInternalObject = true;
						obj[this.property] = this.value;
						this.obj = obj;
					}
				}, {
					key: 'setObjAndRefObjects',
					value: function setObjAndRefObjects() {
						this.obj = undefined;
						this.refObjects = undefined;
						this.refObjects = this.objAndRefObjects[this.refObjectsKey];
						if (typeof this.refObjects === 'undefined') this.refObjects = {};
						if (this.objKey !== '') this.obj = this.objAndRefObjects[this.objKey];else this.obj = this.objAndRefObjects;
					}
				}, {
					key: 'render',
					value: function render() {
						this.rendered = true;
						if (this.isReadOnly()) {
							this.updateTemplateData();
							return;
						}
						this._render();
					}
				}, {
					key: '_render',
					value: function _render() {
						if (this.template) return;

						this.template = document.createElement('template', 'dom-bind');
						var ff = this.updateTemplateData();
						this.createBaseElement(ff.html);

						this.template[CHANGE] = this.onChange.bind(this);
						this.template[KEY_READ_ONLY] = this.onKeyupReadOnly.bind(this);
						this.template[BLUR_READ_ONLY] = this.onBlurReadOnly.bind(this);

						if (!this.isReadOnly()) this.hideFormattedValue = true;

						Polymer.dom(this.$.f).appendChild(this.template);
					}
				}, {
					key: '_setOriginalFormattedValue',
					value: function _setOriginalFormattedValue() {
						var formField = this.getFormField(this.originalValue);
						this.originalFormattedValue = this.getFormattedValue(formField, this.originalValue);
					}
				}, {
					key: 'onChange',
					value: function onChange(e) {
						this._onChange(e);
						this.fire('sb-field-on-change-field');
					}
				}, {
					key: '_onChange',
					value: function _onChange(e) {
						if (this.internal) return;

						var target = this.getEventTarget(e);
						var val = target.value !== undefined ? target.value : e.detail ? e.detail.value : null;
						this.refDisplay = target[REF_DISPLAY] !== undefined ? target[REF_DISPLAY] : e.detail && e.detail[REF_DISPLAY] !== undefined ? e.detail[REF_DISPLAY] : this.refDisplay;

						if (this.isNumericType()) {
							if (val && val !== 0) {
								val = this.numberParser.parse(val);
							} else {
								val = null;
							}
						} else if (this.getType() === 'date' && val instanceof Date) {
							var month = val.getMonth() + 1;
							month = month < 10 ? '0' + month : month;
							var date = val.getDate();
							date = date < 10 ? '0' + date : date;
							val = val.getFullYear() + '-' + month + '-' + date;
						} else if (val instanceof Date) {
							val = val.toISOString();
						}

						this.internal = true;
						this.obj[this.property] = val;
						this.domHost.value = val;
						this.internal = false;
						this.fireCustomChangeEvents(e);
					}
				}, {
					key: 'fireCustomChangeEvents',
					value: function fireCustomChangeEvents(e) {
						if (this.md && e.detail) this.fireControllingSelectChangeEvent();
					}
				}, {
					key: 'fireControllingSelectChangeEvent',
					value: function fireControllingSelectChangeEvent() {
						var data = { tableName: this.md.tableName, fieldName: this.md.name, record: this.record };
						var signal = new CustomEvent('sb-controlling-select-changed', { bubbles: false, detail: data });
						document.dispatchEvent(signal);
					}
				}, {
					key: 'onKeyupReadOnly',
					value: function onKeyupReadOnly(e) {
						var keyCode = e.keyCode || e.detail.keyCode;
						if (keyCode !== 27) return;

						this.onBlurReadOnly(false);
					}
				}, {
					key: 'onBlurReadOnly',
					value: function onBlurReadOnly(keepNewValue) {
						if (!this.isReadOnly()) return;

						if (this.template[HIDE_FIELD]) return;

						if (keepNewValue) {
							this.setPreviouslyFormattedValue();
							this.updateTemplateData();
						} else {
							var data = { target: { value: this.previouslyFormatted ? this.previouslyFormatted.value : this.formattedValue.value } };
							if (this.isLookup()) data.target[REF_DISPLAY] = this.previouslyFormatted ? this.previouslyFormatted.label : this.formattedValue.label;
							this._onChange(data);
							this.updateTemplateData();
						}

						this.template[HIDE_FIELD] = true;
						this.hideFormattedValue = false;

						if (this.renderReadOnly) this.enableSignals();
					}
				}, {
					key: 'updateTemplateData',
					value: function updateTemplateData() {
						var value = this.obj[this.property];
						var formField = this.getFormField(value);

						if (formField.defaultValue && this.template) this._onChange({ target: { value: formField.defaultValue } });

						this.formattedValue = this.getFormattedValue(formField, value);
						this.originalFormattedValue = this.originalFormattedValue || this.formattedValue;
						this.addFormattedValueClasses(formField.numeric);

						if (this.isReadOnly()) this.setFormattedDetails();

						if (!this.template) return;

						formField.attachTo(this.template, KEY_READ_ONLY, BLUR_READ_ONLY, CHANGE, HIDE_FIELD, this.renderReadOnly);
						return formField;
					}
				}, {
					key: 'getFormField',
					value: function getFormField(value) {
						var editable = this.isEditable(true);
						var selectOptions = this.getSelectOptions();
						var referenceDetails = { refDisplay: this.refDisplay, refDisplayName: REF_DISPLAY, refTable: this.refTable, refObjects: this.refObjects, property: this.property, obj: this.obj, record: this.record };
						var factory = new FieldFactory(value, editable, this.disabled, this.hidden, this.index, this.md, this.i18n, this.renderReadOnly, selectOptions, referenceDetails, this.discountDetails, this.preventNumericAlignment);
						return factory.newFormField(this.type);
					}
				}, {
					key: 'getFormattedValue',
					value: function getFormattedValue(formField, value) {
						return formField.formattedValue || { value: value, label: value };
					}
				}, {
					key: 'addFormattedValueClasses',
					value: function addFormattedValueClasses(numeric) {
						var editable = this.isEditable();
						this.toggleClass('editable', editable, this.$.formatted);
						this.toggleClass('numericField', !this.preventNumericAlignment && numeric, this.$.formatted);
						this.toggleClass('firstField', this.index == 0, this.$.formatted);
						this.toggleClass('readOnly', this.readOnly, this.$.formatted);

						this.isDirty = editable && this.formattedValue.value !== this.originalFormattedValue.value && !(this.isNil(this.formattedValue.value) && this.isNil(this.originalFormattedValue.value));
						this.toggleClass('dirty', this.isDirty, this.$.formatted);

						var isBool = this.isBoolean();
						var isEmpty = !isBool && (this.formattedValue.value === false || this.isNil(this.formattedValue.label) && this.formattedValue.value !== true);
						this.toggleClass('empty', isEmpty, this.$.formatted);
						this.toggleClass('empty', isEmpty, this.$.formatted.$.me);

						this.toggleClass('link', this.link, this.$.formatted);
						this.toggleClass('link', this.link, this.$.formatted.$.me);

						this.toggleClass('boolean', isBool, this.$.formatted);
					}
				}, {
					key: 'signalRowFocus',
					value: function signalRowFocus() {
						if (this.signaler) {
							this.signaler.fireSignal('sb-row-focus-signal', true);
							setTimeout(function () {
								this.signaler.disable();
							}.bind(this), 20);
						}
					}
				}, {
					key: 'enableSignals',
					value: function enableSignals() {
						if (this.signaler) this.signaler.enable();
					}
				}, {
					key: 'handleRowFocusSignal',
					value: function handleRowFocusSignal(signal) {
						if (!this.signaler) return;

						this.signaler.toggleRowFocus(signal);
						if (this.isEditable()) this.toggleClass('show', signal.detail.focused, this.$.formatted);
					}
				}, {
					key: 'createBaseElement',
					value: function createBaseElement(html) {
						var d = this.template.content.ownerDocument.createElement('div');
						d.innerHTML = html;
						var el = Polymer.dom(d).firstChild;
						Polymer.dom(this.template.content).appendChild(el);
					}
				}, {
					key: 'isNumericType',
					value: function isNumericType() {
						switch (this.type) {
							case 'double':
							case 'number':
							case 'currency':
							case 'percent':
								return true;
						}
						return false;
					}
				}, {
					key: 'getType',
					value: function getType() {
						return this.md && this.md.type ? this.md.type.toLowerCase() : '';
					}
				}, {
					key: 'valueChanged',
					value: function valueChanged() {
						if (this.value === undefined && this.isBoolean()) return;

						if (!this.rendered) {
							this.attached();
							return;
						}

						if (this.internal && this.template) this.template.value = this.value;else this.obj[this.property] = this.value;

						this.setPreviouslyFormattedValue();
						this.updateTemplateData();
					}
				}, {
					key: 'setPreviouslyFormattedValue',
					value: function setPreviouslyFormattedValue() {
						this.previouslyFormatted = this.formattedValue === undefined ? null : JSON.parse(JSON.stringify(this.formattedValue));
					}
				}, {
					key: 'disabledChanged',
					value: function disabledChanged() {
						this.toggleClass('disabled', this.disabled, this.$.formatted);
						if (this.template) this.template.disabled = this.disabled;

						if (this.renderReadOnly && this.editing) this.updateTemplateData();
					}
				}, {
					key: 'hiddenChanged',
					value: function hiddenChanged() {
						if (!this.template) return;

						this.template.hide = this.hidden;
					}
				}, {
					key: 'recordIdChanged',
					value: function recordIdChanged() {
						if (!this.template) return;

						this.template.recordId = this.recordId;
					}
				}, {
					key: 'recordChanged',
					value: function recordChanged(e) {
						if (!this.template || !e || !e.path || e.path === 'record') return;

						this.template.set(e.path, e.value);
					}
				}, {
					key: 'computeRefTable',
					value: function computeRefTable() {
						if (this.md === undefined) {
							return;
						}
						if (this.md.referenceTable) return this.md.referenceTable;

						return this.md.referenceTo && this.md.referenceTo.length > 0 ? this.md.referenceTo[0] : null;
					}
				}, {
					key: 'setTabindex',
					value: function setTabindex() {
						if (this.md.extraTypeInfo === 'richtextarea') {
							return -1;
						}
						return this.renderReadOnly && this.isEditable() ? 0 : -1;
					}
				}, {
					key: 'linkOrEdit',
					value: function linkOrEdit(e) {
						if (this.link) this.fire('sb-link-tapped', { value: this.value, Id: this.recordId });else this.edit(e, true);
					}
				}, {
					key: 'edit',
					value: function edit(e, clickEdit) {
						if (!this.isEditable()) return;

						this._render();
						this.hideFormattedValue = true;
						this.template[HIDE_FIELD] = false;
						if (this.template._nodes && this.template._nodes[0].focus) this.template._nodes[0].focus();

						if (clickEdit) this.invertValueIfInlineBoolean();

						if (this.renderReadOnly) this.signalRowFocus();
					}
				}, {
					key: 'getEventTarget',
					value: function getEventTarget(e) {
						try {
							return Polymer.dom(e).localTarget || e.target;
						} catch (ex) {
							return e.target;
						}
					}
				}, {
					key: 'isNil',
					value: function isNil(value) {
						return value === undefined || value === null || value === '' || typeof value === 'number' && value + '' === 'NaN';
					}
				}, {
					key: 'applyFocus',
					value: function applyFocus() {
						if (this.template) this.template[APPLY_FOCUS] = this.focus;
					}
				}, {
					key: 'isEditable',
					value: function isEditable(returnTrueIfEverEditable) {
						if (returnTrueIfEverEditable && this._wasEverEditable) return true;

						return this.readOnly || this.renderReadOnly && this.disabled ? false : this.editing;
					}
				}, {
					key: 'isReadOnly',
					value: function isReadOnly() {
						return this.readOnly || this.renderReadOnly;
					}
				}, {
					key: 'setFormattedDetails',
					value: function setFormattedDetails() {
						this.$.formatted.isDirty = undefined;
						this.$.formatted.link = !!this.link;
						this.$.formatted.type = this.type;
						this.$.formatted.booleanValue = this.isBoolean() ? this.obj[this.property] : null;
						this.$.formatted.isDirty = this.isDirty;
					}
				}, {
					key: 'isBoolean',
					value: function isBoolean() {
						return this.type === 'boolean' || this.type === 'checkbox';
					}
				}, {
					key: 'isLookup',
					value: function isLookup() {
						return this.type === 'id' || this.type === 'reference';
					}
				}, {
					key: 'addControlledSelectListener',
					value: function addControlledSelectListener() {
						if (this.md && this.md.controllerName) document.addEventListener('sb-controlling-select-changed', this.controllerSelectHandler.bind(this));
					}
				}, {
					key: 'controllerSelectHandler',
					value: function controllerSelectHandler(e) {
						var tableName = e.detail.tableName;
						var fieldName = e.detail.fieldName;
						var record = e.detail.record;

						var sameRecord = typeof this.record.equals === 'function' && record ? this.record.equals(record) : this.record === record;
						if (tableName !== this.md.tableName || this.md.controllerName !== fieldName || !sameRecord) return;
						var valueCleared = this.buildSelectOptions(true);

						if (!valueCleared) this.updateTemplateData();
					}
				}, {
					key: 'getSelectOptions',
					value: function getSelectOptions() {
						if (this._selectOptions) return this._selectOptions;

						this.buildSelectOptions();
						return this._selectOptions;
					}
				}, {
					key: 'buildSelectOptions',
					value: function buildSelectOptions(clearInvalidValue) {
						if (!this.md.controllerName || !this.record) {
							this._selectOptions = this.md.picklistValues;
							return false;
						}

						var value = typeof this.record.getValue === 'function' ? this.record.getValue(this.md.controllerName) : this.record[this.md.controllerName];
						this._selectOptions = new DependentPicklistBuilder(this.md, value).build();
						if (clearInvalidValue) return this.clearValueIfNotAnOption(this._selectOptions);

						return false;
					}
				}, {
					key: 'clearValueIfNotAnOption',
					value: function clearValueIfNotAnOption(options) {
						if (this.value === null) return false;

						var clearValue = true;
						options.forEach(function (option) {
							if (option.value == this.value) {
								clearValue = false;
							}
						}.bind(this));

						if (!clearValue) return false;

						if (typeof this.record.setValue === 'function') this.record.setValue(this.property, null);else this.record[this.property] = null;

						this.onChange({ target: { value: null } });
						return true;
					}
				}, {
					key: 'invertValueIfInlineBoolean',
					value: function invertValueIfInlineBoolean() {
						if (this.renderReadOnly && this.isBoolean()) {
							this.value = undefined;
							this.value = !this.obj[this.property];
							this.internal = true;
							this.domHost.value = this.value;
							this.internal = false;
							this.fire('sb-field-on-change-field');
						}
					}
				}, {
					key: '_setWasEverEditable',
					value: function _setWasEverEditable() {
						return this._wasEverEditable || this.editing;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.AppContext, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['render(obj, property, md, refObjects, editing, renderReadOnly)', 'setObjAndRefObjects(objAndRefObjects, objKey, refObjectsKey)', '_setOriginalFormattedValue(originalValue, md)', 'addControlledSelectListener(md)', 'recordChanged(record.*)'];
					}
				}]);

				return Field;
			}(AppContext));

			_export('Field', Field);

			Polymer(Field);
		}
	};
});

'use strict';

System.register('common/forms/sb-input/Input.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, Input;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Input', Input = function () {
				function Input() {
					_classCallCheck(this, Input);
				}

				_createClass(Input, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-input';
						this.properties = {
							value: {
								type: String,
								observer: 'changed'
							},
							focusOnAttached: Boolean,
							inputType: {
								type: String,
								value: 'text'
							},
							renderReadOnly: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							showClear: {
								type: Boolean,
								computed: '_showClear(viewport, inputType, disabled)'
							},
							disabled: {
								type: Boolean,
								value: false
							},
							focused: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'hideClearIfEmpty',
					value: function hideClearIfEmpty() {
						if (!this.showClear) return;
						if (!this.$$('#clear')) {
							Polymer.RenderStatus.afterNextRender(this, function () {
								this._hideClearIfEmpty();
							}.bind(this));
						} else this._hideClearIfEmpty();
					}
				}, {
					key: '_hideClearIfEmpty',
					value: function _hideClearIfEmpty() {
						this.toggleClass('hide', this.focused || this.value == null || this.value === '', this.$$('#clear'));
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.$.input.focus();
					}
				}, {
					key: 'blur',
					value: function blur() {
						this.fireChangeOnBlur();
						this.fire('blur');
						this.focused = false;
					}
				}, {
					key: 'clear',
					value: function clear() {
						this.value = null;
						this.$.input.blur();
					}
				}, {
					key: 'highlight',
					value: function highlight() {
						this.focused = true;
						if (this.viewport && this.viewport.isMobile()) return;
						var length = this.value ? this.value.length : 0;
						this.$.input.setSelectionRange(0, length);
					}
				}, {
					key: 'changed',
					value: function changed(newValue, oldValue) {
						if (oldValue === undefined) {
							this.changeOnNextBlur = true;
							return;
						}

						this.changeOnNextBlur = false;
						if (oldValue == newValue) return;

						this.fireChangeEvent(newValue);
					}
				}, {
					key: 'fireChangeEvent',
					value: function fireChangeEvent(value) {
						this.fire('change', { value: value });
					}
				}, {
					key: 'fireChangeOnBlur',
					value: function fireChangeOnBlur() {
						if (!this.changeOnNextBlur) return;

						this.fireChangeEvent(this.value);
						this.changeOnNextBlur = false;
					}
				}, {
					key: 'propagateEsc',
					value: function propagateEsc(e) {
						if (e.keyCode !== 27) return;

						if (this.renderReadOnly) this.$.input.value = this.value;

						this.fire('sb-input-key', { keyCode: 27 });
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: '_showClear',
					value: function _showClear() {
						return this.viewport && this.viewport.isMobile() && !this.disabled && this.inputType !== 'date' && this.inputType !== 'datetime';
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['hideClearIfEmpty(value, showClear, focused)'];
					}
				}]);

				return Input;
			}());

			_export('Input', Input);

			Polymer(Input);
		}
	};
});

'use strict';

System.register('common/forms/sb-lookup/Lookup.js', ['common/core/AppContext.js', 'common/forms/sb-lookup/map/LookupNameMapper.js', 'common/core/sb-page-container/PageContainer.js', 'common/forms/sb-lookup/query/LookupQueryBuilder.js'], function (_export, _context) {
	var AppContext, LookupNameMapper, PageContainer, LookupQueryBuilder, _createClass, Lookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonFormsSbLookupMapLookupNameMapperJs) {
			LookupNameMapper = _commonFormsSbLookupMapLookupNameMapperJs.LookupNameMapper;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonFormsSbLookupQueryLookupQueryBuilderJs) {
			LookupQueryBuilder = _commonFormsSbLookupQueryLookupQueryBuilderJs.LookupQueryBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Lookup', Lookup = function () {
				function Lookup() {
					_classCallCheck(this, Lookup);
				}

				_createClass(Lookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-lookup';
						this.properties = {
							tableName: {
								type: String,
								observer: 'initTableLabel'
							},
							limit: {
								type: Number,
								value: 5
							},
							value: {
								type: String,
								value: null
							},
							label: {
								type: String,
								value: null
							},
							disabled: {
								type: Boolean,
								value: false
							},
							labelName: {
								type: String,
								value: 'label'
							},
							selectedLabel: {
								type: String,
								computed: 'getSelectedLabel(tableName)'
							},
							menuItemLabels: {
								type: Array,
								value: null
							},
							lookupCallback: {
								type: Function,
								value: function value() {
									return this.lookupResultsCallback.bind(this);
								}
							},
							hideInputAndShowPill: {
								type: Boolean,
								value: false
							},
							hideCancelIcon: {
								type: Boolean,
								value: true
							},
							i18n: {
								type: Object,
								value: function value() {
									return AppContext.properties.i18n.value();
								}
							},
							inDialog: {
								type: Boolean,
								value: false
							},
							blurDisabled: {
								type: Boolean,
								value: false
							},
							focusDisabled: {
								type: Boolean,
								value: false
							},
							tableLabel: {
								type: String,
								value: ''
							},
							placeholder: {
								type: String,
								value: null
							},
							labels: {
								type: Array,
								computed: 'getLabels(selectedLabel, menuItemLabels)'
							},
							searchText: {
								type: String,
								computed: 'getSearchText(placeholder, tableLabel, i18n)'
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							showSearchIcon: {
								type: Boolean,
								computed: 'showSearch(viewport, inDialog)'
							},
							mobile: {
								type: Boolean,
								computed: 'isMobile(viewport)'
							},
							fieldFullName: String,
							hasFilter: {
								type: Boolean,
								value: false
							},
							currentRecordFilters: {
								type: Object,
								observer: 'executeDeferredLookupQuery'
							},
							record: Object,
							deferredLookupQuery: Object
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.object.addEventListener('describe-changed', this.setTableLabel.bind(this));
						this.$.typeahead.addEventListener('enter-without-selection', this.handleEnterPressed.bind(this));
						this.$.field.addEventListener('response-changed', this.initCurrentRecordFilters.bind(this));
						this.$.fields.addEventListener('md-changed', this.setCurrentRecordFilters.bind(this));
					}
				}, {
					key: 'initFilterMetadata',
					value: function initFilterMetadata() {
						if (this.currentRecordFilters || this.internal) return;

						if (this.hasFilter && !AppContext.org.isOAuth) this.disableFilterAndWarnNoOAuth();

						if (this.hasFilter && this.fieldFullName) this.$.field.mdItems = [this.fieldFullName];else this.currentRecordFilters = {};
					}
				}, {
					key: 'initTableLabel',
					value: function initTableLabel() {
						if (this.tableName) this.$.object.objects = [this.tableName];
					}
				}, {
					key: 'setTableLabel',
					value: function setTableLabel(e) {
						this.tableLabel = e.detail.value.md[this.tableName].labelPlural;
					}
				}, {
					key: 'setCallback',
					value: function setCallback() {
						this.lookupCallback = this.customCallback.bind(this);
					}
				}, {
					key: 'lookupResultsCallback',
					value: function lookupResultsCallback(searchValue) {
						return new Promise(function (resolve, reject) {
							if (!this.tableName) {
								resolve([]);
								return;
							}
							if (this.currentRecordFilters) {
								this.queryLookupResults(searchValue, resolve, reject);
								return;
							}
							this.deferredLookupQuery = this.queryLookupResults.bind(this, searchValue, resolve, reject);
						}.bind(this));
					}
				}, {
					key: 'queryLookupResults',
					value: function queryLookupResults(searchValue, resolve, reject) {
						var queryBuilder = new LookupQueryBuilder(this.tableName, this.selectedLabel, this.hasFilter, this.fieldFullName, this.limit, this.currentRecordFilters, this.record, true);
						var soql = queryBuilder.build(searchValue);
						this.$.q.query({ soql: soql, version: AppContext.apiVersionString }).then(function (response) {
							var records = response.records;
							var searchText = searchValue == null ? '' : searchValue;
							var search = { Id: '', __md__: { class: 'search', searchValue: searchText, clearAfterSelection: !this.inDialog, noFocusAfterSelection: this.inDialog } };
							var tableLabel = this.tableLabel;
							if (!tableLabel) {
								var tableParts = this.tableName.split('__');
								var tableLabelPartIndex = tableParts.length > 1 ? tableParts.length - 2 : 0;
								tableLabel = tableParts[tableLabelPartIndex];
							}

							if (this.isMobile()) {
								search[this.selectedLabel] = searchText ? this.i18n.l('"{0}"', [searchText]) : '';
								records.push(search);
							} else {
								var searchLabel = searchText ? '"{0}" in {1}' : ' in {1}';
								search[this.selectedLabel] = this.i18n.l(searchLabel, [searchText, tableLabel]);
								records = [search].concat(records);
							}
							if (this.inDialog && this.isMobile()) this.domHost.handleSearchResults(this.limit, { records: records, totalSize: response.totalSize });else resolve(records);
						}.bind(this), function (error) {
							if (error && (error.message === 'The requested resource does not exist' || error.message === 'bind is not supported for this organization.')) {
								AppContext.apiVersion = 36;
								if (Object.keys(this.currentRecordFilters).length > 0) this.disableFilterAndWarnCurrentRecordFiltersNotSupported();
								this.queryLookupResults(searchValue, resolve, reject);
							} else {
								var errorMessage = 'SOQL Execution Error: ' + soql + ' (' + (error && error.message ? error.message : error) + ')';
								reject(errorMessage);
							}
						}.bind(this));
					}
				}, {
					key: 'setLabel',
					value: function setLabel() {
						this._setLabel();
						if (this.value != null && this.selectedLabel != null) this.setSelectedItem();
					}
				}, {
					key: 'setSelectedItem',
					value: function setSelectedItem() {
						if (this.internal) return;

						if (this.label == null) return;

						var label = this.getLabel();
						var selectedItem = { Id: this.value };
						selectedItem[this.selectedLabel] = label;
						this.$.typeahead.items = this.$.typeahead.items || [selectedItem];
						this.$.typeahead.selectedItem = selectedItem;
						this.setHideInputAndShowPill(this.value);

						this.focus();

						if (!this._handleSelectedItemChanged) {
							this._handleSelectedItemChanged = this.handleSelectedItemChanged.bind(this);
							this.$.typeahead.addEventListener('selected-item-changed', this._handleSelectedItemChanged);
						}
					}
				}, {
					key: 'handleSelectedItemChanged',
					value: function handleSelectedItemChanged(e) {
						if (e.detail.path || e.detail.value == '') return;

						var md = e.detail.value.__md__;
						var searchValue = md && md.searchValue !== undefined ? md.searchValue : undefined;
						if (searchValue !== undefined) {
							this.applySearchValue(searchValue);
							return;
						}

						this.setHideInputAndShowPill(e.detail.value.Id);
						this.focus();

						this.internal = true;
						this.value = e.detail.value.Id || null;
						this.label = e.detail.value[this.selectedLabel] || '';
						this.internal = false;

						this._setLabel();
						this.fireLookupValueChanged(this.value, this.label, e.detail.value);
					}
				}, {
					key: 'applySearchValue',
					value: function applySearchValue(searchValue) {
						if (searchValue && searchValue.detail) searchValue = searchValue.detail.value;

						if (this.inDialog) {
							this.domHost.searchValue = searchValue;
							this.domHost.querySearchResults();
						} else this.fire('iron-signal', { name: 'sb-open-lookup-dialog', data: {
									lookup: this,
									searchValue: searchValue
								} });
					}
				}, {
					key: 'handleEnterPressed',
					value: function handleEnterPressed(e) {
						if (this.currentRecordFilters) this.applySearchValue(e.detail.value);
					}
				}, {
					key: 'fireLookupValueChanged',
					value: function fireLookupValueChanged(value, label, obj) {
						var data = {
							value: value,
							obj: obj
						};
						data[this.labelName] = label;
						this.fire('lookup-value-changed', data);
					}
				}, {
					key: 'focus',
					value: function focus(forceSuggest) {
						if (this.isMobile()) return;
						if (!this.hideInputAndShowPill) {
							this.$.typeahead.focus(forceSuggest || this.forceSuggest);
							this.forceSuggest = false;
						} else if (!this.focusDisabled) this.$.container.focus();
					}
				}, {
					key: 'getLabel',
					value: function getLabel() {
						this.labelsByValue = this.labelsByValue || {};
						var label = this.labelsByValue[this.value ? this.value.substring(0, 15) : this.value];
						if (this.value && !label) {
							this.labelsByValue[this.value ? this.value.substring(0, 15) : this.value] = this.label;
							label = this.label;
						}
						return label;
					}
				}, {
					key: '_setLabel',
					value: function _setLabel() {
						this.labelsByValue = this.labelsByValue || {};
						this.labelsByValue[this.value ? this.value.substring(0, 15) : this.value] = this.label;
					}
				}, {
					key: 'setHideInputAndShowPill',
					value: function setHideInputAndShowPill(value) {
						this.hideInputAndShowPill = !this.isMobile() && !this.isNil(value) && !this.clearAfterSelection;
					}
				}, {
					key: 'blurContainer',
					value: function blurContainer() {
						if (this.hideInputAndShowPill && !this.blurDisabled) this.blur();
					}
				}, {
					key: 'blur',
					value: function blur() {
						this.$.typeahead.setOriginalSelected();
						this.fire('sb-type-blur');
					}
				}, {
					key: 'propagateEscOrHandleDelete',
					value: function propagateEscOrHandleDelete(e) {
						if (e.keyCode === 27) this.$.typeahead.suggest(e);else if (e.keyCode === 8) {
							this.deletePill();
							this.blurDisabled = !!this.previousBlurDisabled;
						}
					}
				}, {
					key: 'preventBlurOnDelete',
					value: function preventBlurOnDelete(e) {
						this.previousBlurDisabled = this.blurDisabled;
						if (e.keyCode === 8) this.blurDisabled = true;
					}
				}, {
					key: 'preventBlur',
					value: function preventBlur() {
						this.previousBlurDisabled = this.blurDisabled;
						this.blurDisabled = true;
					}
				}, {
					key: 'deletePill',
					value: function deletePill() {
						if (!this.disabled) this.$.typeahead.clear();
						this.blurDisabled = this.previousBlurDisabled;
					}
				}, {
					key: 'isNil',
					value: function isNil(value) {
						return value === undefined || value === null || value === '';
					}
				}, {
					key: 'dialogOpened',
					value: function dialogOpened() {
						this.blurDisabled = true;
						this.focusDisabled = true;
					}
				}, {
					key: 'dialogClosed',
					value: function dialogClosed() {
						this.blurDisabled = false;
						this.focusDisabled = false;
						this.focus(true);
					}
				}, {
					key: 'getSelectedLabel',
					value: function getSelectedLabel() {
						return new LookupNameMapper(this.tableName).getNameField();
					}
				}, {
					key: 'getLabels',
					value: function getLabels() {
						return this.menuItemLabels || [this.selectedLabel];
					}
				}, {
					key: 'getSearchText',
					value: function getSearchText() {
						return this.placeholder || this.buildSearchText();
					}
				}, {
					key: 'buildSearchText',
					value: function buildSearchText() {
						if (this.i18n && typeof this.i18n.l === 'function') return this.i18n.l('Search {0}', [this.tableLabel]);
						return 'Search ' + this.tableLabel;
					}
				}, {
					key: 'handleMobileEvents',
					value: function handleMobileEvents() {
						if (!this.isMobile()) return;

						if (this.inDialog) {
							this._clearAndSave = this._clearAndSave || (this.domHost.clearAndSave ? this.domHost.clearAndSave.bind(this.domHost) : null);
							if (this._clearAndSave) {
								this.$.typeahead.removeEventListener('sb-type-clear', this._clearAndSave);
								this.$.typeahead.addEventListener('sb-type-clear', this._clearAndSave);
							}
						} else {
							this._applySearchValue = this._applySearchValue || this.applySearchValue.bind(this);
							this.$.typeahead.removeEventListener('sb-type-focus', this._applySearchValue);
							this.$.typeahead.addEventListener('sb-type-focus', this._applySearchValue);
						}
					}
				}, {
					key: 'showSearch',
					value: function showSearch() {
						return this.isMobile() && !this.inDialog;
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'initCurrentRecordFilters',
					value: function initCurrentRecordFilters(e) {
						var currentRecordFilters = [];
						var filterItems = e.detail.value[0].lookupFilter.filterItems;
						var filterItemsArray = filterItems.constructor === Array ? filterItems : [filterItems];
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = filterItemsArray[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var filterItem = _step.value;

								if (filterItem.field.indexOf('$Source.') === 0) {
									var field = filterItem.field.split('.')[1];
									if (currentRecordFilters.indexOf(field) === -1) currentRecordFilters.push(field);
								}
								if (filterItem.valueField != null && filterItem.valueField.indexOf('$Source.') === 0) {
									var _field = filterItem.valueField.split('.')[1];
									if (currentRecordFilters.indexOf(_field) === -1) currentRecordFilters.push(_field);
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						if (currentRecordFilters.length == 0) {
							this.currentRecordFilters = {};
							return;
						}

						var lookupFieldTable = this.fieldFullName.split('.')[0];
						var fields = [];
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = currentRecordFilters[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var f = _step2.value;

								fields.push(lookupFieldTable + '.' + f);
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						this.$.fields.fields = fields;
					}
				}, {
					key: 'setCurrentRecordFilters',
					value: function setCurrentRecordFilters(e) {
						var currentRecordFilters = {};
						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = e.detail.value.fields[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var field = _step3.value;

								currentRecordFilters[field.name] = field.type;
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						this.currentRecordFilters = currentRecordFilters;
					}
				}, {
					key: 'executeDeferredLookupQuery',
					value: function executeDeferredLookupQuery() {
						if (!this.currentRecordFilters) return;

						if (Object.keys(this.currentRecordFilters).length > 0 && AppContext.version < 39) this.disableFilterAndWarnCurrentRecordFiltersNotSupported();

						if (this.deferredLookupQuery) {
							this.deferredLookupQuery();
							this.deferredLookupQuery = null;
						}
					}
				}, {
					key: 'disableFilterAndWarnCurrentRecordFiltersNotSupported',
					value: function disableFilterAndWarnCurrentRecordFiltersNotSupported() {
						this.internal = true;
						this.hasFilter = false;
						if (this.inDialog && this.domHost) this.domHost.hasFilter = false;
						this.internal = false;

						if (this.currentRecordFilterWarning) return;

						this.currentRecordFilterWarning = 'Lookup fields that contain \'Current Record\' filter conditions will not have any of its filters applied in the CPQ app until this org upgrades to the Spring 17\' release.\n';
						this.currentRecordFilterWarning += 'The lookup field ' + this.fieldFullName + ' contains the following \'Current Record\' field(s) as part of its filter definition: ' + Object.keys(this.currentRecordFilters).join() + '.';
						console.warn(this.currentRecordFilterWarning);
					}
				}, {
					key: 'disableFilterAndWarnNoOAuth',
					value: function disableFilterAndWarnNoOAuth() {
						this.internal = true;
						this.hasFilter = false;
						this.internal = false;

						if (this.oauthWarning) return;

						this.oauthWarning = 'Lookup fields that contain filter conditions will not work in the CPQ app until the org has been OAuth authorized by a System Administrator.\n';
						this.oauthWarning += 'Navigate to Editor Settings > Documents > Mass Document User Name > Request Authorization to authorize';
						console.warn(this.oauthWarning);
					}
				}, {
					key: 'setForceSuggest',
					value: function setForceSuggest(e) {
						if (this.forceSuggest) return;

						if (!e || !e.path || e.path === 'record') return;

						if (!this.hasFilter) return;

						var currentRecordFiltersKeys = this.currentRecordFilters ? Object.keys(this.currentRecordFilters) : [];
						if (currentRecordFiltersKeys.length === 0) return;

						var parts = e.path.split('.');
						var property = parts[parts.length - 1];
						if (currentRecordFiltersKeys.indexOf(property) === -1) return;

						this.forceSuggest = true;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setSelectedItem(value, selectedLabel)', 'setLabel(label)', 'setCallback(customCallback)', 'handleMobileEvents(viewport, inDialog)', 'initFilterMetadata(fieldFullName, hasFilter)', 'setForceSuggest(record.*)'];
					}
				}]);

				return Lookup;
			}());

			_export('Lookup', Lookup);

			Polymer(Lookup);
		}
	};
});

'use strict';

System.register('common/forms/sb-lookup-dialog/LookupDialog.js', ['common/layout/tables/TableClassBuilder.js', 'common/core/AppContext.js', 'common/core/sb-page-container/PageContainer.js', 'common/forms/sb-lookup/query/LookupQueryBuilder.js'], function (_export, _context) {
	var TableClassBuilder, AppContext, PageContainer, LookupQueryBuilder, _createClass, LookupDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonFormsSbLookupQueryLookupQueryBuilderJs) {
			LookupQueryBuilder = _commonFormsSbLookupQueryLookupQueryBuilderJs.LookupQueryBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LookupDialog', LookupDialog = function () {
				function LookupDialog() {
					_classCallCheck(this, LookupDialog);
				}

				_createClass(LookupDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-lookup-dialog';
						this.properties = {
							value: {
								type: String,
								value: null
							},
							label: String,
							tableName: String,
							tableLabel: String,
							fieldLabel: String,
							labelName: String,
							selectedLabel: String,
							searchValue: String,
							metadata: Object,
							numResults: Number,
							results: Object,
							invoker: {
								type: Object,
								observer: 'initialize'
							},
							isOAuth: {
								type: Boolean,
								value: function value() {
									return AppContext.org ? AppContext.org.isOAuth : false;
								}
							},
							openSpinner: {
								type: Boolean,
								value: false
							},
							recordSpinner: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: {
								type: Boolean,
								computed: '_isMobile(viewport)'
							},
							hideCancel: {
								type: Boolean,
								computed: '_hideCancel(isMobile, openSpinner, recordSpinner)'
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('sb-close-dialog', this.cancel.bind(this));
						this.addEventListener('lookup-value-changed', this.setValues.bind(this));
						this.$.object.addEventListener('response-changed', this.processSearchLayoutFields.bind(this));
						this.$.object.addEventListener('error-changed', this.getMetadataNoOAuth.bind(this));
						this.$.fs.addEventListener('response-changed', this.processCPQLayoutFields.bind(this));
						this.$.field.addEventListener('md-changed', this.processListFields.bind(this));
						this.addEventListener('sb-link-tapped', this.updateLookup.bind(this));
						window.addEventListener('resize', this.setResultsHeight.bind(this));
					}
				}, {
					key: 'initialize',
					value: function initialize() {
						if (!this.invoker) return;

						this.labelName = this.invoker.labelName;
						this.selectedLabel = this.invoker.selectedLabel;
						this.tableName = this.invoker.tableName;
						this.fieldLabel = this.invoker.fieldLabel;
						this.oauthWarning = this.invoker.oauthWarning;
						this.currentRecordFilterWarning = this.invoker.currentRecordFilterWarning;
						this.currentRecordFilters = this.invoker.currentRecordFilters;
						this.record = this.invoker.record;
						this.hasFilter = this.currentRecordFilters && Object.keys(this.currentRecordFilters).length > 0 && AppContext.apiVersion < 39 ? false : this.invoker.hasFilter;
						this.fieldFullName = this.invoker.fieldFullName;
					}
				}, {
					key: 'open',
					value: function open(searchValue) {
						this.$.dialog.toggle();
						this.invoker.dialogOpened();
						this.$.lookup.$.typeahead.blurred = true;
						this.$.lookup.$.typeahead.hasList = false;
						this.$.lookup.$.typeahead.labelValue = searchValue;
						this.invoker.$.typeahead.$.itemLabel.blur();
						this.searchValue = searchValue;
					}
				}, {
					key: 'cancel',
					value: function cancel() {
						this.close();
					}
				}, {
					key: 'saveAndDeferredClose',
					value: function saveAndDeferredClose() {
						this.syncSelection();
						this.deferredClose();
					}
				}, {
					key: 'save',
					value: function save() {
						this.syncSelection();
						this.close();
					}
				}, {
					key: 'syncSelection',
					value: function syncSelection() {
						this.invoker.value = undefined;
						this.invoker.label = this.label;
						this.invoker.value = this.value;
					}
				}, {
					key: 'clearAndSave',
					value: function clearAndSave() {
						this.label = null;
						this.value = null;
						this.save();
					}
				}, {
					key: 'close',
					value: function close() {
						this.$.dialog.toggle();
						this.$.lookup.$.typeahead.suggest({});
						this.invoker.dialogClosed();
						this.reset();
						this.clearSelected();
					}
				}, {
					key: 'deferredClose',
					value: function deferredClose() {
						setTimeout(function () {
							this.close();
						}.bind(this), 350);
					}
				}, {
					key: 'reset',
					value: function reset() {
						this.value = null;
						this.label = null;
						this.results = null;
						this.tableLabel = null;
						this.fieldLabel = null;
						this.fieldFullName = undefined;
						this.hasFilter = false;
						this.currentRecordFilters = null;
						this.record = null;
						this.tableName = null;
						this.numResults = 0;
						this.metadata = undefined;
						this.invoker.oauthWarning = this.$.lookup.oauthWarning;
						this.invoker.currentRecordFilterWarning = this.$.lookup.currentRecordFilterWarning;
						this.oauthWarning = null;
						this.currentRecordFilterWarning = null;
						this.$.header.cols = undefined;
						this.$.header.$.header.destroyGroup();
						this.$.object.response = null;
						this.$.fs.response = null;
						this.$.fs.uid = undefined;
						this.invoker = null;
					}
				}, {
					key: 'setValues',
					value: function setValues(e) {
						this.value = e.detail.value;
						this.label = e.detail[this.labelName];
					}
				}, {
					key: 'updateLookup',
					value: function updateLookup(e) {
						this.label = undefined;
						this.value = e.detail.Id;
						this.label = this.getSelectedLabelValueById(e.detail.Id);
					}
				}, {
					key: 'getSelectedLabelValueById',
					value: function getSelectedLabelValueById(id) {
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.results[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var result = _step.value;

								if (result.Id === id) return result[this.selectedLabel];
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'getMetadataNoOAuth',
					value: function getMetadataNoOAuth() {
						this.isOAuth = false;
						this.getMetadata();
					}
				}, {
					key: 'getMetadata',
					value: function getMetadata() {
						if (!this.tableName) return;

						this.openSpinner = true;
						if (this.isOAuth) this.$.object.mdItems = [this.tableName];else this.$.fs.uid = this.tableName + '.CPQ_Lookup';
					}
				}, {
					key: 'processSearchLayoutFields',
					value: function processSearchLayoutFields(e) {
						if (!e.detail.value) return;

						this.tableLabel = e.detail.value[0].label;
						if (this.isMobile) {
							this.initMobileMetadata();
							return;
						}

						var fs = e.detail.value[0].fieldSets;
						var fieldSets = !fs ? [] : fs.constructor === Array ? fs : [fs];

						var lookupFields = this.getCpqLookupFields(fieldSets);

						if (!lookupFields) {
							this.warnUserAboutCPQLayoutFieldSet();
							var sr = e.detail.value[0].searchLayouts.searchResultsAdditionalFields;
							var searchResults = !sr ? [] : sr.constructor === Array ? sr : [sr];
							lookupFields = this.getSearchResultsAdditionalFields(searchResults);
						}

						lookupFields = this.ensureNameField(lookupFields);
						this.$.field.fields = lookupFields;
					}
				}, {
					key: 'processCPQLayoutFields',
					value: function processCPQLayoutFields(e) {
						if (!e.detail.value) return;

						this.tableLabel = e.detail.value.label;
						if (this.isMobile) {
							this.initMobileMetadata();
							return;
						}

						var fields = [];
						var fs = e.detail.value.fields;
						if (fs.length === 0) {
							this.warnUserAboutCPQLayoutFieldSet();
						} else {
							var _iteratorNormalCompletion2 = true;
							var _didIteratorError2 = false;
							var _iteratorError2 = undefined;

							try {
								for (var _iterator2 = fs[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
									var field = _step2.value;

									fields.push(this.tableName + '.' + field);
								}
							} catch (err) {
								_didIteratorError2 = true;
								_iteratorError2 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion2 && _iterator2.return) {
										_iterator2.return();
									}
								} finally {
									if (_didIteratorError2) {
										throw _iteratorError2;
									}
								}
							}
						}

						fields = this.ensureNameField(fields);
						this.$.field.fields = fields;
					}
				}, {
					key: 'processListFields',
					value: function processListFields(e) {
						var fields = e.detail.value.fields;
						var fieldNames = [];
						var fieldLabels = [];
						var fieldTypeByName = {};
						var fieldTypeObjByName = {};
						var fieldTypeByLabel = {};
						var fieldsOfTypeLookup = [];
						for (var i = 0, l = fields.length; i < l; i++) {
							var field = fields[i];
							var type = { type: field.type, link: i === 0 };
							fieldNames.push(field.name);
							fieldLabels.push(field.label);
							fieldTypeByName[field.name] = field.type;
							fieldTypeObjByName[field.name] = type;
							fieldTypeByLabel[field.label.replace(/\W/g, '')] = field.type;
							if (field.type === 'reference' || field.type === 'id') fieldsOfTypeLookup.push({ name: field.name, table: field.referenceTo[0] });
						}
						this.headerClassMap = new TableClassBuilder(Object.keys(fieldTypeByLabel), 'Th', fieldTypeByLabel).build();
						this.rowClassMap = new TableClassBuilder(fieldNames, 'Td', fieldTypeByName).build();
						this.metadata = { fieldNames: fieldNames, fieldLabels: fieldLabels, fieldTypeObjByName: fieldTypeObjByName, fieldsOfTypeLookup: fieldsOfTypeLookup };
						this.querySearchResults();
					}
				}, {
					key: 'querySearchResults',
					value: function querySearchResults() {
						this.recordSpinner = !this.openSpinner;
						var limit = 100;
						var queryBuilder = new LookupQueryBuilder(this.tableName, this.selectedLabel, this.hasFilter, this.fieldFullName, limit + 1, this.currentRecordFilters, this.record, false, this.metadata);
						var soql = queryBuilder.build(this.searchValue);
						this.$.query.query({ soql: soql }).then(this.handleSearchResults.bind(this, limit));
					}
				}, {
					key: 'handleSearchResults',
					value: function handleSearchResults(limit, response) {
						this.clearSelected();
						var plus = response.totalSize > limit ? '+' : '';
						var totalSize = Math.min(limit, response.totalSize);
						this.numResults = totalSize + plus;
						this.results = this.getResults(response, limit);
						this.recordSpinner = false;
						this.openSpinner = false;
						if (this.isMobile) this.$.tbody.style.overflow = null;
						Polymer.RenderStatus.afterNextRender(this, function () {
							this.setResultsHeight();
						}.bind(this));
					}
				}, {
					key: 'getResults',
					value: function getResults(response, limit) {
						var results = response.records;
						var numResults = response.totalSize;
						var isMobileWithSpotlight = this.isMobile && results.length > numResults;
						var mobileSpotlight = isMobileWithSpotlight ? results.pop() : null;

						while (numResults > limit) {
							results.pop();
							numResults--;
						}

						if (mobileSpotlight) results.push(mobileSpotlight);

						if (isMobileWithSpotlight) results[numResults][this.selectedLabel] = '<div class="sb-html ' + results[numResults]['__md__'].class + '">' + results[numResults][this.selectedLabel] + '</div>';
						return results;
					}
				}, {
					key: 'setResultsHeight',
					value: function setResultsHeight() {
						var offsetBottom = !this.isMobile ? this.$.dialog.$$('#footer').offsetTop : document.documentElement.clientHeight;
						var offset = offsetBottom - this.$.tbody.offsetTop;
						var scrollHeight = this.$.tbody.scrollHeight;
						var height = offset < scrollHeight ? offset + 'px' : null;
						this.$.tbody.style.height = height;
						var mask = this.$.spinner.$$('#mask');
						mask.style.height = offset + 'px';
						if (this.isMobile) this.$.tbody.style.overflow = 'auto';else mask.style.marginLeft = '-24px';
					}
				}, {
					key: 'getCpqLookupFields',
					value: function getCpqLookupFields(fieldSets) {
						var fields = [];
						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = fieldSets[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var fieldSet = _step3.value;

								if (fieldSet.label !== 'CPQ_Lookup') continue;

								var df = fieldSet.displayedFields;
								var displayedFields = !df ? [] : df.constructor === Array ? df : [df];
								var _iteratorNormalCompletion4 = true;
								var _didIteratorError4 = false;
								var _iteratorError4 = undefined;

								try {
									for (var _iterator4 = displayedFields[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
										var displayedField = _step4.value;

										var field = displayedField.field;
										if (field.split('.').length === 1) fields.push(this.tableName + '.' + field);
									}
								} catch (err) {
									_didIteratorError4 = true;
									_iteratorError4 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion4 && _iterator4.return) {
											_iterator4.return();
										}
									} finally {
										if (_didIteratorError4) {
											throw _iteratorError4;
										}
									}
								}

								return fields;
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}
					}
				}, {
					key: 'getSearchResultsAdditionalFields',
					value: function getSearchResultsAdditionalFields(searchResultsAdditionalFields) {
						var fields = [];
						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = searchResultsAdditionalFields[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var field = _step5.value;

								var parts = field.split('.');
								if (parts.length !== 1 && (this.tableName.toLowerCase() !== parts[0].toLowerCase() || parts.length !== 2)) continue;

								var fieldName = void 0;
								if (parts.length === 1 && parts[0].endsWith('__c')) fieldName = parts[0];else if (parts.length === 2 && parts[1].endsWith('__c')) fieldName = parts[1];else {
											var dbFieldName = parts[parts.length - 1];

											var dbParts = dbFieldName.split('_');
											for (var i = 0, l = dbParts.length; i < l; i++) {
												var dbPart = dbParts[i].toLowerCase();
												dbPart = dbPart.charAt(0).toUpperCase() + dbPart.slice(1);
												dbPart = dbPart.replace(/[0-9]/g, '');
												dbParts[i] = dbPart;
											}
											fieldName = dbParts.join('');
										}
								fields.push(this.tableName + '.' + fieldName);
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}

						return fields;
					}
				}, {
					key: 'ensureNameField',
					value: function ensureNameField(fields) {
						if (fields.indexOf(this.tableName + '.' + this.selectedLabel) === -1) fields = [this.tableName + '.' + this.selectedLabel].concat(fields);
						return fields;
					}
				}, {
					key: 'warnUserAboutCPQLayoutFieldSet',
					value: function warnUserAboutCPQLayoutFieldSet() {
						console.warn('Add a field set named "CPQ_Lookup" to the "' + this.tableLabel + '" object to better control the fields displayed in its corresponding lookup field popup in CPQ');
					}
				}, {
					key: 'initMobileMetadata',
					value: function initMobileMetadata() {
						var rowClassMap = {};
						rowClassMap[this.selectedLabel] = 'lookupItemTd';
						this.rowClassMap = rowClassMap;
						this.metadata = { fieldNames: [this.selectedLabel], fieldLabels: [], fieldTypeObjByName: {}, fieldsOfTypeLookup: [] };
						this.$.lookup.lookupResultsCallback(this.searchValue);
					}
				}, {
					key: 'mobileSelection',
					value: function mobileSelection(e) {
						if (!this.isMobile) return;

						var row = Polymer.dom(e).localTarget;
						this.setSelected(row);
						if (row.hasAttribute('data-search')) {
							this.searchValue = row.getAttribute('data-search');
							this.querySearchResults();
						} else {
							this.value = row.getAttribute('data-id');
							this.label = row.getAttribute('data-name');
							this.saveAndDeferredClose();
						}
					}
				}, {
					key: 'getSearchValue',
					value: function getSearchValue(row) {
						if (row && !row.Id) return row['__md__'].searchValue;
					}
				}, {
					key: 'getNameValue',
					value: function getNameValue(row) {
						return row[this.selectedLabel];
					}
				}, {
					key: 'setSelected',
					value: function setSelected(row) {
						this.selected = row.$.row.$$('sb-table-cell');
						this.toggleClass('selectedLookupItem', true, this.selected);
					}
				}, {
					key: 'clearSelected',
					value: function clearSelected() {
						if (this.selected) this.toggleClass('selectedLookupItem', false, this.selected);
					}
				}, {
					key: '_hideCancel',
					value: function _hideCancel() {
						return !this.isMobile || this.openSpinner || this.recordSpinner;
					}
				}, {
					key: '_isMobile',
					value: function _isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['getMetadata(tableName, viewport)'];
					}
				}]);

				return LookupDialog;
			}());

			_export('LookupDialog', LookupDialog);

			Polymer(LookupDialog);
		}
	};
});

'use strict';

System.register('common/forms/sb-multi-lookup/MultiLookup.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _typeof, _createClass, MultiLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
				return typeof obj;
			} : function (obj) {
				return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
			};

			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('MultiLookup', MultiLookup = function () {
				function MultiLookup() {
					_classCallCheck(this, MultiLookup);
				}

				_createClass(MultiLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-multi-lookup';
						this.properties = {
							tableName: String,
							objectName: String,
							hideCancel: Boolean,
							iconName: String,
							iconMap: Object,
							results: Array,
							selectedItems: {
								type: Array,
								value: []
							},
							selectedIdsByItems: {
								type: Object,
								value: {}
							},
							customCallBack: Function,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: Boolean
						};
					}
				}, {
					key: 'updateTable',
					value: function updateTable(results) {
						this.results = results;
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.lookup.addEventListener('lookup-value-changed', function (e) {
							var selectedItem = e.detail.obj;
							if (!this.selectedIdsByItems[selectedItem.Id]) {
								this._addItem(selectedItem);
							} else {
								this._animateDuplicate(selectedItem);
							}
						}.bind(this));

						if (this.viewport && this.viewport.isMobile()) this._appendMobileClasses();
					}
				}, {
					key: '_addItem',
					value: function _addItem(item) {
						this.selectedIdsByItems[item.Id] = item;
						this.unshift('selectedItems', item);
						Polymer.dom.flush();
						if (this.iconName && this.iconMap) this.toggleClass(this.iconMap[item[this.iconName]], true, this.$$('.pill-icon'));
					}
				}, {
					key: '_animateDuplicate',
					value: function _animateDuplicate(item) {
						var _this = this;

						var pills = Polymer.dom(this.$.selectedContainer).querySelectorAll('.pill');

						var _loop = function _loop(i) {
							if (pills[i].dataValue == item.Id) {
								pills[i].addEventListener('webkitAnimationEnd', function () {
									this.toggleClass('invalid-selection', false, pills[i]);
								}.bind(_this), false);
								_this.toggleClass('invalid-selection', true, pills[i]);
								return {
									v: void 0
								};
							}
						};

						for (var i = 0; i < pills.length; i++) {
							var _ret = _loop(i);

							if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
						}
					}
				}, {
					key: '_appendMobileClasses',
					value: function _appendMobileClasses() {
						this.isMobile = true;
						this.toggleClass('mobile', true, this.$.multilookup);
						this.toggleClass('mobile', true, this.$.selectedContainer);
						this.toggleClass('mobile', true, this.$.lookupContainer);
						this.toggleClass('mobile', true, this.$.resultsTable);
					}
				}, {
					key: 'removeItem',
					value: function removeItem(e) {
						this.splice('selectedItems', Polymer.dom(e.target).parentNode.dataIndex, 1);
						delete this.selectedIdsByItems[Polymer.dom(e.target).parentNode.dataValue];
					}
				}, {
					key: 'selectRow',
					value: function selectRow(e) {
						var selectedItem = this.results[e.currentTarget.index];
						if (!this.selectedIdsByItems[selectedItem.Id]) {
							this._addItem(selectedItem);
						} else {
							this._animateDuplicate(selectedItem);
						}
					}
				}, {
					key: 'clear',
					value: function clear() {
						this.selectedItems = [];
						this.selectedIdsByItems = {};
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return MultiLookup;
			}());

			_export('MultiLookup', MultiLookup);

			Polymer(MultiLookup);
		}
	};
});

'use strict';

System.register('common/forms/sb-pagination/Pagination.js', [], function (_export, _context) {
	var _createClass, Pagination;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Pagination', Pagination = function () {
				function Pagination() {
					_classCallCheck(this, Pagination);
				}

				_createClass(Pagination, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-pagination';
						this.properties = {
							pageIndex: {
								type: Number,
								value: 0
							},
							pageSize: Number,
							numItems: Number };
					}
				}, {
					key: 'next',
					value: function next() {
						this.pageIndex++;
						this.firePageEvent('next');
					}
				}, {
					key: 'previous',
					value: function previous() {
						this.pageIndex--;
						this.firePageEvent('previous');
					}
				}, {
					key: 'setNumberOfPages',
					value: function setNumberOfPages() {
						this.numPages = Math.ceil(this.numItems / this.pageSize);
					}
				}, {
					key: 'setPageWindow',
					value: function setPageWindow() {
						var start = this.pageIndex * this.pageSize;
						var end = start + this.pageSize;
						if (end >= this.numItems) end = this.numItems;
						this.pageWindow = [start, end];
					}
				}, {
					key: 'setNextDisabled',
					value: function setNextDisabled() {
						this.nextDisabled = this.pageIndex === this.numPages - 1;
					}
				}, {
					key: 'setPreviousDisabled',
					value: function setPreviousDisabled() {
						this.previousDisabled = this.pageIndex === 0;
					}
				}, {
					key: 'setPageNum',
					value: function setPageNum() {
						this.pageNum = this.pageIndex + 1;
					}
				}, {
					key: 'firePageEvent',
					value: function firePageEvent(direction) {
						this.fire('pagination-changed', { direction: direction, page: this.pageNum, index: this.pageIndex, window: this.pageWindow });
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setNumberOfPages(pageSize, numItems)', 'setPageWindow(pageIndex, pageSize, numItems)', 'setNextDisabled(pageIndex, numPages)', 'setPreviousDisabled(pageIndex)', 'setPageNum(pageIndex)'];
					}
				}]);

				return Pagination;
			}());

			_export('Pagination', Pagination);

			Polymer(Pagination);
		}
	};
});

'use strict';

System.register('common/forms/sb-rte/RichTextEditor.js', [], function (_export, _context) {
	var _createClass, RichTextEditor;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RichTextEditor', RichTextEditor = function () {
				function RichTextEditor() {
					_classCallCheck(this, RichTextEditor);
				}

				_createClass(RichTextEditor, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-rte';
						this.properties = {
							value: {
								type: String,
								notify: true
							}
						};
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.renderReadOnly) {
							this.focus();
						}
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.fire('iron-signal', { name: 'sb-open-rte-dialog', data: { rte: this, value: this.value } });
					}
				}]);

				return RichTextEditor;
			}());

			_export('RichTextEditor', RichTextEditor);

			Polymer(RichTextEditor);
		}
	};
});

'use strict';

System.register('common/forms/sb-select/Select.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, Select;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Select', Select = function () {
				function Select() {
					_classCallCheck(this, Select);
				}

				_createClass(Select, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-select';
						this.properties = {
							value: {
								type: String,
								value: ''
							},
							options: Array,
							isRequired: {
								type: Boolean,
								value: false
							},
							noneLabel: {
								type: String,
								value: ''
							},
							focusOnAttached: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							multiSelect: Boolean,
							size: Number,
							_multiple: {
								type: Boolean,
								computed: '_setMultiple(multiSelect)'
							},
							_options: Array
						};
					}
				}, {
					key: 'buildOptions',
					value: function buildOptions() {
						var noneSelected = true;
						var options = [];
						var values = this._getValues();
						for (var i = 0, l = this.options.length; i < l; i++) {
							var option = this.options[i];
							var selected = values.indexOf(option.value.toString()) !== -1;
							noneSelected = noneSelected && !selected;
							options.push({ value: option.value, label: option.label, selected: selected });
						}

						if (noneSelected && values.length > 0) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var val = _step.value;

									options.push({ value: val, label: val, selected: true });
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}

							noneSelected = false;
						}

						if (noneSelected || !this.isRequired) options = [{ value: '', label: this.noneLabel, selected: noneSelected }].concat(options);

						if (AppContext.isIE()) {
							var select = Polymer.dom(this.$.select);
							var childNodes = select.childNodes;
							for (var _i = 0, _l = childNodes.length; _i < _l; _i++) {
								select.removeChild(childNodes[_i]);
							}
							for (var j = 0, len = options.length; j < len; j++) {
								this._createOptionElements(this.$.select, options[j]);
							}
						} else {
							this._options = options;
						}
					}
				}, {
					key: '_createOptionElements',
					value: function _createOptionElements(select, option) {
						var optionEl = document.createElement('option');
						optionEl.label = option.label;
						optionEl.value = option.value;
						optionEl.selected = option.selected;
						select.appendChild(optionEl);
					}
				}, {
					key: 'setSelected',
					value: function setSelected() {
						if (this.internal) return;

						var values = this._getValues();
						for (var i = 0, l = this._options.length; i < l; i++) {
							this._options[i].selected = values.indexOf(this._options[i].value.toString()) !== -1;
							if (this.$.select.options[i]) this.$.select.options[i].selected = values.indexOf(this.$.select.options[i].value.toString()) !== -1;
						}
					}
				}, {
					key: 'change',
					value: function change() {
						var options = this.$.select.options;
						var value = null;
						for (var i = 0, l = options.length; i < l; i++) {
							if (!AppContext.isIE()) this._options[i].selected = options[i].selected;

							if (!options[i].selected) continue;

							if (this.multiSelect && value != null) value += ';' + options[i].value;else value = options[i].value;
						}
						this.internal = true;
						this.value = value;
						this.internal = false;

						this.fire('change', { value: this.value });
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.$.select.focus();
					}
				}, {
					key: 'blur',
					value: function blur() {
						this.fire('blur');
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: '_setMultiple',
					value: function _setMultiple() {
						return this.multiSelect ? true : undefined;
					}
				}, {
					key: '_getValues',
					value: function _getValues() {
						return Select.getValues(this.value, this.multiSelect);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildOptions(options, isRequired)', 'setSelected(value, _options)'];
					}
				}], [{
					key: 'getValues',
					value: function getValues(value, multiSelect) {
						if (value != null && value !== '') return multiSelect ? value.split(';') : [value.toString()];
						return [];
					}
				}]);

				return Select;
			}());

			_export('Select', Select);

			Polymer(Select);
		}
	};
});

'use strict';

System.register('common/forms/sb-textarea/Textarea.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, Textarea;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Textarea', Textarea = function () {
				function Textarea() {
					_classCallCheck(this, Textarea);
				}

				_createClass(Textarea, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-textarea';
						this.properties = {
							value: {
								type: String,
								observer: 'changed'
							},
							focusOnAttached: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'focus',
					value: function focus() {
						this.$.textarea.focus();
					}
				}, {
					key: 'blur',
					value: function blur() {
						this.fireChangeOnBlur();
						this.fire('blur');
					}
				}, {
					key: 'highlight',
					value: function highlight() {
						if (this.viewport && this.viewport.isMobile()) return;
						var length = this.value ? this.value.length : 0;
						this.$.textarea.setSelectionRange(0, length);
					}
				}, {
					key: 'changed',
					value: function changed(newValue, oldValue) {
						if (oldValue === undefined) {
							this.changeOnNextBlur = true;
							return;
						}

						this.changeOnNextBlur = false;
						if (oldValue == newValue) return;

						this.fireChangeEvent(newValue);
					}
				}, {
					key: 'fireChangeEvent',
					value: function fireChangeEvent(value) {
						this.fire('change', { value: value });
					}
				}, {
					key: 'fireChangeOnBlur',
					value: function fireChangeOnBlur() {
						if (!this.changeOnNextBlur) return;

						this.fireChangeEvent(this.value);
						this.changeOnNextBlur = false;
					}
				}, {
					key: 'propagateEsc',
					value: function propagateEsc(e) {
						if (e.keyCode !== 27) return;

						if (this.renderReadOnly) this.$.textarea.value = this.value;

						this.fire('sb-textarea-key', { keyCode: 27 });
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return Textarea;
			}());

			_export('Textarea', Textarea);

			Polymer(Textarea);
		}
	};
});

'use strict';

System.register('common/forms/sb-typeahead/Typeahead.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, wildCards, resultLimit, Typeahead;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			wildCards = new RegExp('[*_%]+', 'g');
			resultLimit = 10;

			_export('Typeahead', Typeahead = function () {
				function Typeahead() {
					_classCallCheck(this, Typeahead);
				}

				_createClass(Typeahead, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-typeahead';

						this.properties = {
							items: {
								type: Array,
								value: []
							},
							itemsCallback: {
								type: Object
							},
							debounceDelay: {
								type: Number,
								value: 300
							},
							selectedItem: {
								type: Object,
								notify: true
							},
							itemsList: {
								type: Array,
								observer: 'itemsListChanged',
								notify: true
							},
							labels: {
								type: Array,
								value: function value() {
									return this.getAttribute('labels') || ['label'];
								}
							},
							labelValue: {
								type: String,
								notify: true
							},
							value: {
								type: String
							},
							delimiter: {
								type: String,
								value: function value() {
									return this.getAttribute('delimiter') || '';
								}
							},
							savedLabelValue: {
								type: String
							},
							invalidLabel: {
								type: Boolean,
								value: false
							},
							hasList: {
								type: Boolean,
								value: false,
								observer: '_calculateListPosition'
							},
							hasLabel: {
								type: Boolean,
								value: false
							},
							optionIndex: {
								type: Number,
								value: -1
							},
							focusOnAttached: Boolean,
							applyFocus: {
								type: Boolean,
								observer: '_applyFocus'
							},
							hideCancelIcon: {
								type: Boolean,
								value: false
							},
							clearAfterSelection: {
								type: Boolean,
								value: false
							},
							blurDisabled: {
								type: Boolean,
								value: false
							},
							focusDisabled: {
								type: Boolean,
								value: false
							},
							revertOnEscape: {
								type: Boolean,
								value: false
							},
							showSearchIcon: {
								type: Boolean,
								value: false
							},
							calculateListPosition: {
								type: Boolean,
								value: false
							},
							showListNoSuggestion: {
								type: Boolean,
								value: false
							},
							showListOnFocus: {
								type: Boolean,
								value: false
							},
							hideInput: {
								type: Boolean,
								value: false
							}
						};

						this.observers = ['itemsChanged(items, labels)', 'selectedItemChanged(selectedItem, value)'];
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.itemLabel.addEventListener('focus', this._directInputFocus.bind(this));
						this.$.itemLabel.addEventListener('blur', this._directInputBlur.bind(this));
					}
				}, {
					key: 'attached',
					value: function attached() {
						this.isAttached = true;
						if (this.focusOnAttached) this.focus();
					}
				}, {
					key: 'itemsChanged',
					value: function itemsChanged() {
						if (this.items.length) this.itemsList = this.updateItemsList();
					}
				}, {
					key: 'selectedItemChanged',
					value: function selectedItemChanged() {
						if (this.selectedItem) {
							var md = this.selectedItem.__md__;
							var clearAfterSelection = md ? md.clearAfterSelection : false;

							this.valueAttr = this.value ? this.value : 'value';
							this.labelValue = this.selectedItem[this.valueAttr];

							if (this.clearAfterSelection || clearAfterSelection) {
								this.selectedItem = '';
								this.items = this.itemsList = [];
							}
							if (!this.originalSelected) this.originalSelected = JSON.parse(JSON.stringify(this.selectedItem));
						}
					}
				}, {
					key: 'itemsListChanged',
					value: function itemsListChanged() {
						Polymer.dom.flush();
						var options = Polymer.dom(this.$.selector).querySelectorAll('.option');
						if (!options) return;
						var numOfOptions = options.length;
						var numOfLabels = this.labels.length;
						if (numOfOptions > 0) {
							this.optionIndex = -1;
							for (var i = 0; i < numOfOptions; i++) {
								var item = this.itemsList[i],
								    html = '';
								for (var j = 0; j < numOfLabels; j++) {
									var label = this.labels[j],
									    delimiter = j === 0 ? '' : this.delimiter,
									    labelValue = item[label];
									html += delimiter + labelValue;
								}
								options[i].innerHTML = html;
							}
						}
					}
				}, {
					key: 'getSelectedItemValue',
					value: function getSelectedItemValue() {
						return this.selectedItem ? this.selectedItem[this.valueAttr] : '';
					}
				}, {
					key: 'clear',
					value: function clear() {
						this.hide();
						this.updateItem({}, true);
						this.fire('sb-type-clear');
					}
				}, {
					key: 'hide',
					value: function hide() {
						this.hideList();
						this.invalidLabel = false;
						this.optionIndex = -1;
					}
				}, {
					key: 'cloneItem',
					value: function cloneItem(item) {
						var clone = {},
						    keys = Object.keys(item),
						    len = keys.length;
						for (var i = 0; i < len; i++) {
							var key = keys[i];
							clone[key] = item[key];
						}
						return clone;
					}
				}, {
					key: 'updateItem',
					value: function updateItem(item, forceSuggestOnFocus) {
						var keys = Object.keys(item),
						    len = keys.length;
						var selectedItem = {};
						for (var i = 0; i < len; i++) {
							var key = keys[i];
							selectedItem[key] = item[key] !== undefined ? item[key] : '';
						}
						this.selectedItem = selectedItem;

						var labelValue = '',
						    numOfLabels = this.labels.length;
						for (var j = 0; j < numOfLabels; j++) {
							var delimiter = j === 0 ? '' : this.delimiter;
							var selectedLabel = this.selectedItem[this.labels[j]];
							if (selectedLabel) labelValue += delimiter + selectedLabel;
						}

						var md = this.selectedItem.__md__;
						this.labelValue = md && !md.clearAfterSelection && md.searchValue !== undefined ? md.searchValue : labelValue;

						this.clearSelection();
						this.focusOrBlurAfterSelection(this.selectedItem, forceSuggestOnFocus);
					}
				}, {
					key: 'submitItem',
					value: function submitItem(e) {
						var item = e.model.item;
						this.updateItem(item);
						this.hide();
						this.focusOrBlurAfterSelection(item);
					}
				}, {
					key: 'focusOrBlurAfterSelection',
					value: function focusOrBlurAfterSelection(item, forceSuggestOnFocus) {
						if (!item || !item.__md__ || !item.__md__.noFocusAfterSelection) this.focus(forceSuggestOnFocus);else this.$.itemLabel.blur();
					}
				}, {
					key: 'selectAdjacentItem',
					value: function selectAdjacentItem(keyCode) {
						if (!this.itemsList) return;
						var len = this.itemsList.length;
						if (this.optionIndex >= 0 && this.optionIndex < len) {
							this.$.selector.children[this.optionIndex].removeAttribute('selected');
							if (keyCode === 38) {
								this.optionIndex = this.optionIndex === 0 ? len - 1 : this.optionIndex - 1;
							} else if (keyCode === 40) {
								this.optionIndex = this.optionIndex === len - 1 ? 0 : this.optionIndex + 1;
							}
						} else if (this.optionIndex === -1) {
							if (keyCode === 38) {
								this.optionIndex = len - 1;
							} else if (keyCode === 40) {
								this.optionIndex = 0;
							}
						}
						this.$.selector.children[this.optionIndex].setAttribute('selected', '');
					}
				}, {
					key: 'updateItemsList',
					value: function updateItemsList() {
						var result = [],
						    highlighted = false;
						if (this.showListNoSuggestion || this.labelValue) {
							var labelValue = this.labelValue || '';
							var searchLabel = labelValue.replace(/\+/g, '\\+').replace(/\\/g, '\\\\').replace(wildCards, '.+'),
							    searchText = new RegExp(searchLabel, 'i');

							var numOfItems = this.items.length,
							    numOfLabels = this.labels.length;
							for (var i = 0; i < numOfItems; i++) {
								var item = this.items[i],
								    clone = this.cloneItem(item);
								for (var j = 0; j < numOfLabels; j++) {
									var itemLabel = item[this.labels[j]];
									if (itemLabel && (this.showListNoSuggestion || searchText.test(itemLabel))) {
										var label = '_' + this.labels[j];
										clone[label] = itemLabel.replace(searchText, '<span style="font-weight:bold;">$&</span>');
										highlighted = true;
									}
								}
								if (highlighted) {
									result.push(clone);
									highlighted = false;
								}
								if (result.length >= resultLimit) {
									break;
								}
							}
						}
						return result;
					}
				}, {
					key: 'suggest',
					value: function suggest(e) {
						if (!this.isAttached) return;

						switch (e.keyCode) {
							case 13:
								if (this.hasList) {
									if (this.optionIndex === -1) this.optionIndex = 0;
									this.updateItem(this.itemsList[this.optionIndex]);
									this.noBlur = false;
								} else this.fire('enter-without-selection', { value: this.labelValue });
								this.hide();
								break;
							case 27:
								if (this.revertOnEscape) {
									this.updateItem(this.originalSelected);
									this.items = undefined;
									this.hideList();
									this.clearSelection();
									this.fire('sb-type-blur');
								}
								break;
							case 38:
							case 40:
								this.selectAdjacentItem(e.keyCode);
								break;
							case 9:
							case 16:
								break;
							default:
								this.invalidLabel = false;
								if (this.itemsCallback) {
									this.debounce('itemsCallback', function () {
										var promise = this.itemsCallback(this.labelValue);
										promise.then(function (items) {
											if (items && items.length > 0) this.showList();else this.hideList();
											this.items = items;
										}.bind(this), function (error) {
											console.error(error && error.message ? error.message : error);
											this.items = [];
										}.bind(this));
									}, this.debounceDelay);
								} else {
									this.showList();
									this.itemsList = this.updateItemsList();
									if (this.itemsList.length === 0) {
										if (this.labelValue) {
											this.invalidLabel = true;
										} else {
											this.hasLabel = false;
										}
										this.hasList = false;
									}
								}
								break;
						}
					}
				}, {
					key: 'showList',
					value: function showList() {
						if (this.blurred) {
							this.hideList();
							return;
						}

						if (this.showListNoSuggestion || this.labelValue != null && this.labelValue !== '') {
							this.hasList = true;
							this.hasLabel = true;
						}
					}
				}, {
					key: 'hideList',
					value: function hideList() {
						this.hasList = false;
						this.hasLabel = false;
					}
				}, {
					key: 'clearSelection',
					value: function clearSelection() {
						var options = Polymer.dom(this.$.selector).querySelectorAll('.option');
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = options[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var option = _step.value;

								this.toggleAttribute('selected', false, option);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'tabBlur',
					value: function tabBlur(e) {
						if (e.keyCode === 9) this.hasList = false;
						if (e.keyCode === 38) e.preventDefault();
						if (e.keyCode === 13 && this.hasList) this.preventBlur();
						if (e.keyCode === 27 && !this.revertOnEscape) {
							setTimeout(function (labelValue) {
								this.labelValue = labelValue;
							}.bind(this, this.labelValue), 0);
						}
					}
				}, {
					key: 'focus',
					value: function focus(forceSuggest) {
						if (this.focusDisabled) return;

						this.focusing = true;
						this.$.itemLabel.focus();
						this._showListOnFocus(forceSuggest);
						this.focusing = false;
					}
				}, {
					key: 'blur',
					value: function blur(e, force) {
						if (!force && (this.hasList || this.blurDisabled)) return;

						this.hideList();
						this.fire('sb-type-blur');
						this.setOriginalSelected();
					}
				}, {
					key: 'setOriginalSelected',
					value: function setOriginalSelected() {
						this.originalSelected = JSON.parse(JSON.stringify(this.selectedItem || {}));
					}
				}, {
					key: 'preventBlur',
					value: function preventBlur() {
						this.noBlur = true;
					}
				}, {
					key: 'allowBlur',
					value: function allowBlur() {
						this.noBlur = false;
					}
				}, {
					key: 'focused',
					value: function focused() {
						this.fire('sb-type-focus', { value: this.labelValue });
					}
				}, {
					key: '_applyFocus',
					value: function _applyFocus() {
						if (this.applyFocus) this.focus();
					}
				}, {
					key: '_calculateListPosition',
					value: function _calculateListPosition() {
						if (this.calculateListPosition && this.hasList) {
							var leftOffset = PageContainer.getContainer().getBoundingClientRect().left;
							var left = this.$.itemLabel.getBoundingClientRect().left;
							this.$.selector.style.left = left - leftOffset + 'px';
						}
					}
				}, {
					key: '_showListOnFocus',
					value: function _showListOnFocus(forceSuggest) {
						if (!this.showListOnFocus || this.hideInput || this.hasList) return;

						if (forceSuggest || !this.items || this.items.length === 0) this.suggest({});else this.showList();
					}
				}, {
					key: '_directInputFocus',
					value: function _directInputFocus() {
						this.blurred = false;
						if (!this.focusing) this._showListOnFocus();
					}
				}, {
					key: '_directInputBlur',
					value: function _directInputBlur() {
						this.blurred = true;
						this.blur(null, !this.noBlur);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return Typeahead;
			}());

			_export('Typeahead', Typeahead);

			Polymer(Typeahead);
		}
	};
});

'use strict';

System.register('common/layout/data/RecordGrouper.js', [], function (_export, _context) {
	var _createClass, NOT_GROUPED_NAME, RecordGrouper;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			NOT_GROUPED_NAME = 'Other';

			_export('RecordGrouper', RecordGrouper = function () {
				function RecordGrouper(groupField, groupedRecordFields, recordPath, itemProperties, itemPropertiesByGroup, groupProperties, groupCountPath, groupFieldType, groupFieldTypePath) {
					_classCallCheck(this, RecordGrouper);

					this.groupField = groupField;
					if (groupedRecordFields) this.groupedRecordFields = groupedRecordFields.constructor !== Array ? [groupedRecordFields] : groupedRecordFields;
					this.recordPath = recordPath;
					this.itemProperties = itemProperties;
					this.itemPropertiesByGroup = itemPropertiesByGroup;
					this.groupProperties = groupProperties;
					this.groupCountPath = groupCountPath;
					this.groupFieldType = groupFieldType;
					this.groupFieldTypePath = groupFieldTypePath;
				}

				_createClass(RecordGrouper, [{
					key: 'group',
					value: function group(items) {
						var orderdGroups = [];
						var itemsByGroup = {};

						for (var i = 0, l = items.length; i < l; i++) {
							var item = items[i];

							var record = this._get(item, this.recordPath);

							var group = record[this.groupField];

							var notGrouped = group === undefined || group === null || group === '';

							group = notGrouped ? NOT_GROUPED_NAME : group + '';

							var groupedItems = itemsByGroup[group];

							if (!groupedItems && !notGrouped) orderdGroups.push(group);

							groupedItems = groupedItems || [];

							item.groupie = group;
							item.grouper = null;
							groupedItems.push(item);
							itemsByGroup[group] = groupedItems;

							this._setProperties(item, this.itemProperties);
							this._setProperties(item, this.itemPropertiesByGroup, group);
						}

						if (itemsByGroup[NOT_GROUPED_NAME]) orderdGroups.push(NOT_GROUPED_NAME);

						return this._sortItemsByGroup(orderdGroups, itemsByGroup);
					}
				}, {
					key: '_sortItemsByGroup',
					value: function _sortItemsByGroup(orderedGroups, itemsByGroup) {
						var response = [];
						for (var i = 0, l = orderedGroups.length; i < l; i++) {
							var group = orderedGroups[i];
							var items = itemsByGroup[group];
							var numItems = items.length;
							if (this.groupedRecordFields) {
								var groupItem = { grouper: group, groupie: null };
								var groupRecord = this._get(groupItem, this.recordPath);
								for (var j = 0, ll = this.groupedRecordFields.length; j < ll; j++) {
									groupRecord[this.groupedRecordFields[j]] = group;
								}if (this.groupCountPath) {
									var groupCount = this._get(groupItem, this.groupCountPath.path);
									groupCount[this.groupCountPath.property] = '(' + numItems + ')';
								}
								if (this.groupFieldType && this.groupFieldTypePath) {
									var groupFieldMd = this._get(groupItem, this.groupFieldTypePath.path);
									groupFieldMd[this.groupFieldTypePath.property] = group !== NOT_GROUPED_NAME ? this.groupFieldType : 'string';
								}
								this._setProperties(groupItem, this.groupProperties);
								response.push(groupItem);
							}
							response = response.concat(items);
						}
						return response;
					}
				}, {
					key: '_get',
					value: function _get(obj, path) {
						if (!path) return obj;

						var parts = path.split('.');
						for (var i = 0, l = parts.length; i < l; i++) {
							if (!obj[parts[i]]) obj[parts[i]] = {};
							obj = obj[parts[i]];
						}
						return obj;
					}
				}, {
					key: '_setProperties',
					value: function _setProperties(item, properties, propertiesKey) {
						if (!properties) return;

						if (propertiesKey) {
							if (!properties[propertiesKey]) return;
							properties = properties[propertiesKey];
						}

						for (var key in properties) {
							item[key] = properties[key];
						}
					}
				}]);

				return RecordGrouper;
			}());

			_export('RecordGrouper', RecordGrouper);
		}
	};
});

'use strict';

System.register('common/layout/fields/FieldHider.js', [], function (_export, _context) {
	var _typeof, _createClass, FieldHider;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
				return typeof obj;
			} : function (obj) {
				return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
			};

			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldHider', FieldHider = function () {
				function FieldHider(hidden, toggle) {
					_classCallCheck(this, FieldHider);

					this.toggle = toggle;
					if (typeof hidden === 'boolean') this.hide = { hidden: hidden, type: 'hide' };else if ((typeof hidden === 'undefined' ? 'undefined' : _typeof(hidden)) === 'object') this.hide = { hidden: !!hidden.hidden, type: hidden.type || 'hide' };else this.hide = { hidden: false, type: 'hide' };
				}

				_createClass(FieldHider, [{
					key: 'applyTo',
					value: function applyTo(field) {
						var types = [this.hide];
						if (this.type === 'hide') types.push({ hidden: false, type: 'invisible' });else types.push({ hidden: false, type: 'hide' });

						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = types[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var type = _step.value;

								this.toggle.toggleClass(type.type, type.hidden, field);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'hidden',
					get: function get() {
						return this.hide.hidden;
					}
				}, {
					key: 'type',
					get: function get() {
						return this.hide.type;
					}
				}]);

				return FieldHider;
			}());

			_export('FieldHider', FieldHider);
		}
	};
});

'use strict';

System.register('common/layout/fields/FieldSetHandler.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, FieldSetHandler;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldSetHandler', FieldSetHandler = function () {
				function FieldSetHandler(fieldSets, desktop, tablet, phone) {
					_classCallCheck(this, FieldSetHandler);

					this.fieldSets = fieldSets;
					this.desktopFields = { name: desktop };
					if (tablet) this.tabletFields = { name: tablet };
					if (phone) this.phoneFields = { name: phone };
				}

				_createClass(FieldSetHandler, [{
					key: 'getByViewport',
					value: function getByViewport(viewport) {
						if (viewport && viewport.isPhone()) return this._getPhoneFieldSet();

						if (viewport && viewport.isTablet()) return this._getTabletFieldSet();

						return this._getDesktopFieldSet();
					}
				}, {
					key: '_getPhoneFieldSet',
					value: function _getPhoneFieldSet() {
						var fieldSet = this.phoneFields ? this.fieldSets[this.phoneFields.name] : null;
						if (!fieldSet || fieldSet.length === 0) return this._getTabletFieldSet();

						this.phoneFields.fields = fieldSet;
						return this.phoneFields;
					}
				}, {
					key: '_getTabletFieldSet',
					value: function _getTabletFieldSet() {
						var fieldSet = this.tabletFields ? this.fieldSets[this.tabletFields.name] : null;
						if (!fieldSet || fieldSet.length === 0) return this._getDesktopFieldSet();

						this.tabletFields.fields = fieldSet;
						return this.tabletFields;
					}
				}, {
					key: '_getDesktopFieldSet',
					value: function _getDesktopFieldSet() {
						this.desktopFields.fields = this.fieldSets[this.desktopFields.name];
						return this.desktopFields;
					}
				}]);

				return FieldSetHandler;
			}());

			_export('FieldSetHandler', FieldSetHandler);
		}
	};
});

'use strict';

System.register('common/layout/sb-actions/Actions.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, Actions;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Actions', Actions = function () {
				function Actions() {
					_classCallCheck(this, Actions);
				}

				_createClass(Actions, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-actions';
						this.properties = {
							rowActions: Array,

							position: {
								type: String,
								value: 'left'
							},
							data: {
								type: Object,
								notify: true
							},

							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.isMobile = this._isMobileViewport();
					}
				}, {
					key: 'shouldDisable',
					value: function shouldDisable(index) {
						if (!this.data || !this.rowActions || !this.rowActions[index]) return;
						return this.rowActions[index].title == 'Delete' && (this.data.required && !this.data.addedManually || !!this.data.disabledData && this.data.disabledData.disabled);
					}
				}, {
					key: '_isMobileViewport',
					value: function _isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'tapEvent',
					value: function tapEvent(e) {
						if (this.rowActions[e.currentTarget.dataIndex].onTapFunction && !this.shouldDisable(e.currentTarget.dataIndex)) {
							this.rowActions[e.currentTarget.dataIndex].onTapFunction.bind(this)();
						}
					}
				}, {
					key: '_isVisible',
					value: function _isVisible(invisible) {
						return invisible ? 'visibilityHidden' : '';
					}
				}, {
					key: 'displayTitle',
					value: function displayTitle(action, index) {
						return this.shouldDisable(index) ? 'Disabled' : action.title;
					}
				}, {
					key: '_isDisabled',
					value: function _isDisabled(index) {
						return this.shouldDisable(index) ? 'disabled' : '';
					}
				}, {
					key: 'disableActions',
					value: function disableActions() {
						if (!this.$$('.sb-action-icon')) return;
						for (var i = 0; i < this.rowActions.length; i++) {
							this.toggleClass('disabled', this.shouldDisable(i), this.$$('#_' + i));
						}
					}
				}, {
					key: '_configurationRequired',
					value: function _configurationRequired(iconTitle) {
						if (!this.isMobile || !!this.data.configured) {
							return '';
						}

						for (var i = 0; i < this.rowActions.length; i++) {
							if (iconTitle === 'Configure' && this.rowActions[i].configurationRequired) {
								return 'configurationRequired';
							}
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['disableActions(data.disabledData.disabled)'];
					}
				}]);

				return Actions;
			}());

			_export('Actions', Actions);

			Polymer(Actions);
		}
	};
});

'use strict';

System.register('common/layout/sb-badge/Badge.js', [], function (_export, _context) {
	var _createClass, Badge;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Badge', Badge = function () {
				function Badge() {
					_classCallCheck(this, Badge);
				}

				_createClass(Badge, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-badge';

						this.properties = {
							for: {
								type: String,
								observer: '_changedFor'
							},
							label: {
								type: Number,
								observer: '_changedLabel'
							}
						};
					}
				}, {
					key: 'attached',
					value: function attached() {
						this._updateTarget();
						this._setVisibility();
					}
				}, {
					key: '_setVisibility',
					value: function _setVisibility() {
						if (!this.label && !this.getAttribute("hidden")) {
							this.setAttribute("hidden", "");
						} else {
							this.removeAttribute("hidden");
						}
					}
				}, {
					key: '_updateTarget',
					value: function _updateTarget() {
						this._target = this.target;
						this.updatePosition();
					}
				}, {
					key: 'attributeChanged',
					value: function attributeChanged(name) {
						if (name === 'hidden') {}
					}
				}, {
					key: '_changedFor',
					value: function _changedFor() {
						if (!this.isAttached) {
							return;
						}

						this._updateTarget();
					}
				}, {
					key: '_changedLabel',
					value: function _changedLabel() {
						this.setAttribute('aria-label', this.label);
						this._setVisibility();
					}
				}, {
					key: 'updatePosition',
					value: function updatePosition() {
						var targetRect, thisRect;

						if (!this._target) {
							return;
						}

						targetRect = this._target.getBoundingClientRect();
						thisRect = this.getBoundingClientRect();

						var top = thisRect.top - targetRect.top;
						this.style.top = 0 - (top + targetRect.height / 2) + "px";

						var left = targetRect.right - thisRect.left + 1;
						this.style.left = left + "px";
					}
				}, {
					key: 'target',
					get: function get() {
						var ownerRoot = this.parentNode;
						var target;

						if (this.for) {
							target = Polymer.dom(ownerRoot).querySelector('#' + this.for);
						}

						return target;
					}
				}]);

				return Badge;
			}());

			_export('Badge', Badge);

			Polymer(Badge);
		}
	};
});

'use strict';

System.register('common/layout/sb-dialog/Dialog.js', ['common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js'], function (_export, _context) {
	var PageContainer, AppContext, _createClass, Dialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Dialog', Dialog = function () {
				function Dialog() {
					_classCallCheck(this, Dialog);
				}

				_createClass(Dialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-dialog';
						this.properties = {
							show: {
								type: Boolean,
								value: false
							},
							modal: {
								type: Boolean,
								value: false
							},
							appendedClass: {
								type: String
							},
							cancelText: {
								Type: String,
								value: 'Cancel'
							},
							closeDialog: {
								type: String,
								value: 'sb-close-dialog'
							},
							hideCloseIcon: {
								type: Boolean,
								value: false
							},
							hideCancelButton: {
								type: Boolean,
								value: false
							},
							mobile: {
								type: Boolean,
								value: function value() {
									if (PageContainer.getViewport()) return PageContainer.getViewport().isMobile() ? true : false;
								}
							},
							mobileDropDown: {
								type: Boolean,
								value: false
							},
							tapDialog: String };
					}
				}, {
					key: 'ready',
					value: function ready() {
						if (this.appendedClass) this.$$('.sbDialog').classList.add(this.appendedClass);
						if (this.mobile) {
							this._appendMobileClasses();
							Polymer.dom(this).observeNodes(function () {
								var buttons = Polymer.dom(this).querySelectorAll('paper-button');
								var title = this.$$('#title');
								if (buttons.length === 0) {
									var _title = this.$$('#title');
									this.toggleClass('no-buttons', true, _title);
								} else {
									this.mobileDropDown = buttons.length > 1 ? true : false;
									var mobileButtons = this.$$('#mobileButtons');
									var dropDownButton = this.$$('#drop-down-button');
									this.toggleClass('no-buttons', false, title);
									this.toggleClass('drop-down-menu', this.mobileDropDown, mobileButtons);
									this.toggleClass('single-button', !this.mobileDropDown, mobileButtons);
									this.toggleClass('hidden', !this.mobileDropDown, dropDownButton);
								}
							}.bind(this));
						}
						this.toggleClass('is-ie', AppContext.isIE(), this.$.footer);
					}
				}, {
					key: '_appendMobileClasses',
					value: function _appendMobileClasses() {
						this.toggleClass('mobile', true, this.$$('.sbDialog'));
						var children = Polymer.dom(this).children,
						    numChildren = children.length;
						for (var i = 0; i < numChildren; i++) {
							this.toggleClass('mobile', true, children[i]);
						}
					}
				}, {
					key: 'toggle',
					value: function toggle() {
						this.show = !this.show;
						if (this.show) {
							this.fire('sb-open-dialog');
						}
					}
				}, {
					key: 'open',
					value: function open() {
						this.show = true;
					}
				}, {
					key: 'close',
					value: function close() {
						this.show = false;
					}
				}, {
					key: 'toggleMenu',
					value: function toggleMenu() {
						var dropDownMenu = this.$$('.drop-down-menu');
						if (dropDownMenu && dropDownMenu.classList.contains('open')) this.toggleClass('open', false, dropDownMenu);else this.toggleClass('open', true, dropDownMenu);
					}
				}, {
					key: 'onCloseDialog',
					value: function onCloseDialog() {
						this.fire('iron-signal', { name: 'sb-panel-closed' });

						this.fire(this.closeDialog);
					}
				}, {
					key: 'tapEvent',
					value: function tapEvent() {
						if (this.tapDialog) {
							this.fire(this.tapDialog);
						}
					}
				}, {
					key: '_datePickerOpened',
					value: function _datePickerOpened(e) {
						var dateContainer = e.detail.dateContainer;
						var datepicker = e.detail.datepicker;
						var content = this.$.content;

						datepicker.style.position = 'fixed';
						var dateContainerBoundingClientRect = dateContainer.getBoundingClientRect();
						var contentBoundingClientRect = content.getBoundingClientRect();

						if (AppContext.isIE()) {
							datepicker.style.left = dateContainerBoundingClientRect.left + 'px';
							datepicker.style.top = dateContainerBoundingClientRect.top + dateContainerBoundingClientRect.height + 'px';
						} else {
							datepicker.style.left = dateContainerBoundingClientRect.left - contentBoundingClientRect.left + 'px';
							datepicker.style.top = dateContainerBoundingClientRect.top + dateContainerBoundingClientRect.height - this.$.header.getBoundingClientRect().top + 1 + 'px';
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'datepicker-opened': '_datePickerOpened'
						};
					}
				}]);

				return Dialog;
			}());

			_export('Dialog', Dialog);

			Polymer(Dialog);
		}
	};
});

'use strict';

System.register('common/layout/sb-div/Div.js', [], function (_export, _context) {
    var _createClass, Div;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export('Div', Div = function () {
                function Div() {
                    _classCallCheck(this, Div);
                }

                _createClass(Div, [{
                    key: 'beforeRegister',
                    value: function beforeRegister() {
                        this.is = 'sb-div';
                    }
                }]);

                return Div;
            }());

            _export('Div', Div);

            Polymer(Div);
        }
    };
});

'use strict';

System.register('common/layout/sb-drawer/Drawer.js', [], function (_export, _context) {
	var _createClass, Drawer;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Drawer', Drawer = function () {
				function Drawer() {
					_classCallCheck(this, Drawer);
				}

				_createClass(Drawer, [{
					key: 'beforeRegister',
					value: function beforeRegister() {

						this.is = 'sb-drawer';

						this.listeners = {
							'iron-deselect': '_blurActiveElement'
						};

						this.properties = {
							isRight: {
								Type: Boolean,
								value: true
							},
							renderHeader: {
								type: Boolean,
								value: true
							},
							icon: String,
							arrows: String,

							sideText: String,

							rightSideButton: Boolean
						};
					}
				}, {
					key: '_blurActiveElement',
					value: function _blurActiveElement(e) {
						if (e.detail.item.id === 'drawer') {
							document.activeElement.blur();
						}
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.drawer.rightDrawer = this.isRight;
					}
				}, {
					key: 'closeDrawer',
					value: function closeDrawer() {
						this.$.drawer.closeDrawer();
					}
				}, {
					key: 'toggleDrawer',
					value: function toggleDrawer() {
						this.fire('side-toggle-clicked');
					}
				}, {
					key: 'setIcon',
					value: function setIcon() {
						if (this.isOpen === "open") {
							this.icon = 'sf-icon-left';
						} else {
							this.icon = 'sf-icon-right';
							this.arrows = 'closedArrows';
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setIcon(isOpen)'];
					}
				}]);

				return Drawer;
			}());

			_export('Drawer', Drawer);

			Polymer(Drawer);
		}
	};
});

'use strict';

System.register('common/layout/sb-field-item/FieldItem.js', ['common/relationship/RelationshipFieldManager.js'], function (_export, _context) {
	var RelationshipFieldManager, _createClass, FieldItem;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldItem', FieldItem = function () {
				function FieldItem() {
					_classCallCheck(this, FieldItem);
				}

				_createClass(FieldItem, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-field-item';
						this.properties = {
							value: {
								notify: true
							},

							item: String,

							model: Object,

							md: Object,
							data: Object
						};
					}
				}, {
					key: '_setFieldData',
					value: function _setFieldData() {
						this.md = this.model[this.item];
						this.label = this.md.label;
						this.helpText = this.md.inlineHelpText;
						this.$.field.editing = this.md.updateable;
						this.$.field.md = this.md;
						this.$.field.property = this.item;
						var obj = {};
						obj[this.item] = this.value;
						this.$.field.obj = obj;
					}
				}, {
					key: '_dataChanged',
					value: function _dataChanged() {
						var rfm = new RelationshipFieldManager(this.item, this.data);
						if (rfm.hasRelationship()) this.display = rfm.getRelationshipName();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_setFieldData(item, model)', '_dataChanged(data, item)'];
					}
				}]);

				return FieldItem;
			}());

			_export('FieldItem', FieldItem);

			Polymer(FieldItem);
		}
	};
});

'use strict';

System.register('common/layout/sb-field-table/FieldTable.js', [], function (_export, _context) {
	var _createClass, FieldTable;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldTable', FieldTable = function () {
				function FieldTable() {
					_classCallCheck(this, FieldTable);
				}

				_createClass(FieldTable, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-field-table';
						this.properties = {
							numColumns: {
								type: Number,
								value: 1
							},
							data: {
								type: Object,
								notify: true
							},
							fieldNames: String,
							md: Object,
							disabled: Boolean
						};
					}
				}, {
					key: 'generateColumns',
					value: function generateColumns() {
						var column1Group = [],
						    column2Group = [],
						    column3Group = [];
						var numFields = this.fieldNames.length;
						for (var i = 0; i < numFields; i++) {
							if (i % this.numColumns == 0) {
								column1Group.push(this.fieldNames[i]);
							} else if (i % this.numColumns == 1) {
								column2Group.push(this.fieldNames[i]);
							} else {
								column3Group.push(this.fieldNames[i]);
							}
						}

						if (this.numColumns == 1) this.columnOneWidth = 'td1';else if (this.numColumns == 2) {
							this.columnOneWidth = 'td2';
							this.columnTwoWidth = 'td2';
						} else {
							this.columnOneWidth = 'td3';
							this.columnTwoWidth = 'td3';
							this.columnThreeWidth = 'td3';
						}

						this.setColumns(column1Group, column2Group, column3Group);
					}
				}, {
					key: 'setColumns',
					value: function setColumns(column1Group, column2Group, column3Group) {
						if (column1Group.length > 0) {
							this.$.firstColumn.model = this.md;
							this.$.firstColumn.group = column1Group;
						}
						if (column2Group.length > 0) {
							this.$.secondColumn.model = this.md;
							this.$.secondColumn.group = column2Group;
						}
						if (column3Group.length > 0) {
							this.$.thirdColumn.model = this.md;
							this.$.thirdColumn.group = column3Group;
						}
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['generateColumns(md, fieldNames)'];
					}
				}]);

				return FieldTable;
			}());

			_export('FieldTable', FieldTable);

			Polymer(FieldTable);
		}
	};
});

'use strict';

System.register('common/layout/sb-filter-item/FilterItem.js', ['common/relationship/RelationshipFieldManager.js'], function (_export, _context) {
	var RelationshipFieldManager, _createClass, FilterItem;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FilterItem', FilterItem = function () {
				function FilterItem() {
					_classCallCheck(this, FilterItem);
				}

				_createClass(FilterItem, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-filter-item';
						this.properties = {
							value: {
								notify: true
							},
							item: String,
							model: Object,
							md: Object,
							hidden: {
								type: Boolean,
								value: false
							},
							label: String,
							display: String
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.handleKeyPress();
						this.addEventListener('lookup-value-changed', this.handleLabelChange);
					}
				}, {
					key: 'handleLabelChange',
					value: function handleLabelChange(e) {
						var data = {
							item: this.item.split('.')[0],
							value: e.detail.refDisplay
						};
						this.fire('filter-item-value-changed', data);
					}
				}, {
					key: 'handleKeyPress',
					value: function handleKeyPress() {
						this.addEventListener('keypress', function (e) {
							var item = this.item.split('.')[0];
							this.fire('filter-item-field-keypress', { keyCode: e.keyCode, item: item, itemType: this.model[item].model.type });
						}.bind(this));
					}
				}, {
					key: 'clear',
					value: function clear() {
						this.value = null;
					}
				}, {
					key: 'setMd',
					value: function setMd() {
						var item = this.item.split('.')[0];
						this.md = this.model[item].model;
						this.label = this.model[item].label ? this.model[item].label : this.model[item].record.Name;
						this.$.field.editing = true;
						this.$.field.property = this.item;
						this.$.field.md = this.md;
					}
				}, {
					key: 'setHidden',
					value: function setHidden() {
						var item = this.item;
						if (!this.data[item]) item = this.item.split('.')[0];

						if (this.data[item]) {
							this.hidden = this.data[item].hidden;
						}
					}
				}, {
					key: 'dataChanged',
					value: function dataChanged() {
						var id = this.item.split('.')[0];
						this.display = this.data[id].label;

						this.$.field.record = this;
					}
				}, {
					key: '_displayChanged',
					value: function _displayChanged() {
						var id = this.item.split('.')[0];
						var rfm = new RelationshipFieldManager(id, this.data);
						var relationship = rfm.buildRelationship(this.value, this.display, this.md.referenceTo[0]);
						if (relationship) this.data[id].label = relationship.value.Name;
					}
				}, {
					key: 'getValue',
					value: function getValue(name) {
						if (this.data[name]) return this.data[name].value;else for (var process in this.data) {
							if (this.data[process].field === name) return this.data[process].value;
						}

						return null;
					}
				}, {
					key: 'setValue',
					value: function setValue(path, value) {
						this.set('data.' + path, value);
					}
				}, {
					key: 'equals',
					value: function equals(filterItem) {
						return this.data === filterItem.data;
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setMd(item, model)', 'setHidden(data.*)', 'dataChanged(data, item)', '_displayChanged(value, display, item, data, md)'];
					}
				}]);

				return FilterItem;
			}());

			_export('FilterItem', FilterItem);

			Polymer(FilterItem);
		}
	};
});

'use strict';

System.register('common/layout/sb-filter-layout/FilterLayout.js', ['common/core/Page.js', 'common/data/format/DataBuilder.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var Page, DataBuilder, PageContainer, _createClass, FilterLayout;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FilterLayout', FilterLayout = function (_Page) {
				_inherits(FilterLayout, _Page);

				function FilterLayout() {
					_classCallCheck(this, FilterLayout);

					return _possibleConstructorReturn(this, (FilterLayout.__proto__ || Object.getPrototypeOf(FilterLayout)).apply(this, arguments));
				}

				_createClass(FilterLayout, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-filter-layout';
						this.properties = Polymer.Base.extend({
							searchModel: {
								type: Object,
								notify: true
							},
							filterPath: {
								type: String,
								value: 'searchFilters'
							},
							filterKey: String,
							filterDelegator: Object,
							searchFilterData: {
								type: Object,
								notify: true
							},
							searchFilterModel: {
								type: Object,
								notify: true
							},
							groupItems: {
								type: Array,
								notify: true },
							serviceLoader: String,
							quote: Object,
							enterCallback: Object,
							translationCallback: Object,
							spinner: {
								type: Boolean,
								notify: true
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.mdResponse();
						this.handleEnterKeyPressed();
					}
				}, {
					key: 'handleEnterKeyPressed',
					value: function handleEnterKeyPressed() {
						this.addEventListener('filter-item-field-keypress', function (e) {
							if (e.detail.keyCode !== 13 || typeof this.enterCallback !== 'function' || e.detail.itemType === 'reference') return;
							this.enterCallback();
						}.bind(this));
					}
				}, {
					key: 'searchModelReady',
					value: function searchModelReady() {
						if (this.searchModelInitialized === true) return;
						this.searchModelInitialized = true;
						if (this.filterKey === undefined) this.filterKey = this.searchModel.hasCustomSearchFilters ? 'Id' : 'Name';
						var properties = this.filterPath.split('.');
						this.path = 'this.searchModel';
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = properties[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var property = _step.value;

								this.path += '.' + property;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						var searchFilters = eval(this.path),
						    fields = [],
						    searchFilterModel = {};
						if (Array.isArray(searchFilters) === false) return;

						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = searchFilters[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var filter = _step2.value;

								fields.push(this.getSearchTable() + '.' + filter.targetFieldName);

								var duplicateHidden = searchFilterModel[this.filterDelegator.getGroupKey(filter)];
								searchFilterModel[this.filterDelegator.getGroupKey(filter)] = filter;
								if (duplicateHidden) searchFilterModel[this.filterDelegator.getGroupKey(filter)].hidden = duplicateHidden;
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						this.fields = this.filterDelegator.buildFields(fields);
						this.searchFilterModel = searchFilterModel;
					}
				}, {
					key: 'mdResponse',
					value: function mdResponse() {
						this.$.md.addEventListener('md-changed', function (e) {
							var mdResponse = e.detail.value;
							if (mdResponse === undefined) return;

							this.setFilterValueMap(mdResponse);
						}.bind(this));
					}
				}, {
					key: 'setFilterValueMap',
					value: function setFilterValueMap(mdResponse) {
						var groupItems = [];
						var groupKeys = [];
						if (this.searchFilterModel === undefined) return;

						for (var i in this.searchFilterModel) {
							if (this.searchFilterModel[i].hidden === true) continue;
							var fieldName = this.searchFilterModel[i].targetFieldName;
							groupItems.push(i + '.value');
							groupKeys.push(i);
							this.searchFilterModel[i].model = mdResponse.fieldsByObject[this.getSearchTable()][fieldName];
						}

						if (JSON.stringify(this.groupItems) !== JSON.stringify(groupItems)) this.groupItems = groupItems;
						this.filterDelegator.setDefaultFilterValues(groupKeys, this.searchFilterModel).then(function (searchFilterData) {
							if (!this.searchFilterData) this.searchFilterData = searchFilterData;
							this.filterDelegator.searchFilterModel = this.searchFilterModel;
							this.filterDelegator.groupItems = this.groupItems;
						}.bind(this));
					}
				}, {
					key: 'getSearchTable',
					value: function getSearchTable() {
						if (this.searchModel === undefined) return;

						return this.filterDelegator.getSearchTable();
					}
				}, {
					key: 'focusFirstField',
					value: function focusFirstField() {
						if (!this.isMobile()) this.$.panel.applyFocusToItem(0);
					}
				}, {
					key: 'runService',
					value: function runService(actionId, resultLimit, pageNumber, fieldSet) {
						if (this.serviceLoader === undefined || this.quote === undefined) return;

						this.spinner = true;
						var context = new DataBuilder().addQuote('quote', this.quote).addObject('filterContext', this.filterDelegator.getFilterContext()).add('additional', this.filterDelegator.getAdditionalProperties()).add('actionId', this.actionId).add('resultLimit', resultLimit).add('pageNumber', pageNumber).add('fieldSet', fieldSet).build();

						this.$.service.client.load(this.prefix, this.serviceLoader, null, context).then(function (result) {
							this.spinner = false;
							this.searchModel = this.localizer ? this.localizer.localizeSearchModel(result) : result;
						}.bind(this));
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['searchModelReady(searchModel, filterDelegator)'];
					}
				}, {
					key: 'prefix',
					get: function get() {
						return this.app.org.prefix;
					}
				}]);

				return FilterLayout;
			}(Page));

			_export('FilterLayout', FilterLayout);

			Polymer(FilterLayout);
		}
	};
});

'use strict';

System.register('common/layout/sb-group/Group.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, quiet, Group;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			quiet = typeof Visualforce !== 'undefined';

			_export('Group', Group = function () {
				function Group() {
					_classCallCheck(this, Group);
				}

				_createClass(Group, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-group';
						this.properties = {
							item: String,
							group: Array,
							data: {
								type: Object,
								notify: true
							},
							model: {
								type: Object,
								value: null
							},
							groupClass: String,
							itemClass: String,
							groupDisplay: Object,
							primaryItems: {
								type: Array,
								value: null
							},
							numPrimary: {
								type: Number,
								value: 0
							},
							includePrimaryInSecondary: {
								type: Boolean,
								value: false
							},
							selected: {
								type: Boolean,
								value: false,
								observer: 'updateSelected'
							},
							disabled: {
								type: Boolean,
								value: false,
								observer: 'updateDisabled'
							},

							pathPrefix: {
								type: String,
								value: ''
							},
							focusIndex: {
								type: Number,
								observer: 'updateFocusIndex'
							},
							itemClassMap: {
								type: Object,
								value: {}
							},
							itemEditableMap: {
								type: Object,
								observer: 'toggleEditable'
							},
							columnWidths: {
								type: Object,
								value: {}
							},
							signaler: {
								type: Object,
								observer: 'updateSignaler'
							}
						};
					}
				}, {
					key: 'buildGroup',
					value: function buildGroup() {
						this.initInternalGroupAndPrimaryItems();
						if (this.template) {
							if (this.template.group === this._group) {
								this.template.selected = this.selected;
								this.template.disabled = this.disabled;
								this.template.data = this.data;
								this.template.model = this.model;
								if (this.columnWidths && this.template.columnWidths != this.columnWidths) {
									this._updateColumnWidths();
								}
							} else if (!quiet) console.error('Rebuilding a group is no longer supported. Called by ' + this.domHost.tagName.toLowerCase() + ': old group [' + this.template.group + '], new group [' + this._group + ']');

							return;
						}
						this.expanded = false;
						this.template = document.createElement('template', 'dom-bind');
						this.template.group = this._group;
						this.template.selected = this.selected;
						this.template.disabled = this.disabled;
						this.template.signaler = this.signaler;
						this.template.model = this.model;
						this.template.data = this.data;
						this.template.columnWidths = this.columnWidths;
						this.buildItems(this.template);
						Polymer.dom(this.$.g).appendChild(this.template);

						Polymer.dom(this.$.g).observeNodes(function (info) {
							if (info.addedNodes[0]) this.bindElementEvents(Polymer.dom(info.addedNodes[0]).childNodes);
						}.bind(this));
					}
				}, {
					key: 'destroyGroup',
					value: function destroyGroup() {
						if (!this.template) return;

						try {
							this.elements = null;
							Polymer.dom(this.$.g).removeChild(this.template);
							Polymer.dom.flush();
							this.template = null;
							this.group = undefined;
						} catch (e) {
							return;
						}
					}
				}, {
					key: '_updateColumnWidths',
					value: function _updateColumnWidths() {
						if (!this.columnWidths) return;
						var items = Polymer.dom(this.$.g).querySelectorAll(this.item);

						if (!items || items && items.length == 0) {
							Polymer.RenderStatus.afterNextRender(this, function () {
								var items = Polymer.dom(this.$.g).querySelectorAll(this.item);
								this._setColumnWidths(items);
							});
						} else {
							this._setColumnWidths(items);
						}
					}
				}, {
					key: '_setColumnWidths',
					value: function _setColumnWidths(items) {
						for (var i = 0, l = items.length; i < l; i++) {
							var item = items[i],
							    fieldName = item.getAttribute('item');

							item.style.minWidth = this.columnWidths[fieldName] + 'px';
							item.style.maxWidth = this.columnWidths[fieldName] + 'px';
						}
					}
				}, {
					key: 'updateSelected',
					value: function updateSelected() {
						if (this.template) this.template.selected = this.selected;
					}
				}, {
					key: 'updateDisabled',
					value: function updateDisabled() {
						if (this.template) this.template.disabled = this.disabled;
					}
				}, {
					key: 'updateSignaler',
					value: function updateSignaler() {
						if (this.template) this.template.signaler = this.signaler;
					}
				}, {
					key: 'applyFocusToItem',
					value: function applyFocusToItem(focusIndex) {
						this.focusIndex = undefined;
						this.focusIndex = focusIndex;
					}
				}, {
					key: 'updateFocusIndex',
					value: function updateFocusIndex() {
						if (!this.template) return;

						if (!this.elements) return;

						if (this.focusIndex === undefined || this.focusIndex < 0) return;

						for (var i = 0, l = this.template.group.length; i < l; i++) {
							this.template['focus_' + i] = false;
							if (this.focusIndex === i) this.template['focus_' + i] = true;
						}
					}
				}, {
					key: 'initInternalGroupAndPrimaryItems',
					value: function initInternalGroupAndPrimaryItems() {
						this._group = this.group;

						this._primaryItems = undefined;

						if (!this.primaryItems || this.primaryItems.length === 0) return;

						var primaryItems = [].concat(this.primaryItems);

						if (this.group.indexOf(primaryItems[0]) === -1) primaryItems[0] = this.group[0];

						if (primaryItems.length > 1) {
							if (this.group.indexOf(primaryItems[1]) === -1) primaryItems = [primaryItems[0]];else primaryItems = [primaryItems[0], primaryItems[1]];
						}

						this._primaryItems = primaryItems;
						if (this.includePrimaryInSecondary) {
							this._group = primaryItems.concat(this.group);
							this._normalizeWithTemplateGroup();
							return;
						}

						var secondary = this.group.filter(function (item) {
							return primaryItems.indexOf(item) === -1;
						});

						this._group = primaryItems.concat(secondary);
						this._normalizeWithTemplateGroup();
					}
				}, {
					key: 'buildItems',
					value: function buildItems(template) {

						var doc = template.content.ownerDocument;
						var root = doc.createElement('div');
						if (this.groupClass) Polymer.dom(root).setAttribute('class', this.groupClass);

						var numPrimary = this.numPrimary > 0 ? this.numPrimary : this._primaryItems ? this._primaryItems.length : 0;
						this._group.forEach(function (item, index) {
							var html = '<' + this.item + ' ' + 'item="' + item + '" value="{{data.' + item + '}}" model="[[model]]" data="[[data]]" disabled="[[disabled]]" selected="[[selected]]" focus="[[focus_' + index + ']]" index="' + index + '"';

							var isPrimary = index < numPrimary;

							if (!isPrimary && this.groupDisplay && this.groupDisplay[item]) {
								html += ' field-label="' + this.groupDisplay[item] + '"';
							} else if (!isPrimary && this.groupDisplay && this.groupDisplay[item.split(".")[1]]) {
								html += ' field-label="' + this.groupDisplay[item.split(".")[1]] + '"';
							}

							var classes = '';
							if (this.itemClass) classes += this.itemClass + ' ';

							if (isPrimary) {
								classes += index === 0 ? 'primary first' : 'primary multi';
								classes += this.selected ? ' selected' : '';
							} else if (numPrimary > 0) {
								classes += 'secondary';
							}

							if (this.itemClassMap && this.itemClassMap[item]) {
								classes += ' ' + (this.itemClassMap[item].class || this.itemClassMap[item]);
								if (this.itemClassMap[item].style) html += ' style="' + this.itemClassMap[item].style + '"';
							}

							if (classes) html += ' class' + '=' + '"' + classes + '"';

							if (this.columnWidths && this.columnWidths[item]) {
								html += ' style' + '=' + '"min-width:' + this.columnWidths[item] + 'px;' + 'max-width:' + this.columnWidths[item] + 'px;"';
							}

							html += ' signaler="[[signaler]]"></' + this.item + '>';
							var div = doc.createElement('div');

							div.innerHTML = html;

							Polymer.dom(root).appendChild(Polymer.dom(div).firstChild);
						}.bind(this));
						Polymer.dom(template.content).appendChild(root);
					}
				}, {
					key: 'bindElementEvents',
					value: function bindElementEvents(elements) {
						this.elements = elements;
						var numElements = elements ? elements.length : 0;
						this.updateFocusIndex();

						this.propagateValueToParent = this.propagateValueToParent || function (e) {
							this.internal = true;
							this.set('data.' + e.target.item, e.detail.value);
							if (this.childToParentExtension) this.childToParentExtension({ path: 'data.' + e.target.item, value: e.detail.value });
							this.internal = false;
						}.bind(this);

						for (var i = 0; i < numElements; i++) {
							elements[i].removeEventListener('value-changed', this.propagateValueToParent);
							elements[i].addEventListener('value-changed', this.propagateValueToParent);
						}
					}
				}, {
					key: 'propagateFromParentToChild',
					value: function propagateFromParentToChild(e) {
						if (this.internal) return;

						if (e.path === 'data') return;

						if (this.propagateFromParentToChildOverride) {
							this.propagateFromParentToChildOverride(e);
							return;
						}

						this._propagateFromParentToChild(e);
					}
				}, {
					key: '_propagateFromParentToChild',
					value: function _propagateFromParentToChild(e) {
						var elements = this.elements;
						var numElements = elements ? elements.length : 0;

						var parts = e.path.split('.');
						var item = this.pathPrefix + parts[parts.length - 1];
						for (var i = 0; i < numElements; i++) {
							if (elements[i].item === item) {
								elements[i].value = e.value;
								return;
							}
						}
					}
				}, {
					key: 'handlePrimaryEvents',
					value: function handlePrimaryEvents() {
						if (this.primaryEventsResistered) return;

						this.addEventListener('group-selected', function (e) {
							var items = Polymer.dom(this.root).querySelectorAll(this.item + '.primary');
							for (var i = 0, l = items.length; i < l; i++) {
								this.toggleClass('selected', e.detail.selected, items[i]);
							}
						}.bind(this));

						this.addEventListener('group-expanded', function (e) {
							var primary = e.detail.path.filter(function (node) {
								var el = Polymer.dom(node);
								var tagName = el.node.tagName ? el.node.tagName.toLowerCase() : '';
								return tagName === this.item && el.classList.contains('primary');
							}.bind(this));

							if (!primary || primary.length === 0) return;

							this.toggleClass('initial', false, primary[0]);
							this.expanded = !this.expanded;


							if (this.domHost) {
								this.domHost.expanded = !this.domHost.expanded;
							}

							var items = Polymer.dom(this.root).querySelectorAll(this.item);
							for (var i = 0, l = items.length; i < l; i++) {
								var itemField = items[i].$$('sb-field');
								if (itemField) itemField.renderReadOnly = false;
								this.toggleClass('expanded', this.expanded, items[i]);
							}

							this.fire('expanded-changed', { expanded: this.expanded });
						}.bind(this));
						this.primaryEventsResistered = true;
					}
				}, {
					key: 'navigationChanged',
					value: function navigationChanged() {
						this.fire('group-selected', { selected: false }, { bubbles: false });
					}
				}, {
					key: 'overridePropagateFromParentToChild',
					value: function overridePropagateFromParentToChild(propagateFromParentToChildOverride) {
						if (typeof propagateFromParentToChildOverride !== 'function') return;

						this.propagateFromParentToChildOverride = propagateFromParentToChildOverride;
					}
				}, {
					key: 'setFromChildToParentExtension',
					value: function setFromChildToParentExtension(childToParentExtension) {
						if (typeof childToParentExtension !== 'function') return;

						this.childToParentExtension = childToParentExtension;
					}
				}, {
					key: 'toggleItemClass',
					value: function toggleItemClass(e) {
						var parts = e.path.split('.');
						if (parts.length === 1) return;

						var path = parts[1];
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.elements[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var element = _step.value;

								if (element.item === path) {
									for (var i = 0, l = e.value.length; i < l; i++) {
										element.toggleClass(e.value[i].class, e.value[i].value);
									}return;
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'toggleEditable',
					value: function toggleEditable() {
						if (!this.itemEditableMap) return;var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {

							for (var _iterator2 = this.elements[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var element = _step2.value;

								var editable = this.itemEditableMap[element.item];
								if (editable != null) element.editable = editable;
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}
					}
				}, {
					key: '_normalizeWithTemplateGroup',
					value: function _normalizeWithTemplateGroup() {
						if (!this.template || !this.template.group) return;

						if (this.template.group.length !== this._group.length) return;

						for (var i = 0, l = this._group.length; i < l; i++) {
							if (this.template.group[i] !== this._group[i]) return;
						}

						this._group = this.template.group;
					}
				}, {
					key: '_datePickerOpened',
					value: function _datePickerOpened(e) {
						var dateContainer = e.detail.dateContainer,
						    datepicker = e.detail.datepicker;

						datepicker.style.position = 'absolute';
						var dateRow = datepicker.offsetParent;

						var dateRowRect = dateRow.getBoundingClientRect(),
						    dateContainerRect = dateContainer.getBoundingClientRect();

						datepicker.style.left = -dateRowRect.left + dateContainerRect.left + 'px';
						datepicker.style.top = dateContainerRect.bottom - dateRowRect.top + 'px';

						if (dateContainerRect.left + datepicker.offsetWidth > window.innerWidth) {
							datepicker.style.left = '';
							datepicker.style.right = dateRowRect.right - dateContainerRect.right + 17 + 'px';
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildGroup(item, group, data, primaryItems, itemClassMap, columnWidths)', 'handlePrimaryEvents(template, _primaryItems)', 'propagateFromParentToChild(data.*)', 'toggleItemClass(itemClassMap.*)'];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'datepicker-opened': '_datePickerOpened'
						};
					}
				}]);

				return Group;
			}());

			_export('Group', Group);

			Polymer(Group);
		}
	};
});

'use strict';

System.register('common/layout/sb-html/Html.js', ['common/layout/tables/ImageCellSizer.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var DEFAULT_WIDTH, DEFAULT_HEIGHT, PageContainer, _createClass, CHECKBOX, CHECKBOX_DIRTY, CHECKBOX_CHECKED, CHECKBOX_CHECKED_DIRTY, Html;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutTablesImageCellSizerJs) {
			DEFAULT_WIDTH = _commonLayoutTablesImageCellSizerJs.DEFAULT_WIDTH;
			DEFAULT_HEIGHT = _commonLayoutTablesImageCellSizerJs.DEFAULT_HEIGHT;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			CHECKBOX = 'iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTQ0NzJFMzhEQjQwMTFFMEJENkNCN0I0QjBBMDU3MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RUQyN0E5N0NEQjQzMTFFMEJENkNCN0I0QjBBMDU3MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNDQ3MkUzNkRCNDAxMUUwQkQ2Q0I3QjRCMEEwNTczNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBNDQ3MkUzN0RCNDAxMUUwQkQ2Q0I3QjRCMEEwNTczNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnhkEREAAACaSURBVHjaYvz//z8DCKxdu1YLSJkBMRsDYfALiE8FBwdfA3EYQYYADZgPNeAUVAEhwAZTDzQokXHNmjUJQI49iMNAIoBafpAJSNgA8REG8gBInw3IEE4g/k6mISB9nEwMVACjhowaQqwhX4CYh0z9IH1fQIbMAuJpwMzkRGLmswfpA+mHFQUhQE4dEOuSYM5lIG4F5v6VAAEGAGkRMGla548DAAAAAElFTkSuQmCC';
			CHECKBOX_DIRTY = 'iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAABHNCSVQICAgIfAhkiAAAAGJ6VFh0UmF3IHByb2ZpbGUgdHlwZSBBUFAxAAB4nFXIsQ2AMAwAwd5TeIR3HBwyDkIBRUKAsn9BAQ1XnuztbKOveo9r60cTVVVVz5JrrmkBZl4GbhgJKF8t/ExEDQ8rHgYgD0i2FMl6UPBzAAAA30lEQVQ4je3OMU4CYRiE4ZnPZckmdDaewYR2KxISz+AB+G28gDHEws6ohBYKCrb2GCZU25rY2tpYQcRd5BsKbbRZWUp8+3kyxHfFMBz7iikPFKMirVlaQ3nzInsGAALAfHCeNVSmFHNQZRUCMRaVUsyb/Wngy+iqdzR/7Sb9aagc/6q4O8tceIwO3986JGbbAl+HMDOiE8Xrz8TgyzqIyZcOJgZ4nf1PbGfhH9kHJCKxcLJVZ+zGFoWF0X0CYfxx2zvZBlgNQhfCmO4TAkBxH04lXINs/1mRnsxwE19mDxtbAk/8Q+6dmAAAAABJRU5ErkJggg==';
			CHECKBOX_CHECKED = 'iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUY4QjA4OTVEQkY3MTFFMDgzQzJCMzYyMkRFM0JDMjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUY4QjA4OTZEQkY3MTFFMDgzQzJCMzYyMkRFM0JDMjgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFNjFGRUE4QURCRjMxMUUwODNDMkIzNjIyREUzQkMyOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5RjhCMDg5NERCRjcxMUUwODNDMkIzNjIyREUzQkMyOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpLVrhgAAAEoSURBVHjanJS9aoRAFIXnjjqykCcJpE21sJBXMA+QgIWFCoKFVbrgX2EhpEiTOqAPEUi1bSBPsrCwzeQe0SK77rp64ShX5nx3frxDWmuBaNv2ll/3LCWm48DaOo7zi4QAYcBHD9j2A6ZCDeMZ9ExN0zxxskEiZkZf/EvyY836FssCvjUgK9Z+IQS+lZzrStNUH3+bBcnzXJumKcqy/AcyrwUURaENwxBQFEU0OZPjKaOyZVlCKXUCGIVkWdZVHKZcVZWGGZAwDGms6AkkSRKSUgqsva7rDmDbtvB9n84tdXQ5cRwTIKgOgOd5dGm/zp5OEAQdyHVdmtr0i0d8DWCA7Fg3C/9Y+HaAvLPeuJkeZjbfBj74h6vgkZMX1t0Mzg/rlbv/80+AAQCVIVhcOwWhjQAAAABJRU5ErkJggg==';
			CHECKBOX_CHECKED_DIRTY = 'iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAABHNCSVQICAgIfAhkiAAAAGJ6VFh0UmF3IHByb2ZpbGUgdHlwZSBBUFAxAAB4nFXIsQ2AMAwAwd5TeIR3HBwyDkIBRUKAsn9BAQ1XnuztbKOveo9r60cTVVVVz5JrrmkBZl4GbhgJKF8t/ExEDQ8rHgYgD0i2FMl6UPBzAAABCUlEQVQ4jZ3UsUrDUBgF4HN+Y2KhTyK4dioUfAYfoDeLLyDayU1sRdcOHZLZxxA6dRV8ECm0acj/O9RiSGNu0jOf8907XC7xm+zVXWrOAc8shCdWcCfntoru0i8AIABk0zg12oDGFWg7HwJjeOhHk8Tx++12HOX5KJokzjuuJJvGqRo+AtFiaMSyK7C/EJZCDIOgsJ5AN6cgYrpRsCeAdhpuZ7EdYacAVag1Uh5ePCT0ItWTmoBapHplH1CLlIttgFqkbtAE/IuUhz6gEWkLAEBAYq1kv025GhX2aVgLVRcwzLfP4+suQP7iRjDMqbrYfwUzd2OGR5BXh5KBII5e+F/MPkXwFN6n7z9GMnsCPVgwRwAAAABJRU5ErkJggg==';

			_export('Html', Html = function () {
				function Html() {
					_classCallCheck(this, Html);
				}

				_createClass(Html, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-html';
						this.properties = {
							value: String,
							type: String,
							link: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							booleanValue: {
								type: Boolean,
								value: null,
								observer: 'registerTabIndexEvents'
							},
							isDirty: {
								type: Boolean,
								value: false
							},
							tabindex: {
								type: Number,
								reflectToAttribute: true
							}
						};
					}
				}, {
					key: 'sanitizeAndSetInnerHTML',
					value: function sanitizeAndSetInnerHTML() {
						if (this.isNil()) {
							var blankImage = '<img id="blank" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="width:50%; height:18px"/>';
							var useImage = !this.link && !this.isMobile();

							this.$.me.innerHTML = useImage ? blankImage : '';
							return;
						}

						if (this.booleanValue != null) {
							var checkboxBase64 = this.booleanValue ? CHECKBOX_CHECKED : CHECKBOX;
							if (this.isDirty) checkboxBase64 = this.booleanValue ? CHECKBOX_CHECKED_DIRTY : CHECKBOX_DIRTY;
							this.$.me.innerHTML = '<img id="checkbox" style="margin-top:5px" src="data:image/png;base64,' + checkboxBase64 + '"/>';
							return;
						}

						if (this.type === 'string' || this.type === 'textarea') {
							this.$.me.innerHTML = sanitizeHtmlText((this.value + '').trim());
						} else {
							this.$.me.textContent = (this.value + '').trim();
						}
						this.handleDefaultSizeIfImage();
					}
				}, {
					key: 'handleDefaultSizeIfImage',
					value: function handleDefaultSizeIfImage() {
						var imageNoWidth = this.$$('#me img:not([style*=width])');
						if (imageNoWidth) imageNoWidth = this.$$('#me img:not([width])');

						if (imageNoWidth) Polymer.dom(imageNoWidth).setAttribute('width', DEFAULT_WIDTH);

						var imageNoHeight = this.$$('#me img:not([style*=height])');
						if (imageNoHeight) imageNoHeight = this.$$('#me img:not([height])');

						if (imageNoHeight) Polymer.dom(imageNoHeight).setAttribute('height', DEFAULT_HEIGHT);
					}
				}, {
					key: 'isNil',
					value: function isNil() {
						return (this.value == null || (this.value + '').trim() === '') && this.booleanValue == null;
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'registerTabIndexEvents',
					value: function registerTabIndexEvents() {
						if (this.booleanValue == null) return;

						if (this._registeredTabIndexEvents) return;

						this.addEventListener('mouseenter', this.clearTabIndex.bind(this));
						this.addEventListener('mouseleave', this.restoreTabIndex.bind(this));
						this.addEventListener('tap', this.restoreTabIndex.bind(this));
						this._registeredTabIndexEvents = true;
					}
				}, {
					key: 'clearTabIndex',
					value: function clearTabIndex() {
						this._tabindex = this.tabindex;
						this.tabindex = undefined;
					}
				}, {
					key: 'restoreTabIndex',
					value: function restoreTabIndex() {
						this.tabindex = this._tabindex;
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['sanitizeAndSetInnerHTML(value, type, link, viewport, booleanValue, isDirty)'];
					}
				}]);

				return Html;
			}());

			_export('Html', Html);

			Polymer(Html);
		}
	};
});

'use strict';

System.register('common/layout/sb-lookup-layout/LookupLayout.js', ['common/layout/fields/FieldSetHandler.js', 'common/layout/tables/ImageCellSizer.js', 'common/layout/tables/TableClassBuilder.js', 'common/layout/data/RecordGrouper.js', 'common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js'], function (_export, _context) {
	var FieldSetHandler, ImageCellSizer, TableClassBuilder, RecordGrouper, PageContainer, AppContext, _createClass, LookupLayout;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutFieldsFieldSetHandlerJs) {
			FieldSetHandler = _commonLayoutFieldsFieldSetHandlerJs.FieldSetHandler;
		}, function (_commonLayoutTablesImageCellSizerJs) {
			ImageCellSizer = _commonLayoutTablesImageCellSizerJs.ImageCellSizer;
		}, function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonLayoutDataRecordGrouperJs) {
			RecordGrouper = _commonLayoutDataRecordGrouperJs.RecordGrouper;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LookupLayout', LookupLayout = function () {
				function LookupLayout() {
					_classCallCheck(this, LookupLayout);
				}

				_createClass(LookupLayout, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-lookup-layout';
						this.properties = {
							selectedRows: {
								type: Object,
								value: {},
								notify: true
							},
							searchModel: Object,
							totalCount: {
								type: String,
								notify: true
							},
							hasTotalCount: {
								notify: true
							},
							selectionIdDataPath: String,
							parentAttributesPath: String,
							additionalFields: Array,
							fieldPrefix: {
								type: String,
								value: ''
							},
							groupByField: String,
							groupByFieldType: String,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							primaryMobileCols: Array,
							_primaryMobileColumns: {
								type: Array,
								computed: '_getPrimaryMobileCols(primaryMobileCols, fieldSet)'
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.handleAllRowsSelected();
						this.handleOneRowSelected();
						this.handleMetaDataResponse();
						this.hiddenByGroup = {};
					}
				}, {
					key: 'handleMetaDataResponse',
					value: function handleMetaDataResponse() {
						this.$.md.addEventListener('md-changed', function (e) {
							this.initRecordKeysFieldLabelsAndTypeMap(e.detail.value.fields);
						}.bind(this));
					}
				}, {
					key: 'initFieldMetadata',
					value: function initFieldMetadata() {
						if (this.fieldMetadataInitialized) return;
						this.$.md.object = this.searchModel.targetObjectName;
						this.fieldSetHandler = new FieldSetHandler(this.searchModel, 'resultFieldNames', 'resultFieldNamesTablet', 'resultFieldNamesPhone');
						this.setFieldMetadata();
						this.fieldMetadataInitialized = true;
					}
				}, {
					key: 'setFieldMetadata',
					value: function setFieldMetadata() {
						this.fieldSet = this.fieldSetHandler.getByViewport(this.viewport);
						if (this.$.md.name === this.fieldSet.name) return false;

						this.$.md.fields = undefined;
						this.$.md.name = this.fieldSet.name;

						var metadataFields = this.fieldSet.fields;

						if (Array.isArray(this.additionalFields)) metadataFields = this.fieldSet.fields.concat(this.additionalFields);

						if (this.groupByField && metadataFields.indexOf(this.groupByField) === -1) {
							metadataFields = [this.groupByField].concat(metadataFields);
						}

						this.$.md.fields = metadataFields;
					}
				}, {
					key: 'initRecordKeysFieldLabelsAndTypeMap',
					value: function initRecordKeysFieldLabelsAndTypeMap(fields) {
						var recordKeys = [],
						    fieldLabels = [],
						    fieldLabelMap = {},
						    typeMap = {},
						    labelTypeMap = {},
						    itemTypeMap = {};

						fields.forEach(function (field) {
							if (this.groupByField === field.name) {
								this.groupByFieldType = field.type;

								if (this.fieldSet.fields.indexOf(field.name) === -1) {
									return;
								}
							}

							var key = field.name === 'UnitPrice' ? field.name : this.fieldPrefix + field.name;
							recordKeys.push(key);
							fieldLabels.push(field.label);
							fieldLabelMap[key] = field.label;
							typeMap[key] = { type: field.type };
							if (field.type.toLowerCase() === 'currency') typeMap[key].CurrencyIsoCode = this.currencyIsoCode;

							var type = field.type;
							if (!this.isMobileViewport()) {
								var imageWidth = new ImageCellSizer(field).getImageWidth(20);

								if (imageWidth) type += ':' + imageWidth;
							}

							labelTypeMap[field.label.replace(/\W/g, '')] = type;
							itemTypeMap[key] = type;
						}.bind(this));

						if (this.groupByFieldType === undefined) {
							this.groupByFieldType = null;
						}

						this.headerClassMap = new TableClassBuilder(Object.keys(labelTypeMap), 'Th', labelTypeMap).build();
						this.rowClassMap = new TableClassBuilder(recordKeys, 'Td', itemTypeMap).build();
						this.typeMap = typeMap;
						this.recordKeys = recordKeys;
						this.fieldLabels = fieldLabels;
						this.fieldLabelMap = fieldLabelMap;
					}
				}, {
					key: 'handleAllRowsSelected',
					value: function handleAllRowsSelected() {
						this.addEventListener('header-selection-changed', function (e) {
							var selected = e.detail.selected;
							this.toggleRowSelections(selected);
						}.bind(this));
					}
				}, {
					key: 'toggleRowSelections',
					value: function toggleRowSelections(selected, group) {
						var rows = Polymer.dom(this.$.tbody).querySelectorAll('sb-table-row');
						if (rows && rows.length > 0) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var row = _step.value;

									if (group && (row.grouper || row.groupie && row.groupie !== group)) continue;
									var items = Polymer.dom(row.$.row.root).querySelectorAll('sb-table-cell.primary');
									row.selected = selected;

									for (var i = 0, l = items.length; i < l; i++) {
										this.toggleClass('selected', selected, items[i]);
									}
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}
					}
				}, {
					key: 'handleOneRowSelected',
					value: function handleOneRowSelected() {
						this.addEventListener('selection-changed', function (e) {
							var selected = e.detail.selected;
							var recordId = e.detail.Id;
							if (selected && !e.detail.group) {
								if (this.selectedRows === null) this.selectedRows = {};
								this.selectedRows[recordId] = {
									record: { Id: recordId, attributes: e.detail.attributes, UnitPrice: e.detail.rowData.UnitPrice },
									invalid: !!e.detail.group
								};
							}
							if (!selected && !e.detail.group && this.selectedRows) delete this.selectedRows[recordId];

							if (e.detail.group) this.toggleRowSelections(selected, e.detail.group);
						}.bind(this));
					}
				}, {
					key: 'deSelectAll',
					value: function deSelectAll() {
						this.$.header.selected = undefined;
						this.$.header.selected = false;
					}
				}, {
					key: 'setViewResults',
					value: function setViewResults() {
						this.selectedRows = {};
						var viewResults = this.getViewResults(this.searchModel.results);
						this.hasGroupedField = !!this.groupByField;

						if (!this.hasGroupedField) {
							this.viewResults = viewResults;
							return;
						}

						if (this.viewResults) viewResults = JSON.parse(JSON.stringify(this.getViewResults(this.searchModel.results)));

						if (this.isMobileViewport()) {
							this.expandAll(viewResults);
							this.viewResults = viewResults;
							this.setGroupExpandedHandler(false);
							return;
						}

						var groupFieldNames = [this.fieldSet.fields[0], 'Id'];
						var recordPath = 'record.' + this.searchModel.targetObjectName;
						var groupCountPath = { path: 'record._transient_.' + this.searchModel.targetObjectName + '.' + groupFieldNames[0], property: 'suffix' };
						var groupFieldTypePath = { path: 'record._transient_.' + this.searchModel.targetObjectName + '.' + groupFieldNames[0] + '.md', property: 'type' };

						var grouper = new RecordGrouper(this.groupByField, groupFieldNames, recordPath, { hidden: true }, this.hiddenByGroup, { hidden: false }, groupCountPath, this.groupByFieldType, groupFieldTypePath);
						this.viewResults = grouper.group(viewResults);

						this.setGroupExpandedHandler(true);

						if (this.viewResults.length === this.searchModel.results.length + 1) {
							this.expandAll(this.viewResults);
							Polymer.RenderStatus.afterNextRender(this, function () {
								var groupRow = this.$$('sb-table-row');
								groupRow.grouperExpanded = true;
								this.hiddenByGroup[groupRow.grouper] = { hidden: false };
							});
						}
					}
				}, {
					key: 'getViewResults',
					value: function getViewResults(products) {
						var prefix = this.org.prefix ? this.org.prefix + '__' : '';
						var results = [];
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = (products || [])[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var product = _step2.value;

								var result = { followed: product.followed, record: {} };
								for (var field in product.record) {
									if (field === 'UnitPrice' && product.record.Product2[prefix + 'HidePriceInSearchResults__c']) {
										continue;
									}
									result.record[field] = product.record[field];
								}
								results.push(result);
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						return results;
					}
				}, {
					key: 'expandAll',
					value: function expandAll(viewResults) {
						for (var i = 0, l = viewResults.length; i < l; i++) {
							viewResults[i].hidden = false;
						}
					}
				}, {
					key: 'isSelected',
					value: function isSelected(row) {
						if (!this.selectedRows) return false;
						return !!this.selectedRows[row.Id];
					}
				}, {
					key: 'isExpanded',
					value: function isExpanded(group) {
						return !!(this.hiddenByGroup[group] && this.hiddenByGroup[group].hidden === false);
					}
				}, {
					key: 'setGroupExpandedHandler',
					value: function setGroupExpandedHandler(isGrouped) {
						this.groupExpandedHandler = this.groupExpandedHandler || function (e) {
							this.expandGroupedViewResults(e.detail.group, e.detail.expanded);
						}.bind(this);
						this.removeEventListener('sb-row-group-tapped', this.groupExpandedHandler);
						if (isGrouped) this.addEventListener('sb-row-group-tapped', this.groupExpandedHandler);
					}
				}, {
					key: 'expandGroupedViewResults',
					value: function expandGroupedViewResults(group, expanded) {
						for (var i = 0, l = this.viewResults.length; i < l; i++) {
							if (group === this.viewResults[i].groupie) this.set('viewResults.' + i + '.hidden', !expanded);
						}
						this.hiddenByGroup[group] = { hidden: !expanded };
					}
				}, {
					key: 'isMobileViewport',
					value: function isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'updateTotalCount',
					value: function updateTotalCount() {
						if (this.searchModel.totalCount !== null) this.totalCount = this.searchModel.totalCount;
						this.hasTotalCount = this.totalCount > 0;
					}
				}, {
					key: '_getPrimaryMobileCols',
					value: function _getPrimaryMobileCols() {
						var primaryMobileCols = [].concat(this.primaryMobileCols);

						if (primaryMobileCols && primaryMobileCols.length > 0 && this.fieldSet.name.endsWith('Phone')) {
							var parts = primaryMobileCols[0].split('.');
							var prefix = parts.length > 1 ? parts[0] + '.' : '';
							primaryMobileCols[0] = prefix + this.fieldSet.fields[0];
						}

						return primaryMobileCols;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.AppContext, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setViewResults(searchModel, fieldSet, groupByFieldType)', 'initFieldMetadata(searchModel)', 'updateTotalCount(searchModel.totalCount)'];
					}
				}]);

				return LookupLayout;
			}());

			_export('LookupLayout', LookupLayout);

			Polymer(LookupLayout);
		}
	};
});

'use strict';

System.register('common/layout/sb-popup/Popup.js', [], function (_export, _context) {
	var _createClass, Popup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Popup', Popup = function () {
				function Popup() {
					_classCallCheck(this, Popup);
				}

				_createClass(Popup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-popup';
						this.properties = {
							url: String,
							messenger: Object,
							channel: {
								type: String,
								value: 'sbQQ'
							},
							responseMessage: {
								type: Object,
								notify: true
							},
							closePopup: {
								type: String,
								value: 'sb-close-popup'
							},
							autoLaunched: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('sb-close-dialog', this.close.bind(this));
					}
				}, {
					key: 'open',
					value: function open() {
						this._initRpc();
						this._sendMessage();
						this._handleAutoLaunch();
						this.$.dialog.toggle();
					}
				}, {
					key: 'close',
					value: function close() {
						this._close(this._getRedirectDetails(false));
					}
				}, {
					key: '_close',
					value: function _close(redirectDetails) {
						if (this.rpc) this.rpc.destroy();
						this.$.dialog.toggle();
						var frame = this.$.dialog.$$('#content').querySelector('#easyXDM_' + this.channel + '_provider');
						if (frame) frame.remove();
						this.fire('iron-signal', { name: 'sb-navigation-changed' });
						this.fire(this.closePopup, { redirect: redirectDetails });
					}
				}, {
					key: '_initRpc',
					value: function _initRpc() {
						if (!this.url) return;

						this.rpc = new easyXDM.Rpc({ remote: this.url, container: this.$.dialog.$$('#content'), channel: this.channel }, { remote: { postMessage: {} }, local: { postMessage: this._receiveMessage.bind(this) }
						});
					}
				}, {
					key: '_sendMessage',
					value: function _sendMessage() {
						var outgoing = {};
						if (this.messenger && typeof this.messenger.getRequest === 'function') outgoing = this.messenger.getRequest();

						outgoing.redirect = this._getRedirectDetails(this.autoLaunched);
						this.rpc.postMessage(JSON.stringify(outgoing));
					}
				}, {
					key: '_handleAutoLaunch',
					value: function _handleAutoLaunch() {
						if (this.autoLaunched) this.fire('iron-signal', { name: 'sb-auto-launch-popup' });
					}
				}, {
					key: '_receiveMessage',
					value: function _receiveMessage(incoming) {
						this.debounce('_receiveMessage', function () {
							if (!this.messenger || typeof this.messenger.getResponse !== 'function') {
								this.close();
								return;
							}
							var received = JSON.parse(incoming);
							this._logReceivedMessage(received);
							this.responseMessage = this.messenger.getResponse(received);
							var redirectDetails = received.redirect ? received.redirect : this._getRedirectDetails(this.autoLaunched);
							this._close(redirectDetails);
						}.bind(this), 100);
					}
				}, {
					key: '_logReceivedMessage',
					value: function _logReceivedMessage(received) {
						console.log('RPC Received Message:');
						console.log(received);
					}
				}, {
					key: '_getRedirectDetails',
					value: function _getRedirectDetails(redirect) {
						return { auto: !!redirect, save: !!redirect };
					}
				}]);

				return Popup;
			}());

			_export('Popup', Popup);

			Polymer(Popup);
		}
	};
});

'use strict';

System.register('common/layout/sb-side-panel/SidePanel.js', [], function (_export, _context) {
	var _createClass, SidePanel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SidePanel', SidePanel = function () {
				function SidePanel() {
					_classCallCheck(this, SidePanel);
				}

				_createClass(SidePanel, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-side-panel';
						this.properties = {
							renderHeader: {
								type: Boolean,
								value: true
							},
							icon: String,
							arrows: String,

							sideText: String,

							rightSideButton: Boolean
						};
					}
				}, {
					key: 'closeDrawer',
					value: function closeDrawer() {
						this.fire('x-clicked');
					}
				}, {
					key: 'keyCheck',
					value: function keyCheck(event) {
						if (event.keyCode == 13) {
							this.fire('enter-keypress');
						}
					}
				}, {
					key: 'toggleDrawer',
					value: function toggleDrawer() {
						this.fire('side-toggle-clicked');
					}
				}, {
					key: 'setIcon',
					value: function setIcon() {
						if (this.isOpen === "open") {
							this.icon = 'sf-icon-left';
						} else {
							this.icon = 'sf-icon-right';
							this.arrows = 'closedArrows';
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setIcon(isOpen)'];
					}
				}]);

				return SidePanel;
			}());

			_export('SidePanel', SidePanel);

			Polymer(SidePanel);
		}
	};
});

'use strict';

System.register('common/layout/sb-swipe-container/SwipeContainer.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, SwipeContainer;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SwipeContainer', SwipeContainer = function () {
				function SwipeContainer() {
					_classCallCheck(this, SwipeContainer);
				}

				_createClass(SwipeContainer, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-swipe-container';

						this.listeners = {
							'expanded-changed': 'onGroupExpanded'
						};

						this.properties = {
							disableSwipe: {
								type: Boolean,
								value: false
							},
							preventSwipe: {
								type: Boolean,
								value: false
							},
							isRequiredRowNotSelected: {
								type: Boolean,
								value: false
							},
							groupExpanded: {
								type: Boolean,
								value: false
							},
							swipeHeader: Object,
							swipeMenu: Object,
							swipeItems: {
								type: Array,
								value: []
							},
							swipeItemWidth: {
								type: Number,
								value: 58
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: '_preventSwipe',
					value: function _preventSwipe() {
						this.preventSwipe = this.isRequiredRowNotSelected || this.groupExpanded;
					}
				}, {
					key: 'onGroupExpanded',
					value: function onGroupExpanded(e) {
						this.groupExpanded = e.detail.expanded;
						this._preventSwipe();
					}
				}, {
					key: 'attached',
					value: function attached() {
						var isMobile = this.viewport && this.viewport.isMobile();

						if (!isMobile || this.disableSwipe) {
							this.style.minWidth = "100%";
							this.style.position = "static";
							return;
						}

						Polymer.dom(this.$.content).observeNodes(function (mutations) {
							for (var i = 0; i < mutations.addedNodes.length; i++) {
								this._findSwipeHeaderAndMenu(mutations.addedNodes[i]);
							}
						}.bind(this));
					}
				}, {
					key: '_findSwipeHeaderAndMenu',
					value: function _findSwipeHeaderAndMenu(node) {
						if (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.COMMENT_NODE) {
							return;
						}

						if (node.id === 'swipe-header') {
							this._initSwipeHeader(node);
							return;
						}

						if (node.id === 'swipe-menu') {
							this._initSwipeMenu(node);
							return;
						}
					}
				}, {
					key: '_initSwipeHeader',
					value: function _initSwipeHeader(node) {
						var swipeHeader = this.swipeHeader = node;
						var swipeHeaderStyle = swipeHeader.style;

						if (this.viewport && !this.viewport.isMobile()) {
							swipeHeaderStyle.maxWidth = '100%';
							swipeHeaderStyle.display = 'table';

							return;
						}

						swipeHeaderStyle.maxWidth = '50%';
						swipeHeaderStyle.position = 'relative';

						this.listen(node, 'track', '_onTrack');
						this.setScrollDirection('y', node);
					}
				}, {
					key: '_closeMenuWhenTapped',
					value: function _closeMenuWhenTapped(swipeMenu, swipeContainer) {
						swipeMenu.addEventListener('tap', function () {
							swipeContainer._animate(100, 1, swipeContainer.swipeHeader);
						});
					}
				}, {
					key: '_initSwipeMenu',
					value: function _initSwipeMenu(node) {
						node.style.maxWidth = '50%';
						this._closeMenuWhenTapped(node, this);

						if (this.swipeItems && this.swipeItems.length) {
							for (var k = 0; k < this.swipeItems.length; k++) {
								var swipeItem = this.swipeItems[k];
								swipeItem.style.position = '';
								swipeItem.style.width = '0px';
							}
						}

						this.swipeMenu = node;
						var allNodesOfSwipeMenu = [],
						    swipeMenuItems = [];

						if (node.children[0].shadowRoot) {
							if (node.children[0].nodeName === 'SB-ACTIONS') {
								Polymer.dom(node.children[0].shadowRoot).flush();
								allNodesOfSwipeMenu = node.children[0].shadowRoot.children;
							} else if (node.children[0].nodeName === 'SB-CUSTOM-ACTION') {
								allNodesOfSwipeMenu = node.children;
							}
						} else {

							if (node.children[0].nodeName === 'SB-ACTIONS') {
								Polymer.dom(node.children[0]).flush();
								allNodesOfSwipeMenu = node.children[0].children;
							} else if (node.children[1].nodeName === 'SB-CUSTOM-ACTION') {
								Polymer.dom(node.children[1]).flush();
								allNodesOfSwipeMenu = node.children;
							}
						}

						for (var i = 0, len = allNodesOfSwipeMenu.length; i < len; i++) {
							var currentNode = allNodesOfSwipeMenu[i];

							if (this._isValidSwipeMenuItem(currentNode)) {
								swipeMenuItems.push(currentNode);
							}
						}

						this.swipeItems = swipeMenuItems;

						var width = this.swipeItemWidth * this.swipeItems.length;

						node.style.width = width + 'px';

						for (var j = 0, swipeItemsLen = this.swipeItems.length; j < swipeItemsLen; j++) {
							var _swipeItem = this.swipeItems[j];

							this.toggleClass('swipe-menu-item', true, _swipeItem);

							var speed = (200 - (swipeItemsLen - 1) * 20) * swipeItemsLen;

							this.style.transition = 'transform ' + speed + 'ms ease-out';
							this._setSwipeItemStyles(_swipeItem.style, speed, width);
						}
					}
				}, {
					key: '_setSwipeItemStyles',
					value: function _setSwipeItemStyles(swipeItemStyle, speed, width) {
						swipeItemStyle.transition = 'transform ' + speed + 'ms ease-out';
						swipeItemStyle.webkitBackfaceVisibility = 'hidden';
						swipeItemStyle.borderRadius = 0;
						swipeItemStyle.position = 'absolute';
						swipeItemStyle.left = 0;
						swipeItemStyle.height = '100%';
						swipeItemStyle.width = '57px';
					}
				}, {
					key: '_onTrack',
					value: function _onTrack(event) {
						if (this.preventSwipe || !this.swipeItems.length) {
							return;
						}

						var target = event.currentTarget,
						    track = event.detail;

						if (track.state === 'track') {
							this._trackMove(track, target);
						}
					}
				}, {
					key: '_trackMove',
					value: function _trackMove(event, target) {
						this._animate(event.dx, event.dy, target);
					}
				}, {
					key: '_animate',
					value: function _animate(dx, dy, blah) {
						var direction = dx > 0 ? 1 : -1;

						if (direction === -1 && Math.abs(dy) < 20 && dx < -60) {
							this.fire('row-swiped', { 'isOpen': true });

							var cho = parseFloat(getComputedStyle(this.swipeItems[0]).width);
							var nag = cho.toPrecision(5) * this.swipeItems.length;

							var distance = nag * direction;
							this.style.transform = 'translate3d(' + distance + 'px, 0, 0)';
							this.style.webkitBackfaceVisibility = 'hidden';

							for (var i = this.swipeItems.length - 1; i >= 0; i--) {
								var dist = i * cho.toPrecision(5);
								this.swipeItems[i].style.width = cho.toPrecision(5) + 'px';
								this.swipeItems[i].style.transform = 'translate3d(' + dist + 'px, 0, 0)';
							}

							return;
						}

						if (direction === 1 && Math.abs(dy) < 20 && dx > 25) {
							this.fire('row-swiped', { 'isOpen': false });

							var originalPosition = 0;
							this.style.transform = 'translate3d(' + originalPosition + '%, 0, 0)';
							this.style.webkitBackfaceVisibility = 'hidden';

							for (var i = 0; i < this.swipeItems.length; i++) {
								var trans = 'translate3d(' + originalPosition + '%, 0, 0)';

								this.swipeItems[i].style.transform = trans;
							}

							return;
						}
					}
				}, {
					key: '_isValidSwipeMenuItem',
					value: function _isValidSwipeMenuItem(currentNode) {
						if ((currentNode.nodeName.toLowerCase() === 'span' || currentNode.$$ && currentNode.$$('span')) && !currentNode.classList.contains('ignore-in-mobile')) {
							if (currentNode.$$ && currentNode.$$('span')) {
								var fav = currentNode.$$('span');

								if ((fav.id === 'removeFromFavBtn' || fav.id === 'addToFavBtn') && fav.style.display === 'none') {
									return false;
								}
							}

							if (!currentNode.classList.contains('visibilityHidden')) {
								return true;
							} else {
								currentNode.style.display = 'none';
							}
						}

						return false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_preventSwipe(isRequiredRowNotSelected)'];
					}
				}]);

				return SwipeContainer;
			}());

			_export('SwipeContainer', SwipeContainer);

			Polymer(SwipeContainer);
		}
	};
});

'use strict';

System.register('common/layout/sb-table-cell/TableCell.js', ['common/relationship/RelationshipFieldManager.js', 'common/layout/fields/FieldHider.js'], function (_export, _context) {
	var RelationshipFieldManager, FieldHider, _createClass, TableCell;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}, function (_commonLayoutFieldsFieldHiderJs) {
			FieldHider = _commonLayoutFieldsFieldHiderJs.FieldHider;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TableCell', TableCell = function () {
				function TableCell() {
					_classCallCheck(this, TableCell);
				}

				_createClass(TableCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-table-cell';
						this.properties = {
							item: String,
							disabled: Boolean,
							hide: Object,
							value: {
								notify: true
							},
							data: {
								type: Object,
								value: null
							},
							model: {
								type: Object,
								value: null
							}
						};
					}
				}, {
					key: 'buildCell',
					value: function buildCell() {
						this.setDisabled();
						this.setHidden();
						this.setRecordId();
						this.setSuffix();

						if (this.model && this.model[this.item] && this.model[this.item].type) {
							this.setFieldMetadataFromModel();
							return;
						}

						var type = 'string';
						this.md = this.md || { type: type };
					}
				}, {
					key: 'setDisabled',
					value: function setDisabled() {
						this.disabled = !!(this.data && this.data.disabled);
					}
				}, {
					key: 'setHidden',
					value: function setHidden() {
						var hidden = !this.data ? false : this.data.hidden;
						this.hide = new FieldHider(hidden).hide;
					}
				}, {
					key: 'setRecordId',
					value: function setRecordId() {
						this.recordId = this.data ? this.data.Id : null;
					}
				}, {
					key: 'setSuffix',
					value: function setSuffix() {
						if (this.data && this.data['_transient_'] && this.get(['data', '_transient_', this.item, 'suffix']) != null) this.suffix = this.get(['data', '_transient_', this.item, 'suffix']);else this.suffix = undefined;
					}
				}, {
					key: 'overrideWidth',
					value: function overrideWidth() {
						if (this.data && this.data.fullWidthItem && this.classList.contains(this.data.fullWidthItem)) this.style.width = '100%';else if (this.style.width == '100%') this.style.width = null;
					}
				}, {
					key: 'setFieldMetadataFromModel',
					value: function setFieldMetadataFromModel() {
						var md = this.model[this.item];

						if (this.data && this.data['_transient_'] && this.get(['data', '_transient_', this.item, 'md']) != null) md = this.get(['data', '_transient_', this.item, 'md']);

						this.$.field.link = !!md.link;
						this.$.field.readOnly = true;

						this.md = md;
					}
				}, {
					key: 'dataChanged',
					value: function dataChanged() {
						var rfm = new RelationshipFieldManager(this.item, this.data);
						if (rfm.hasRelationship()) this.display = rfm.getRelationshipName();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildCell(item, value, model, data)', 'setDisabled(data.disabled)', 'setRecordId(data.Id)', 'overrideWidth(data.setItemToFullWidth)', 'dataChanged(data, item)'];
					}
				}]);

				return TableCell;
			}());

			_export('TableCell', TableCell);

			Polymer(TableCell);
		}
	};
});

'use strict';

System.register('common/layout/sb-table-cell-select/TableCellSelect.js', ['common/layout/fields/FieldHider.js'], function (_export, _context) {
	var FieldHider, _createClass, TableCellSelect;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutFieldsFieldHiderJs) {
			FieldHider = _commonLayoutFieldsFieldHiderJs.FieldHider;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TableCellSelect', TableCellSelect = function () {
				function TableCellSelect() {
					_classCallCheck(this, TableCellSelect);
				}

				_createClass(TableCellSelect, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-table-cell-select';
						this.properties = {
							item: String,
							isRadio: {
								type: Boolean,
								computed: '_isRadio(item)'
							},
							value: {
								notify: true
							},
							data: {
								type: Object,
								observer: 'init'
							}
						};
					}
				}, {
					key: 'init',
					value: function init() {
						Polymer.dom(this.$.s).observeNodes(function () {
							this._setDisabled();
							this._setHidden();
						}.bind(this));
					}
				}, {
					key: '_isRadio',
					value: function _isRadio() {
						return this.item === 'radio';
					}
				}, {
					key: '_setDisabled',
					value: function _setDisabled() {
						this.disabled = !!(this.data && this.data.disabled);
					}
				}, {
					key: '_setHidden',
					value: function _setHidden() {
						var hidden = !this.data ? false : this.data.hidden;
						var hider = new FieldHider(hidden, Polymer.Base);
						hider.applyTo(this.$$('#' + this.item));
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return TableCellSelect;
			}());

			_export('TableCellSelect', TableCellSelect);

			Polymer(TableCellSelect);
		}
	};
});

'use strict';

System.register('common/layout/sb-table-header/TableHeader.js', ['common/core/sb-page-container/PageContainer.js', 'common/layout/fields/FieldHider.js'], function (_export, _context) {
	var PageContainer, FieldHider, _createClass, TableHeader;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonLayoutFieldsFieldHiderJs) {
			FieldHider = _commonLayoutFieldsFieldHiderJs.FieldHider;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TableHeader', TableHeader = function () {
				function TableHeader() {
					_classCallCheck(this, TableHeader);
				}

				_createClass(TableHeader, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-table-header';
						this.properties = {
							cols: Array,
							selectable: Boolean,
							selectionType: {
								type: String,
								value: 'checkbox'
							},
							selected: {
								type: Boolean,
								value: false,
								notify: true
							},
							headerClassMap: {
								type: Object,
								value: {}
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							headerActions: Array,
							hideHiddenSelectable: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.isMobile = this._isMobileViewport();
					}
				}, {
					key: '_isMobileViewport',
					value: function _isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: 'setIsMobile',
					value: function setIsMobile(viewport) {
						if (viewport) {
							return viewport.isMobile();
						}
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: 'buildLabels',
					value: function buildLabels() {
						var data = {};
						var group = [];
						this.cols.forEach(function (col) {
							if (!col) return;

							var item = col.replace(/\W/g, '');
							group.push(item);
							data[item] = col;
						});

						this.$.header.data = undefined;
						this.$.header.itemClassMap = this.headerClassMap;
						if (!this.$.header.group) this.$.header.group = group;
						this.$.header.data = data;
					}
				}, {
					key: 'setSelectable',
					value: function setSelectable() {
						if (!this.selectable) return;

						this.$.selection.addEventListener('data-changed', function (e) {
							this.internal = true;
							this.selected = typeof e.detail.value[this.selectionType] !== 'undefined' ? e.detail.value[this.selectionType] : e.detail.value;
							this.internal = false;
							this.fire('header-selection-changed', { selected: this.selected });
						}.bind(this));
					}
				}, {
					key: 'setSelected',
					value: function setSelected() {
						if (this.internal) return;
						var key = this.selectionType === 'radio' ? 'radio' : 'checkbox';
						if (!this.$.selection.group) this.$.selection.group = [key];
						var selectionData = {};

						var value = this.selected;
						selectionData[key] = value;
						var hidden = new FieldHider(!this.selectable).hide;
						hidden.type = 'invisible';
						selectionData.hidden = hidden;
						this.$.selection.data = selectionData;

						var hideSelection = this.hideHiddenSelectable ? !this.selectable : false;
						this.toggleClass('hidden', hideSelection, this.$.selection);
					}
				}, {
					key: '_showHeaderActions',
					value: function _showHeaderActions(position) {
						if (!this.headerActions || this.headerActions.length === 0) {
							return false;
						}

						for (var i = 0, l = this.headerActions.length; i < l; i++) {
							if (this.headerActions[i].position == position && !this.headerActions[i].hidden) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildLabels(cols, headerClassMap)', 'setSelectable(selectable, selectionType)', 'setSelected(selected, selectable, selectionType)'];
					}
				}]);

				return TableHeader;
			}());

			_export('TableHeader', TableHeader);

			Polymer(TableHeader);
		}
	};
});

'use strict';

System.register('common/layout/sb-table-row/TableRow.js', ['common/core/sb-page-container/PageContainer.js', 'common/layout/fields/FieldHider.js', 'common/signal/RowFocusSignaler.js'], function (_export, _context) {
	var PageContainer, FieldHider, RowFocusSignaler, _createClass, TableRow;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonLayoutFieldsFieldHiderJs) {
			FieldHider = _commonLayoutFieldsFieldHiderJs.FieldHider;
		}, function (_commonSignalRowFocusSignalerJs) {
			RowFocusSignaler = _commonSignalRowFocusSignalerJs.RowFocusSignaler;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TableRow', TableRow = function () {
				function TableRow() {
					_classCallCheck(this, TableRow);
				}

				_createClass(TableRow, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-table-row';

						this.listeners = {
							'row-swiped': 'onRowSwiped'
						};

						this.properties = {
							cell: String,
							cols: Array,
							colsDisplay: Object,
							rowActions: Array,
							routeSource: String,
							rowData: {
								type: Object,
								notify: true
							},
							model: {
								type: Object,
								value: null
							},
							requiresModel: {
								type: Boolean,
								value: false
							},
							selectable: {
								type: Boolean,
								value: false
							},
							selected: {
								type: Boolean,
								value: false,
								notify: true
							},
							selectionType: {
								type: String,
								value: 'checkbox'
							},
							disabledData: {
								type: Object,
								value: {
									'disabled': false,
									'constrained': false
								}
							},
							selectionIdDataPath: {
								type: String,
								value: 'Id'
							},
							parentIdDataPath: {
								type: String,
								value: 'Parent'
							},
							parentAttributesPath: String,
							primaryMobileCols: {
								type: Array,
								value: []
							},
							repeatPrimaryMobileCols: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: {
								type: Boolean,
								value: false,
								computed: 'setIsMobile(viewport)'
							},
							actionId: {
								type: String,
								computed: 'setActionId(isMobile)'
							},
							grouper: String,
							grouperExpanded: Boolean,
							groupie: String,
							ignoreViewportChange: Boolean,
							rowClassMap: {
								type: Object,
								value: {}
							},
							editFirstWhenSelected: {
								type: String,
								value: ''
							},
							index: Number,
							disableSwipe: {
								type: Boolean,
								value: false
							},
							expanded: {
								type: Boolean,
								value: false
							},
							expandDisabled: {
								type: Boolean,
								value: false
							},
							hideSelection: {
								type: Object,
								value: null
							},
							selectionClass: {
								type: String,
								value: null
							},
							leftClass: {
								type: String,
								value: '',
								computed: 'setLeftClass(routeSource, rowData, selected)'
							},
							highlightRowOnFocus: {
								type: Boolean,
								observer: '_highlightRowOnFocus'
							}
						};
					}
				}, {
					key: 'onRowSwiped',
					value: function onRowSwiped(e) {
						this.expandDisabled = e.detail.isOpen;
					}
				}, {
					key: 'setIsMobile',
					value: function setIsMobile(viewport) {
						if (viewport) {
							return viewport.isMobile();
						}
					}
				}, {
					key: 'setActionId',
					value: function setActionId(isMobile) {
						return isMobile ? 'swipe-menu' : '';
					}
				}, {
					key: 'buildRow',
					value: function buildRow() {
						if (this.requiresModel && !this.model) return;

						this.$.row.groupDisplay = undefined;
						this.expanded = false;

						this.setPrimaryMobileColumnsIfMobileViewport();
						this.$.row.itemClassMap = this.rowClassMap;
						this.$.row.groupDisplay = this.colsDisplay;
						if (!this.$.row.group) this.$.row.group = this.cols;
					}
				}, {
					key: 'setSelectable',
					value: function setSelectable() {
						if (!this.selectable) return;

						this.$.selection.addEventListener('data-changed', function (e) {
							var selected = this.selected;
							this.internal = true;
							this.selected = typeof e.detail.value[this.selectionType] !== 'undefined' ? e.detail.value[this.selectionType] : e.detail.value;
							this.$.row.selected = this.selected;
							this.internal = false;

							var changed = selected !== this.selected;
							var path = e.detail.path === 'data.checkbox' || e.detail.path == 'data.radio';
							if (this.editFirstWhenSelected && this.selected && changed) this.editFirst();

							Polymer.RenderStatus.afterNextRender(this, this.fireSetSelectionEvent.bind(this, changed, path));
						}.bind(this));
					}
				}, {
					key: 'editFirst',
					value: function editFirst() {
						var itemToEdit = this.$.row.$$(this.cell).$$(this.editFirstWhenSelected);
						if (itemToEdit && typeof itemToEdit.edit === 'function') itemToEdit.edit();
					}
				}, {
					key: 'fireSetSelectionEvent',
					value: function fireSetSelectionEvent(changed, path) {
						this.fire('selection-changed', {
							selected: this.selected,
							selectionType: this.selectionType,
							Id: this.get('rowData.' + this.selectionIdDataPath),
							bundleId: this.get('rowData.' + this.parentIdDataPath),
							attributes: this.parentAttributesPath === undefined ? undefined : this.get('rowData.' + this.parentAttributesPath),
							group: this.grouper,
							changed: changed,
							path: path,
							index: this.index,
							rowData: this.rowData
						});
					}
				}, {
					key: 'setSelected',
					value: function setSelected() {
						if (!this.selectable || this.internal) return;

						this._setSelected(this.selected);
					}
				}, {
					key: '_setSelected',
					value: function _setSelected(selected) {
						if (this.disabledData.constrained && selected === true) {
							this.internal = true;
							this.$.row.fire('group-selected', { selected: false });
							selected = false;
							this.internal = false;
						}

						var defaultHidden = new FieldHider(this.routeSource === 'Configurator' && this.hasDeleteAction()).hide;
						if (this.hideSelection != null) {
							var hidden = new FieldHider(this.hideSelection).hide;
							Polymer.Base.extend(defaultHidden, hidden);
						}

						this.selectionData = { hidden: defaultHidden };
						this.selectionData[this.selectionType] = selected;
						this.selectionData.disabled = this.disabledData.disabled || this.disabledData.constrained;
						this.$.selection.data = this.selectionData;

						if (this.$.selection.group === undefined) this.$.selection.group = [this.selectionType];
						this.toggleClass('td', this.selectable && !defaultHidden.hidden || defaultHidden.type === 'invisible', this.$.selectionContainer);
						this.toggleClass('innerTd', this.selectable && !defaultHidden.hidden || defaultHidden.type === 'invisible', this.$.selection);
						this.toggleClass('selection', this.selectable && !defaultHidden.hidden || defaultHidden.type === 'invisible', this.$.selection);
						if (this.selectionClass) this.toggleClass(this.selectionClass, true, this.$.selection);
					}
				}, {
					key: 'select',
					value: function select(e) {
						if (this.selectionData !== undefined && this.selectionData.disabled === true) return;
						var rootTarget = Polymer.dom(e).rootTarget;
						var tagName = rootTarget && rootTarget.tagName ? rootTarget.tagName.toLowerCase() : '';
						if (tagName === 'sb-group') this._setSelected(!this.selected);

						this.$.row.fire('group-selected', {
							selected: this.selected,
							selectionDisabled: this.selectionDisabled,
							tableRow: this
						});
					}
				}, {
					key: 'expand',
					value: function expand(e) {
						if (this.expandDisabled) return;

						var path = e.detail && e.detail.preventer ? Polymer.dom(e.detail.preventer).path : Polymer.dom(e).path;
						this.$.row.fire('group-expanded', { path: path });
					}
				}, {
					key: 'setPrimaryMobileColumnsIfMobileViewport',
					value: function setPrimaryMobileColumnsIfMobileViewport() {
						this.$.row.numPrimary = this.primaryMobileCols.length;
						this.$.row.primaryItems = this.isMobileViewport() ? this.primaryMobileCols : null;
						this.$.row.includePrimaryInSecondary = this.isMobileViewport() ? this.repeatPrimaryMobileCols : false;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
						if (this.ignoreViewportChange) return;
						this.setPrimaryMobileColumnsIfMobileViewport();
					}
				}, {
					key: 'setGrouper',
					value: function setGrouper() {
						var isGrouper = !this.isMobileViewport() && !!this.grouper;
						this.toggleClass('groupTr', isGrouper, this);
						this.toggleClass('groupTd', isGrouper, this.$.row);
						this.toggleClass('groupExpandTd', isGrouper, this.$.rowDiv);
						this.setGrouperToggle(isGrouper);
						if (isGrouper) this.rowData.fullWidthItem = 'firstInnerTd';else this.rowData.fullWidthItem = null;
					}
				}, {
					key: 'setGrouperToggle',
					value: function setGrouperToggle(isGrouper) {
						this._toggleGroupHandler = this._toggleGroupHandler || this.toggleGroupHandler.bind(this);
						this.$.rowDiv.removeEventListener('tap', this._toggleGroupHandler);
						if (isGrouper) this.$.rowDiv.addEventListener('tap', this._toggleGroupHandler);
					}
				}, {
					key: 'toggleGroupHandler',
					value: function toggleGroupHandler(e) {
						var expected = e.detail && e.detail.expand;
						var eventTarget = Polymer.dom(e).localTarget;
						var isExpanded = Polymer.dom(eventTarget).classList.contains('expanded');
						isExpanded = isExpanded || !!Polymer.dom(eventTarget).querySelector('.expanded');
						if (expected === isExpanded) return;

						this.setGrouperClasses(!isExpanded);
						this.fire('sb-row-group-tapped', { expanded: !isExpanded, group: this.grouper });
					}
				}, {
					key: 'setGrouperClasses',
					value: function setGrouperClasses(expanded) {
						this.toggleClass('expanded', expanded, this.$.row);
						this.toggleClass('expanded', expanded, this);
					}
				}, {
					key: 'isMobileViewport',
					value: function isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'displayRowActions',
					value: function displayRowActions(position) {
						if (!position) {
							return true;
						}

						if (!this.rowActions || this.rowActions.length === 0) {
							return false;
						}

						for (var i = 0, l = this.rowActions.length; i < l; i++) {
							if (this.rowActions[i].position == position && !this.rowActions[i].hidden) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: 'hasDeleteAction',
					value: function hasDeleteAction() {
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.rowActions[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var action = _step.value;

								if (action.title === 'Delete') return true;
								return false;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: '_configurationRequired',
					value: function _configurationRequired() {
						if (this.routeSource !== 'Configurator' || !this.rowData.configurationRequired || !this.selected || !!this.rowData.configured) {
							return false;
						}
						return true;
					}
				}, {
					key: 'setLeftClass',
					value: function setLeftClass() {
						if (this._configurationRequired()) {
							if (!this.rowData.added) {
								return 'left';
							}
						}
					}
				}, {
					key: '_highlightRowOnFocus',
					value: function _highlightRowOnFocus() {
						this.signaler = this.signaler || new RowFocusSignaler(this, 'row', this.cell, 'swipe-header');
						this.signaler.signalOnFocus('sb-row-focus-signal', !this.highlightRowOnFocus);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildRow(cell, cols, colsDisplay, rowData, model, primaryMobileCols, repeatPrimaryMobileCols, requiresModel, rowClassMap)', 'setSelectable(selectable)', 'setSelected(selected, selectable, selectionType, rowActions, routeSource, disabledData, hideSelection, selectionClass)', 'setGrouper(rowData, grouper)', 'setGrouperClasses(grouperExpanded, grouper)'];
					}
				}]);

				return TableRow;
			}());

			_export('TableRow', TableRow);

			Polymer(TableRow);
		}
	};
});

'use strict';

System.register('common/layout/sb-tabs/Tabs.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, Tabs;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Tabs', Tabs = function () {
				function Tabs() {
					_classCallCheck(this, Tabs);
				}

				_createClass(Tabs, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-tabs';
						this.properties = {
							tabs: Array,
							pageComponent: {
								type: String,
								value: null
							},
							pageData: {
								type: Object,
								value: {}
							},
							commonData: {
								type: Object,
								value: {}
							},
							selectedTabIndex: {
								type: Number,
								value: 0
							},
							selectedPageIndex: {
								type: Number,
								value: 0
							},
							tabsClass: {
								type: String,
								value: 'horizontal layout center-justified'
							},
							usePagination: {
								type: Boolean,
								value: false
							},
							paginationClass: {
								type: String,
								value: 'horizontal layout center-justified'
							},
							viewport: {
								type: Object,
								observer: '_viewportChanged',
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							tabLimit: {
								type: Number,
								value: 0
							},
							rendered: {
								type: Boolean,
								value: false
							},
							overflowTab: Object,
							overflowTabClass: String,
							overflowTabMenuClass: String,
							menuMaskClass: String,
							bindingData: {
								type: Object,
								value: {}
							},
							bind: {
								type: Array,
								value: []
							},
							attributes: {
								type: Array,
								value: []
							},
							hideTabs: {
								type: Boolean,
								value: false
							},
							pageElements: {
								type: Array,
								value: []
							}
						};
					}
				}, {
					key: 'render',
					value: function render() {
						this._enforceValidTabSelected();
						this._buildTabs();
						Polymer.dom(this.$.paperTabs).observeNodes(function () {
							this.rendered = true;
							if (!this.tabs || this.tabs.length <= 0) return;
							this._viewportChanged();
						}.bind(this));
					}
				}, {
					key: 'destroyTabs',
					value: function destroyTabs() {
						if (!this.template) return;

						try {
							var pages = Polymer.dom(this.$.pages);
							var childNodes = pages.childNodes;
							for (var i = 0, l = childNodes.length; i < l; i++) {
								pages.removeChild(childNodes[i]);
							}
							Polymer.dom.flush();
							this.template = null;
							this.selectedTabIndex = 0;
						} catch (e) {
							return;
						}
					}
				}, {
					key: '_enforceValidTabSelected',
					value: function _enforceValidTabSelected() {
						if (isNaN(this.selectedPageIndex) || this.tabs && this.tabs.length <= this.selectedPageIndex || this.selectedPageIndex < 0 || this.selectedPageIndex % 1 !== 0) {
							this.selectedPageIndex = 0;
						}
					}
				}, {
					key: '_buildTabs',
					value: function _buildTabs() {
						if (this.template) {
							this._initTemplateData(this.template);
							return;
						}
						this.template = document.createElement('template', 'dom-bind');
						this._buildPages(this.template);
						this._initTemplateData(this.template);
						Polymer.dom(this.$.pages).appendChild(this.template);

						Polymer.dom.flush();

						Polymer.dom(this.$.pages).observeNodes(function (info) {
							for (var i = 0, l = info.addedNodes.length; i < l; i++) {
								this.pageElements = this.pageElements.concat(Polymer.dom(info.addedNodes[i]).childNodes);
							}this.bindElementEvents(this.pageElements);
						}.bind(this));
					}
				}, {
					key: 'setPageElements',
					value: function setPageElements(elements) {
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = (elements || [])[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var element = _step.value;

								this.pageElements.push(element);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: '_initTemplateData',
					value: function _initTemplateData(template) {
						template.pageData = this.pageData;
						template.commonData = this.commonData;
						for (var key in this.bindingData) {
							template[key] = this.bindingData[key];
						}
						this.templateBindData(template);
					}
				}, {
					key: '_buildPages',
					value: function _buildPages(template) {
						var doc = template.content.ownerDocument;
						this._bind = [];
						this.tabs.forEach(function (tab) {
							var page = tab.pageComponent || this.pageComponent;
							if (!page) return;
							var d = doc.createElement('div');
							var elem = doc.createElement(page);
							Polymer.dom(elem).setAttribute('name', tab.name);
							Polymer.dom(elem).setAttribute('label', tab.label);
							Polymer.dom(elem).setAttribute('tabs', true);
							Polymer.dom(elem).setAttribute('key', tab.key);
							Polymer.dom(elem).setAttribute('page-data', '[[pageData.' + tab.name + ']]');
							Polymer.dom(elem).setAttribute('common-data', '[[commonData]]');
							for (var key in this.bindingData) {
								Polymer.dom(elem).setAttribute(Polymer.CaseMap.camelToDashCase(key), '{{' + key + '}}');
							}
							var attributes = tab.attributes || this.attributes || {};
							var _iteratorNormalCompletion2 = true;
							var _didIteratorError2 = false;
							var _iteratorError2 = undefined;

							try {
								for (var _iterator2 = attributes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
									var attr = _step2.value;

									Polymer.dom(elem).setAttribute(attr.name, attr.value);
								}
							} catch (err) {
								_didIteratorError2 = true;
								_iteratorError2 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion2 && _iterator2.return) {
										_iterator2.return();
									}
								} finally {
									if (_didIteratorError2) {
										throw _iteratorError2;
									}
								}
							}

							this.appendBindData(tab, elem);
							Polymer.dom(d).appendChild(elem);
							Polymer.dom(template.content).appendChild(d);
						}.bind(this));
					}
				}, {
					key: 'appendBindData',
					value: function appendBindData(tab, elem) {
						var bind = tab.bind || this.bind;
						if (!bind) return;

						this._bind = this._bind.concat(bind.filter(function (item) {
							return this._bind.indexOf(item) < 0;
						}.bind(this)));

						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = bind[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var key = _step3.value;

								Polymer.dom(elem).setAttribute(Polymer.CaseMap.camelToDashCase(key), '{{' + key + '}}');

								this._addComplexObserverEffect('updateData(' + key + ')');
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}
					}
				}, {
					key: 'templateBindData',
					value: function templateBindData(template) {
						this.requiresTemplateBindData = this._bind && this._bind.length > 0;
						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = this._bind[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var bind = _step4.value;

								if (this.__data__[bind] && this.__data__[bind] !== this[bind] || this[bind] === undefined) {
									this[bind] = this.__data__[bind];
								}

								if (this[bind] !== undefined) {
									this.requiresTemplateBindData = false;
									template[bind] = this[bind];
								}
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}
					}
				}, {
					key: 'displayPage',
					value: function displayPage(selectedTabIndex) {
						var selectedTab = Polymer.dom(this.$.paperTabs).querySelectorAll('paper-tab')[selectedTabIndex];

						if (selectedTab != null) {
							if (selectedTab.id === 'overflowTab' && selectedTabIndex != 0) {
								return this.selectedPageIndex;
							}
						}
						this.selectedPageIndex = +selectedTabIndex;
						return selectedTabIndex;
					}
				}, {
					key: 'setPaginationListener',
					value: function setPaginationListener() {
						if (this.usePagination) {
							this.addEventListener('pagination-changed', function (e) {
								var paperTabs = Polymer.dom(this.$.paperTabs).node;
								var overflowTab = Polymer.dom(paperTabs.querySelector('#overflowTab')).node;
								var tabLimit = this.tabLimit;
								var tabLength = this.tabs.length;

								this.selectedTabIndex = e.detail.index;

								if (this.selectedTabIndex >= tabLimit && tabLength - 1 > tabLimit) {
									this._displayOverflowTabName(overflowTab, this.tabs[this.selectedTabIndex].label);

									paperTabs.selected = paperTabs.getElementsByTagName('paper-tab').length - 1;
									this.$$('#pagination').pageIndex = +e.detail.index;
								} else if (tabLength - 2 > tabLimit) {
									this._displayOverflowTabName(overflowTab, this.tabs[tabLimit].label);
								}
							});
						}
					}
				}, {
					key: 'closeMenu',
					value: function closeMenu(isMenuItemSelected) {
						var selectedPage = this.selectedPageIndex;
						this.overflowTabMenuClass = '';
						this.menuMaskClass = '';

						if (isMenuItemSelected !== true && selectedPage < this.tabLimit) {
							this.selectedTabIndex = selectedPage;
						}
					}
				}, {
					key: 'updateData',
					value: function updateData(e) {
						if (this.template && e && e.path) this.template.set(e.path, e.value);
					}
				}, {
					key: 'selectTab',
					value: function selectTab(e) {
						var index = parseInt(e.currentTarget.id);
						var overflowTab = Polymer.dom(this.$.paperTabs.querySelector('#overflowTab')).node;
						var tabLimit = this.tabLimit;

						if (Number.isInteger(index)) {
							this.selectedPageIndex = index;
							this._deselectPreviouslySelectedTab();
							Polymer.dom(this.$.pages).node.selected = index;
							this.set('tabs.' + index + '.className', 'overflow selected');
							this.overflowTab = this.tabs[index];
							if (this.tabs[index].iconId) {
								var iconSpan = this.$$('#' + this.tabs[index].iconId + '-overflow');
								this.toggleClass('hideIconClass', false, iconSpan);
							}

							this._displayOverflowTabName(overflowTab, e.currentTarget.textContent);
							this.overflowTabClass = 'overflowTab iron-selected';
							this.closeMenu(true);
						} else if (this.tabs.length - 1 > tabLimit) {
							this._deselectPreviouslySelectedTab();
							this._displayOverflowTabName(overflowTab, this.tabs[tabLimit].label);
						}
					}
				}, {
					key: '_handleEvent',
					value: function _handleEvent(e) {
						var event = e.currentTarget.getAttribute('data-tap-event');
						var id = e.currentTarget.getAttribute('id');
						var firedEventName = event != null ? event : 'tab-' + Polymer.CaseMap.camelToDashCase(id);
						this.fire(firedEventName + '-tapped', {
							event: event,
							Id: id
						});
					}
				}, {
					key: 'showMenu',
					value: function showMenu() {
						this.overflowTabMenuClass = 'showOverflowTabMenu';
						this.menuMaskClass = 'showMenuMask';
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: '_displayOverflowTabName',
					value: function _displayOverflowTabName(overflowTab, tabToDisplay) {
						if (tabToDisplay.length > 7) {
							tabToDisplay = tabToDisplay.slice(0, 7) + ' ...';
						}

						Polymer.dom(overflowTab).firstChild.textContent = tabToDisplay;
						this.overflowTabClass = 'overflowTab';
					}
				}, {
					key: '_handleOverFlow',
					value: function _handleOverFlow() {
						var paperTabs = Polymer.dom(this.$.paperTabs).node;
						var selectedPage = this.selectedPageIndex;
						var overflowTab = Polymer.dom(paperTabs.querySelector('#overflowTab')).node;
						var pagination = Polymer.dom(this.$$('#pagination')).node;
						var tabLimit = this.tabLimit;
						var tabLength = this.tabs.length;
						var tabClassName = void 0,
						    tabIndex = void 0;

						this.overflowTabClass = '';

						for (var i = 0; i < tabLength; i++) {
							tabClassName = 'noOverflow';
							tabIndex = tabLimit;

							if (i >= tabLimit) {
								if (tabLength - 1 > tabLimit) {
									if (i === tabLength - 1) {
										if (selectedPage >= tabLimit) {
											tabIndex = selectedPage;
										}
										this.overflowTab = this.tabs[tabIndex];
										this._displayOverflowTabName(overflowTab, this.tabs[tabIndex].label);
									}
									tabClassName = 'overflow';
								}
							}

							if (this.tabs[i].iconId) {
								var iconSpan = this.$$('#' + this.tabs[i].iconId);
								var hideIcon = !(tabClassName == 'noOverflow' || tabClassName == 'overflow' && i >= tabLimit && i != tabLength - 1);
								this.toggleClass('hideIconClass', hideIcon, iconSpan);

								if (tabClassName == 'overflow' && i === selectedPage) {
									var overflowIconSpan = this.$$('#' + this.tabs[i].iconId + '-overflow');
									this.toggleClass('hideIconClass', false, overflowIconSpan);
								}
							}
							this.set('tabs.' + i + '.className', i === selectedPage ? tabClassName + ' iron-selected' : tabClassName);
						}

						if (selectedPage < tabLimit || tabLength - 1 === tabLimit && selectedPage === tabLimit) {
							this.selectedTabIndex = selectedPage;
							this.set('tabs.' + selectedPage + '.className', this.tabs[selectedPage].className.replace(' selected', ''));
						} else if (selectedPage >= tabLimit) {
							paperTabs.selected = tabLength;
							this.overflowTabClass = 'overflowTab iron-selected';
							this.set('tabs.' + selectedPage + '.className', 'overflow selected');
						}

						if (this.usePagination) {
							if (pagination != null) {
								pagination.pageIndex = selectedPage;
							}
						}
					}
				}, {
					key: '_handleSelectedChanged',
					value: function _handleSelectedChanged() {
						this._enforceValidTabSelected();
						this.fire('selected-page-changed', this.selectedPageIndex);
						this.fireTabSelected();
					}
				}, {
					key: 'fireTabSelected',
					value: function fireTabSelected() {
						if (this.pageElements.length > this.selectedPageIndex) this.pageElements[this.selectedPageIndex].fire('sb-tab-selected');
					}
				}, {
					key: '_deselectPreviouslySelectedTab',
					value: function _deselectPreviouslySelectedTab() {
						var tabIndex = parseInt(Polymer.dom(this.$.overflowTabMenu.querySelector('.selected')).node.id);

						if (Number.isInteger(tabIndex)) {
							this.set('tabs.' + tabIndex + '.className', this.tabs[tabIndex].className.replace(' selected', ''));
						}
					}
				}, {
					key: '_viewportChanged',
					value: function _viewportChanged() {
						if (this.rendered) {
							if (this.viewport && this.viewport.XL.up) {
								this.tabLimit = 8;
							} else if (this.viewport && this.viewport.L.up) {
								this.tabLimit = 6;
							} else if (this.viewport && this.viewport.M.up) {
								this.tabLimit = 5;
							} else if (this.viewport && this.viewport.S.up) {
								this.tabLimit = 3;
							} else if (this.viewport && this.viewport.XS.up) {
								this.tabLimit = 2;
							}
							this._handleOverFlow();
						}
					}
				}, {
					key: 'bindElementEvents',
					value: function bindElementEvents(elements) {
						var numElements = elements ? elements.length : 0;
						if (numElements == 0) return;

						this.fireTabSelected();
						for (var key in this.bindingData) {
							var dashKey = Polymer.CaseMap.camelToDashCase(key);
							for (var i = 0; i < numElements; i++) {
								elements[i].addEventListener(dashKey + '-changed', function (e) {
									if (e.detail.path) this.domHost.set(e.detail.path, e.detail.value);
								}.bind(this));
							}

							this.domHost.addEventListener(dashKey + '-changed', function (e) {
								if (!e.detail.path) return;
								for (var _i = 0; _i < numElements; _i++) {
									elements[_i].set(e.detail.path, e.detail.value);
								}
							}.bind(this));
						}

						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = this._bind[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var bind = _step5.value;

								var dashBind = Polymer.CaseMap.camelToDashCase(bind);
								for (var _i2 = 0; _i2 < numElements; _i2++) {
									elements[_i2].addEventListener(dashBind + '-changed', function (e) {
										if (e.detail.path) this.domHost.set(e.detail.path, e.detail.value);
									}.bind(this));
								}
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}

						if (this.requiresTemplateBindData) this.templateBindData(this.template);
					}
				}, {
					key: '_propertyChanged',
					value: function _propertyChanged(property, value) {
						if (this.template && this._bind.indexOf(property.split('.')[0]) !== -1) this.template.set(property, value);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['render(tabs, pageComponent, pageData, commonData, bindingData, bind, attributes)', 'setPaginationListener(usePagination)', 'updateData(pageData.*)', 'updateData(commonData.*)', '_handleSelectedChanged(selectedPageIndex, pageElements)'];
					}
				}]);

				return Tabs;
			}());

			_export('Tabs', Tabs);

			Polymer(Tabs);
		}
	};
});

'use strict';

System.register('common/layout/table-layout-builder/TableLayoutBuilder.js', ['common/layout/tables/ImageCellSizer.js'], function (_export, _context) {
	var ImageCellSizer, _createClass, TableLayoutBuilder;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutTablesImageCellSizerJs) {
			ImageCellSizer = _commonLayoutTablesImageCellSizerJs.ImageCellSizer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TableLayoutBuilder', TableLayoutBuilder = function () {
				function TableLayoutBuilder(parentElWidth, columns, md, actionsOnTheLeft, hasSelection) {
					_classCallCheck(this, TableLayoutBuilder);

					this.parentElWidth = parentElWidth;
					this.md = md;
					this.columns = columns;
					this.actionsOnTheLeft = actionsOnTheLeft;
					this.hasSelection = hasSelection;
				}

				_createClass(TableLayoutBuilder, [{
					key: 'build',
					value: function build() {
						this.layout = {};
						this.availableWidth = this._getAvailableWidth();

						var totalWidth = 0,
						    minWidth = 150,
						    numOfCols = this.columns.length,
						    widthPerCol = this.availableWidth / numOfCols,
						    imageCols = [];

						for (var i = 0; i < numOfCols; i++) {
							var col = this.columns[i],
							    colWidth = minWidth;
							var imageWidth = new ImageCellSizer(this.md[col], 0).getImageWidth(25);
							if (imageWidth > minWidth) {
								colWidth = imageWidth;
								imageCols.push(col);
							} else if (widthPerCol > minWidth) {
									colWidth = Math.ceil(widthPerCol * this._getMultiplier(col));
								}
							this.layout[col] = colWidth;
							totalWidth += colWidth;
						}

						this.totalColsWidth = totalWidth;

						if (widthPerCol > minWidth) {
							var diff = totalWidth - this.availableWidth,
							    numberOfColsDivisor = numOfCols - imageCols.length,
							    totalAdjustedWidth = 0;
							this.totalColsWidth = 0;
							for (var j = 0; j < numOfCols; j++) {
								var _col = this.columns[j];
								var isImageColumn = imageCols.indexOf(_col) !== -1;

								var adjustedWidth = !isImageColumn ? Math.ceil(this.layout[_col] - diff / numberOfColsDivisor) : this.layout[_col];
								totalAdjustedWidth += adjustedWidth;

								if (j == numOfCols - 1) {
									adjustedWidth -= totalAdjustedWidth - this.availableWidth;
								}
								this.layout[_col] = adjustedWidth;
								this.totalColsWidth += adjustedWidth;
							}
						}
						return this.layout;
					}
				}, {
					key: '_getAvailableWidth',
					value: function _getAvailableWidth() {
						return this.parentElWidth - this._getStaticColsWidth() - 12;
					}
				}, {
					key: 'getTotalWidth',
					value: function getTotalWidth() {
						return this.totalColsWidth + this._getStaticColsWidth() + 10;
					}
				}, {
					key: '_getStaticColsWidth',
					value: function _getStaticColsWidth() {
						var width = 40 + 95;
						if (this.hasSelection) {
							width += 30;
						}
						return width;
					}
				}, {
					key: 'getLeftOffset',
					value: function getLeftOffset() {
						var offset = 40;
						if (this.actionsOnTheLeft) {
							offset += 95;
						}
						if (this.hasSelection) {
							offset += 30;
						}
						return offset;
					}
				}, {
					key: '_getMultiplier',
					value: function _getMultiplier(col) {
						var type = this.md[col] ? this.md[col].type : 'currency';

						switch (type.toUpperCase()) {
							case 'STRING':
								return 1.5;
								break;
							case 'BOOLEAN':
								return 1;
								break;
							case 'DATE':
								return 1.3;
								break;
							case 'DOUBLE':
							case 'CURRENCY':
							case 'PERCENT':
							case 'NUMBER':
								return 1.6;
								break;
							case 'PICKLIST':
							case 'MULTIPICKLIST':
								return 1.4;
								break;
							case 'REFERENCE':
								return 1.6;
								break;
							case 'TEXTAREA':
								return 1.6;
								break;
						}
					}
				}]);

				return TableLayoutBuilder;
			}());

			_export('TableLayoutBuilder', TableLayoutBuilder);
		}
	};
});

'use strict';

System.register('common/layout/tables/ImageCellSizer.js', [], function (_export, _context) {
	var _createClass, DEFAULT_WIDTH, DEFAULT_HEIGHT, ImageCellSizer;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DEFAULT_WIDTH', DEFAULT_WIDTH = 60);

			_export('DEFAULT_WIDTH', DEFAULT_WIDTH);

			_export('DEFAULT_HEIGHT', DEFAULT_HEIGHT = 60);

			_export('DEFAULT_HEIGHT', DEFAULT_HEIGHT);

			_export('ImageCellSizer', ImageCellSizer = function () {
				function ImageCellSizer(metadata, labelMultiplier) {
					_classCallCheck(this, ImageCellSizer);

					this.metadata = metadata;
					this.labelMultiplier = labelMultiplier != null ? labelMultiplier : 9;
				}

				_createClass(ImageCellSizer, [{
					key: 'getImageWidth',
					value: function getImageWidth(padding) {
						var imageWidth = this._getImageWidth(padding, 0);
						if (imageWidth == null) return;
						var width = -1;
						do {
							width = Math.max(width, imageWidth.width);
							imageWidth = this._getImageWidth(padding, imageWidth.end);
						} while (imageWidth != null);

						if (this.hasInvalidWidth) this._warnInvalidWidthParameter();

						return width;
					}
				}, {
					key: '_getImageWidth',
					value: function _getImageWidth(padding, start) {
						if (!this.metadata) return;

						var imageFunctionStartIndex = this._getImageFunctionStart(start);

						if (imageFunctionStartIndex === -1) return;

						var imageFunctionEndIndex = this._getImageFunctionEnd(imageFunctionStartIndex);

						var imageFunction = this.metadata.calculatedFormula.substring(imageFunctionStartIndex, imageFunctionEndIndex);

						var args = imageFunction.split(',');

						var imageWidth = this._getWidthFromImageFunctionArgs(args);

						padding = padding != null ? padding : 0;
						var headerWidth = this.metadata.label.length * this.labelMultiplier;

						return { width: Math.max(imageWidth, headerWidth) + padding, end: imageFunctionEndIndex };
					}
				}, {
					key: '_getImageFunctionStart',
					value: function _getImageFunctionStart(start) {
						return this.metadata.calculatedFormula ? this.metadata.calculatedFormula.toLowerCase().indexOf('image(', start) : -1;
					}
				}, {
					key: '_getImageFunctionEnd',
					value: function _getImageFunctionEnd(start) {
						var formula = this.metadata.calculatedFormula ? this.metadata.calculatedFormula.toLowerCase() : null;
						if (!formula) return -1;

						var numOpenParenthesis = 0;
						var numClosedParenthesis = 0;
						for (var i = start, l = formula.length; i < l; i++) {
							if (formula.substring(i, i + 1) === '(') numOpenParenthesis++;else if (formula.substring(i, i + 1) === ')') numClosedParenthesis++;

							if (numOpenParenthesis > 0 && numOpenParenthesis === numClosedParenthesis) return i;
						}
						return -1;
					}
				}, {
					key: '_getWidthFromImageFunctionArgs',
					value: function _getWidthFromImageFunctionArgs(args) {
						if (args.length <= 3) return DEFAULT_WIDTH;

						var width = void 0;
						try {
							width = parseInt(args[3].trim());
						} catch (e) {
							this.hasInvalidWidth = true;
							return DEFAULT_WIDTH;
						}

						if (isNaN(width)) {
							this.hasInvalidWidth = true;
							return DEFAULT_WIDTH;
						}

						return width;
					}
				}, {
					key: '_warnInvalidWidthParameter',
					value: function _warnInvalidWidthParameter() {
						console.warn('May not have properly sized the column to fit the image specified by this formula: "' + this.metadata.calculatedFormula + '"\n' + 'REASON: At least one of the formula\'s IMAGE function(s) has its width parameter (4th argument) defined from a field.\n' + 'SOLUTION: All of the formula\'s IMAGE function(s) should have its width parameter either omitted or hardcoded to a number.');
					}
				}]);

				return ImageCellSizer;
			}());

			_export('ImageCellSizer', ImageCellSizer);
		}
	};
});

'use strict';

System.register('common/layout/tables/TableClassBuilder.js', [], function (_export, _context) {
	var _createClass, TableClassBuilder;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TableClassBuilder', TableClassBuilder = function () {
				function TableClassBuilder(columns, firstLastClassSuffix, typeByColumnMap, allColumnClasses) {
					_classCallCheck(this, TableClassBuilder);

					this.columns = columns;
					this.firstLastClassSuffix = firstLastClassSuffix;
					this.typeByColumnMap = typeByColumnMap;
					this.allColumnClasses = allColumnClasses || [];
				}

				_createClass(TableClassBuilder, [{
					key: 'build',
					value: function build() {
						var classMap = {};
						this._appendTypeClass(classMap);
						this._appendFirstAndLastColumnClasses(classMap);
						this._appendAllColumnClasses(classMap);
						this._addWidthStyles(classMap);
						return classMap;
					}
				}, {
					key: '_appendTypeClass',
					value: function _appendTypeClass(classMap) {
						if (!this.typeByColumnMap) return;

						var prevNumeric = false;
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.columns[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var col = _step.value;

								var type = this.typeByColumnMap[col];
								var isNumeric = this._isNumericType(type);
								var isBoolean = this._isBooleanType(type);

								if (isNumeric) this._appendClass(classMap, col, 'numericCell');else if (isBoolean) this._appendClass(classMap, col, 'checkboxCell');else if (prevNumeric) this._appendClass(classMap, col, 'afterNumericCell');

								prevNumeric = isNumeric;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: '_appendFirstAndLastColumnClasses',
					value: function _appendFirstAndLastColumnClasses(classMap) {
						var firstInnerClass = 'firstInner' + this.firstLastClassSuffix;
						var lastInnerClass = 'lastInner' + this.firstLastClassSuffix;
						var secondInnerClass = 'secondInner' + this.firstLastClassSuffix;

						this._appendClass(classMap, this.columns[0], firstInnerClass);
						this._appendClass(classMap, this.columns[this.columns.length - 1], lastInnerClass);
						if (this.columns.length > 1) this._appendClass(classMap, this.columns[1], secondInnerClass);
					}
				}, {
					key: '_appendAllColumnClasses',
					value: function _appendAllColumnClasses(classMap) {
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = this.columns[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var column = _step2.value;
								var _iteratorNormalCompletion3 = true;
								var _didIteratorError3 = false;
								var _iteratorError3 = undefined;

								try {
									for (var _iterator3 = this.allColumnClasses[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
										var columnClass = _step3.value;

										this._appendClass(classMap, column, columnClass);
									}
								} catch (err) {
									_didIteratorError3 = true;
									_iteratorError3 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion3 && _iterator3.return) {
											_iterator3.return();
										}
									} finally {
										if (_didIteratorError3) {
											throw _iteratorError3;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}
					}
				}, {
					key: '_addWidthStyles',
					value: function _addWidthStyles(classMap) {
						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = this.columns[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var column = _step4.value;

								var type = this.typeByColumnMap[column];
								var typeAndWidth = type.split(':');
								if (typeAndWidth.length === 2) this._setWidthStyle(classMap, column, typeAndWidth[1]);
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}
					}
				}, {
					key: '_isNumericType',
					value: function _isNumericType(type) {
						type = type.split(':')[0];
						return type === 'double' || type === 'number' || type === 'currency' || type === 'percent';
					}
				}, {
					key: '_isBooleanType',
					value: function _isBooleanType(type) {
						type = type.split(':')[0];
						return type === 'boolean' || type === 'checkbox';
					}
				}, {
					key: '_appendClass',
					value: function _appendClass(classMap, key, classToAppend) {
						if (!classMap[key]) classMap[key] = {};

						var existingClass = classMap[key].class;
						classMap[key].class = existingClass ? existingClass + ' ' + classToAppend : classToAppend;
					}
				}, {
					key: '_setWidthStyle',
					value: function _setWidthStyle(classMap, key, width) {
						if (!classMap[key]) classMap[key] = {};
						classMap[key].style = 'width:' + width + 'px';
					}
				}]);

				return TableClassBuilder;
			}());

			_export('TableClassBuilder', TableClassBuilder);
		}
	};
});

'use strict';

System.register('common/services/sb-field-md/FieldMetadata.js', ['common/core/AppContext.js'], function (_export, _context) {
	var AppContext, _createClass, FieldMetadata;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldMetadata', FieldMetadata = function () {
				function FieldMetadata() {
					_classCallCheck(this, FieldMetadata);
				}

				_createClass(FieldMetadata, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-field-md';
						this.properties = {
							fields: Array,
							object: String,
							md: {
								type: Object,
								notify: true
							},
							error: {
								type: String,
								notify: true
							},
							prefix: {
								type: String,
								value: function value() {
									return AppContext.org.prefix ? AppContext.org.prefix + '__' : '';
								}
							},
							background: {
								type: Boolean,
								value: false
							},
							doNotFixObjectName: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.describe.addEventListener('describe-changed', function (e) {
							var md = e.detail.value.md,
							    fieldNames = e.detail.value.fields,
							    fields = [],
							    fieldsByObject = {};
							for (var i = 0, l = fieldNames.length; i < l; i++) {
								if (!md[fieldNames[i]]) continue;

								var object = fieldNames[i].split('.')[0],
								    field = fieldNames[i].split('.')[1];
								if (!fieldsByObject[object]) fieldsByObject[object] = {};

								fields.push(md[fieldNames[i]]);
								fieldsByObject[object][field] = md[fieldNames[i]];
							}

							this.md = { fields: fields, fieldsByObject: fieldsByObject };
						}.bind(this));
						this.$.describe.addEventListener('error-changed', function (e) {
							this.error = e.detail.value;
						}.bind(this));
					}
				}, {
					key: 'initFieldSetDescribe',
					value: function initFieldSetDescribe() {
						var fields = [];
						this.fields.forEach(function (field) {
							var fieldSplit = field.split('.');
							if (fieldSplit.length === 2) fields.push(this.buildFieldList(fieldSplit[0], fieldSplit[1]));else fields.push(this.buildFieldList(this.object, field));
						}.bind(this));
						this.$.describe.fields = fields;
					}
				}, {
					key: 'buildFieldList',
					value: function buildFieldList(target, field) {
						if (!this.doNotFixObjectName && target.endsWith('__c') && !target.startsWith(this.prefix)) return this.prefix + target + '.' + field;

						return target + '.' + field;
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['initFieldSetDescribe(fields, prefix)'];
					}
				}]);

				return FieldMetadata;
			}());

			_export('FieldMetadata', FieldMetadata);

			Polymer(FieldMetadata);
		}
	};
});

'use strict';

System.register('common/services/sb-job-checker/JobChecker.js', [], function (_export, _context) {
	var _createClass, COMPLETED, FAILED, ABORTED, JobChecker;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			COMPLETED = 'Completed';
			FAILED = 'Failed';
			ABORTED = 'Aborted';

			_export('JobChecker', JobChecker = function () {
				function JobChecker() {
					_classCallCheck(this, JobChecker);
				}

				_createClass(JobChecker, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-job-checker';
						this.properties = {
							spinner: {
								type: Boolean,
								value: false
							},

							useSpinner: {
								type: Boolean,
								value: true
							},

							data: Object,

							status: String,

							result: {
								type: Object
							},

							error: {
								type: String,
								notify: true
							},

							asyncNumList: {
								type: Array,
								value: []
							},

							firstStatusTime: Number,

							lastStatusTime: Number
						};
					}
				}, {
					key: '_useSpinner',
					value: function _useSpinner() {
						return this.spinner && this.useSpinner;
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.firstStatusTime = Date.now();
						this.lastStatusTime = Date.now();
						this._setLoadingSpinner(false);

						this.$.service.addEventListener('response-changed', function (e) {
							this._checkStatus(e);
						}.bind(this));

						this.$.service.addEventListener('error-changed', function (e) {
							this.error = e.detail.value;

							this._setLoadingSpinner(false);
						}.bind(this));
					}
				}, {
					key: '_setLoadingSpinner',
					value: function _setLoadingSpinner(value) {
						this.spinner = value;
						this.$.loadingSpinner.show = this._useSpinner();
					}
				}, {
					key: '_ping',
					value: function _ping(data) {
						this._setLoadingSpinner(true);

						this.$.service.background = true;
						this.$.service.model = undefined;
						this.$.service.model = data;
					}
				}, {
					key: '_checkStatus',
					value: function _checkStatus(e) {
						var result = e.detail.value;
						if (result != null) {
							var jobId = result.job.Id;
							this.status = result.job.Status;
							if (!this._isFinished()) {
								this.lastStatusTime = Date.now();
								this.data.jobId = jobId;
								this._getStatusMessages();
								var asyncNum = this.async(function () {
									this._ping(this.data);
								}.bind(this), 1000);
								this.asyncNumList.push(asyncNum);
							} else {
								if (result.payload != null) {
									this.result = result;
									for (var i = 0; i < this.asyncNumList.length; i++) {
										this.cancelAsync(this.asyncNumList[i]);
									}
								}
								this._getStatusMessages();
								this._setLoadingSpinner(false);

								if (result.payload != null) {
									this.fire('job-completed');
								}
							}
						}
					}
				}, {
					key: '_getStatusMessages',
					value: function _getStatusMessages() {
						var waitTime = Date.now() - this.lastStatusTime;

						console.log('Record Id: ' + this.data.recordId + ' Job Type: ' + this.data.jobType + ' [Job Id: ' + this.data.jobId + ' - Status:' + this.status + '] Time : ' + (this.lastStatusTime - this.firstStatusTime) + ' [Wait Time: ' + waitTime + ']');
					}
				}, {
					key: '_isFailure',
					value: function _isFailure() {
						return this.status && (this.status == ABORTED || this.status == FAILED);
					}
				}, {
					key: '_isFinished',
					value: function _isFinished() {
						return this.status && (this.status == COMPLETED || this._isFailure());
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_ping(data)'];
					}
				}]);

				return JobChecker;
			}());

			_export('JobChecker', JobChecker);

			Polymer(JobChecker);
		}
	};
});

'use strict';

System.register('common/services/sb-line-editor-cache-save/LineEditorCacheSaver.js', [], function (_export, _context) {
	var _createClass, LineEditorCacheSaver;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LineEditorCacheSaver', LineEditorCacheSaver = function () {
				function LineEditorCacheSaver() {
					_classCallCheck(this, LineEditorCacheSaver);
				}

				_createClass(LineEditorCacheSaver, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-line-editor-cache-save';
						this.properties = {
							quote: Object,
							error: {
								type: String,
								notify: true
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.service.addEventListener('error-changed', function (e) {
							this.error = e.detail;
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'save',
					value: function save() {
						this.$.service.transient = true;
						this.$.service.uid = this.quote.record.Id;
						this.$.service.model = this.quote;
						this.$.service.saver = null;
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['save(quote)'];
					}
				}]);

				return LineEditorCacheSaver;
			}());

			_export('LineEditorCacheSaver', LineEditorCacheSaver);

			Polymer(LineEditorCacheSaver);
		}
	};
});

'use strict';

System.register('common/services/sb-line-editor-read/LineEditorReader.js', [], function (_export, _context) {
    var _createClass, LineEditorReader;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export('LineEditorReader', LineEditorReader = function () {
                function LineEditorReader() {
                    _classCallCheck(this, LineEditorReader);
                }

                _createClass(LineEditorReader, [{
                    key: 'beforeRegister',
                    value: function beforeRegister() {
                        this.is = 'sb-line-editor-read';
                        this.properties = {
                            quoteId: String,
                            background: {
                                type: Boolean,
                                value: false
                            },
                            lineEditorModel: {
                                type: Object,
                                notify: true
                            },
                            error: {
                                type: Array,
                                notify: true
                            }
                        };
                    }
                }, {
                    key: 'ready',
                    value: function ready() {
                        this.firstStatusTime = Date.now();
                        this.$.service.addEventListener('response-changed', function (e) {

                            this._checkStatus(e);
                        }.bind(this));

                        this.$.service.addEventListener('error-changed', function (e) {
                            if (e.detail.value) {
                                if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
                            }
                            this.$.loadingSpinner.show = false;
                        }.bind(this));
                    }
                }, {
                    key: 'read',
                    value: function read() {
                        this.$.service.uid = undefined;
                        this.$.service.response = null;
                        this.$.service.background = true;
                        this.$.loadingSpinner.show = !this.background;
                        this.$.service.uid = this.quoteId.substring(0, 15);
                    }
                }, {
                    key: '_checkStatus',
                    value: function _checkStatus(e) {
                        if (e.detail.value) {
                            this.lastStatusTime = Date.now();

                            if (e.detail.value == 'Incomplete') {
                                this.$.service.ignoreCache = true;
                                this._getStatusMessages();
                                this.async(function () {
                                    this.read();
                                }.bind(this), 1000);
                            } else {
                                this.lineEditorModel = e.detail.value;
                                this.$.service.ignoreCache = false;
                                this.$.loadingSpinner.show = false;
                            }
                        }
                    }
                }, {
                    key: '_getStatusMessages',
                    value: function _getStatusMessages() {
                        var waitTime = Date.now() - this.lastStatusTime;

                        console.log('Reading: Quote Id: ' + this.quoteId + ' Time : ' + (this.lastStatusTime - this.firstStatusTime) + ' [Wait Time: ' + waitTime + ']');
                    }
                }, {
                    key: 'observers',
                    get: function get() {
                        return ['read(quoteId, background)'];
                    }
                }]);

                return LineEditorReader;
            }());

            _export('LineEditorReader', LineEditorReader);

            Polymer(LineEditorReader);
        }
    };
});

'use strict';

System.register('common/services/sb-search-model-load/SearchModelLoader.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, SearchModelLoader;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SearchModelLoader', SearchModelLoader = function () {
				function SearchModelLoader() {
					_classCallCheck(this, SearchModelLoader);
				}

				_createClass(SearchModelLoader, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-search-model-load';
						this.properties = {
							quote: Object,
							processId: {
								type: String,
								value: null
							},
							actionId: {
								type: String,
								value: null
							},
							searchModel: {
								type: Object,
								notify: true
							},
							filters: {
								type: Array
							},
							fieldSet: {
								type: String
							},
							error: {
								type: Array,
								notify: true
							},
							pageNumber: {
								type: Number,
								value: 0
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.service.addEventListener('response-changed', function (e) {
							this.searchModel = e.detail.value;
						}.bind(this));
						this.$.service.addEventListener('error-changed', function (e) {
							if (e.detail.value) {
								if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
							}
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'load',
					value: function load() {
						this.$.service.uid = null;
						this.$.service.context = new DataBuilder().addQuote('quote', this.quote).add('processId', this.processId).add('actionId', this.actionId).add('pageNumber', this.pageNumber).add('filters', this.filters).add('fieldSet', this.fieldSet).build();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['load(quote, processId, actionId, pageNumber)'];
					}
				}]);

				return SearchModelLoader;
			}());

			_export('SearchModelLoader', SearchModelLoader);

			Polymer(SearchModelLoader);
		}
	};
});

'use strict';

System.register('common/services/sb-search-model-select/SearchModelSelector.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, SearchModelSelector;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SearchModelSelector', SearchModelSelector = function () {
				function SearchModelSelector() {
					_classCallCheck(this, SearchModelSelector);
				}

				_createClass(SearchModelSelector, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-search-model-select';
						this.properties = {
							quote: Object,
							selectedProducts: {
								type: Object,
								notify: true
							},
							selectedProductList: Array,
							error: {
								type: Array,
								notify: true
							},
							result: {
								type: Object,
								notify: true
							},
							targetGroupKey: {
								type: Number,
								value: null
							},
							quoteProcess: {
								type: String,
								value: null
							},
							saver: String,
							background: {
								type: Boolean,
								value: true
							},
							useCache: {
								type: Boolean,
								value: true
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.service.addEventListener('response-changed', function (e) {
							this.result = e.detail.value;
						}.bind(this));
						this.$.service.addEventListener('error-changed', function (e) {
							if (e.detail.value) {
								if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
							}
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'save',
					value: function save() {
						var selectionArray = [];
						for (var val in this.selectedProducts) {
							selectionArray.push(this.selectedProducts[val]);
						}this.selectedProductList = selectionArray;
					}
				}, {
					key: '_save',
					value: function _save() {
						if (this.useCache === true) this.$.service.uid = this.quote.record.Id.substring(0, 15);
						this.$.service.model = new DataBuilder().addQuote('quote', this.quote).addObject('products', this.selectedProductList).add('targetGroupKey', this.targetGroupKey).addObject('quoteProcess', this.quoteProcess).build();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['save(selectedProducts, quote)', '_save(selectedProductList)'];
					}
				}]);

				return SearchModelSelector;
			}());

			_export('SearchModelSelector', SearchModelSelector);

			Polymer(SearchModelSelector);
		}
	};
});

'use strict';

System.register('products/config/message/ProductMessenger.js', ['products/config/viewmodel/ProductViewModel.js'], function (_export, _context) {
	var ProductViewModel, _createClass, ProductMessenger;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_productsConfigViewmodelProductViewModelJs) {
			ProductViewModel = _productsConfigViewmodelProductViewModelJs.ProductViewModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductMessenger', ProductMessenger = function () {
				function ProductMessenger(quote, product, prefix, currencyIsoCode, extender) {
					_classCallCheck(this, ProductMessenger);

					this.quote = quote;
					this.product = product;
					this.prefix = prefix;
					this.extender = extender;
					this.currencyIsoCode = currencyIsoCode;
					if (this.product && !this.product.initialized) this._initializeProduct(this.product);
				}

				_createClass(ProductMessenger, [{
					key: 'getRequest',
					value: function getRequest() {
						var message = { quote: this.quote.record };

						if (!this.product) return message;

						message.product = {
							configuredProductId: this.product.configuration.configuredProductId,
							lineItemId: this.product.configuration.lineItemId,
							lineKey: this.product.configuration.lineItemKey,
							configurationAttributes: this._createConfigAttributesMap(),
							optionConfigurations: this._createFeatureOptionsMap(),
							configurationData: {} };
						message.products = [];

						this._appendReadOnlyProperties(message, this.product.configuration);
						return message;
					}
				}, {
					key: 'getResponse',
					value: function getResponse(message) {
						if (!message) return;

						var clones = [];
						if (message.products) {
							for (var i = 0, l = message.products.length; i < l; i++) {
								clones.push(this._cloneProduct(i));
							}
						}

						this._extendResponseQuote(message.quote);
						this._extendResponseProduct(this.product, message.product);

						return {
							quote: this.quote,
							product: this.product,
							products: this._extendResponseProducts(message.products, clones),
							optionNotifications: this._getResponseOptionPaths()
						};
					}
				}, {
					key: '_appendReadOnlyProperties',
					value: function _appendReadOnlyProperties(obj, config) {
						obj.readOnly = {};
						var line = this._getMatchingQuoteLine(config);
						if (line) obj.readOnly.line = line.record;
					}
				}, {
					key: '_getMatchingQuoteLine',
					value: function _getMatchingQuoteLine(config) {
						if (config == null || config.lineItemKey == null) return null;

						var lines = this.quote.lineItems.filter(function (line) {
							return line.key === config.lineItemKey;
						}.bind(this));

						return lines.length === 1 ? lines[0] : null;
					}
				}, {
					key: '_createConfigAttributesMap',
					value: function _createConfigAttributesMap() {
						var map = {};
						for (var i = 0, l = this.product.configurationAttributes.length; i < l; i++) {
							map[this.product.configurationAttributes[i].targetFieldName] = null;
						}this.extender.extend(map, this.product.configuration.configurationData);
						return map;
					}
				}, {
					key: '_createFeatureOptionsMap',
					value: function _createFeatureOptionsMap() {
						var featuresMap = {};
						var features = this.product.features;
						for (var i = 0, l = features.length; i < l; i++) {
							var featureName = features[i].record.Name;
							featuresMap[featureName] = [];
							var optionConfigurations = features[i]._transient_.optionConfigurations;
							if (optionConfigurations) for (var j = 0, ll = optionConfigurations.length; j < ll; j++) {
								featuresMap[featureName].push(this._createPseudoOptionConfiguration(optionConfigurations[j]));
							}
						}
						return featuresMap;
					}
				}, {
					key: '_createPseudoOptionConfiguration',
					value: function _createPseudoOptionConfiguration(optionConfiguration) {
						var pseudoOptionConfig = {
							optionId: optionConfiguration.record.Id,
							selected: optionConfiguration.selected,
							ProductCode: optionConfiguration.record[this.prefix + 'ProductCode__c'],
							ProductName: optionConfiguration.record[this.prefix + 'ProductName__c'],
							Quantity: optionConfiguration.record[this.prefix + 'Quantity__c'],
							configurationData: {}
						};
						this._appendReadOnlyProperties(pseudoOptionConfig, optionConfiguration);
						return pseudoOptionConfig;
					}
				}, {
					key: '_extendResponseQuote',
					value: function _extendResponseQuote(responseQuote) {
						if (responseQuote != null) this.extender.extend(this.quote.record, this._sanitizeObject(responseQuote));
					}
				}, {
					key: '_extendResponseProduct',
					value: function _extendResponseProduct(product, responseProduct, productKey) {
						if (!responseProduct) return;

						this._extendResponseConfigurationData(product, responseProduct.configurationData);
						this._extendResponseConfigurationAttributes(product, responseProduct.configurationAttributes);
						this._extendResponseOptionConfigurations(product, responseProduct.optionConfigurations, productKey);
					}
				}, {
					key: '_extendResponseConfigurationData',
					value: function _extendResponseConfigurationData(product, responseConfigurationData) {
						if (responseConfigurationData != null) this.extender.extend(product.configuration.externalConfigurationData, this._sanitizeObject(responseConfigurationData));
					}
				}, {
					key: '_extendResponseConfigurationAttributes',
					value: function _extendResponseConfigurationAttributes(product, responseConfigurationAttributes) {
						if (responseConfigurationAttributes != null) this.extender.extend(product.configuration.configurationData, this._sanitizeObject(responseConfigurationAttributes));
					}
				}, {
					key: '_extendResponseOptionConfigurations',
					value: function _extendResponseOptionConfigurations(product, responseOptionConfigurations, parentProductKey) {
						var responseOptionConfigurationsByOptionId = {};
						for (var feature in responseOptionConfigurations) {
							var featureOptionConfigurations = responseOptionConfigurations[feature];
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = featureOptionConfigurations[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var optionConfiguration = _step.value;

									var optionId = optionConfiguration.optionId;
									if (optionId) responseOptionConfigurationsByOptionId[optionId] = optionConfiguration;
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}

						var options = product.options;
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = options[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var option = _step2.value;

								var sourceOption = responseOptionConfigurationsByOptionId[option.record.Id];
								if (!sourceOption) continue;

								if (parentProductKey) option.parentProductKey = parentProductKey;
								if (sourceOption.configurationData != null) {
									option.externalConfigurationData = option.externalConfigurationData || {};
									this.extender.extend(option.externalConfigurationData, this._sanitizeObject(sourceOption.configurationData));
								}

								if (sourceOption.selected != null) option.selected = sourceOption.selected;

								if (sourceOption.Quantity != null && option.selected) option.record[this.prefix + 'Quantity__c'] = sourceOption.Quantity;
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}
					}
				}, {
					key: '_extendResponseProducts',
					value: function _extendResponseProducts(responseProducts, clones) {
						if (!responseProducts || responseProducts.length === 0) return [];

						var products = [];
						for (var i = 0, l = responseProducts.length; i < l; i++) {
							var product = clones[i];
							this._extendResponseProduct(product, responseProducts[i], product.productKey);
							this._resetFeatureOptionConfiguration(product);
							products.push(product);
						}
						return products;
					}
				}, {
					key: '_cloneProduct',
					value: function _cloneProduct(index) {
						var clone = JSON.parse(JSON.stringify(this.product));
						clone.productKey = this._buildProductKey(this.product.record.Id, index);
						this._enableSaveToLineEditor(clone);
						return clone;
					}
				}, {
					key: '_buildProductKey',
					value: function _buildProductKey(productId, index) {
						var prefix = index < 10 ? '00' : index < 100 ? '0' : '';
						var suffix = prefix + index;
						return productId.substring(0, 15) + suffix;
					}
				}, {
					key: '_enableSaveToLineEditor',
					value: function _enableSaveToLineEditor(clone) {
						clone.configuration.lineItemKey = null;
						delete clone.configuration.lineItemId;
					}
				}, {
					key: '_resetFeatureOptionConfiguration',
					value: function _resetFeatureOptionConfiguration(product) {
						var features = product.features || [];
						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = features[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var feature = _step3.value;

								feature._transient_.optionConfigurations = [];
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						this._initializeProduct(product);
					}
				}, {
					key: '_initializeProduct',
					value: function _initializeProduct(product) {
						var prefix = this.prefix.endsWith('__') ? this.prefix.substring(0, this.prefix.length - 2) : this.prefix;
						new ProductViewModel(this.quote.record.Id, product, prefix, this.quote.record.CurrencyIsoCode);
					}
				}, {
					key: '_getResponseOptionPaths',
					value: function _getResponseOptionPaths() {
						return ['selected', 'record.' + this.prefix + 'Quantity__c'];
					}
				}, {
					key: '_sanitizeObject',
					value: function _sanitizeObject(object) {
						return JSON.parse(JSON.stringify(object, function (key, value) {
							if (key.endsWith('__c') && value instanceof Object) return JSON.stringify(value);
							return value;
						}));
					}
				}]);

				return ProductMessenger;
			}());

			_export('ProductMessenger', ProductMessenger);
		}
	};
});

'use strict';

System.register('products/config/search/ConfiguratorSearch.js', [], function (_export, _context) {
	var _createClass, ConfiguratorSearch;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ConfiguratorSearch', ConfiguratorSearch = function () {
				function ConfiguratorSearch(searchFilters, prefix) {
					_classCallCheck(this, ConfiguratorSearch);

					this.searchFilters = searchFilters;
					this.prefix = prefix;
				}

				_createClass(ConfiguratorSearch, [{
					key: 'containsFeature',
					value: function containsFeature(feature) {
						var featureInput = this.searchFilters[this.prefix + 'Feature__c'];
						if (featureInput !== null && featureInput !== undefined) return feature.record.Name.toLowerCase().indexOf(featureInput.toLowerCase()) !== -1 || feature.untranslatedRecord !== undefined && feature.untranslatedRecord.Name.toLowerCase().indexOf(featureInput.toLowerCase()) !== -1;
						return true;
					}
				}, {
					key: 'hasVisibleOptions',
					value: function hasVisibleOptions(options) {
						var allFiltered = true;
						if (options.length > 0) {
							for (var i = 0, numOptions = options.length; i < numOptions; i++) {
								if (!options[i].hidden) {
									allFiltered = false;
									break;
								}
							}
							return !allFiltered;
						}
						return !this.hasFilterValues();
					}
				}, {
					key: 'allOptionsHiddenByRule',
					value: function allOptionsHiddenByRule(options) {
						var allFiltered = true;
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = options[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var option = _step.value;

								if (option.hiddenByRule === false || option.hiddenByRule == null) {
									allFiltered = false;
									break;
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return allFiltered;
					}
				}, {
					key: 'hasRequiredConfigAttributes',
					value: function hasRequiredConfigAttributes(feature, model) {
						var configAttributes = model.configAttributesByFeatureId[feature.record.Id];
						if (configAttributes) {
							var _iteratorNormalCompletion2 = true;
							var _didIteratorError2 = false;
							var _iteratorError2 = undefined;

							try {
								for (var _iterator2 = configAttributes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
									var configAttr = _step2.value;

									if (configAttr.required) return true;
								}
							} catch (err) {
								_didIteratorError2 = true;
								_iteratorError2 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion2 && _iterator2.return) {
										_iterator2.return();
									}
								} finally {
									if (_didIteratorError2) {
										throw _iteratorError2;
									}
								}
							}
						}
						return false;
					}
				}, {
					key: 'hasConfigAttributes',
					value: function hasConfigAttributes(feature, model) {
						return model.configAttributesByFeatureId[feature.record.Id] ? true : false;
					}
				}, {
					key: 'setOptionVisibility',
					value: function setOptionVisibility(options) {
						var _options = JSON.parse(JSON.stringify(options));

						for (var i = 0, numOptions = _options.length; i < numOptions; i++) {
							var filtered = false;
							if (_options[i].record[this.prefix + 'UnitPrice__c'] === undefined) {
								_options[i].hidden = true;
								continue;
							}

							if (_options[i].isUpgrade) {
								continue;
							}
							var searchKeys = Object.keys(this.searchFilters);
							for (var j = 0, numFilters = searchKeys.length; j < numFilters; j++) {
								var filter = searchKeys[j];
								var filterValue = this.searchFilters[filter];
								if (filter === this.prefix + 'Feature__c') continue;
								if (filterValue !== null && _options[i].record[filter] && _options[i].record[filter].toLowerCase().indexOf(filterValue.toLowerCase()) === -1 && (_options[i].untranslatedRecord[filter] === undefined || _options[i].untranslatedRecord[filter].toLowerCase().indexOf(filterValue.toLowerCase()) === -1)) {
									filtered = true;
									break;
								}
							}
							_options[i].hidden = _options[i].hiddenByRule || filtered;
						}
						return _options;
					}
				}, {
					key: 'hasFilterValues',
					value: function hasFilterValues() {
						for (var filter in this.searchFilters) {
							if (this.searchFilters[filter] !== null) return true;
						}
						return false;
					}
				}]);

				return ConfiguratorSearch;
			}());

			_export('ConfiguratorSearch', ConfiguratorSearch);
		}
	};
});

'use strict';

System.register('products/config/viewmodel/ProductViewModel.js', ['products/localization/LocalizeFields.js'], function (_export, _context) {
	var LocalizeFields, _createClass, ProductViewModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_productsLocalizationLocalizeFieldsJs) {
			LocalizeFields = _productsLocalizationLocalizeFieldsJs.LocalizeFields;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductViewModel', ProductViewModel = function () {
				function ProductViewModel(qId, product, prefix, currencyIsoCode, fId) {
					_classCallCheck(this, ProductViewModel);

					this.init(product, qId, prefix, currencyIsoCode, fId);
				}

				_createClass(ProductViewModel, [{
					key: 'init',
					value: function init(product, qId, prefix, currencyIsoCode, fId) {
						this.product = product || this.product;
						this.qId = qId || this.qId;
						this.prefix = prefix ? prefix + '__' : this.prefix || '';
						this.currencyIsoCode = currencyIsoCode || this.currencyIsoCode;
						this.featureLookupId = fId || this.featureLookupId;
						this.optionsById = {};
						this.optionIndexById = {};
						this.optionsByFeatureId = {};
						this.featuresWithOptionsOrConfigAttr = [];
						this.featureIdsWithOptionsOrConfigAttr = {};
						this.featureIdsWithSelectionMethodAdd = {};
						this.featureIdsWithSelectionMethodClick = {};
						this.featureIdsWIthSelectionMethodDynamic = {};
						this.configAttributesByFeatureId = {};
						this.configurationAttributeValueMap = {};
						this.configurationAttributeModelMap = {};
						this.configurationAttributeTargetFieldMap = {};
						this.configurationAttributeApplyToOptionMap = {};
						this.optionActionsByOptionId = {};
						this.attributeValueMap = {};
						this.productRulesActions = {};
						this.originalDataByOptionIds = {};
						this.optionDataByOptionIds = {};
						this.featureIdByOptionId = {};
						this.productOptionConfigurationsMap = {};
						this.initializeProduct();
						this.product.initialized = true;
					}
				}, {
					key: 'getFeature',
					value: function getFeature(featureId) {
						if (featureId === undefined || featureId === 'null') featureId = null;
						return this.product.features.find(function (feature) {
							return feature.record.Id === featureId;
						});
					}
				}, {
					key: 'getOption',
					value: function getOption(optionId) {
						return this.optionsById[optionId];
					}
				}, {
					key: 'getOptionsByFeatureId',
					value: function getOptionsByFeatureId(featureId) {
						if (featureId === null || featureId === 'null') featureId = 'Other';

						if (this.isOptionLookupViewModel()) {
							var options = [];
							this.optionsByFeatureId[featureId].forEach(function (option) {
								var dummy = JSON.parse(JSON.stringify(option));
								dummy.selected = false;
								options.push(dummy);
							});
							return options;
						}

						var feature = this.getFeature(featureId);

						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = feature._transient_.optionConfigurations[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var option = _step.value;

								if (feature.optionSelectionMethod !== 'Click') option.selected = true;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return feature._transient_.optionConfigurations;
					}
				}, {
					key: 'maxOptionsMet',
					value: function maxOptionsMet(feature) {
						var maxOptions = this.prefix + 'MaxOptionCount__c';
						return feature._transient_.optionConfigurations.length >= feature.record[maxOptions];
					}
				}, {
					key: 'setOptionSelected',
					value: function setOptionSelected(optionId, selected) {
						var option = this.optionsById[optionId],
						    isClick = this.featureIdsWithSelectionMethodClick[this.featureIdByOptionId[optionId]];
						if (!option.record[this.prefix + 'Required__c'] && isClick) option.selected = selected;
					}
				}, {
					key: 'setConfigurationAttributesToOptions',
					value: function setConfigurationAttributesToOptions(option) {
						for (var attribute in this.configurationAttributeApplyToOptionMap) {
							option.record[attribute] = this.product.configuration.configurationData[attribute];
						}
					}
				}, {
					key: 'getOptionLayout',
					value: function getOptionLayout() {
						var optionLayout = this.prefix + 'OptionLayout__c';
						return this.product.record[optionLayout] || 'Sections';
					}
				}, {
					key: 'getTabFeaturesMap',
					value: function getTabFeaturesMap() {
						var _this = this;

						var featureCategoryLabels = this.product.featureCategoryLabels;

						var featuresWithoutCategory = this.featuresWithOptionsOrConfigAttr.filter(function (feature) {
							return feature.record[_this.prefix + 'Category__c'] === undefined;
						});
						var tabFeaturesMap = {};

						var featuresLength = this.featuresWithOptionsOrConfigAttr.length;

						if (featuresLength === featuresWithoutCategory.length) {
							this.featuresWithOptionsOrConfigAttr.forEach(function (feature) {
								tabFeaturesMap[feature.record.Name] = [feature];
							});
						} else {
							this.product.featureCategories.forEach(function (category) {
								_this.featuresWithOptionsOrConfigAttr.forEach(function (feature) {
									var featureCategory = feature.record[_this.prefix + 'Category__c'];

									if (featureCategory === featureCategoryLabels[category]) tabFeaturesMap[category] !== undefined ? tabFeaturesMap[category].push(feature) : tabFeaturesMap[category] = [feature];
								});
							});
							if (featuresWithoutCategory.length !== 0) {
								tabFeaturesMap["Other"] = tabFeaturesMap["Other"] || [];
								tabFeaturesMap["Other"] = tabFeaturesMap["Other"].concat(featuresWithoutCategory);
							}
						}
						return tabFeaturesMap;
					}
				}, {
					key: 'checkAtLeastOneFeatureHasCategory',
					value: function checkAtLeastOneFeatureHasCategory() {
						var _this2 = this;

						return !!this.featuresWithOptionsOrConfigAttr.find(function (feature) {
							return feature.record[_this2.prefix + 'Category__c'] != null && feature.record[_this2.prefix + 'Category__c'] !== 'Other';
						});
					}
				}, {
					key: 'isAppliedImmediately',
					value: function isAppliedImmediately(optionId) {
						var appliedImmediately = this.prefix + 'AppliedImmediately__c';
						return this.getOption(optionId).record[appliedImmediately];
					}
				}, {
					key: 'initializeProduct',
					value: function initializeProduct() {
						var _this3 = this;

						this.localizer = new LocalizeFields(this.prefix);
						this.product = this.localizer.localizeProduct(this.product);

						var featureLabel = this.prefix + 'Feature__c',
						    selectedOptions = [];

						if (!this.featureLookupId) {
							this.initConfigAttributesById();
							this.initConfigurationAttributeMap();
						}

						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = this.product.options[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var option = _step2.value;

								this.initOptionInfo(option, selectedOptions);
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						this.buildOptionConfigurationMap();

						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = this.product.features[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var feature = _step3.value;

								feature.optionSelectionMethod = this.getOptionSelectionMethod(feature);
								if (!feature._transient_) feature._transient_ = {};
								this.initFeatureOptionConfigurations(feature);

								if (this.optionsByFeatureId[feature.record.Id] || this.configAttributesByFeatureId[feature.record.Id] || feature.optionSelectionMethod === 'Dynamic') {
									this.featuresWithOptionsOrConfigAttr.push(feature);
									this.featureIdsWithOptionsOrConfigAttr[feature.record.Id] = feature;
									if (feature.optionSelectionMethod === 'Add') this.featureIdsWithSelectionMethodAdd[feature.record.Id] = true;
									if (feature.optionSelectionMethod === 'Click') this.featureIdsWithSelectionMethodClick[feature.record.Id] = true;
									if (feature.optionSelectionMethod === 'Dynamic') this.featureIdsWIthSelectionMethodDynamic[feature.record.Id] = true;
								}
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							var _loop = function _loop() {
								var option = _step4.value;

								var feature = _this3.getFeature(option.record[featureLabel] || 'Other'),
								    configuredOption = void 0;
								if (option.selectionType === 'radio' && option.hidden && feature.visibleSelected) option.selected = false;
								if (_this3.getOptionSelectionMethod(feature) === 'Add') {
									configuredOption = feature._transient_.optionConfigurations.find(function (opt) {
										return opt.record.Id === option.record.Id;
									});
									if (!configuredOption) {
										feature._transient_.optionConfigurations.push(option);
									} else {
										configuredOption.added = true;
										configuredOption.configured = option.configured;
										_this3.setOptionDisabledData(configuredOption);
									}
									option.added = true;
								}
								_this3.setOptionDisabledData(option);
							};

							for (var _iterator4 = selectedOptions[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								_loop();
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}
					}
				}, {
					key: 'initOptionInfo',
					value: function initOptionInfo(option, selectedOptions) {
						var featureLabel = this.prefix + 'Feature__c',
						    quantityLabel = this.prefix + 'Quantity__c',
						    minQuantityLabel = this.prefix + 'MinQuantity__c',
						    recordSelected = this.prefix + 'Selected__c',
						    recordRequired = this.prefix + 'Required__c',
						    unitPrice = this.prefix + 'UnitPrice__c',
						    featureId = option.record[featureLabel] || 'Other';

						this.setConfigurationAttributesToOptions(option);
						option.valueChanged = false;
						option.record[unitPrice] = option.record[unitPrice] == null ? undefined : option.record[unitPrice];
						option.hidden = option.hiddenByRule && option.hidden || option.record[unitPrice] === undefined;
						option.removed = option.removed || option.selected === false && option.record[recordSelected];
						option.selected = option.selected === undefined ? option.record[recordSelected] && !option.removed || option.record[recordRequired] : option.selected;

						if (!option._transient_) option._transient_ = {};

						if (!option.selected) this.setOptionDisabledData(option);else if (selectedOptions != null) selectedOptions.push(option);

						if (option.isUpgrade === true) option.hidden = true;
						if (!option.record[featureLabel] && !this.product.mappedFeaturelessOptions) {
							this.product.features.push(this.createOtherOptionsFeature(this.product.virtualFeatureTitle));
							this.product.mappedFeaturelessOptions = true;
						}
						if (option.record[quantityLabel] === undefined) {
							option.recordHasQuantity = false;
							option.record[quantityLabel] = option.record[minQuantityLabel] === undefined ? 1 : option.record[minQuantityLabel];
						}
						if (option.record[recordRequired]) option.required = true;

						this.optionsById[option.record.Id] = option;
						this.featureIdByOptionId[option.record.Id] = featureId;
						this.addToOptionByFeatureId(featureId, option);
						this.originalDataByOptionIds[option.record.Id] = {
							unitPrice: option.record[this.prefix + 'UnitPrice__c'],
							discountAmount: option.record[this.prefix + 'DiscountAmount__c'],
							discountRate: option.record[this.prefix + 'Discount__c'],
							quantity: option.record[quantityLabel]
						};
					}
				}, {
					key: 'createOtherOptionsFeature',
					value: function createOtherOptionsFeature(name) {
						return {
							addOptionButtonLabel: "Add Option",
							addOptionDialogTitle: "Add Option",
							instructionsText: null,
							record: {
								Id: 'Other',
								Name: name
							},
							searchFilters: null
						};
					}
				}, {
					key: 'getOptionSelectionMethod',
					value: function getOptionSelectionMethod(feature) {
						if (feature.record[this.prefix + 'OptionSelectionMethod__c'] != null) return feature.record[this.prefix + 'OptionSelectionMethod__c'];
						if (this.product.record[this.prefix + 'OptionSelectionMethod__c'] != null) return this.product.record[this.prefix + 'OptionSelectionMethod__c'];

						return 'Click';
					}
				}, {
					key: 'setOptionDisabledData',
					value: function setOptionDisabledData(option, duplicate) {
						option.disabledData = option.disabledData || {
							'disabled': !!option.record[this.prefix + 'Required__c'] && !option.added || !!option.record[this.prefix + 'System__c'],
							'constrained': false
						};
						if (duplicate) {
							var original = this.optionsById[option.record.Id];
							original.disabledData = { 'disabled': false, 'constrained': false };
							option.disabledData.disabled = false;
						}
					}
				}, {
					key: 'initFeatureOptionConfigurations',
					value: function initFeatureOptionConfigurations(feature) {
						if (feature._transient_.optionConfigurations == null) feature._transient_.optionConfigurations = [];

						if (this.optionsByFeatureId[feature.record.Id] == null) return;

						var displayRadio = feature.record[this.prefix + 'MaxOptionCount__c'] === 1;
						var notInitialized = feature._transient_.optionConfigurations.length === 0;
						var featureId = feature.record.Id || 'Other';
						var isClick = feature.optionSelectionMethod === 'Click';
						var isDynamic = feature.optionSelectionMethod === 'Dynamic';
						var unsortedOptionConfigs = [];
						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = this.optionsByFeatureId[featureId][Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var option = _step5.value;

								feature.visibleSelected = feature.visibleSelected || !option.hidden && option.selected;
								option.selectionType = displayRadio ? 'radio' : 'checkbox';
								option.record[this.prefix + 'ConfiguredSKU__c'] = this.product.record.Id;
								if (isDynamic) {
									option.selected = true;
									option.added = true;
								}
								if (this.featureLookupId) {
									option._transient_.rowActions = [];
									continue;
								}

								this.initOptionActions(option, !isClick);
								this.initReconfiguredOption(option, feature, notInitialized, isClick, unsortedOptionConfigs);
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}

						if (unsortedOptionConfigs.length > 0) this.sortAndAddOptionConfigs(feature, unsortedOptionConfigs, !isClick);
					}
				}, {
					key: 'setOptionProductConfigurationData',
					value: function setOptionProductConfigurationData(option) {
						var config = this.getProductOptionConfigurationData(option.record.Id, option.index);
						if (config === undefined) return;

						for (var i in config) {
							if (option.hasOwnProperty(i)) continue;

							option[i] = config[i];
						}
					}
				}, {
					key: 'getProductOptionConfigurationData',
					value: function getProductOptionConfigurationData(optionId, index) {
						if (this.productOptionConfigurationsMap[optionId][index] !== undefined) return this.productOptionConfigurationsMap[optionId][index];else this.buildOptionConfigurationMap();

						return this.productOptionConfigurationsMap[optionId][index];
					}
				}, {
					key: 'buildOptionConfigurationMap',
					value: function buildOptionConfigurationMap() {
						if (!this.product.features[0] || this.product.features[0]._transient_ != null) return;
						var _iteratorNormalCompletion6 = true;
						var _didIteratorError6 = false;
						var _iteratorError6 = undefined;

						try {
							for (var _iterator6 = this.product.configuration.optionConfigurations[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
								var optionConfiguration = _step6.value;

								this.productOptionConfigurationsMap[optionConfiguration.optionId] = this.productOptionConfigurationsMap[optionConfiguration.optionId] || [];
								this.productOptionConfigurationsMap[optionConfiguration.optionId].push(optionConfiguration);
							}
						} catch (err) {
							_didIteratorError6 = true;
							_iteratorError6 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion6 && _iterator6.return) {
									_iterator6.return();
								}
							} finally {
								if (_didIteratorError6) {
									throw _iteratorError6;
								}
							}
						}
					}
				}, {
					key: 'initOptionActions',
					value: function initOptionActions(option, isNotClick) {
						var actions = [];
						if (isNotClick) {
							actions.push({
								icon: 'sf-icon-delete',
								title: 'Delete',
								position: 'left',
								mobileDisabled: true,
								hidden: false,
								invisible: false,
								onTapFunction: function onTapFunction() {
									this.fire('delete-tapped', { Id: this.data.record.Id, index: this.index });
								}
							});
						}
						if (option.configurable) {
							actions.push({
								icon: 'sf-icon-custom_apps',
								title: 'Configure',
								position: 'left',
								mobileDisabled: false,
								hidden: false,
								invisible: false,
								configurationRequired: option.configurationRequired,
								onTapFunction: function onTapFunction() {
									this.fire('configure-tapped', { Id: this.data.record.Id, index: this.index });
								}
							});
						} else {
							actions.push({
								icon: 'sf-icon-custom_apps',
								title: 'Configure',
								position: 'left',
								mobileDisabled: false,
								hidden: false,
								invisible: true,
								onTapFunction: function onTapFunction() {
									this.fire('configure-tapped', { Id: this.data.record.Id, index: this.index });
								}
							});
						}

						option._transient_.rowActions = actions;
					}
				}, {
					key: 'addToOptionByFeatureId',
					value: function addToOptionByFeatureId(featureId, option) {
						this.optionsByFeatureId[featureId] = this.optionsByFeatureId[featureId] || [];
						this.optionsByFeatureId[featureId].push(option);
					}
				}, {
					key: 'initConfigAttributesById',
					value: function initConfigAttributesById() {
						var attr = this.product.configurationAttributes;
						var numAttributes = attr.length;
						for (var i = 0; i < numAttributes; i++) {
							if (attr[i].featureId === null) {
								if (!this.configAttributesByFeatureId.featureless) this.configAttributesByFeatureId.featureless = [attr[i]];else this.configAttributesByFeatureId.featureless.push(attr[i]);
							} else {
								if (!this.configAttributesByFeatureId[attr[i].featureId]) this.configAttributesByFeatureId[attr[i].featureId] = [attr[i]];else this.configAttributesByFeatureId[attr[i].featureId].push(attr[i]);
							}
						}
					}
				}, {
					key: 'initConfigurationAttributeMap',
					value: function initConfigurationAttributeMap() {
						var attr = this.product.configurationAttributes;
						var numAttributes = attr.length;
						for (var i = 0; i < numAttributes; i++) {
							this.attributeValueMap[attr[i].targetFieldName] = '';
							var configurationAttributeValue = this.product.configuration.configurationData[attr[i].targetFieldName];

							this.configurationAttributeValueMap[attr[i].myId] = configurationAttributeValue !== undefined ? configurationAttributeValue : null;

							var bundleId = this.product.productKey || this.product.record.Id;
							this.configurationAttributeModelMap[attr[i].myId] = {
								targetFieldName: attr[i].targetFieldName,
								value: this.product.configuration.configurationData[attr[i].targetFieldName],
								required: attr[i].required,
								hidden: attr[i].hidden,
								myId: attr[i].myId,
								bundleId: bundleId,
								autoSelect: attr[i].autoSelect,
								shownValues: attr[i].shownValues,
								hiddenValues: attr[i].hiddenValues
							};
							var ids = this.configurationAttributeTargetFieldMap[attr[i].targetFieldName] || [];
							ids.push(attr[i].myId);
							this.configurationAttributeTargetFieldMap[attr[i].targetFieldName] = ids;

							if (attr[i].applyToProductOptions === true && this.configurationAttributeApplyToOptionMap[attr[i].targetFieldName] === undefined) this.configurationAttributeApplyToOptionMap[attr[i].targetFieldName] = true;
						}
					}
				}, {
					key: 'initReconfiguredOption',
					value: function initReconfiguredOption(option, feature, notInitialized, isClick, unsortedOptionConfigs) {
						var configsArray = this.productOptionConfigurationsMap[option.record.Id];
						if (!configsArray || option.removed) {
							if (notInitialized && isClick) return feature._transient_.optionConfigurations.push(option);
							return;
						}

						var requiredOptionAdded = {};
						for (var i = 0; i < configsArray.length; i++) {
							var clonedOption = void 0;

							if (!isClick) {
								clonedOption = JSON.parse(JSON.stringify(option));
								clonedOption._transient_.rowActions = option._transient_.rowActions;
								if (requiredOptionAdded[clonedOption.record.Id] === true) clonedOption.required = false;else requiredOptionAdded[clonedOption.record.Id] = true;
							}
							var productOption = clonedOption != null ? clonedOption : option;
							productOption.index = i;
							this.setOptionProductConfigurationData(productOption);
							this.setOptionConfigurations(productOption, configsArray[i]);

							if (notInitialized) {
								if (isClick) feature._transient_.optionConfigurations.push(productOption);else unsortedOptionConfigs.push(productOption);
							}
						}
					}
				}, {
					key: 'setOptionConfigurations',
					value: function setOptionConfigurations(option, config) {
						option.selected = option.selected !== false;
						for (var key in config.optionData) {
							if (key !== 'attributes') option.record[key] = config.optionData[key];
						}
					}
				}, {
					key: 'getHasUpgradeOptions',
					value: function getHasUpgradeOptions(feature) {
						if (feature.record.Id === 'Other') {
							for (var i = 0; i < feature._transient_.optionConfigurations.length; i++) {
								if (feature._transient_.optionConfigurations[i].isUpgrade === true) {
									return true;
								}
							}
							return false;
						} else {
							return feature.containsUpgrades;
						}
					}
				}, {
					key: 'sortAndAddOptionConfigs',
					value: function sortAndAddOptionConfigs(feature, unsorted, isNotClick) {
						var _this4 = this;

						var duplicate = void 0;
						var _iteratorNormalCompletion7 = true;
						var _didIteratorError7 = false;
						var _iteratorError7 = undefined;

						try {
							var _loop2 = function _loop2() {
								var optionConfig = _step7.value;

								if (!!optionConfig) {
									if (isNotClick) {
										optionConfig.added = true;
										duplicate = !!feature._transient_.optionConfigurations.filter(function (o) {
											return o.record.Id === optionConfig.record.Id;
										});
									}
									_this4.setOptionDisabledData(optionConfig, duplicate);
									feature._transient_.optionConfigurations.push(optionConfig);
								}
							};

							for (var _iterator7 = unsorted[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {
								_loop2();
							}
						} catch (err) {
							_didIteratorError7 = true;
							_iteratorError7 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion7 && _iterator7.return) {
									_iterator7.return();
								}
							} finally {
								if (_didIteratorError7) {
									throw _iteratorError7;
								}
							}
						}
					}
				}, {
					key: 'createConstraintsHoverMessages',
					value: function createConstraintsHoverMessages(constraintsByConstrained) {
						this.optionConstraintsByConstrained = constraintsByConstrained;
						var _iteratorNormalCompletion8 = true;
						var _didIteratorError8 = false;
						var _iteratorError8 = undefined;

						try {
							for (var _iterator8 = this.product.options[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {
								var option = _step8.value;

								this.createConstraintHoverMessage(option);
							}
						} catch (err) {
							_didIteratorError8 = true;
							_iteratorError8 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion8 && _iterator8.return) {
									_iterator8.return();
								}
							} finally {
								if (_didIteratorError8) {
									throw _iteratorError8;
								}
							}
						}
					}
				}, {
					key: 'createConstraintHoverMessage',
					value: function createConstraintHoverMessage(option) {
						if (!this.optionConstraintsByConstrained[option.record.Id]) return;

						var constraint = this.optionConstraintsByConstrained[option.record.Id],
						    message = { 'Requires': [], 'Excludes': [] },
						    constraintMessage = [];

						constraint.ungroupedConstraints.forEach(function (ungrouped) {
							var type = ungrouped.type === 'Dependency' ? 'Requires' : 'Excludes',
							    operator = message[type].length ? 'and ' : type + ': ',
							    constraining = this.optionsById[ungrouped.option].record[this.prefix + 'ProductName__c'];
							message[type].push(operator + constraining);
						}.bind(this));

						Object.keys(constraint.groups).forEach(function (groupName, i) {
							var group = constraint.groups[groupName],
							    type = group.type === 'Dependency' ? 'Requires' : 'Excludes',
							    operator = message[type].length ? i == 0 && constraint.ungroupedConstraints[0] ? 'and ' : 'or ' : type + ': ',
							    statement = '';

							group.options.forEach(function (groupedOption, index) {
								var constraining = this.optionsById[groupedOption].record[this.prefix + 'ProductName__c'];
								operator = index === 0 ? operator : ' and ';
								statement += operator + constraining;
							}.bind(this));

							message[type].push(statement);
						}.bind(this));

						if (message.Requires.length) {
							var _iteratorNormalCompletion9 = true;
							var _didIteratorError9 = false;
							var _iteratorError9 = undefined;

							try {
								for (var _iterator9 = message.Requires[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {
									var _requirement = _step9.value;
									constraintMessage.push(_requirement);
								}
							} catch (err) {
								_didIteratorError9 = true;
								_iteratorError9 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion9 && _iterator9.return) {
										_iterator9.return();
									}
								} finally {
									if (_didIteratorError9) {
										throw _iteratorError9;
									}
								}
							}
						}if (message.Excludes.length) {
							var _iteratorNormalCompletion10 = true;
							var _didIteratorError10 = false;
							var _iteratorError10 = undefined;

							try {
								for (var _iterator10 = message.Excludes[Symbol.iterator](), _step10; !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {
									var _exclusion = _step10.value;
									constraintMessage.push(_exclusion);
								}
							} catch (err) {
								_didIteratorError10 = true;
								_iteratorError10 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion10 && _iterator10.return) {
										_iterator10.return();
									}
								} finally {
									if (_didIteratorError10) {
										throw _iteratorError10;
									}
								}
							}
						}option.constraintMessage = constraintMessage;
					}
				}, {
					key: 'optionSystemOrRequired',
					value: function optionSystemOrRequired(id) {
						var option = this.optionsById[id];
						return option.record[this.prefix + 'System__c'] || option.record[this.prefix + 'Required__c'];
					}
				}, {
					key: 'isOptionLookupViewModel',
					value: function isOptionLookupViewModel() {
						return !!this.featureLookupId;
					}
				}]);

				return ProductViewModel;
			}());

			_export('ProductViewModel', ProductViewModel);
		}
	};
});

'use strict';

System.register('products/prototype/sb-product-search/ProductSearch.js', ['common/core/Page.js'], function (_export, _context) {
	var Page, _createClass, TILE, ProductSearch, products, categories;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	function flatten(flat, cats, level) {
		var keys = cats ? Object.keys(cats) : [],
		    len = keys.length;

		for (var i = 0; i < len; i++) {
			var item = cats[keys[i]];
			flat.push({ label: item.label, id: keys[i], indent: level });
			if (item.kids) flatten(flat, item.kids, level + 1);
		}
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			TILE = 'tile';

			_export('ProductSearch', ProductSearch = function (_Page) {
				_inherits(ProductSearch, _Page);

				function ProductSearch() {
					_classCallCheck(this, ProductSearch);

					return _possibleConstructorReturn(this, (ProductSearch.__proto__ || Object.getPrototypeOf(ProductSearch)).apply(this, arguments));
				}

				_createClass(ProductSearch, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-search';
						this.properties = Polymer.Base.extend({
							categories: {
								type: Object,
								value: function value() {
									return {};
								},
								observer: '_categoriesChanged'
							},
							flatcats: {
								type: Array,
								value: function value() {
									return [];
								}
							},
							products: {
								type: Array,
								value: function value() {
									return [];
								}
							},
							searchcats: {
								type: Array,
								value: function value() {
									return [];
								}
							},
							searchContext: {
								type: Object,
								value: function value() {
									return { label: 'All' };
								}
							},
							showTiles: {
								type: String,
								value: function value() {
									return TILE;
								}
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this._loadCategoryMenu().then(function (cats) {
							this.categories = cats;
						}.bind(this));

						this._loadProducts().then(function (rows) {
							this.products = rows;
						}.bind(this));
					}
				}, {
					key: '_showFavorites',
					value: function _showFavorites() {}
				}, {
					key: '_showCategory',
					value: function _showCategory(e) {
						if (e && e.model && e.model.item && e.model.item.id) {
							var categoryId = e.model.item.id;
							this.products = products.filter(function (e, i) {
								return e.cat == categoryId;
							});
						}
					}
				}, {
					key: '_loadCategoryMenu',
					value: function _loadCategoryMenu() {
						return Promise.resolve(categories);
					}
				}, {
					key: '_loadProducts',
					value: function _loadProducts() {
						return Promise.resolve(products);
					}
				}, {
					key: '_categoriesChanged',
					value: function _categoriesChanged(nv) {
						var f = [];
						flatten(f, nv, 0);
						this.flatcats = f;
						this.searchcats = f.filter(function (e, i) {
							return e && e.indent == 0;
						});
					}
				}, {
					key: '_toggleLayout',
					value: function _toggleLayout() {
						this.showTiles = this.showTiles ? false : TILE;
					}
				}, {
					key: '_setSearchContext',
					value: function _setSearchContext(e) {
						this.searchContext = e.model.item;
						e.preventDefault();
					}
				}, {
					key: '_formatMoney',
					value: function _formatMoney(value) {
						return this.i18n.format(value, { currency: 'USD', style: 'currency' });
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page];
					}
				}]);

				return ProductSearch;
			}(Page));

			_export('ProductSearch', ProductSearch);

			Polymer(ProductSearch);

			products = [{ id: 1, name: 'Magic Mouse 2', code: 'MM2', price: 79.00, cat: '1014', desc: 'Featuring a new design, Magic Mouse 2 is completely rechargeable, so you’ll eliminate the use of traditional batteries. It’s lighter, has fewer moving parts thanks to its built-in battery and continuous bottom shell, and has an optimized foot design — all helping Magic Mouse 2 track easier and move with less resistance across your desk. And the Multi-Touch surface allows you to perform simple gestures such as swiping between web pages and scrolling through documents. Magic Mouse 2 is ready to go right out of the box and pairs automatically with your Mac.' }, { id: 2, name: 'Magic Trackpad 2', code: 'TPAD2', price: 129.00, cat: '1014', desc: 'Redesigned and rechargeable, Magic Trackpad 2 includes a built-in battery and brings Force Touch to the desktop for the first time. Four force sensors underneath the trackpad surface allow you to click anywhere, and detect subtle differences in the amount of pressure you apply, bringing increased functionality to your fingertips and enabling a deeper connection to your content. Magic Trackpad 2 also features an edge-to-edge glass surface area that is nearly 30 percent larger than the previous trackpad. This design, along with a lower profile, makes scrolling and swiping through your favorite content more productive and comfortable than ever.' }, { id: 3, name: 'Magic Keyboard', code: 'KEY', price: 99.00, cat: '1014', desc: 'The Magic Keyboard combines a sleek new design with a built-in rechargeable battery and enhanced key features. With an improved scissor mechanism beneath each key for increased stability, as well as optimized key travel and a lower profile, the Magic Keyboard provides a remarkably comfortable and precise typing experience. It pairs automatically with your Mac, so you can get to work right away. And the battery is incredibly long-lasting — it will power your keyboard for about a month or more between charges.' }, { id: 4, name: 'Naim Audio mu-so Wireless Speaker System', code: 'AUDO', price: 1499.95, cat: '1014', desc: 'Naim Audio\'s mu-so is a wireless music system finely tuned to deliver high-quality sound. Commanding 450 watts of power through six custom-designed speakers, mu-so provides a music experience that has to be heard to be believed.' }, { id: 5, name: 'Microsoft Word', code: 'WORD', price: 79.00, cat: '1022', desc: 'Create, polish, and share beautiful documents. Now sharing and collaborating with the team is a breeze. The new Word allows you to co-author and edit documents with multiple people at the same time—whether you’re in the same room or across the globe. And cloud integration makes sharing docs a cinch.' }, { id: 6, name: 'Microsoft Excel', code: 'EXCEL', price: 89.00, cat: '1022', desc: 'Analyze and visualize your data in new and intuitive ways. Turn numbers into insights with the new Excel. PivotTable Slicers help you discover patterns in large volumes of data, and Recommended Charts gives you the best charts to communicate your data. One-Click Forecasting automatically scans worksheets for data trends and formats them into charts and tables.' }, { id: 7, name: 'Microsoft Office 365 1-year', code: 'OFFICE-1', price: 149.00, cat: '1021', desc: 'Great for 1 PC or Mac, and 1 iPad, Office 365 helps you get things done from virtually anywhere, on all your devices. Plus, every new upgrade is included so you’ll always have the most up-to-date versions or applications.' }, { id: 8, name: 'Microsoft Office 365 2-year', code: 'OFFICE-2', price: 289.00, cat: '1021', desc: 'Great for 1 PC or Mac, and 1 iPad, Office 365 helps you get things done from virtually anywhere, on all your devices. Plus, every new upgrade is included so you’ll always have the most up-to-date versions or applications.' }, { id: 9, name: 'Microsoft Office 365 3-year', code: 'OFFICE-3', price: 329.00, cat: '1021', desc: 'Great for 1 PC or Mac, and 1 iPad, Office 365 helps you get things done from virtually anywhere, on all your devices. Plus, every new upgrade is included so you’ll always have the most up-to-date versions or applications.' }, { id: 10, name: 'Macbook Air', code: 'MBOOK-AIR', price: 1299.00, cat: '1012', desc: 'Fifth-generation Intel Core processors in MacBook Air give you more time to do more things. Add that to an array of other smart and efficient features, and you have an incredible amount of power in your hands. While carrying next to nothing.' }, { id: 11, name: 'Macbook Pro', code: 'MBOOK-PRO', price: 2499.00, cat: '1012', desc: 'A groundbreaking Retina display. A new force-sensing trackpad. All-flash architecture. Powerful dual-core and quad-core Intel processors. Together, these features take the notebook to a new level of performance. And they will do the same for you in everything you create.' }, { id: 12, name: 'Mac Pro', code: 'M-PRO', price: 4300.00, cat: '1011', desc: 'When we began work on the new Mac Pro, we considered every element that defines a pro computer — graphics, storage, expansion, processing power, and memory. And we challenged ourselves to find the best, most forward-looking way possible to engineer each one of them. When we put it all together, the result was something entirely new. Something radically different from anything before it. Something that provides an extremely powerful argument against the status quo' }];
			categories = {
				'1020': {
					label: 'Software',
					kids: {
						'1021': { label: 'Subscriptions' },
						'1022': { label: 'Licenses' }
					}
				},
				'1010': {
					label: 'Hardware',
					kids: {
						'1011': { label: 'Servers' },
						'1012': { label: 'Laptops' },
						'1013': { label: 'Routers' },
						'1014': { label: 'Accessories' }
					}
				},
				'1030': {
					label: 'Services',
					kids: {
						'1031': { label: 'Training' },
						'1032': { label: 'Support' }
					}
				}
			};
		}
	};
});

'use strict';

System.register('products/resources/optionConstraints/OptionConstraintsHandler.js', [], function (_export, _context) {
	var _createClass, OptionConstraintsHandler;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OptionConstraintsHandler', OptionConstraintsHandler = function () {
				function OptionConstraintsHandler(product, prefix) {
					_classCallCheck(this, OptionConstraintsHandler);

					this.product = product;
					this.prefix = prefix;
					this.messages = {};
					this.setOptionConstraints();
				}

				_createClass(OptionConstraintsHandler, [{
					key: 'setOptionConstraints',
					value: function setOptionConstraints() {
						if (!this.product.constraints) return null;

						var constraintType = this.prefix + 'Type__c',
						    constrainedOption = this.prefix + 'ConstrainedOption__c',
						    constrainingOption = this.prefix + 'ConstrainingOption__c',
						    constraintGroup = this.prefix + 'OptionConstraintGroup__c',
						    constraints = {
							byConstraining: {},
							byConstrained: {}
						};

						this.product.constraints.forEach(function (constraint) {
							var type = constraint.record[constraintType],
							    constrainedId = constraint.record[constrainedOption],
							    constrainingId = constraint.record[constrainingOption],
							    groups = constraint.record[constraintGroup] ? constraint.record[constraintGroup].split(', ') : null;

							if (constraints.byConstraining[constrainingId]) {
								constraints.byConstraining[constrainingId].push({
									type: type,
									option: constrainedId
								});
							} else {
								constraints.byConstraining[constrainingId] = [{
									type: type,
									option: constrainedId
								}];
							}

							if (constraints.byConstrained[constrainedId]) {
								if (groups) {
									groups.forEach(function (group) {
										if (constraints.byConstrained[constrainedId].groups[group]) {
											constraints.byConstrained[constrainedId].groups[group].options.push(constrainingId);
										} else {
											constraints.byConstrained[constrainedId].groups[group] = {
												type: type,
												options: [constrainingId]
											};
										}
									});
								} else {
									constraints.byConstrained[constrainedId].ungroupedConstraints.push({
										type: type,
										option: constrainingId
									});
								}
							} else {
								constraints.byConstrained[constrainedId] = {
									ungroupedConstraints: [],
									groups: {}
								};
								if (groups) {
									groups.forEach(function (group) {
										if (constraints.byConstrained[constrainedId].groups[group]) {
											constraints.byConstrained[constrainedId].groups[group].options.push(constrainingId);
										} else {
											constraints.byConstrained[constrainedId].groups[group] = {
												type: type,
												options: [constrainingId]
											};
										}
									});
								} else {
									constraints.byConstrained[constrainedId].ungroupedConstraints = [{
										type: type,
										option: constrainingId
									}];
								}
							}

							if (type === 'Exclusion' && !groups) {
								if (constraints.byConstraining[constrainedId]) {
									constraints.byConstraining[constrainedId].push({
										type: type,
										option: constrainingId
									});
								} else {
									constraints.byConstraining[constrainedId] = [{
										type: type,
										option: constrainingId
									}];
								}
								if (constraints.byConstrained[constrainingId]) {
									constraints.byConstrained[constrainingId].ungroupedConstraints.push({
										type: type,
										option: constrainedId
									});
								} else {
									constraints.byConstrained[constrainingId] = {
										ungroupedConstraints: [{
											type: type,
											option: constrainedId
										}],
										groups: {}
									};
								}
							}
						});

						this.optionConstraints = constraints;
					}
				}, {
					key: 'handleOptionConstraints',
					value: function handleOptionConstraints(changedOptionId, selected) {
						var _this = this;

						if (!this.optionConstraints || !this.optionConstraints.byConstraining[changedOptionId]) return;

						var result = [],
						    addedOrSelected = selected || this.getOption(changedOptionId).added;

						this.getOption(changedOptionId).selected = selected;

						this.optionConstraints.byConstraining[changedOptionId].forEach(function (constraint) {
							var disabledState = _this.optionIsConstrained(constraint, changedOptionId, addedOrSelected);
							result.push({ optionId: constraint.option, disabledState: disabledState });
						});

						return result;
					}
				}, {
					key: 'optionIsConstrained',
					value: function optionIsConstrained(constraint, changedOptionId, selected) {
						var constraintType = constraint.type,
						    constrainedOption = this.optionConstraints.byConstrained[constraint.option],
						    hasGroupConstraints = Object.keys(constrainedOption.groups).length > 0,
						    constraintObj = this.isConstrainedByUngrouped(constrainedOption);

						if (constraintObj.constrained) return true;

						if (hasGroupConstraints) return this.isConstrainedByGrouped(constrainedOption.groups);

						return this.getUnaffectedDisabledState(changedOptionId, selected, constraintType === 'Dependency', constraintObj.requiredConditionMet);
					}
				}, {
					key: 'isConstrainedByUngrouped',
					value: function isConstrainedByUngrouped(constrainedOption) {
						var excludedConstrained = false,
						    requiredConstrained = false,
						    requiredConditionMet = false,
						    ungroupedConstraints = constrainedOption.ungroupedConstraints,
						    len = ungroupedConstraints ? ungroupedConstraints.length : -1,
						    i = 0;

						while (!excludedConstrained && i < len) {
							var associatedOption = this.getOption(ungroupedConstraints[i].option),
							    associatedType = ungroupedConstraints[i].type;

							if (associatedType === 'Exclusion') {
								excludedConstrained = this.isSelected(associatedOption);
							} else if (associatedType === 'Dependency' && !requiredConditionMet) {
								requiredConditionMet = this.isSelected(associatedOption);
								requiredConstrained = !requiredConditionMet;
							}

							i++;
						}

						return { 'constrained': excludedConstrained || requiredConstrained, 'requiredConditionMet': requiredConditionMet };
					}
				}, {
					key: 'isConstrainedByGrouped',
					value: function isConstrainedByGrouped(groups) {
						var constrained = false,
						    constrainedByDependency = true,
						    constrainedByExclusion = false,
						    len = Object.keys(groups).length,
						    i = 0;

						while (i < len) {
							var constrainedWithinGroup = false,
							    group = groups[Object.keys(groups)[i]],
							    type = group.type,
							    options = group.options,
							    len2 = options.length,
							    j = 0;

							if (type === 'Dependency' && constrainedByDependency && !constrainedByExclusion) {
								while (!constrainedWithinGroup && j < len2) {
									var option = this.getOption(options[j]);
									constrainedWithinGroup = !this.isSelected(option);
									if (!constrainedWithinGroup && j === len2 - 1) constrainedByDependency = false;
									j++;
								}
								constrained = constrainedByDependency;
							}

							if (type === 'Exclusion' && !constrainedByExclusion) {
								while (!constrainedWithinGroup && j < len2) {
									var _option = this.getOption(options[j]);
									constrainedWithinGroup = !this.isSelected(_option);
									if (!constrainedWithinGroup && j === len2 - 1) {
										constrainedByExclusion = true;
									}
									j++;
								}
								constrained = constrainedByExclusion;
							}

							i++;
						}

						return constrained;
					}
				}, {
					key: 'getOption',
					value: function getOption(optionId) {
						return this.product.options.find(function (option) {
							return option.record.Id === optionId;
						});
					}
				}, {
					key: 'isSelected',
					value: function isSelected(option) {
						return option && (option.selected || option.added || !!option.priorOptionExists);
					}
				}, {
					key: 'getUnaffectedDisabledState',
					value: function getUnaffectedDisabledState(optId, selected, isDependency, requiredConditionMet) {
						if (isDependency) {
							return requiredConditionMet ? false : !(selected || !!this.getOption(optId).priorOptionExists);
						} else return selected || !!this.getOption(optId).priorOptionExists;
					}
				}, {
					key: 'optionShouldBeDisabled',
					value: function optionShouldBeDisabled(optId) {
						var constrainedOption = this.optionConstraints.byConstrained[optId],
						    hasUngroupedConstraints = void 0,
						    hasGroupedConstraints = void 0,
						    constrainingId = void 0,
						    selected = void 0,
						    constraint = void 0;

						if (!constrainedOption) return false;

						hasUngroupedConstraints = constrainedOption.ungroupedConstraints.length >= 1;
						hasGroupedConstraints = Object.keys(constrainedOption.groups).length >= 1;

						if (hasUngroupedConstraints) {
							constrainingId = constrainedOption.ungroupedConstraints[0].option;
						} else if (hasGroupedConstraints) {
							constrainingId = constrainedOption.groups[Object.keys(constrainedOption.groups)[0]].options[0];
						} else {
							return false;
						}

						selected = this.isSelected(this.getOption(constrainingId));
						constraint = this.optionConstraints.byConstraining[constrainingId].find(function (c) {
							return c.option === optId;
						});

						return this.optionIsConstrained(constraint, constrainingId, selected);
					}
				}]);

				return OptionConstraintsHandler;
			}());

			_export('OptionConstraintsHandler', OptionConstraintsHandler);
		}
	};
});

'use strict';

System.register('products/resources/optionUpgrades/OptionUpgradeHandler.js', [], function (_export, _context) {
	var _createClass, OptionUpgradeHandler;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OptionUpgradeHandler', OptionUpgradeHandler = function () {
				function OptionUpgradeHandler(prefix, options, option) {
					_classCallCheck(this, OptionUpgradeHandler);

					this.prefix = prefix;
					this.options = options;
					this.option = option;
				}

				_createClass(OptionUpgradeHandler, [{
					key: 'isSourceLine',
					value: function isSourceLine() {
						return this.option.priorBundledQuantity != null;
					}
				}, {
					key: 'getLine',
					value: function getLine() {
						return this.option;
					}
				}, {
					key: 'getLines',
					value: function getLines() {
						return this.options;
					}
				}, {
					key: 'getSourceOrUpgrade',
					value: function getSourceOrUpgrade(sourceOp, upgradeOp) {
						for (var i = 0; i < this.options.length; i++) {
							var sourceOption = sourceOp || this.options[i];
							var upgradeOption = upgradeOp || this.options[i];

							if (upgradeOption.sourceProductIds && upgradeOption.sourceProductIds.indexOf(sourceOption.record[this.prefix + 'OptionalSKU__c']) != -1) {
								return this.options[i];
							}
						}
					}
				}, {
					key: 'setSourceAndUpgrade',
					value: function setSourceAndUpgrade(sourceOption, upgradeOption) {
						this.sourceOption = sourceOption;
						this.upgradeOption = upgradeOption;
					}
				}, {
					key: 'getSourceIdField',
					value: function getSourceIdField() {
						return this.prefix + 'OptionalSKU__c';
					}
				}, {
					key: 'getUpgradeConversionRateField',
					value: function getUpgradeConversionRateField() {
						return this.prefix + 'UpgradeConversionRate__c';
					}
				}, {
					key: 'getSourceCurrentQuantityField',
					value: function getSourceCurrentQuantityField(sourceOption) {
						return sourceOption.selected ? sourceOption.record[this.prefix + 'Quantity__c'] : 0;
					}
				}, {
					key: 'getUpgradeCurrentQuantityField',
					value: function getUpgradeCurrentQuantityField(upgradeOption) {
						return upgradeOption.selected ? upgradeOption.record[this.prefix + 'Quantity__c'] : 0;
					}
				}, {
					key: 'getSourcePriorQuantity',
					value: function getSourcePriorQuantity(sourceOption) {
						return sourceOption.priorBundledQuantity;
					}
				}, {
					key: 'didSourceQuantityChange',
					value: function didSourceQuantityChange(didUserChangeSourceOption, sourceOption, upgradeOption) {
						return upgradeOption.selected && (didUserChangeSourceOption || !sourceOption.selected);
					}
				}, {
					key: 'didUpgradeQuantityChange',
					value: function didUpgradeQuantityChange(didUserChangeSourceOption, sourceOption) {
						return sourceOption.selected && !didUserChangeSourceOption;
					}
				}, {
					key: 'isSelected',
					value: function isSelected(option) {
						return option.selected;
					}
				}, {
					key: 'setUpdatedQuantity',
					value: function setUpdatedQuantity(sourceOption, upgradeOption, sourceQtyAfterUpdate, upgradeQtyAfterUpdate) {
						if (sourceOption.selected) {
							sourceOption.record[this.prefix + 'Quantity__c'] = sourceQtyAfterUpdate;
						}

						if (upgradeOption.selected) {
							upgradeOption.record[this.prefix + 'Quantity__c'] = upgradeQtyAfterUpdate;
						}
					}
				}, {
					key: 'getSourceOption',
					value: function getSourceOption() {
						return this.sourceOption;
					}
				}, {
					key: 'getUpgradeOption',
					value: function getUpgradeOption() {
						return this.upgradeOption;
					}
				}, {
					key: 'setUpgradedAssetId',
					value: function setUpgradedAssetId() {
						var sourceOption = this.getSourceOrUpgrade(null, this.option);
						this.option.upgradedAssetId = sourceOption.upgradedAssetId;
					}
				}]);

				return OptionUpgradeHandler;
			}());

			_export('OptionUpgradeHandler', OptionUpgradeHandler);
		}
	};
});

'use strict';

System.register('products/resources/reconfigure/ProductReconfigurer.js', ['../model/nestedOptions/NestedOptionsModel.js'], function (_export, _context) {
	var NestedOptionsModel, _createClass, ProductReconfigurer;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_modelNestedOptionsNestedOptionsModelJs) {
			NestedOptionsModel = _modelNestedOptionsNestedOptionsModelJs.NestedOptionsModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductReconfigurer', ProductReconfigurer = function () {
				function ProductReconfigurer(product, quoteType) {
					_classCallCheck(this, ProductReconfigurer);

					this.product = product;
					this.product.quoteType = quoteType;
				}

				_createClass(ProductReconfigurer, [{
					key: 'reconfigure',
					value: function reconfigure(configuration) {
						var selectedOptions = {};

						if (!configuration) this.product.nestedOptionModel = this.product.nestedOptionModel || new NestedOptionsModel(this.product.configuration, true);else this.product.configuration = configuration;

						if (!!this.product.configuration.optionConfigurations.length) {
							this.buildOptionConfiguration(this.product.configuration.optionConfigurations, selectedOptions);
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = this.product.options[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var option = _step.value;

									if (selectedOptions[option.record.Id]) {
										option.isDynamicOption = selectedOptions[option.record.Id].isDynamicOption;
										option.upgradedAssetId = selectedOptions[option.record.Id].upgradedAssetId;
										option.priorBundledQuantity = selectedOptions[option.record.Id].priorBundledQuantity;

										if (selectedOptions[option.record.Id].configured === true || selectedOptions[option.record.Id].optionConfigurations) {
											option.configured = true;
										}
									} else {
										option.selected = option.selected === true;
									}
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						} else {
							var _iteratorNormalCompletion2 = true;
							var _didIteratorError2 = false;
							var _iteratorError2 = undefined;

							try {
								for (var _iterator2 = this.product.options[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
									var _option = _step2.value;

									if (_option.configuration) delete _option.configuration;
								}
							} catch (err) {
								_didIteratorError2 = true;
								_iteratorError2 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion2 && _iterator2.return) {
										_iterator2.return();
									}
								} finally {
									if (_didIteratorError2) {
										throw _iteratorError2;
									}
								}
							}
						}
					}
				}, {
					key: 'buildOptionConfiguration',
					value: function buildOptionConfiguration(optionConfigs, selectedOptions) {
						var segmentedMap = {};
						for (var i = 0; i < optionConfigs.length; i++) {
							var config = optionConfigs[i];

							if (segmentedMap[config.optionId] === true) continue;
							if (config.isSegmented) segmentedMap[config.optionId] = true;

							selectedOptions[config.optionId] = this.buildStrippedOptionData(config, i);
						}
					}
				}, {
					key: 'buildStrippedOptionData',
					value: function buildStrippedOptionData(config, index) {
						if (config.optionConfigurations.length === 0) {
							var productConfiguration = ProductReconfigurer.newConfiguration(config.optionId, config.optionData, config.isDynamicOption, index);
							productConfiguration.configured = config.configured;
							if (this.product.quoteType === 'Amendment') {
								productConfiguration.upgradedAssetId = config.upgradedAssetId;
								productConfiguration.priorBundledQuantity = config.priorBundledQuantity;
							}
							return productConfiguration;
						}

						var optionConfigurations = config.optionConfigurations.length > 0;
						return { optionId: config.optionId, optionData: config.optionData, optionConfigurations: optionConfigurations, index: index };
					}
				}], [{
					key: 'newConfiguration',
					value: function newConfiguration(optionId, optionData, isDynamicOption, index) {
						return { optionId: optionId, optionData: optionData, isDynamicOption: isDynamicOption, index: index };
					}
				}]);

				return ProductReconfigurer;
			}());

			_export('ProductReconfigurer', ProductReconfigurer);
		}
	};
});

'use strict';

System.register('products/resources/rules/RuleProcessor.js', ['common/core/AppContext.js', '../model/nestedOptions/NestedOptionsModel.js'], function (_export, _context) {
	var AppContext, NestedOptionsModel, _createClass, RuleProcessor;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_modelNestedOptionsNestedOptionsModelJs) {
			NestedOptionsModel = _modelNestedOptionsNestedOptionsModelJs.NestedOptionsModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RuleProcessor', RuleProcessor = function () {
				function RuleProcessor(data, product) {
					_classCallCheck(this, RuleProcessor);

					this.prefix = AppContext.org.prefix ? AppContext.org.prefix + '__' : '';
					this.data = data;
					this.product = product;
					this.validationMessages = [];
					this.productRulesActions = {};
					this.optionDataByOptionIds = {};
				}

				_createClass(RuleProcessor, [{
					key: 'getValidationMessages',
					value: function getValidationMessages() {
						return this.validationMessages;
					}
				}, {
					key: 'getProductRulesActions',
					value: function getProductRulesActions() {
						return this.productRulesActions;
					}
				}, {
					key: 'getOptionDataByOptionIds',
					value: function getOptionDataByOptionIds() {
						return this.optionDataByOptionIds;
					}
				}, {
					key: 'init',
					value: function init() {
						this.initValidationMessages();

						if (this.product) {
							this.initProductRulesActions();
							this.initOptionDataByOptionIds();
						}
					}
				}, {
					key: 'initValidationMessages',
					value: function initValidationMessages() {
						if (this.data.validationMessages) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = this.data.validationMessages[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var message = _step.value;

									this.validationMessages.push(message);
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						} else {
							var _iteratorNormalCompletion2 = true;
							var _didIteratorError2 = false;
							var _iteratorError2 = undefined;

							try {
								for (var _iterator2 = this.data.configuredProducts[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
									var product = _step2.value;
									var _iteratorNormalCompletion3 = true;
									var _didIteratorError3 = false;
									var _iteratorError3 = undefined;

									try {
										for (var _iterator3 = product.configuration.validationMessages[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
											var message = _step3.value;

											this.validationMessages.push(message);
										}
									} catch (err) {
										_didIteratorError3 = true;
										_iteratorError3 = err;
									} finally {
										try {
											if (!_iteratorNormalCompletion3 && _iterator3.return) {
												_iterator3.return();
											}
										} finally {
											if (_didIteratorError3) {
												throw _iteratorError3;
											}
										}
									}
								}
							} catch (err) {
								_didIteratorError2 = true;
								_iteratorError2 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion2 && _iterator2.return) {
										_iterator2.return();
									}
								} finally {
									if (_didIteratorError2) {
										throw _iteratorError2;
									}
								}
							}
						}
					}
				}, {
					key: 'initProductRulesActions',
					value: function initProductRulesActions(onLoad) {
						var selectedOptionIds = {},
						    disabledOptionIds = {},
						    hiddenOptionIds = {};
						var selectOptions = {},
						    deselectOptions = {},
						    showOptions = {},
						    hideOptions = {},
						    enableOptions = {},
						    disableOptions = {};var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = this.data.optionConfigurations[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var serverOption = _step4.value;

								selectedOptionIds[serverOption.optionData.Id || serverOption.optionId] = true;
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}

						if (this.data.disabledOptionIds != null) {
							var _iteratorNormalCompletion5 = true;
							var _didIteratorError5 = false;
							var _iteratorError5 = undefined;

							try {
								for (var _iterator5 = this.data.disabledOptionIds[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
									var disabledOption = _step5.value;

									disabledOptionIds[disabledOption] = true;
								}
							} catch (err) {
								_didIteratorError5 = true;
								_iteratorError5 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion5 && _iterator5.return) {
										_iterator5.return();
									}
								} finally {
									if (_didIteratorError5) {
										throw _iteratorError5;
									}
								}
							}
						}
						if (this.data.hiddenOptionIds != null) {
							var _iteratorNormalCompletion6 = true;
							var _didIteratorError6 = false;
							var _iteratorError6 = undefined;

							try {
								for (var _iterator6 = this.data.hiddenOptionIds[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
									var hiddenOption = _step6.value;

									hiddenOptionIds[hiddenOption] = true;
								}
							} catch (err) {
								_didIteratorError6 = true;
								_iteratorError6 = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion6 && _iterator6.return) {
										_iterator6.return();
									}
								} finally {
									if (_didIteratorError6) {
										throw _iteratorError6;
									}
								}
							}
						}

						if (onLoad) return this.assignProductRules(selectedOptionIds, disabledOptionIds, hiddenOptionIds);

						var _iteratorNormalCompletion7 = true;
						var _didIteratorError7 = false;
						var _iteratorError7 = undefined;

						try {
							for (var _iterator7 = this.product.options[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {
								var option = _step7.value;

								if (this.optionNotInPricebook(option)) continue;
								this.handleProductActions(hiddenOptionIds, option, showOptions, hideOptions, 'hidden');
								this.handleProductActions(disabledOptionIds, option, enableOptions, disableOptions, 'disabled');
								this.handleProductActions(selectedOptionIds, option, deselectOptions, selectOptions, 'selected');
							}
						} catch (err) {
							_didIteratorError7 = true;
							_iteratorError7 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion7 && _iterator7.return) {
									_iterator7.return();
								}
							} finally {
								if (_didIteratorError7) {
									throw _iteratorError7;
								}
							}
						}

						this.productRulesActions = {
							showOptions: showOptions, hideOptions: hideOptions, selectOptions: selectOptions,
							deselectOptions: deselectOptions, enableOptions: enableOptions, disableOptions: disableOptions
						};
					}
				}, {
					key: 'initOptionDataByOptionIds',
					value: function initOptionDataByOptionIds() {
						var optionConfigurations = this.data.optionConfigurations;

						for (var i = 0; i < optionConfigurations.length; i++) {
							this.optionDataByOptionIds[optionConfigurations[i].optionId] = {
								optionData: optionConfigurations[i].optionData,
								listPrice: optionConfigurations[i].listPrice
							};
						}
					}
				}, {
					key: 'handleProductActions',
					value: function handleProductActions(ids, option, positiveAction, negativeAction, action) {
						if (action === 'disabled') {
							if (ids[option.record.Id] && option.disabledData && !option.disabledData.disabled) return negativeAction[option.record.Id] = true;
							if (!ids[option.record.Id] && option.disabledData && option.disabledData.disabled) return positiveAction[option.record.Id] = true;
							return;
						}

						if (ids[option.record.Id] && !option[action]) return negativeAction[option.record.Id] = true;
						if (!ids[option.record.Id] && option[action]) return positiveAction[option.record.Id] = true;
					}
				}, {
					key: 'assignProductRules',
					value: function assignProductRules(selectedOptionIds, disabledOptionIds, hiddenOptionIds) {
						var systemLabel = this.prefix + 'System__c';
						this.product.rulesProcessed = true;
						var _iteratorNormalCompletion8 = true;
						var _didIteratorError8 = false;
						var _iteratorError8 = undefined;

						try {
							for (var _iterator8 = this.product.options[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {
								var option = _step8.value;

								if (this.optionNotInPricebook(option)) continue;

								option.selected = option.selectedByRule = !!selectedOptionIds[option.record.Id];
								if (disabledOptionIds[option.record.Id]) option.disabledData = {
										'disabled': true,
										'constrained': !!option.record[systemLabel] && !option.selectedByRule
									};
								if (hiddenOptionIds[option.record.Id]) {
									option.hidden = true;
									option.hiddenByRule = true;
								}
							}
						} catch (err) {
							_didIteratorError8 = true;
							_iteratorError8 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion8 && _iterator8.return) {
									_iterator8.return();
								}
							} finally {
								if (_didIteratorError8) {
									throw _iteratorError8;
								}
							}
						}
					}
				}, {
					key: 'initDescendantLevelRules',
					value: function initDescendantLevelRules(product) {
						var indices = {};
						for (var i = 0; i < this.data.optionConfigurations.length; i++) {
							var optionConfig = this.data.optionConfigurations[i];
							indices[optionConfig.optionId] = indices[optionConfig.optionId] === undefined ? 0 : indices[optionConfig.optionId] + 1;

							var parentInfo = { 'optionId': this.data.optionId, 'index': this.data.index || 0 },
							    childInfo = { 'optionId': optionConfig.optionId, 'index': indices[optionConfig.optionId] };
							product.nestedOptionModel.handleDescendantRules([parentInfo, childInfo], optionConfig.optionConfigurations, optionConfig.hiddenOptionIds, optionConfig.disabledOptionIds);
						}
					}
				}, {
					key: 'optionNotInPricebook',
					value: function optionNotInPricebook(option) {
						return option.record[this.prefix + 'UnitPrice__c'] === undefined || option.record[this.prefix + 'UnitPrice__c'] === null;
					}
				}]);

				return RuleProcessor;
			}());

			_export('RuleProcessor', RuleProcessor);
		}
	};
});

'use strict';

System.register('products/resources/sb-product-alert/ProductAlert.js', [], function (_export, _context) {
	var _createClass, ProductAlert;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductAlert', ProductAlert = function () {
				function ProductAlert() {
					_classCallCheck(this, ProductAlert);
				}

				_createClass(ProductAlert, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-alert';
						this.properties = {
							alerts: Array,
							continueCB: Object,
							cancelCB: Object,
							displayContinueButton: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.dialog.addEventListener('sb-close-dialog', this._onCancel.bind(this));
					}
				}, {
					key: 'init',
					value: function init() {
						this.$.dialog.toggle();
					}
				}, {
					key: 'onRevise',
					value: function onRevise() {
						this.$.dialog.toggle();
					}
				}, {
					key: 'toggle',
					value: function toggle() {
						this.$.dialog.toggle();
					}
				}, {
					key: 'onContinue',
					value: function onContinue() {
						if (typeof this.continueCB === 'function') this.continueCB();
					}
				}, {
					key: '_onCancel',
					value: function _onCancel() {
						if (typeof this.cancelCB === 'function') {
							this.cancelCB();
						} else {
							this.$.dialog.toggle();
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['init(alerts)'];
					}
				}]);

				return ProductAlert;
			}());

			_export('ProductAlert', ProductAlert);

			Polymer(ProductAlert);
		}
	};
});

'use strict';

System.register('products/resources/tree/ConfigTree.js', [], function (_export, _context) {
	var _createClass, ConfigTree;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ConfigTree', ConfigTree = function () {
				function ConfigTree(root) {
					_classCallCheck(this, ConfigTree);

					this.root = root;
					this.idProperties = ['optionId', 'index'];
					this.buildSubtree(this.root);
				}

				_createClass(ConfigTree, [{
					key: 'buildSubtree',
					value: function buildSubtree(obj) {
						var _this = this;

						var indices = {};
						this._buildNode(obj);
						obj.getChildren(obj).forEach(function (child) {
							indices[child.optionId] = indices[child.optionId] || child.index || 0;
							if (child.index === undefined || indices[child.optionId] === child.index) {
								child.index = indices[child.optionId];
								indices[child.optionId]++;
							}
							_this.buildSubtree(child);
						});
					}
				}, {
					key: 'getFromPath',
					value: function getFromPath(path) {
						var currentLevel = this.root;
						for (var i = 0, l = path.length; i < l; i++) {
							currentLevel = this._findOnLevel(path[i], currentLevel);
						}
						return currentLevel;
					}
				}, {
					key: '_buildNode',
					value: function _buildNode(obj) {
						obj.nodeId = this._buildId(obj);
						obj.getChildren = function () {
							return this.optionConfigurations;
						}.bind(obj);
					}
				}, {
					key: '_buildId',
					value: function _buildId(properties) {
						var id = '';
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.idProperties[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var key = _step.value;

								id += '_' + properties[key];
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return id;
					}
				}, {
					key: '_findOnLevel',
					value: function _findOnLevel(idProperties, obj) {
						var id = idProperties.constructor === String ? idProperties : this._buildId(idProperties);
						obj = obj || this.root;
						return obj.getChildren().find(function (child) {
							return child.nodeId === id;
						});
					}
				}]);

				return ConfigTree;
			}());

			_export('ConfigTree', ConfigTree);
		}
	};
});

'use strict';

System.register('quotes/dialogs/sb-custom-segment-dialog/CustomSegmentDialog.js', ['quotes/models/LineModel.js', 'quotes/models/DragDropModel.js', 'common/layout/tables/TableClassBuilder.js', 'common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js'], function (_export, _context) {
	var LineModel, DragDropModel, TableClassBuilder, PageContainer, AppContext, _createClass, GHOST_X_OFFSET, GHOST_Y_OFFSET, visibilityHidden, CustomSegmentDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsLineModelJs) {
			LineModel = _quotesModelsLineModelJs.LineModel;
		}, function (_quotesModelsDragDropModelJs) {
			DragDropModel = _quotesModelsDragDropModelJs.DragDropModel;
		}, function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			GHOST_X_OFFSET = 410;
			GHOST_Y_OFFSET = 180;
			visibilityHidden = ' visibilityHidden';

			_export('CustomSegmentDialog', CustomSegmentDialog = function () {
				function CustomSegmentDialog() {
					_classCallCheck(this, CustomSegmentDialog);
				}

				_createClass(CustomSegmentDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-custom-segment-dialog';
						this.properties = {
							dataLineModels: Array,

							lineModels: {
								type: Array
							},

							groupModel: {
								type: Object
							},

							deletedLineKeys: {
								type: Array,
								value: []
							},

							errors: {
								type: Array,
								value: [],
								notify: true
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},

							headerActions: Array,

							headerSelected: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.isMobile = this._isMobileViewport();
					}
				}, {
					key: '_findTableRowValidTarget',
					value: function _findTableRowValidTarget(el) {
						if (!el) {
							return null;
						}
						if (this._ifParentIsValidTarget(el)) {
							return el;
						}
						if (el.parentNode) {
							return this._findTableRowValidTarget(el.parentNode);
						} else {
							return null;
						}
					}
				}, {
					key: '_ifParentIsValidTarget',
					value: function _ifParentIsValidTarget(element) {
						if (!element.parentElement) return false;
						if (element.parentElement.id == 'swipe-header') {
							this.targetRowElement = element.parentElement.parentElement;
							return true;
						}
						return false;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
						var rows = this.dragDrop ? this.dragDrop.segmentRows : null;
						if (rows) {
							if (this._isMobileViewport() || !AppContext.isDesktop) {

								for (var i = 0, l = rows.length; i < l; i++) {

									rows[i].removeEventListener('track', this.onTrack.bind(this));
								}
							} else {
								for (var j = 0, _l = rows.length; j < _l; j++) {
									rows[j].addEventListener('track', this.onTrack.bind(this));
								}
							}
						}
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: '_dataChanged',
					value: function _dataChanged() {
						if (!this.dataLineModels) {
							return;
						}

						this.groupModel = this.dataLineModels[0].groupModel;
						this.editorModel = this.groupModel.quoteModel.editorModel;

						var lineModels = [];
						var i = void 0,
						    l = this.dataLineModels.length;
						var lineModelByStartDate = {};

						for (i = 0; i < l; i++) {
							var currentLineModel = this.dataLineModels[i];
							var newLineVO = JSON.parse(JSON.stringify(currentLineModel.lineVO));
							var newLineModel = new LineModel(newLineVO, this.groupModel);
							newLineModel.selected = false;
							lineModelByStartDate[newLineModel.lineVO.record[this.constants.START_DATE_FIELD]] = newLineModel;
						}

						var startDates = Object.keys(lineModelByStartDate).sort();
						for (i = 0; i < l; i++) {
							lineModels.push(lineModelByStartDate[startDates[i]]);
						}

						this.lineModels = lineModels;
					}
				}, {
					key: '_lineModelChanged',
					value: function _lineModelChanged() {
						if (this.lineModels && this.lineModels.length > 0) {
							this.deletedLineKeys = [];
							this.errors = [];
							this._buildDialog();
						}
					}
				}, {
					key: '_handleCustomSegmentsResponseChanged',
					value: function _handleCustomSegmentsResponseChanged(e) {
						this.fire('segmented-changed', { quoteVO: e });

						this.resetData();
					}
				}, {
					key: '_handleErrorResponseChanged',
					value: function _handleErrorResponseChanged(e) {
						this.set('errors', this.errors.push(errorResponse));
					}
				}, {
					key: '_onAddByLine',
					value: function _onAddByLine(e) {
						this._onAddByIndex(e.detail.index);
					}
				}, {
					key: '_onAdd',
					value: function _onAdd(e) {
						this.$.dialog.toggleMenu();

						var index = this.lineModels.length - 1;
						this._onAddByIndex(index);
					}
				}, {
					key: '_onAddByIndex',
					value: function _onAddByIndex(index) {
						var currentLineModel = this.lineModels[index];
						var newLineVO = JSON.parse(JSON.stringify(currentLineModel.lineVO));
						newLineVO.record = {};
						newLineVO.record[this.constants.SEGMENT_LABEL_FIELD] = '';
						newLineVO.record[this.constants.START_DATE_FIELD] = null;
						newLineVO.record[this.constants.END_DATE_FIELD] = null;

						var newLineModel = new LineModel(newLineVO, this.groupModel);

						newLineModel.lineVO.record.Id = null;
						newLineModel.lineVO.key = null;
						newLineModel.selected = false;

						this.splice('lineModels', index + 1, 0, newLineModel);
						this.headerSelected = false;
						this.$.segmentGroup.addEventListener("dom-change", function (e) {
							var newRows = this.$.segmentRows.querySelectorAll('#segmentRow');
							if (newRows[newRows.length - 1].model.lineVO.key === null) {
								newRows[newRows.length - 1].$.row.click();
							}
						}.bind(this));
					}
				}, {
					key: '_onDeleteByLine',
					value: function _onDeleteByLine(e) {
						this._onDeleteLineData(e.detail.index);
						this.headerSelected = false;
					}
				}, {
					key: '_onDelete',
					value: function _onDelete() {
						var i = void 0,
						    l = this.lineModels.length;
						for (i = l - 1; i > 0; i--) {
							var lineModel = this.lineModels[i];
							if (lineModel.selected) {
								this._onDeleteLineData(i);
							}
						}
						this.$.dialog.toggleMenu();

						this.headerSelected = false;
					}
				}, {
					key: '_onDeleteLineData',
					value: function _onDeleteLineData(index) {
						var lineModel = this.lineModels[index];
						if (lineModel.lineVO.key != null) {
							this.deletedLineKeys.push(lineModel.lineVO.key);
						}
						this.splice('lineModels', index, 1);
					}
				}, {
					key: '_onSave',
					value: function _onSave() {
						this._resetProperties();
						this.$.dialog.toggleMenu();

						this._validateCustomSegmentLabels();
						this._validateCustomSegmentDates();
						var errors = [];
						if (this.hasInvalidSegmentDates) {
							errors.push(this.customLabels.msg_invalid_custom_segment_dates);
						}

						if (this.hasInvalidSegmentLabels) {
							errors.push(this.customLabels.msg_invalid_custom_segment_labels);
						}

						if (this.hasNonConsecutiveDates) {
							errors.push(this.customLabels.msg_nonsequential_custom_segment_dates);
						}

						if (this.hasOverlappingSegments) {
							errors.push(this.customLabels.msg_overlapping_custom_segment_dates);
						}

						this.set('errors', []);
						this.set('errors', errors);

						if (errors.length == 0) {
							var updateSegmentMap = this._getCustomSegmentUpdates();
							updateSegmentMap.updateCustomSegments = true;
							var model = {
								quoteJSON: JSON.stringify(this.groupModel.quoteModel.quoteVO),
								updateCustomSegments: updateSegmentMap.updateCustomSegments,
								updatedLineKeys: updateSegmentMap.updatedLineKeys,
								deletedLineKeys: this.deletedLineKeys,
								startDates: updateSegmentMap.startDates,
								endDates: updateSegmentMap.endDates,
								segmentLabels: updateSegmentMap.segmentLabels
							};
							this.$.UpdateCustomSegmentsService.model = model;
						}
					}
				}, {
					key: '_onCancel',
					value: function _onCancel() {
						this.errors = undefined;
						this.groupModel = undefined;
						this.deletedLineKeys = [];
						this._resetProperties();
						this.$.dialog.toggle();
					}
				}, {
					key: '_toggleAllCheckBoxes',
					value: function _toggleAllCheckBoxes() {
						if (this.lineModels) {
							var i = void 0,
							    l = this.lineModels.length;

							for (i = l - 1; i > 0; i--) {
								this.set('lineModels.' + i + '.selected', this.headerSelected);
							}
						}
					}
				}, {
					key: 'resetData',
					value: function resetData() {
						this.errors = undefined;
						this.deletedLineKeys = [];
					}
				}, {
					key: '_isMobileViewport',
					value: function _isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: '_buildDialog',
					value: function _buildDialog() {
						this._buildFieldsMD();
						this._toggleAllCheckBoxes();
						this._buildRowData();
						this._buildHeaderActions();
					}
				}, {
					key: '_buildFieldsMD',
					value: function _buildFieldsMD() {
						var quoteLineMD = this.quoteLineMD;
						var fields = [this.constants.SEGMENT_LABEL_FIELD, this.constants.START_DATE_FIELD, this.constants.END_DATE_FIELD];
						var fieldsMD = [];
						for (var i = 0; i < fields.length; i++) {
							fieldsMD.push(quoteLineMD[fields[i]]);
						}
						this.fields = fields;
						this.fieldsMD = fieldsMD;
					}
				}, {
					key: '_buildRowData',
					value: function _buildRowData() {
						var recordKeys = [];
						var fieldLabels = [];
						var fieldLabelMap = {};
						var labelTypeMap = {};
						var itemTypeMap = {};
						var fieldsLength = this.fields.length;
						for (var i = 0; i < fieldsLength; i++) {
							var field = this.fields[i];
							var fieldMD = this.fieldsMD[i];
							var key = fieldMD.name;
							recordKeys.push(key);
							var label = fieldMD.label;
							fieldLabels.push(label);
							fieldLabelMap[key] = fieldMD.label;
							labelTypeMap[fieldMD.label.replace(/\W/g, '')] = fieldMD.type;
							itemTypeMap[key] = fieldMD.type;
						}

						this.headerClassMap = new TableClassBuilder(Object.keys(labelTypeMap), 'Th', labelTypeMap).build();
						this.rowClassMap = new TableClassBuilder(recordKeys, 'Td', itemTypeMap).build();
						this.recordKeys = recordKeys;
						this.fieldLabels = fieldLabels;
						this.fieldLabelMap = fieldLabelMap;
					}
				}, {
					key: '_buildHeaderActions',
					value: function _buildHeaderActions() {
						var rightAction = {
							icon: 'sf-icon-delete',
							position: 'right',
							hidden: false,
							invisible: true
						};
						this.headerActions = [rightAction, rightAction];
					}
				}, {
					key: '_buildRowActions',
					value: function _buildRowActions(index) {
						var actions = [];
						var addAction = {
							icon: 'sb-icon-plus',
							title: this.customLabels.lbl_add_segment,
							position: 'right',
							hidden: false,
							invisible: this.groupModel.quoteModel.isAmendment,
							onTapFunction: function onTapFunction() {
								this.fire('add-tapped', { index: this.index });
							}
						};

						var deleteAction = {
							icon: 'sf-icon-delete',
							title: this.customLabels.lbl_delete_custom_segments,
							position: 'right',
							hidden: false,
							invisible: index == 0 || this.groupModel.quoteModel.isAmendment,
							onTapFunction: function onTapFunction() {
								this.fire('delete-tapped', { index: this.index });
							}
						};
						actions.push(addAction);
						actions.push(deleteAction);

						return actions;
					}
				}, {
					key: '_hideSelection',
					value: function _hideSelection(index) {
						return index === 0 ? { hidden: true, type: 'invisible' } : null;
					}
				}, {
					key: '_updateData',
					value: function _updateData(dataMap) {
						var lineModelsLength = this.lineModels.length;
						for (var i = 0; i < lineModelsLength; i++) {
							var keys = Object.keys(dataMap);
							for (var j = 0; j < keys.length; j++) {
								var key = keys[j];
								var value = dataMap[key];
								var path = 'lineModels.' + i + '.' + key;
								this.set(path, value);
							}
						}
					}
				}, {
					key: '_updateSegmentTable',
					value: function _updateSegmentTable() {
						var dataMap = { 'selected': false };
						this._updateData(dataMap);
					}
				}, {
					key: '_getCustomSegmentUpdates',
					value: function _getCustomSegmentUpdates() {
						var updates = { updatedLineKeys: [], startDates: [], endDates: [], segmentLabels: [] };
						var lineModelsLength = this.lineModels.length;
						for (var i = 0; i < lineModelsLength; i++) {
							var lineVO = this.lineModels[i].lineVO;
							var record = this.lineModels[i].lineVO.record;
							updates.updatedLineKeys.push(lineVO.key);
							updates.segmentLabels.push(record[this.constants.SEGMENT_LABEL_FIELD]);
							updates.startDates.push(record[this.constants.START_DATE_FIELD]);
							updates.endDates.push(record[this.constants.END_DATE_FIELD]);
						}
						return updates;
					}
				}, {
					key: '_validateCustomSegmentLabels',
					value: function _validateCustomSegmentLabels() {
						this.hasInvalidSegmentLabels = false;
						var customSegmentLabels = {};
						var lineModelsLength = this.lineModels.length;
						for (var i = 0; i < lineModelsLength; i++) {
							var segmentLabel = this.lineModels[i].lineVO.record[this.constants.SEGMENT_LABEL_FIELD];
							if (segmentLabel == null || segmentLabel.trim() === '') {
								this.hasInvalidSegmentLabels = true;
								return;
							} else {
								if (!customSegmentLabels[segmentLabel]) {
									customSegmentLabels[segmentLabel] = true;
								} else {
									this.hasInvalidSegmentLabels = true;
									return;
								}
							}
						}
					}
				}, {
					key: '_validateCustomSegmentDates',
					value: function _validateCustomSegmentDates() {
						var lineModelsLength = this.lineModels.length;
						for (var i = 0; i < lineModelsLength; i++) {
							var segment = this.lineModels[i].lineVO;
							var segmentStartDate = segment.record[this.constants.START_DATE_FIELD];
							var segmentEndDate = segment.record[this.constants.END_DATE_FIELD];

							var segStartDate = new Date(segmentStartDate);
							var segEndDate = new Date(segmentEndDate);
							if (segmentStartDate == null || segmentEndDate == null) {
								this.hasInvalidDateFormat = true;
								return;
							} else {
								if (segStartDate > segEndDate) {
									this.hasInvalidSegmentDates = true;
									return;
								}

								if (i - 1 >= 0) {
									var prevSegment = this.lineModels[i - 1].lineVO;
									var endDate = new Date(prevSegment.record[this.constants.END_DATE_FIELD]);
									var dayAfterEndDate = Date.parse(new Date(endDate.getFullYear(), endDate.getMonth(), endDate.getDate() + 1));
									var startDate = Date.parse(new Date(segStartDate.getFullYear(), segStartDate.getMonth(), segStartDate.getDate()));

									if (this.editorModel.data.settings.allowsNonConsecutiveCustomSegments) {
										if (segStartDate <= endDate) {
											this.hasOverlappingSegments = true;
											return;
										}
									} else {
										if (dayAfterEndDate != startDate) {
											this.hasNonConsecutiveDates = true;
											return;
										}
									}
								}
							}
						}
					}
				}, {
					key: '_resetProperties',
					value: function _resetProperties() {
						this.set('errors', []);
						this.headerSelected = false;
						this.hasInvalidSegmentLabels = false;
						this.hasInvalidSegmentDates = false;
						this.hasNonConsecutiveDates = false;
						this.hasOverlappingSegments = false;
						this.hasInvalidDateFormat = false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'sb-cancel-custom-segment': '_onCancel',
							'add-tapped': '_onAddByLine',
							'delete-tapped': '_onDeleteByLine'
						};
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_dataChanged(dataLineModels)', '_lineModelChanged(lineModels)', '_handleCustomSegmentsResponseChanged(updateCustomSegmentsResponse)', '_handleErrorResponseChanged(errorResponse)', '_toggleAllCheckBoxes(headerSelected)'];
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.editorModel.constants;
					}
				}, {
					key: 'quoteLineMD',
					get: function get() {
						return this.editorModel.md.fieldsMap[this.constants.QUOTE_LINE];
					}
				}, {
					key: 'customLabels',
					get: function get() {
						return this.editorModel.data.customLabels;
					}
				}]);

				return CustomSegmentDialog;
			}());

			_export('CustomSegmentDialog', CustomSegmentDialog);

			Polymer(CustomSegmentDialog);
		}
	};
});

'use strict';

System.register('quotes/dialogs/sb-discount-schedule-dialog/DiscountScheduleDialog.js', ['common/layout/tables/TableClassBuilder.js', 'quotes/models/DiscountTierModel.js', 'quotes/models/DiscountTiersValidator.js', 'common/data/cache/Cache.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var TableClassBuilder, DiscountTierModel, DiscountTiersValidator, Cache, PageContainer, _createClass, DiscountScheduleDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_quotesModelsDiscountTierModelJs) {
			DiscountTierModel = _quotesModelsDiscountTierModelJs.DiscountTierModel;
		}, function (_quotesModelsDiscountTiersValidatorJs) {
			DiscountTiersValidator = _quotesModelsDiscountTiersValidatorJs.DiscountTiersValidator;
		}, function (_commonDataCacheCacheJs) {
			Cache = _commonDataCacheCacheJs.Cache;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DiscountScheduleDialog', DiscountScheduleDialog = function () {
				function DiscountScheduleDialog() {
					_classCallCheck(this, DiscountScheduleDialog);
				}

				_createClass(DiscountScheduleDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-discount-schedule-dialog';
						this.properties = {
							discountSchedule: {
								type: Object
							},
							discountUnit: {
								type: String
							},
							lineModel: Object,
							schedule: {
								type: Object,
								notify: true
							},
							error: {
								type: Object,
								notify: true
							},
							model: {
								type: Object,
								value: {}
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: {
								type: Boolean,
								value: false
							},
							dialogTapped: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('sb-cancel-ds', this.onCancel);

						this.addEventListener('data-changed', function (e) {
							if (e.detail && e.detail.path == 'data.' + this.discountUnitField) {
								if (this.discountUnit != e.detail.value) {
									this.discountUnit = e.detail.value;
									this._calculateDiscountAmounts(this.discountTiers);
									this.buildRowData();
								}
							}
						}.bind(this));
						this._handleDialogTap();
						this._handleDialogMouseEvents();
					}
				}, {
					key: '_createErrorHandler',
					value: function _createErrorHandler() {
						if (this.error) {
							this.errors = [this.error.message];
						}
					}
				}, {
					key: '_retrieveSchedule',
					value: function _retrieveSchedule(Id) {
						if (!Id) {
							return;
						}
						this.showSpinner = true;
						this.context = {
							currencyCode: this.editorModel.quoteModel.quoteVO.record.CurrencyIsoCode,
							fieldSetName: 'DiscountScheduleModal'
						};
						this.$.loadDiscountScheduleService.uid = undefined;
						this.$.loadDiscountScheduleService.context = this.context;
						this.$.loadDiscountScheduleService.uid = Id;

						this.$.loadDiscountScheduleService.spinner = false;
					}
				}, {
					key: '_buildDialog',
					value: function _buildDialog() {
						if (!this.schedule) {
							return;
						}
						this._setConstants(this.constants);
						this.discountTiers = undefined;
						this.currencyCode = this.editorModel.quoteModel.quoteVO.record.CurrencyIsoCode;
						this.editable = !this.schedule[this.overrideBehaviorField] ? false : true;
						this.savedTiers = [];
						this.discountSchedule = JSON.parse(JSON.stringify(this.schedule));
						this.data = this.discountSchedule;
						this.discountSchedule[this.discountUnitField] = this.discountSchedule[this.usePriceForAmountField] ? 'Price' : this.discountSchedule[this.discountUnitField];
						this._setDSFields();
						this.showRevertBtn = this.discountSchedule[this.originalScheduleField] ? true : false;
						this.discountUnit = this.discountSchedule[this.usePriceForAmountField] ? 'Price' : this.discountSchedule[this.discountUnitField];
						this.buildRowData();
						var tierModels = this.buildTiers();
						this._calculateDiscountAmounts(tierModels);
						this.buildFieldData();
						this.discountTiers = tierModels;
						this._createActions();
						this._toggleEditableClasses();
						if (this.isMobile) {
							this._buildTabData();
						}
						this.showSpinner = false;
					}
				}, {
					key: '_discountScheduleResponseChanged',
					value: function _discountScheduleResponseChanged() {
						var newScheduleId = this.discountScheduleResponse.Id;
						this.lineModel.lineVO.record[this.discountScheduleField] = newScheduleId;
						if (this.lineModel.lineVO.record[this.segmentKeyField]) {
							var segments = this.lineModel.segments;
							for (var i = 0, l = segments.length; i < l; i++) {
								segments[i].lineVO.record[this.discountScheduleField] = newScheduleId;
							}
						}
						if (this.action === 'save') {
							this.onCancel();
						} else {
							this.schedule = this.discountScheduleResponse;
							this.showRevertBtn = this.discountScheduleResponse[this.originalScheduleField];
						}
						this.domHost.onFlagCalculate();
					}
				}, {
					key: '_discountScheduleChanged',
					value: function _discountScheduleChanged(changedRecord) {
						if (changedRecord.path == 'discountSchedule.' + this.discountUnitField) {
							this.discountUnit = changedRecord.value;
							this._calculateDiscountAmounts(this.discountTiers);
							this.buildRowData();
						}
					}
				}, {
					key: 'buildTiers',
					value: function buildTiers() {
						var tiers = [];
						var discountTierRecords = this._retrieveRecords();
						this.previousLowerBound = undefined;
						discountTierRecords.forEach(function (tier) {
							if (tier[this.lowerBoundField] == null) {
								tiers.push(new DiscountTierModel(tier, this.discountSchedule));
								return;
							}

							if (this.discountUnit == "Percent" && this.previousLowerBound != tier[this.lowerBoundField]) {
								this.previousLowerBound = tier[this.lowerBoundField];
							} else if (this.discountUnit == "Percent" || tier.CurrencyIsoCode != this.currencyCode) {
								return;
							}
							tiers.push(new DiscountTierModel(tier, this.discountSchedule));
						}.bind(this));
						return tiers;
					}
				}, {
					key: 'buildFieldData',
					value: function buildFieldData() {
						if (this.fieldNames) {
							return;
						}
						var fieldsMD = this.editorModel.md.fieldsMap[this.discountScheduleField];
						fieldsMD[this.discountUnitField].required = true;
						this.fieldTableData = fieldsMD;
						this.fieldNames = ['Name', this.discountUnitField];
					}
				}, {
					key: 'buildRowData',
					value: function buildRowData() {
						if (this.fieldsArray) {
							this.fire('iron-signal', { name: 'delete-groups' });
						}
						var fields = this.editorModel.data.discountScheduleModalFieldNames;
						var fieldsMD = this.editorModel.md.fieldsMap[this.tierField];
						var fieldLabels = [];
						var fieldLabelMap = {};
						var labelTypeMap = {};
						var itemTypeMap = {};
						var priceLabel = this.editorModel.data.customLabels.lbl_price;
						var prefixedFieldsByFields = {};
						fields.forEach(function (field) {
							prefixedFieldsByFields[field] = 'template.' + field;
						}.bind(this));
						if (this.discountUnit === 'Price') {
							prefixedFieldsByFields[priceLabel] = 'template.' + priceLabel;
							fieldsMD[priceLabel] = JSON.parse(JSON.stringify(fieldsMD[this.discountAmountField]));
							fieldsMD[priceLabel].label = priceLabel + '(' + (this.currencyCode || this.editorModel.data.currencySymbol) + ')';
							fieldsMD[priceLabel].name = priceLabel;
						}
						this.fieldsArray = Object.keys(prefixedFieldsByFields);
						var prefixedFieldsArray = [];
						this.fieldsArray.forEach(function (field) {
							if (!this._isFieldShown(field)) {
								return;
							}
							var fieldMD = fieldsMD[field];
							var key = fieldMD.name;
							var label;
							if (field === this.numberField) {
								label = '#';
							} else if (field === this.discountAmountField) {
								label = fieldMD.label.replace('{0}', this.currencyCode || this.editorModel.data.currencySymbol);
								fieldMD.label = label;
							} else {
								label = fieldMD.label;
							}
							prefixedFieldsArray.push(prefixedFieldsByFields[field]);
							fieldLabels.push(label);
							fieldLabelMap[key] = fieldMD.label;
							labelTypeMap[fieldMD.label.replace(/\W/g, '')] = fieldMD.type;
							itemTypeMap[prefixedFieldsByFields[field]] = fieldMD.type;
						}.bind(this));
						this.set('model.fieldsMD', fieldsMD);
						if (!this.isMobile) {
							this.set('model.selected', false);
							this.set('model.headerClassMap', new TableClassBuilder(Object.keys(labelTypeMap), 'Th', labelTypeMap).build());
							this.set('model.fieldLabels', fieldLabels);
						}
						this.set('model.rowClassMap', new TableClassBuilder(prefixedFieldsArray, 'Td', itemTypeMap).build());
						this.set('model.fieldLabelMap', fieldLabelMap);
						this.set('model.recordKeys', prefixedFieldsArray);
					}
				}, {
					key: 'onRevert',
					value: function onRevert() {
						this._retrieveSchedule(this.discountSchedule[this.originalScheduleField]);
					}
				}, {
					key: 'onAddLine',
					value: function onAddLine(e) {
						var record = this._createBlankTierRecord();
						var tierModel = new DiscountTierModel(record, this.discountSchedule);
						tierModel.rowActions = this._createRowActions();
						if (e.detail && e.detail.index !== undefined) {
							this.splice('discountTiers', e.detail.index + 1, 0, tierModel);
						} else {
							this.push('discountTiers', tierModel);
						}
						this._renumberLines(this.discountTiers, true);
					}
				}, {
					key: 'onDeleteLines',
					value: function onDeleteLines(e) {
						if (e.detail && e.detail.index) {
							this.splice('discountTiers', e.detail.index, 1);
						} else {
							for (var i = 0, l = this.discountTiers.length; i < l; i++) {
								if (!this.discountTiers[i]) {
									break;
								}
								if (this.discountTiers[i].selected) {
									this.splice('discountTiers', i, 1);
									i--;
								}
							}
							this.set('model.selected', false);
						}
						this._selectCheckboxes(false);
						this._renumberLines(this.discountTiers, true);
					}
				}, {
					key: 'onSave',
					value: function onSave(e) {
						this.errors = undefined;
						this.tiers = this._processForSaving();
						if (!this.tiers) {
							return;
						}
						this.errors = undefined;
						this.action = e.currentTarget.attributes.id.value;
						var model = void 0;

						if (this.discountSchedule[this.userDefinedField] && this.lineModel.lineVO.record.Id === this.discountSchedule[this.quoteLineField]) {
							model = {
								discountScheduleJSON: JSON.stringify(this.discountSchedule),
								tiersJSON: JSON.stringify(this.tiers),
								ignoreValidate: true,
								context: JSON.stringify(this.context)
							};
							this.$.discountScheduleUpdaterService.uid = this.discountSchedule.Id;
							this.$.discountScheduleUpdaterService.model = model;
						} else {
							this.discountSchedule[this.quoteLineField] = this.lineModel.lineVO.record.Id;
							this.discountSchedule[this.userDefinedField] = true;
							this.discountSchedule[this.originalScheduleField] = this.discountSchedule.Id;
							model = {
								discountScheduleJSON: JSON.stringify(this.discountSchedule),
								tiersJSON: JSON.stringify(this.tiers),
								ignoreValidate: true,
								context: JSON.stringify(this.context)
							};
							this.$.discountScheduleClonerService.model = model;
						}
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.fire('iron-signal', { name: 'delete-groups' });
						this.dialogTapped = false;
						this.dialogOverlapping = false;
						this.set('model.fieldsEditable', false);
						this.errors = undefined;
						this.schedule = undefined;
						this.discountSchedule = undefined;
						this.discountTiers = undefined;
						this.discountScheduleId = undefined;
						this.$.dialog.close();
					}
				}, {
					key: '_processForSaving',
					value: function _processForSaving() {
						var hiddenTiers = this._sortTiers(this.savedTiers);
						var visibleTiers = this._sortTiers(this.discountTiers);
						if (!hiddenTiers || !visibleTiers) {
							return null;
						}
						var tierModels = hiddenTiers.concat(visibleTiers);
						this._renumberLines(tierModels, false);
						this.set('discountTiers', visibleTiers);
						this._updateActions();

						this._calculateDiscountAmounts(tierModels);
						this._createTiers(tierModels);
						var validator = new DiscountTiersValidator(this.discountSchedule, this.editorModel);
						var errors = validator.validate(tierModels);
						if (errors.size > 0) {
							this._createError(errors);
							return null;
						}
						var tiers = [];
						tierModels.forEach(function (tierModel) {
							tierModel.tiers.forEach(function (tier) {
								tiers.push(tier);
							}.bind(this));
						}.bind(this));
						this.discountSchedule[this.tiersField].records = tiers;
						this.discountSchedule[this.tiersField].totalSize = tiers.length;
						if (this.discountUnit === "Price") {
							this.discountSchedule[this.discountUnitField] = "amount";
							this.discountSchedule[this.usePriceForAmountField] = true;
						} else {
							this.discountSchedule[this.usePriceForAmountField] = false;
						}
						return tiers;
					}
				}, {
					key: '_setConstants',
					value: function _setConstants(constants) {
						this.discountAmountField = constants.DISCOUNT_AMOUNT_FIELD;
						this.discountScheduleField = constants.DISCOUNT_SCHEDULE_FIELD;
						this.discountRateField = constants.ADDITIONAL_DISCOUNT_RATE_FIELD;
						this.discountUnitField = constants.DISCOUNT_UNIT_FIELD;
						this.lowerBoundField = constants.LOWER_BOUND_FIELD;
						this.numberField = constants.NUMBER_FIELD;
						this.originalScheduleField = constants.ORIGINAL_SCHEDULE_FIELD;
						this.overrideBehaviorField = constants.OVERRIDE_BEHAVIOR_FIELD;
						this.quantityField = constants.QUANTITY_FIELD;
						this.quoteLineField = constants.QUOTE_LINE;
						this.segmentKeyField = constants.SEGMENT_KEY_FIELD;
						this.specialPriceField = constants.SPECIAL_PRICE_FIELD;
						this.tierField = constants.DISCOUNT_TIER_FIELD;
						this.tiersField = constants.DISCOUNT_TIERS_FIELD;
						this.upperBoundField = constants.UPPER_BOUND_FIELD;
						this.usePriceForAmountField = constants.USE_PRICE_FOR_AMOUNT_FIELD;
						this.userDefinedField = constants.USER_DEFINED_FIELD;
					}
				}, {
					key: '_createError',
					value: function _createError(errors) {
						var errorsArray = [];
						for (var i = 0, l = this.discountTiers.length; i < l; i++) {
							var rowNumber = this.discountTiers[i].template[this.numberField];

							if (errors && errors.get(rowNumber)) {
								errorsArray.push(errors.get(rowNumber));
							};
						}

						if (errorsArray.length > 0) {
							this.errors = errorsArray;
						}
					}
				}, {
					key: '_createActions',
					value: function _createActions() {
						if (!this.discountTiers) {
							return;
						}
						var headerActions = [];
						for (var i = 0, l = this.discountTiers.length; i < l; i++) {
							var rowActions = this._createRowActions(i);

							this.set('discountTiers.' + i + '.rowActions', rowActions);
						}

						headerActions.push({ icon: 'sb-icon-plus', position: 'right', hidden: true, invisible: true });
						headerActions.push({ icon: 'sf-icon-delete', position: 'right', hidden: true, invisible: true });
						if (!this.isMobile) {
							this.set('model.headerActions', headerActions);
						}
					}
				}, {
					key: '_createRowActions',
					value: function _createRowActions() {
						var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;

						return [{ icon: 'sb-icon-plus',
							title: 'Add',
							position: 'right',
							invisible: false,
							hidden: false,
							onTapFunction: function onTapFunction() {
								this.fire('add-tapped', { index: this.index });
							}
						}, { icon: 'sf-icon-delete',
							title: 'Delete',
							position: 'right',
							invisible: index == 0,
							hidden: false,
							onTapFunction: function onTapFunction() {
								this.fire('delete-tapped', { index: this.index });
							}
						}];
					}
				}, {
					key: '_retrieveVisibleRecords',
					value: function _retrieveVisibleRecords(tiers) {
						var visibleTiers = [];
						var currentQuantity = this.lineModel.lineVO.record[this.quantityField];
						tiers.forEach(function (tier) {
							var lowerBound = tier[this.lowerBoundField];
							var upperBound = tier[this.upperBoundField];
							var userDefined = this.discountSchedule[this.userDefinedField];

							if (!upperBound) {
								return currentQuantity >= lowerBound || userDefined ? visibleTiers.push(tier) : visibleTiers;
							}

							if (currentQuantity >= lowerBound && currentQuantity >= upperBound) {
								this.savedTiers.push(new DiscountTierModel(tier, this.discountSchedule));
							} else if (lowerBound <= currentQuantity && currentQuantity < upperBound) {
								visibleTiers.push(tier);
							} else if (userDefined && lowerBound > currentQuantity) {
								visibleTiers.push(tier);
							}
						}.bind(this));

						if (visibleTiers.length == 0 && tiers.length > 0) {
							var lastPositionIndex = tiers.length - 1;
							var lowestBound = tiers[0][this.lowerBoundField];
							var highestBound = tiers[lastPositionIndex][this.upperBoundField];
							var record = this._createBlankTierRecord();
							if (currentQuantity < lowestBound) {
								record[this.numberField] = 1;
							} else if (currentQuantity >= highestBound) {
								record[this.numberField] = tiers[lastPositionIndex][this.numberField] + 1;
								record[this.lowerBoundField] = highestBound;
							}
							visibleTiers.push(record);
						}
						return visibleTiers;
					}
				}, {
					key: '_retrieveRecords',
					value: function _retrieveRecords() {
						var records = [];
						if (!this.discountSchedule[this.tiersField]) {
							var record = this._createBlankTierRecord();
							record[this.numberField] = 1;
							records.push(record);
						} else {
							records = this.discountSchedule[this.tiersField].records;
							if (this.discountSchedule[this.overrideBehaviorField] === 'Current Tier Only') {
								records = this._retrieveVisibleRecords(records);

								if (this.savedTiers.length > 0) {
									this.editorModel.disabledDiscountTier = records[0][this.numberField];
								}
							} else {
								this.editorModel.disabledDiscountTier = undefined;
							}
						}
						return records;
					}
				}, {
					key: '_calculateDiscountAmounts',
					value: function _calculateDiscountAmounts(tiers) {
						if (!tiers) {
							return;
						}
						var priceScale = this.editorModel.data.settings.currencyDecimalScale;
						var specialPrice = Number(this.lineModel.lineVO.record[this.specialPriceField]).toFixed(priceScale);
						tiers.forEach(function (tier) {
							var row = tier.template;
							if (this.discountUnit === 'Price') {
								row.Price = !row.Price && row.Price !== 0 ? (specialPrice - Number(row[this.discountAmountField])).toFixed(priceScale) : row.Price;
								row[this.discountAmountField] = (specialPrice - row.Price).toFixed(priceScale);
							} else {
								row[this.discountRateField] = row[this.discountRateField] || 0;
								row[this.discountAmountField] = Number(row[this.discountAmountField] || 0).toFixed(priceScale);
							}

							if (!row[this.constants.UPPER_BOUND_FIELD] && row[this.constants.UPPER_BOUND_FIELD] != 0) {
								row[this.constants.UPPER_BOUND_FIELD] = null;
							}
						}.bind(this));
					}
				}, {
					key: '_renumberLines',
					value: function _renumberLines(tiers, notify) {
						var behavior = this.discountSchedule[this.overrideBehaviorField];

						var number = behavior === 'Current Tier Only' && this.savedTiers.length > 0 ? tiers[0].template[this.numberField] : 1;
						for (var i = 0, l = tiers.length; i < l; i++) {
							if (tiers[i].template[this.numberField] != number) {
								if (notify) {
									this.set('discountTiers.' + i + '.template.' + this.numberField, number);
								} else {
									tiers[i].template[this.numberField] = number;
								}
							}
							number++;
						}
					}
				}, {
					key: '_sortTiers',
					value: function _sortTiers(tiers) {
						var lowerBoundList = [];
						var tiersByLowerBound = {};
						var sortedTiers = [];
						tiers.forEach(function (tier) {
							var lowerBound = tier.template[this.lowerBoundField];
							if (tiersByLowerBound[lowerBound]) {
								this.errors = [this.editorModel.data.customLabels.msg_identical_lower_bounds];
								return null;
							}
							lowerBoundList.push(lowerBound);
							tiersByLowerBound[lowerBound] = tier;
						}.bind(this));
						lowerBoundList.sort(function (a, b) {
							return a - b;
						});
						lowerBoundList.forEach(function (lowerBound) {
							var tier = tiersByLowerBound[lowerBound];
							sortedTiers.push(tier);
						}.bind(this));
						return sortedTiers;
					}
				}, {
					key: '_createTiers',
					value: function _createTiers(tiers) {
						var isoCodes = this.editorModel.data.settings.currencyIsoCodes;

						tiers.forEach(function (row) {
							row.tiers = [];
							if (!isoCodes) {
								row.tiers.push(row.template);
								return;
							}
							isoCodes.forEach(function (isoCode) {
								if (isoCode == this.currencyCode) {
									row.template.CurrencyIsoCode = isoCode;
									row.tiers.push(row.template);
									return;
								} else if (this.discountUnit === 'Percent') {
									return;
								}
								row.tiers.push(this._createMultiCurrencyRecord(row.template, isoCode));
							}.bind(this));
						}.bind(this));
					}
				}, {
					key: '_selectCheckboxes',
					value: function _selectCheckboxes(selected) {
						if (!this.discountTiers) {
							return;
						}
						for (var i = 1, l = this.discountTiers.length; i < l; i++) {
							if (this.discountTiers[i]) {
								this.set('discountTiers.' + i + '.selected', selected);
							}
						}
					}
				}, {
					key: '_createMultiCurrencyRecord',
					value: function _createMultiCurrencyRecord(tier, isoCode) {
						var priceScale = this.editorModel.data.settings.currencyDecimalScale;
						var record = JSON.parse(JSON.stringify(tier));
						record['CurrencyIsoCode'] = isoCode;
						record[this.discountAmountField] = 0 .toFixed(priceScale);
						record[this.discountRateField] = Number(record[this.discountRateField] || 0).toFixed(priceScale);

						delete record.Price;
						return record;
					}
				}, {
					key: '_createBlankTierRecord',
					value: function _createBlankTierRecord() {
						var record = {};
						var priceScale = this.editorModel.data.settings.currencyDecimalScale;
						this.fieldsArray.forEach(function (fieldName) {
							record[fieldName] = null;
							record['CurrencyIsoCode'] = this.currencyCode;
							record[this.discountAmountField] = 0 .toFixed(priceScale);
							record[this.discountRateField] = 0 .toFixed(priceScale);
						}.bind(this));
						return record;
					}
				}, {
					key: '_handleIconAction',
					value: function _handleIconAction(e) {
						var event = e.detail.event;
						var type = event.type;
						var model = e.detail.model;
						this.lineModel = this.editorModel.quoteModel.lineModelsByKey[model.serviceModel.keys[0]];
						this.discountScheduleId = model.serviceModel.scheduleId;
						switch (type) {
							case 'mouseenter':
								if (!this.isMobile && !this.dialogTapped) {
									this._toggleDialogClasses(true);
									this.$.dialog.open();
								}
								break;
							case 'mouseleave':
								this.debounce('closeDialog', function () {
									if (!this.isMobile && !this.dialogTapped && !this.dialogOverlapping) {
										this.onCancel();
									}
								}.bind(this), 1);
								break;
							case 'tap':
								this._openDialog();
								break;
						}
					}
				}, {
					key: '_openDialog',
					value: function _openDialog() {
						if (this.dialogTapped) {
							return;
						}
						this.dialogTapped = true;
						this.$.dialog.open();
						this._toggleDialogClasses(false);
					}
				}, {
					key: '_toggleDialogClasses',
					value: function _toggleDialogClasses(applyClasses) {
						var dialog = Polymer.dom(this.$.dialog.root);
						var sbDialog = dialog.querySelector('.sbDialog');
						this.toggleClass('boxShadow', applyClasses, sbDialog);
						this.toggleClass('noMarginBottom', applyClasses, dialog.querySelector('#content'));
					}
				}, {
					key: '_handleDialogTap',
					value: function _handleDialogTap() {
						this.addEventListener('sb-tap-ds', function () {
							if (this.isMobile || !this.dialogOverlapping) {
								return;
							}
							this._openDialog();
						}.bind(this));
					}
				}, {
					key: '_handleDialogMouseEvents',
					value: function _handleDialogMouseEvents() {
						if (this.isMobile) {
							return;
						}
						var dialog = Polymer.dom(this.$.dialog.root).querySelector('.sbDialog');
						dialog.addEventListener('mouseenter', function () {
							if (this.dialogTapped) {
								return;
							}
							this.dialogOverlapping = true;
						}.bind(this));

						dialog.addEventListener('mouseleave', function () {
							if (this.dialogTapped || !this.dialogOverlapping) {
								return;
							}
							this.onCancel();
						}.bind(this));
					}
				}, {
					key: '_toggleEditableClasses',
					value: function _toggleEditableClasses() {
						this.set('model.fieldsEditable', this.editable && this.dialogTapped);
						if (!this.discountTiers) {
							return;
						}
						this._setDisabled();
						this._updateActions();
					}
				}, {
					key: '_updateActions',
					value: function _updateActions() {
						for (var i = 0, l = this.discountTiers.length; i < l; i++) {
							var rowActions = this.discountTiers[i].rowActions;
							if (!rowActions) {
								continue;
							}
							for (var j = 0, k = rowActions.length; j < k; j++) {
								var invisible = i == 0 && rowActions[j].icon == 'sf-icon-delete';
								this.set('discountTiers.' + i + '.rowActions.' + j + '.hidden', !this.model.fieldsEditable);
								this.set('discountTiers.' + i + '.rowActions.' + j + '.invisible', invisible);
							}
						}
						if (!this.isMobile && this.model.headerActions) {
							for (var m = 0, n = this.model.headerActions.length; m < n; m++) {
								this.set('model.headerActions.' + m + '.hidden', !this.model.fieldsEditable);
							}
						}
					}
				}, {
					key: '_setDisabled',
					value: function _setDisabled() {
						for (var i = 0, l = this.discountTiers.length; i < l; i++) {
							this.set('discountTiers.' + i + '.disabled', !this.model.fieldsEditable);
						}
					}
				}, {
					key: '_setDSFields',
					value: function _setDSFields() {
						var quote = this.editorModel.quoteModel.quoteVO;
						this.discountSchedule[this.constants.QUOTE] = quote.record.Id;
						var accountId = void 0;
						if (quote.record[this.constants.ACCOUNT_FIELD]) {
							accountId = quote.record[this.constants.ACCOUNT_FIELD].Id;
						} else if (quote.record[this.constants.OPPORTUNITY_FIELD]) {
							accountId = quote.record[this.constants.OPPORTUNITY_FIELD].AccountId;
						}
						this.discountSchedule[this.constants.ACCOUNT_ID_FIELD] = accountId;
					}
				}, {
					key: '_isFieldShown',
					value: function _isFieldShown(field) {
						if (this.discountUnit === 'Percent' && field === this.discountAmountField) {
							return false;
						} else if (this.discountUnit === 'Amount' && field === this.discountRateField) {
							return false;
						} else if (this.discountUnit === 'Price' && (field === this.discountRateField || field === this.discountAmountField)) {
							return false;
						}
						return true;
					}
				}, {
					key: '_buildTabData',
					value: function _buildTabData() {
						var tabs = [],
						    labels = ['Details', 'Tiers'];

						if (this.tabs === tabs) {
							return;
						}

						for (var i = 0, len = labels.length; i < len; i++) {
							var label = labels[i];
							var tId = "t" + i;
							var bind = void 0;
							var pageComponent = void 0;
							if (label === 'Details') {
								bind = ['data', 'fieldNames', 'md', 'numColumns', 'disabled'];
								pageComponent = 'sb-field-table';
							} else if (label === 'Tiers') {
								bind = ['discountTiers', 'model', 'editorModel'];
								pageComponent = 'sb-ds-tiers';
							}
							tabs.push({ name: tId, label: label, bind: bind, pageComponent: pageComponent });
						}
						this.tabs = tabs;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged() {
						this.isMobile = this.viewport && this.viewport.isMobile() ? true : false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_retrieveSchedule(discountScheduleId)', '_buildDialog(schedule)', '_discountScheduleResponseChanged(discountScheduleResponse)', '_discountScheduleChanged(discountSchedule.*)', '_createErrorHandler(error)', '_toggleEditableClasses(dialogTapped)', '_selectCheckboxes(model.selected)'];
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.editorModel.constants;
					}
				}, {
					key: 'listeners',
					get: function get() {
						return { 'delete-tapped': 'onDeleteLines',
							'add-tapped': 'onAddLine' };
					}
				}]);

				return DiscountScheduleDialog;
			}());

			_export('DiscountScheduleDialog', DiscountScheduleDialog);

			Polymer(DiscountScheduleDialog);
		}
	};
});

'use strict';

System.register('quotes/dialogs/sb-favorite-dialog/FavoriteDialog.js', [], function (_export, _context) {
	var _createClass, FavoriteDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FavoriteDialog', FavoriteDialog = function () {
				function FavoriteDialog() {
					_classCallCheck(this, FavoriteDialog);
				}

				_createClass(FavoriteDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-favorite-dialog';
						this.properties = {
							favName: String
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('sb-cancel-fav', this.onCancel);
					}
				}, {
					key: 'onSave',
					value: function onSave() {
						if (this.favName == "" || this.favName === undefined) {
							this.errors = ['Favorite name cannot be left blank.'];
							return;
						}
						var favoriteKeys = [];
						if (this.favoritedGroup) {
							var numGroupLines = this.groupLines.length;
							for (var i = 0; i < numGroupLines; i++) {
								if (!this.groupLines[i].component) {
									favoriteKeys.push(this.groupLines[i].lineVO.key);
								}
							}
						} else {
							favoriteKeys.push(this.favoritedLine[0]);
						}

						this.fire('sb-favorite-saved', { keys: favoriteKeys, name: this.favName, groupKey: this.favoritedGroup });
						this.favoritedGroup = this.favoritedLine = this.groupLines = null;
						this.favName = "";
						this.$.dialog.toggle();
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.favoritedGroup = this.favoritedLine = this.groupLines = null;
						this.favName = "";
						this.$.dialog.toggle();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return FavoriteDialog;
			}());

			_export('FavoriteDialog', FavoriteDialog);

			Polymer(FavoriteDialog);
		}
	};
});

'use strict';

System.register('quotes/dialogs/sb-pricebook-dialog/PricebookDialog.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, PricebookDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('PricebookDialog', PricebookDialog = function () {
				function PricebookDialog() {
					_classCallCheck(this, PricebookDialog);
				}

				_createClass(PricebookDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-pricebook-dialog';
						this.properties = {
							pricebooks: Array,
							selectedPricebook: String
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.select.addEventListener('change', function (e) {
							this.selectedPricebook = e.detail.value;
						}.bind(this));
						this.$.dialog.addEventListener('sb-close-dialog', this.onCancel.bind(this));
					}
				}, {
					key: 'open',
					value: function open() {
						this.$.pricebookLoaderService.addEventListener('response-changed', function (e) {
							var pricebooks = [],
							    results = e.detail.value,
							    numResults = results.length;

							for (var i = 0; i < numResults; i++) {
								pricebooks.push({ value: results[i].Id, label: results[i].Name, selected: false });
							}

							pricebooks[0].selected = true;
							this.selectedPricebook = pricebooks[0].value;

							this.$.select.value = this.selectedPricebook;
							this.$.select.isRequired = true;
							this.pricebooks = pricebooks;

							this.$.dialog.toggle();
						}.bind(this));

						this.$.pricebookLoaderService.uid = '';
						this.$.pricebookLoaderService.context = '';
					}
				}, {
					key: 'onSave',
					value: function onSave() {
						this.$.pricebookSaverService.addEventListener('response-changed', function (e) {
							this.fire('pricebook-saved', e.detail.value);
						}.bind(this));

						this.editorModel.quoteModel.quoteVO.record[this.editorModel.constants.PRICEBOOK_ID_FIELD] = this.selectedPricebook;
						this.$.pricebookSaverService.model = new DataBuilder().add('targetId', this.selectedPricebook).addQuote('quoteJSON', this.editorModel.quoteModel.quoteVO).build();

						this.$.dialog.toggle();
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.fire('le-action-tapped', {
							customAction: { eventHandlerName: 'onCancel' }
						});
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return PricebookDialog;
			}());

			_export('PricebookDialog', PricebookDialog);

			Polymer(PricebookDialog);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-cse-table-cell/CSETableCell.js', ['quotes/models/Constants.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var Constants, PageContainer, _createClass, CSETableCell;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsConstantsJs) {
			Constants = _quotesModelsConstantsJs.Constants;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('CSETableCell', CSETableCell = function () {
				function CSETableCell() {
					_classCallCheck(this, CSETableCell);
				}

				_createClass(CSETableCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-cse-table-cell';
						this.properties = {
							item: String,
							disabled: Boolean,
							hidden: Boolean,
							value: {
								notify: true
							},
							data: {
								type: Object,
								value: null
							},
							model: {
								type: Object,
								value: null
							},
							render: {
								type: Boolean,
								value: false
							},
							index: Number,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'buildCell',
					value: function buildCell() {
						var tableCols = [this.constants.SEGMENT_LABEL_FIELD, this.constants.START_DATE_FIELD, this.constants.END_DATE_FIELD];
						var quoteLineFieldsMD = this.model.groupModel.editorModel.md.fieldsMap[this.constants.QUOTE_LINE];
						var fieldsMD = [];

						for (var i = 0; i < tableCols.length; i++) {
							var fieldMD = quoteLineFieldsMD[tableCols[i]];
							fieldsMD[tableCols[i]] = fieldMD;
						}

						this.editing = true;

						if (this.viewport && this.viewport.isMobile()) {
							this.render = true;
							if (this.index === 0) {
								this.editing = false;
							}
						}

						this.disabled = false;
						this.md = fieldsMD[this.item];
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildCell(item, value, model, data)'];
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.model.groupModel.editorModel.constants;
					}
				}]);

				return CSETableCell;
			}());

			_export('CSETableCell', CSETableCell);

			Polymer(CSETableCell);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-custom-action/CustomAction.js', ['common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js'], function (_export, _context) {
	var PageContainer, AppContext, _createClass, CustomAction;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('CustomAction', CustomAction = function () {
				function CustomAction() {
					_classCallCheck(this, CustomAction);
				}

				_createClass(CustomAction, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-custom-action';
						this.properties = {
							customAction: Object,
							model: Object,
							actionHidden: Boolean,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							label: String
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						if (this.customAction && this.customAction.isSeparator) {
							this.button = false;
							this.span = true;
						}

						this.addEventListener('paper-dropdown-close', function (e) {
							if (this.$$('#menuButton')) this.$$('#menuButton').close();
						});

						if (!this.horizontalAlign) {
							this.horizontalAlign = this.span ? "left" : "right";
						}
						this.horizontalOffset = this.span ? 18 : 0;
						this.verticalOffset = this.span ? -30 : 0;
					}
				}, {
					key: 'triggerCustomAction',
					value: function triggerCustomAction(e) {
						if (this.customAction.eventHandlerName === "showDSModal") {
							if (this.classList.contains('swipe-menu-item') && e.type !== 'tap') {
								return;
							}

							this.fire('iron-signal', { name: 'schedule-action', data: { event: e, model: this.model } });
							return;
						} else if (e.type !== 'tap') {
							return;
						}

						this.fire('le-action-tapped', {
							customAction: this.customAction,
							model: this.model
						});
						this.fire('paper-dropdown-close');
					}
				}, {
					key: '_toggleQuoteButton',
					value: function _toggleQuoteButton() {
						this._toggleButton();
					}
				}, {
					key: '_toggleLineButton',
					value: function _toggleLineButton() {
						this._toggleButton();
					}
				}, {
					key: '_toggleButton',
					value: function _toggleButton() {
						this.showAction = !this.customAction.isHidden(this.model);
						this.hasMenu = !this.button && !this.span || this.customAction.hasMenu && !(this.viewport && (this.viewport.isMobile() || this.viewport.S.down));
						this.menuButton = this.hasMenu && !this.span;

						if (this.viewport && this.viewport.isMobile() && !this.model.favorite && this.customAction.caClass === 'removeFromFavBtn' && this.style.transform) {
							var container = this.parentElement.parentElement;
							container._initSwipeMenu(this.parentElement);
						}

						this._setButtonClassAndLabel();
					}
				}, {
					key: '_setButtonClassAndLabel',
					value: function _setButtonClassAndLabel() {
						this.label = (!this.customAction.icon || this.viewport && (this.viewport.isMobile() || this.viewport.S.down)) && this.customAction.renderLocation !== 'Line' ? this.customAction.label : null;
						this.buttonClass = (this.groupAction ? 'groupButton ' : '') + (this.customAction.icon && !this.label ? this.customAction.icon : '') + (this.customAction.first ? '' : ' notFirst') + (this.customAction.last && !this.hasMenu ? '' : ' notLast') + (this.customAction.primary ? ' primary' : '');
						if (!this.button && this.groupAction) {
							this.menuClass = 'mobileGroupMenu';
						} else {
							this.menuClass = (this.groupAction ? 'groupMenu ' : '') + (this.customAction.last ? '' : 'notLast');
						}

						if (this.viewport && this.viewport.isMobile() && this.model.favorite && this.customAction.caClass === 'removeFromFavBtn' && this.parentElement) {
							Polymer.dom(this.parentElement).flush();
							var container = this.parentElement.parentElement;
							container._initSwipeMenu(this.parentElement);
						}
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
						this._setButtonClassAndLabel();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_toggleQuoteButton(model.grouped, model.allOptional)', '_toggleLineButton(model.favorite)'];
					}
				}]);

				return CustomAction;
			}());

			_export('CustomAction', CustomAction);

			Polymer(CustomAction);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-ds-table-cell/DSTableCell.js', ['quotes/models/Constants.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var Constants, PageContainer, _createClass, DSTableCell;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsConstantsJs) {
			Constants = _quotesModelsConstantsJs.Constants;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DSTableCell', DSTableCell = function () {
				function DSTableCell() {
					_classCallCheck(this, DSTableCell);
				}

				_createClass(DSTableCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-ds-table-cell';
						this.properties = {
							item: String,
							disabled: Boolean,
							hidden: Boolean,
							value: {
								notify: true
							},
							data: {
								type: Object,
								value: null
							},
							model: {
								type: Object,
								value: null
							},
							index: Number,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'buildCell',
					value: function buildCell() {
						var fieldsMD = this.model.md.fieldsMap[this.constants.DISCOUNT_TIER_FIELD];
						var field = this.item.replace('template.', '');
						if (this.value === undefined) {
							this.value = '';
						}
						this.handleOriginalValues();
						this.editing = this.isEditable(field, fieldsMD);
						this.md = fieldsMD[field];
					}
				}, {
					key: 'isEditable',
					value: function isEditable(field, fieldsMD) {
						if (field === this.constants.NUMBER_FIELD) return false;

						if (field === this.constants.LOWER_BOUND_FIELD && this.data.template[this.constants.NUMBER_FIELD] === this.model.disabledDiscountTier) return false;

						if (this.index === 0 && this.viewport && this.viewport.isMobile()) return false;

						return fieldsMD[field].updateable;
					}
				}, {
					key: 'handleOriginalValues',
					value: function handleOriginalValues() {
						if (!this.data.original && this.data.template) {
							this.data.original = {};
							this.data.original.template = JSON.parse(JSON.stringify(this.data.template));
						}
						if (this.data.original) this.$.field.originalValue = this.get('data.original.' + this.item);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildCell(item, model, data, index, viewport)'];
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.model.constants;
					}
				}]);

				return DSTableCell;
			}());

			_export('DSTableCell', DSTableCell);

			Polymer(DSTableCell);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-ds-tiers/DSTiers.js', [], function (_export, _context) {
	var _createClass, DSTiers;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DSTiers', DSTiers = function () {
				function DSTiers() {
					_classCallCheck(this, DSTiers);
				}

				_createClass(DSTiers, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-ds-tiers';
						this.properties = {
							discountTiers: {
								type: Array,
								notify: true
							},
							model: {
								type: Object,
								notify: true
							}
						};
					}
				}, {
					key: '_hideSelection',
					value: function _hideSelection(index) {
						return index === 0 && this.model.fieldsEditable ? { hidden: true, type: 'invisible' } : null;
					}
				}, {
					key: '_deleteGroups',
					value: function _deleteGroups() {
						this.$.header.$.header.destroyGroup();
						var rows = Polymer.dom(this.$.tbody).querySelectorAll('sb-table-row');
						rows.forEach(function (row) {
							row.cols = undefined;
							row.$.row.destroyGroup();
						}.bind(this));
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return DSTiers;
			}());

			_export('DSTiers', DSTiers);

			Polymer(DSTiers);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-field-set-table/FieldSetTable.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, FieldSetTable;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldSetTable', FieldSetTable = function () {
				function FieldSetTable() {
					_classCallCheck(this, FieldSetTable);
				}

				_createClass(FieldSetTable, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-field-set-table';
						this.properties = {
							editorModel: Object,
							data: {
								type: Object,
								notify: true
							},
							numColumns: {
								type: Number,
								value: 1
							},
							objectName: String,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'generateColumns',
					value: function generateColumns() {
						this.isMobile = this.viewport && this.viewport.isMobile();

						var fieldsObject = {};
						var fieldsArray = [];
						var fieldNames = [];
						var numFields = void 0;
						var column1Group = [],
						    column2Group = [],
						    column3Group = [];
						if (this.objectName == this.editorModel.constants.QUOTE_LINE_GROUP) {
							var groupFieldNames = this.editorModel.fieldsetMap.groupFieldNames.slice();

							for (var i = 0, l = groupFieldNames.length; i < l; i++) {
								if (!this.isMobile && (this.editorModel.constants.DESCRIPTION_FIELD == groupFieldNames[i] || 'Name' == groupFieldNames[i])) {
									groupFieldNames.splice(i, 1);
									i--;
								}
							}
							fieldNames = groupFieldNames;
							numFields = groupFieldNames.length;
						} else if (this.objectName == this.editorModel.data.quoteObjectName) {
							fieldNames = this.editorModel.fieldsetMap.quoteFieldNames;
							numFields = this.editorModel.fieldsetMap.quoteFieldNames.length;
						}
						fieldsObject = this.editorModel.md.fieldsMap[this.objectName];
						for (var _i = 0; _i < numFields; _i++) {
							fieldsArray.push(fieldsObject[fieldNames[_i]]);
							if (_i % this.numColumns == 0) {
								column1Group.push(fieldNames[_i]);
							} else if (_i % this.numColumns == 1) {
								column2Group.push(fieldNames[_i]);
							} else {
								column3Group.push(fieldNames[_i]);
							}
						}

						if (this.numColumns == 1) this.columnOneWidth = 'td1';else if (this.numColumns == 2) {
							this.columnOneWidth = 'td2';
							this.columnTwoWidth = 'td2';
						} else {
							this.columnOneWidth = 'td3';
							this.columnTwoWidth = 'td3';
							this.columnThreeWidth = 'td3';
						}

						this.md = fieldsArray;
						this.setColumns(column1Group, column2Group, column3Group);
					}
				}, {
					key: 'setColumns',
					value: function setColumns(column1Group, column2Group, column3Group) {
						if (column1Group.length > 0) {
							this.$.firstColumn.model = this.md;
							if (!this.$.firstColumn.group) this.$.firstColumn.group = column1Group;
						}
						if (column2Group.length > 0) {
							this.$.secondColumn.model = this.md;
							if (!this.$.secondColumn.group) this.$.secondColumn.group = column2Group;
						}
						if (column3Group.length > 0) {
							this.$.thirdColumn.model = this.md;
							if (!this.$.thirdColumn.group) this.$.thirdColumn.group = column3Group;
						}
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['generateColumns(editorModel, objectName, viewport)'];
					}
				}]);

				return FieldSetTable;
			}());

			_export('FieldSetTable', FieldSetTable);

			Polymer(FieldSetTable);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-field-set-table-item/FieldSetTableItem.js', ['common/core/sb-page-container/PageContainer.js', 'common/relationship/RelationshipFieldManager.js', 'common/core/AppContext.js'], function (_export, _context) {
	var PageContainer, RelationshipFieldManager, AppContext, _createClass, FieldSetTableItem;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldSetTableItem', FieldSetTableItem = function () {
				function FieldSetTableItem() {
					_classCallCheck(this, FieldSetTableItem);
				}

				_createClass(FieldSetTableItem, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-field-set-table-item';
						this.properties = {
							value: {
								notify: true,
								observer: '_valueChanged'
							},

							item: String,

							model: Object,

							md: Object,
							data: Object,
							display: String,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							calculateImmediately: {
								type: Object,
								value: function value() {
									return AppContext.org.calculateImmediately;
								}
							}
						};
					}
				}, {
					key: '_datePickerOpened',
					value: function _datePickerOpened(e) {
						var dateContainer = e.detail.dateContainer,
						    dateInput = Polymer.dom(dateContainer).querySelector('input'),
						    datepicker = e.detail.datepicker,
						    datepickerHeight = e.detail.datepicker.offsetHeight,
						    datepickerWidth = e.detail.datepicker.offsetWidth,
						    windowHeight = window.innerHeight,
						    windowWidth = window.innerWidth,
						    dateContainerBoundingClientRect = dateContainer.getBoundingClientRect(),
						    distanceFromBottom = windowHeight - dateContainerBoundingClientRect.bottom - datepickerHeight,
						    distanceFromRight = windowWidth - dateContainerBoundingClientRect.left - datepickerWidth;

						datepicker.style.position = 'fixed';

						if (distanceFromRight < 0) {
							datepicker.style.left = dateInput.getBoundingClientRect().right - datepickerWidth + 'px';
						} else {
							datepicker.style.left = dateContainerBoundingClientRect.left + 'px';
						}

						if (distanceFromBottom < 0) {
							datepicker.style.top = dateContainerBoundingClientRect.top - datepickerHeight + 'px';
						} else {
							datepicker.style.top = dateContainerBoundingClientRect.bottom + 'px';
						}
					}
				}, {
					key: '_setFieldData',
					value: function _setFieldData() {
						var numFields = this.model.length;
						for (var i = 0; i < numFields; i++) {
							if (this.model[i].name === this.item) this.md = this.model[i];
						}
						this.isMobile = this.viewport && this.viewport.isMobile();

						this.label = this.value == null && this.md.extraTypeInfo === 'richtextarea' && this.isMobile ? null : this.md.label;

						this.helpText = this.md.inlineHelpText;

						if (this.data.CurrencyIsoCode) {
							this.md['CurrencyIsoCode'] = this.data.CurrencyIsoCode;
						}

						this.$.field.editing = this.md.updateable ? true : false;
						this.$.field.md = this.md;
						this.$.field.property = this.item;
						var obj = {};
						obj[this.item] = this.value;
						this.$.field.obj = obj;
					}
				}, {
					key: '_valueChanged',
					value: function _valueChanged() {
						this._updateLookupDisplayValue();
						this.$.field.value = this.value;
					}
				}, {
					key: '_updateLookupDisplayValue',
					value: function _updateLookupDisplayValue() {
						if (!this.data) {
							return;
						}
						var rfm = new RelationshipFieldManager(this.item, this.data);
						if (rfm.hasRelationship()) this.display = rfm.getRelationshipName();
					}
				}, {
					key: '_handleFieldValueChanged',
					value: function _handleFieldValueChanged() {
						if (this.calculateImmediately) {
							this.fire('calculate-immediately');
						}
					}
				}, {
					key: '_displayChanged',
					value: function _displayChanged() {
						var rfm = new RelationshipFieldManager(this.item, this.data);
						rfm.addRelationshipName(this.value, this.display, this.md.referenceTo[0]);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'datepicker-opened': '_datePickerOpened',
							'sb-field-on-change-field': '_handleFieldValueChanged'
						};
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_setFieldData(item, model, data)', '_displayChanged(value, display, item, data, md)'];
					}
				}]);

				return FieldSetTableItem;
			}());

			_export('FieldSetTableItem', FieldSetTableItem);

			Polymer(FieldSetTableItem);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-footer/LEFooter.js', [], function (_export, _context) {
	var _createClass, LEFooter;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LEFooter', LEFooter = function () {
				function LEFooter() {
					_classCallCheck(this, LEFooter);
				}

				_createClass(LEFooter, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-footer';
						this.properties = {
							quoteModel: Object,
							quoteTotal: {
								type: Number
							},
							quoteTotalMd: Object,
							editorModel: {
								type: Object
							}
						};
					}
				}, {
					key: 'colWidthsChanged',
					value: function colWidthsChanged() {
						this._setTotalWidth();
					}
				}, {
					key: '_setTotalWidth',
					value: function _setTotalWidth() {
						if (!this.quoteModel.editorModel.layout || this.quoteModel.editorModel.deviceContext.isMobile) {
							return;
						}
						this.totalWidth = this.quoteModel.editorModel.layout.totalWidth + 'px';
					}
				}, {
					key: '_showQuoteTotal',
					value: function _showQuoteTotal() {
						this.grouped = this.quoteModel.grouped ? 'grouped' : '';

						if (this.settings.lineEditorTotalsField != 'doNotDisplay' && this.quoteVO.lineItems && this.quoteVO.lineItems.length > 0) {
							this._setQuoteTotal();
							this.showQuoteTotal = true;
						} else {
							this.showQuoteTotal = false;
						}
					}
				}, {
					key: '_setQuoteTotal',
					value: function _setQuoteTotal() {
						var total = void 0,
						    priceScale = void 0,
						    constants = this.quoteModel.editorModel.constants,
						    totalsField = this.settings.lineEditorTotalsField;
						if (!totalsField || totalsField == 'Default') {
							if (this.settings.isMultiCurrencyOrg) {
								priceScale = this.settings.currencyDecimalScale;
							} else {
								if (this.quoteVO.applyAdditionalDiscountLast) {
									priceScale = this.quoteFields[constants.CUSTOMER_AMOUNT_FIELD].scale;
								} else {
									priceScale = this.quoteFields[constants.NET_AMOUNT_FIELD].scale;
								}
							}
							total = this.quoteVO.applyAdditionalDiscountLast ? this.quoteVO.customerTotal : this.quoteVO.netTotal;
						} else {
							priceScale = this.settings.isMultiCurrencyOrg ? this.settings.currencyDecimalScale : this.quoteFields[totalsField].scale;
							total = this.quoteVO.record[totalsField] || 0;
						}
						if (!this.quoteTotalMd) {
							this.quoteTotalMd = { type: "currency", scale: priceScale, CurrencyIsoCode: this.quoteVO.record.CurrencyIsoCode };
						}
						this.quoteTotal = total.toFixed(priceScale);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_showQuoteTotal(quoteModel.quoteVO.*)', '_setTotalWidth(quoteModel.editorModel.layout)'];
					}
				}, {
					key: 'settings',
					get: function get() {
						return this.quoteModel.editorModel.data.settings;
					}
				}, {
					key: 'quoteFields',
					get: function get() {
						return this.quoteModel.editorModel.md.fieldsMap[this.settings.developerPrefix + 'Quote__c'];
					}
				}, {
					key: 'quoteVO',
					get: function get() {
						return this.quoteModel.quoteVO;
					}
				}]);

				return LEFooter;
			}());

			_export('LEFooter', LEFooter);

			Polymer(LEFooter);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-group/LEGroup.js', ['../../../common/core/Navigator.js', 'common/core/sb-page-container/PageContainer.js', 'quotes/models/DragDropModel.js'], function (_export, _context) {
	var Navigator, PageContainer, DragDropModel, _createClass, GHOST_X_OFFSET, GHOST_Y_OFFSET, LEGroup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreNavigatorJs) {
			Navigator = _commonCoreNavigatorJs.Navigator;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_quotesModelsDragDropModelJs) {
			DragDropModel = _quotesModelsDragDropModelJs.DragDropModel;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			GHOST_X_OFFSET = 8;
			GHOST_Y_OFFSET = 150;

			_export('LEGroup', LEGroup = function () {
				function LEGroup() {
					_classCallCheck(this, LEGroup);
				}

				_createClass(LEGroup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-group';
						this.properties = {
							groupModel: {
								type: Object,
								notify: true,
								observer: '_groupModelChanged'
							},
							groupClass: {
								type: String
							},
							subtotal: Number,
							subtotalMd: Object,

							value: {
								notify: true,
								observer: '_descriptionChanged'
							},
							descriptionMd: Object,
							groupLevelTabs: {
								type: Array,
								value: []
							},
							isMobile: {
								type: Boolean,
								value: false
							},
							editorModel: {
								type: Object,
								notify: true
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							favorited: Boolean
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.groupExpanded = false;
						this.showSpinner = false;
					}
				}, {
					key: '_createDragDropModel',
					value: function _createDragDropModel() {
						var validTargets = new Set(['sb-droppable-mdqRows', 'sb-droppable-emptyTable', 'sb-droppable-emptyMDQTable', 'sb-droppable-emptyMDQSegmentTab', 'sb-droppable-sidePanelGroups']);
						this.dragDrop = new DragDropModel(this, this.editorModel.data.settings.bundleKeptTogether, 'sb-le-table-row', validTargets, this.dragFunc.bind(this), this.trackFunc.bind(this), this.dropFunc.bind(this), GHOST_X_OFFSET, GHOST_Y_OFFSET);
					}
				}, {
					key: '_groupModelChanged',
					value: function _groupModelChanged() {
						this.editorModel = this.groupModel.quoteModel.editorModel;
						this._updateTableProperties();
						this._updatePageData();
						this._setIsButton();
						this.isMobile = this.viewport ? this.viewport.isMobile() : false;
						if (this.isMobile) {
							this.set('groupModel.groupExpanded', this.groupExpanded);
							this.buildGroupTabs();
						}

						if (this.viewport && !this.viewport.isMobile()) {
							this.set('groupModel.groupExpanded', true);
							this._setTotalWidth();
						}
					}
				}, {
					key: '_setIsButton',
					value: function _setIsButton() {
						this.isButton = this.viewport ? this.viewport.isDesktop() && this.viewport.M.up : true;
					}
				}, {
					key: '_setTotalWidth',
					value: function _setTotalWidth() {
						if (!this.editorModel.layout || this.editorModel.deviceContext.isMobile) {
							return;
						}
						this.totalWidth = this.editorModel.layout.totalWidth + 2 + 'px';
					}
				}, {
					key: 'colWidthsChanged',
					value: function colWidthsChanged() {
						this._setTotalWidth();
					}
				}, {
					key: '_updateTableProperties',
					value: function _updateTableProperties() {
						this.groupHasStandardProducts = this.groupModel._groupHasStandardProducts();
						this.groupHasSegmentedProducts = this.groupModel._groupHasSegmentedProducts();
						this.groupedAndHasNoLineItems = this.groupModel.quoteModel.grouped && !this._groupHasLineItems();
						this.groupHasBothProducts = this._groupHasBothProducts();
						this._showSubtotal();
						this._setGroupDescription();
					}
				}, {
					key: '_segmentedPrimaryMobileColsChanged',
					value: function _segmentedPrimaryMobileColsChanged() {
						this._updatePageData();
					}
				}, {
					key: '_updatePageData',
					value: function _updatePageData() {
						if (this.$$('#leGroupTabs')) {
							this.$$('#leGroupTabs').destroyTabs();
						}

						var tabs = [],
						    dimensions = this.groupModel.dimensions;

						for (var i = 0, len = dimensions.length; i < len; i++) {
							var dimension = dimensions[i];

							if (this.groupModel.hasVisibleSegmentedLines[dimension]) {
								var tId = "t" + i;
								var tab = { name: tId, key: dimension, label: this.groupModel.quoteModel.quoteVO.localizedDimensionNames[dimension], bind: ['groupModel'] };
								if (dimension == 'Custom') {
									tab.iconId = tId + '-' + this.groupModel.groupKey;
									tab.iconClass = 'sb-icon-pencil';
									tab.iconEvent = 'cseDialog';
								}
								tabs.push(tab);
							}
						}
						this.tabs = tabs;
						if (!this.groupMDQTabs) {
							this.groupMDQTabs = tabs;
						}
					}
				}, {
					key: '_handleCSEDialogTapped',
					value: function _handleCSEDialogTapped(e) {
						this.fire('cse-tapped', {
							dialog: 'cseDialog',
							groupModelKey: this.groupModel.groupKey
						});
					}
				}, {
					key: '_groupHasBothProducts',
					value: function _groupHasBothProducts() {
						return this.groupModel._groupHasStandardProducts() && this.groupModel._groupHasSegmentedProducts();
					}
				}, {
					key: '_groupHasLineItems',
					value: function _groupHasLineItems() {
						return this.groupModel._groupHasStandardProducts() || this.groupModel._groupHasSegmentedProducts();
					}
				}, {
					key: '_groupRecordChanged',
					value: function _groupRecordChanged(changedRecord) {
						if (changedRecord.path == 'groupModel.groupVO.record.' + this.editorModel.constants.OPTIONAL_FIELD) {
							this.fire('iron-signal', { name: 'toggle-optional-clicked', data: { toggleOptionalBoolean: changedRecord.value, groupKey: this.groupModel.groupKey } });
						}
						var groupRecord = this.groupModel.groupVO.record;
						this.favorited = !!(groupRecord && groupRecord[this.editorModel.constants.FAVORITE_ID_FIELD]);
					}
				}, {
					key: '_setGroupDescription',
					value: function _setGroupDescription() {
						if (!this.groupModel.groupVO.record) {
							return;
						}

						this.value = this.groupModel.groupVO.record[this.editorModel.constants.DESCRIPTION_FIELD];
						if (this.groupModel && this.editorModel.md && this.editorModel.constants) {
							this._getDescriptionMd();
						}
						if (this.value) {
							return;
						}

						this.value = "Click to edit description.";
					}
				}, {
					key: '_descriptionChanged',
					value: function _descriptionChanged() {
						if (this.value !== "Click to edit description.") {
							this.groupModel.groupVO.record[this.editorModel.constants.DESCRIPTION_FIELD] = this.value;
						}
					}
				}, {
					key: '_getDescriptionMd',
					value: function _getDescriptionMd() {
						var groupObjMd = this.editorModel.md.fieldsMap[this.groupModel.groupObjectName];
						this.descriptionMd = groupObjMd[this.editorModel.constants.DESCRIPTION_FIELD];
					}
				}, {
					key: '_getSegmentKeys',
					value: function _getSegmentKeys() {
						return Object.keys(this.groupModel.segmentedLinesBySegmentKey);
					}
				}, {
					key: 'triggerCustomAction',
					value: function triggerCustomAction(e) {
						this.fire('le-action-tapped', {
							customAction: { eventHandlerName: e.currentTarget.attributes.eventHandlerName.value },
							model: this.groupModel
						});
					}
				}, {
					key: 'showGroupNameEditor',
					value: function showGroupNameEditor(e) {
						e.stopPropagation();
						if (this.isMobile) {
							return;
						}
						this.toggleClass('hidden', true, this.$$('#groupHeaderName'));
						this.toggleClass('hidden', false, this.$$('#groupNameInput'));
						this.$$('#groupNameInput').focus();
						this.$$('#groupNameInput').setSelectionRange(0, this.groupModel.groupVO.record.Name.length);
					}
				}, {
					key: 'checkInputValue',
					value: function checkInputValue(e) {
						e.stopPropagation();
						if (e.target.value != "") {
							this.set('groupModel.groupVO.record.Name', e.target.value);
						}
						this.toggleClass('hidden', false, this.$$('#groupHeaderName'));
						this.toggleClass('hidden', true, this.$$('#groupNameInput'));
					}
				}, {
					key: 'closeGroupNameEditor',
					value: function closeGroupNameEditor(e) {
						e.stopPropagation();
						if (e.keyCode == '13') {
							this.$$('#groupNameInput').blur();
						}
					}
				}, {
					key: '_showSubtotal',
					value: function _showSubtotal() {
						if (!this.groupModel.groupVO.record) return;

						var settings = this.groupModel.quoteModel.editorModel.data.settings;
						if (this.groupModel.quoteModel.grouped && settings.lineEditorGroupSubtotalsField != 'doNotDisplay' && (this.groupModel.segmentedLines.length > 0 && this.groupModel._groupHasStandardProducts() || this.viewport && this.viewport.isMobile())) {
							this._getSubtotal();
							this.showSubtotal = true;
						} else {
							this.showSubtotal = false;
						}
					}
				}, {
					key: '_getSubtotal',
					value: function _getSubtotal() {
						if (!this.groupModel.quoteModel.grouped) {
							return;
						}

						var editorModel = this.groupModel.quoteModel.editorModel,
						    settings = editorModel.data.settings,
						    priceScale = void 0,
						    subtotal = void 0;

						var subtotalField = settings.lineEditorGroupSubtotalsField;

						if (subtotalField == 'Default' || subtotalField == null) {
							priceScale = settings.isMultiCurrencyOrg ? settings.currencyDecimalScale : editorModel.md.fieldsMap[settings.developerPrefix + 'QuoteLineGroup__c'][editorModel.constants.NET_TOTAL_FIELD].scale;
							subtotal = (this.groupModel.groupVO.record[editorModel.constants.NET_TOTAL_FIELD] || 0).toFixed(priceScale);
						} else {
							priceScale = settings.isMultiCurrencyOrg ? settings.currencyDecimalScale : editorModel.md.fieldsMap[settings.developerPrefix + 'QuoteLineGroup__c'][subtotalField].scale;
							subtotal = (this.groupModel.groupVO.record[settings.lineEditorGroupSubtotalsField] || 0).toFixed(priceScale);
						}
						if (!this.subtotalMd) {
							this.subtotalMd = { type: "currency", scale: priceScale, CurrencyIsoCode: this.groupModel.quoteModel.quoteVO.record.CurrencyIsoCode };
						}
						this.subtotal = subtotal;
					}
				}, {
					key: '_toggleGrouping',
					value: function _toggleGrouping() {
						this.notifyPath('groupModel.quoteModel.grouped', this.groupModel.quoteModel.grouped);
						this.set('groupClass', this.groupModel.quoteModel.grouped ? 'group' : 'virtualGroup');
					}
				}, {
					key: 'buildGroupTabs',
					value: function buildGroupTabs() {
						if (!this.editorModel) return;

						var namesForGroupLayout = [];
						if (this.editorModel.fieldsetMap.groupFieldNames.length > 0 && this._groupHasLineItems()) namesForGroupLayout.push('details');
						if (this.groupModel._groupHasSegmentedProducts()) namesForGroupLayout.push('segmented');
						if (this.groupModel._groupHasStandardProducts()) namesForGroupLayout.push('standard');

						var tabs = [];

						this.groupModel.groupMDQTabs = this.tabs;

						if (!this._renderTabs(namesForGroupLayout)) {
							return;
						}

						if (this.$$('#groupTabs')) {
							this.$$('#groupTabs').destroyTabs();
						}

						for (var i = 0, l = namesForGroupLayout.length; i < l; i++) {
							var tId = "t" + i,
							    tabName = namesForGroupLayout[i];

							tabs.push({ name: tId, label: tabName });
						}
						this.groupLevelTabs = undefined;
						this.bind = ['groupModel', 'editorModel'];
						this.groupMDQTabs = this.groupModel.groupMDQTabs;
						this.selectedTabIndex = 0;
						this.hideTabs = tabs.length == 1;
						this.groupLevelTabs = tabs;
					}
				}, {
					key: '_renderTabs',
					value: function _renderTabs(namesForGroupLayout) {
						if (this.groupLevelTabs.length !== namesForGroupLayout.length) {
							return true;
						}

						if (this.groupModel.groupMDQTabs && this.groupMDQTabs.length !== this.groupModel.groupMDQTabs.length) {
							return true;
						}

						for (var i = 0, l = this.groupLevelTabs.length; i < l; i++) {
							if (this.groupLevelTabs[i].label !== namesForGroupLayout[i]) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: 'expandGroup',
					value: function expandGroup(e) {
						var _this = this;

						if (!e.target.hasAttribute('triggersExpandGroup') || !this.isMobile || this.showSpinner) {
							return;
						}

						if (!this.$$('#mobileGroupTabs')) {
							this.showSpinner = true;
						}

						Polymer.RenderStatus.afterNextRender(this, function () {
							_this.set('groupModel.groupExpanded', !_this.groupModel.groupExpanded);
							_this.groupExpanded = _this.groupModel.groupExpanded;

							Polymer.RenderStatus.afterNextRender(_this, function () {
								_this.showSpinner = false;
							});
						});
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
						this._setIsButton();
						if (this.viewport && this.viewport.isMobile()) {
							this.isMobile = true;
						} else {
							this.isMobile = false;
						}
					}
				}, {
					key: '_setUpgradeQuantity',
					value: function _setUpgradeQuantity(e) {
						var _this2 = this;

						var sourceIndex = e.detail.sourceIndex;
						var upgradeIndex = e.detail.upgradeIndex;
						var sourceLineVO = e.detail.sourceLineVO;
						var upgradeLineVO = e.detail.upgradeLineVO;

						this.debounce('Handle user input for automatic upgrade asset quantity changed', function () {
							if (sourceLineVO.invalidQuantity) {
								_this2._notifyQuantityChanged(sourceIndex, upgradeIndex, sourceLineVO, true);
							} else if (upgradeLineVO.invalidQuantity) {
								_this2._notifyQuantityChanged(upgradeIndex, sourceIndex, upgradeLineVO, true);
							} else {
								_this2._notifyQuantityChanged(sourceIndex, upgradeIndex);
							}
							sourceLineVO.invalidQuantity = null;
							upgradeLineVO.invalidQuantity = null;
						}, 10);
					}
				}, {
					key: '_notifyQuantityChanged',
					value: function _notifyQuantityChanged(index1, index2, lineVO, invalidQuantity) {
						var invalidQuantityCheck = void 0;
						var validQuantityCheck = void 0;
						this.groupModel.standardLines[index1].internalUpdate = true;
						this.groupModel.standardLines[index2].internalUpdate = true;

						if (invalidQuantity) {
							invalidQuantityCheck = lineVO.invalidQuantity;
							validQuantityCheck = lineVO.validQuantity;
							lineVO.record[this.editorModel.constants.QUANTITY_FIELD] = lineVO.invalidQuantity;
							this.notifyPath('groupModel.standardLines.' + index1 + '.lineVO.record.' + this.editorModel.constants.QUANTITY_FIELD, this.groupModel.standardLines[index1].lineVO.record[this.editorModel.constants.QUANTITY_FIELD]);
							lineVO.record[this.editorModel.constants.QUANTITY_FIELD] = lineVO.validQuantity;
						}

						this.notifyPath('groupModel.standardLines.' + index1 + '.lineVO.record.' + this.editorModel.constants.QUANTITY_FIELD, this.groupModel.standardLines[index1].lineVO.record[this.editorModel.constants.QUANTITY_FIELD]);
						this.groupModel.standardLines[index1].internalUpdate = false;
						this.notifyPath('groupModel.standardLines.' + index2 + '.lineVO.record.' + this.editorModel.constants.QUANTITY_FIELD, this.groupModel.standardLines[index2].lineVO.record[this.editorModel.constants.QUANTITY_FIELD]);
						this.groupModel.standardLines[index2].internalUpdate = false;

						this.fire('validate-quantity-changed', {
							invalidQuantity: invalidQuantityCheck,
							validQuantity: validQuantityCheck
						});
					}
				}, {
					key: 'addSegmentedLineToEmptyTable',
					value: function addSegmentedLineToEmptyTable(lineModel) {
						var lineVO = lineModel.lineVO,
						    lineRecord = lineVO.record,
						    segmentKey = lineRecord[this.groupModel.constants.SEGMENT_KEY_FIELD],
						    dimension = this.groupModel.quoteModel.quoteVO.multiSegmentKeys ? this.groupModel.quoteModel.quoteVO.multiSegmentKeys[segmentKey] : null;

						if (!this.groupModel.hasVisibleSegmentedLines) {
							this.groupModel.hasVisibleSegmentedLines = {};
						};

						this.groupModel.setDimensionProperties(dimension);

						this.groupModel.segmentedLines.push(lineModel);

						this.groupModel.groupVO.multiSegmentColumns[dimension] = lineModel.groupModel.groupVO.multiSegmentColumns[dimension];
						this.groupModel.groupVO.localizedMultiSegmentColumns[dimension] = lineModel.groupModel.groupVO.localizedMultiSegmentColumns[dimension];

						lineModel.groupModel = this.groupModel;
						lineModel.lineVO.parentGroupKey = this.groupModel.groupKey;
						for (var i = 0, l = lineModel.segments.length; i < l; i++) {
							lineModel.segments[i].lineVO.parentGroupKey = this.groupModel.groupKey;
						}
						this.groupModel.segmentedLinesBySegmentKey[segmentKey] = lineModel;
						this.push('groupModel.segmentedLinesByDimension.' + dimension, lineModel);
						if (this.$$('#leGroupTabs')) {
							this.$$('#leGroupTabs').destroyTabs();
						}

						this._updatePageData();
					}
				}, {
					key: 'addSegmentedLineToExistingTab',
					value: function addSegmentedLineToExistingTab(lineModel) {
						var lineVO = lineModel.lineVO,
						    lineRecord = lineVO.record,
						    segmentKey = lineRecord[this.groupModel.constants.SEGMENT_KEY_FIELD],
						    dimension = this.groupModel.quoteModel.quoteVO.multiSegmentKeys ? this.groupModel.quoteModel.quoteVO.multiSegmentKeys[segmentKey] : null;

						this.groupModel.segmentedLines.push(lineModel);

						lineModel.groupModel = this.groupModel;
						lineModel.lineVO.parentGroupKey = this.groupModel.groupKey;
						for (var i = 0, l = lineModel.segments.length; i < l; i++) {
							lineModel.segments[i].lineVO.parentGroupKey = this.groupModel.groupKey;
						}
						this.groupModel.segmentedLinesBySegmentKey[segmentKey] = lineModel;
						this.push('groupModel.segmentedLinesByDimension.' + dimension, lineModel);
					}
				}, {
					key: 'removeSegmentedLine',
					value: function removeSegmentedLine(lineModel) {
						var lineVO = lineModel.lineVO,
						    lineRecord = lineVO.record,
						    lineKey = lineVO.key,
						    segmentKey = lineRecord[this.groupModel.constants.SEGMENT_KEY_FIELD],
						    segmentLabel = lineRecord[this.groupModel.constants.SEGMENT_LABEL_FIELD],
						    dimension = this.groupModel.quoteVO.multiSegmentKeys ? this.groupModel.quoteVO.multiSegmentKeys[segmentKey] : null;

						this.groupModel.segmentedLines.splice(this.groupModel.segmentedLines.indexOf(lineModel), 1);
						delete this.groupModel.segmentedLinesBySegmentKey[segmentKey];
						this.splice('groupModel.segmentedLinesByDimension.' + dimension, this.groupModel.segmentedLinesByDimension[dimension].indexOf(lineModel), 1);
						if (this.groupModel.segmentedLinesByDimension[dimension].length === 0) {
							this.groupModel.removeDimensionProperties(dimension);
							delete this.groupModel.groupVO.localizedMultiSegmentColumns[dimension];
							delete this.groupModel.groupVO.multiSegmentColumns[dimension];
							this.$$('#leGroupTabs').destroyTabs();

							this._updatePageData();
						}
					}
				}, {
					key: '_onTrack',
					value: function _onTrack(e) {
						this.dragDrop._onTrack(e);
					}
				}, {
					key: 'dragFunc',
					value: function dragFunc(dragElement) {
						this.dragDrop.ghost = this.dragDrop.lineEditor.$.ghost;

						this.linesByParentKey = this.editorModel.quoteModel.linesByParentItemKey;
						this.indexByGroupKey = this.groupModel.quoteModel.indexByGroupKey;
						this.lineModelsByKey = this.groupModel.quoteModel.lineModelsByKey;
						this.dragDrop.dragLineModel = [];
						this.dragDrop.dragGroupModel = dragElement.lineModel.groupModel;

						this.dragDrop.dragKey = dragElement.lineModel.lineVO.key;
						this.dragDrop.dragLineModel = dragElement.lineModel;
						this.dragDrop.segment = dragElement.domHost.dimension;
						this.dragDrop.dragIndex = this.groupModel.segmentedLinesByDimension[this.dragDrop.segment].indexOf(dragElement.lineModel);

						this.set('groupModel.segmentedLinesByDimension.' + this.dragDrop.segment + '.' + this.dragDrop.dragIndex + '.hidden', true);
					}
				}, {
					key: 'trackFunc',
					value: function trackFunc(hoverElement) {
						var dd = this.dragDrop;
						hoverElement = dd._findTableRowValidTarget(hoverElement);
						if (!hoverElement) return;
						if (hoverElement.id === 'placeholder') {
							hoverElement = hoverElement.getAttribute('ref') === 'before' ? hoverElement.previousElementSibling : hoverElement.nextElementSibling;
						}
						switch (dd.targetClass) {
							case 'sb-droppable-mdqRows':
								dd._updateMDQTableRowHoverOverObject(dd.sourceElement, hoverElement);
								if (!dd.hoverOver) return;
								dd.targetHost = dd.hoverOver.comp.domHost;
								dd.usePlaceholder = true;
								dd.enableHighLight = false;
								break;
							case 'sb-droppable-emptyTable':
								if (!dd.keepBundleTogether) {
									dd.hoverOver = { "comp": hoverElement };
								} else if (dd.sourceElement.lineModel.component) {
									dd.hoverOver = null;
								} else {
									dd.hoverOver = { "comp": hoverElement };
								}
								dd.usePlaceholder = false;
								dd.enableHighLight = true;
								break;
							case 'sb-droppable-sidePanelGroups':
								if (!dd.keepBundleTogether) {
									dd.hoverOver = { "comp": hoverElement };
								} else if (dd.sourceElement.lineModel.component) {
									dd.hoverOver = null;
								} else {
									dd.hoverOver = { "comp": hoverElement };
								}
								dd.usePlaceholder = false;
								dd.enableHighLight = true;
								break;
						}
					}
				}, {
					key: 'dropFunc',
					value: function dropFunc(dragElement, dropElement, className, dropElementBefore) {
						this.dragDrop.dropKey = null;
						this.dragDrop.dropIndex = null;
						this.dragDrop.dropGroupModel = null;
						var dropLeGroup = void 0,
						    dropSegLinesTable = void 0,
						    dragLineModel = this.dragDrop.dragLineModel;

						this.set('groupModel.segmentedLinesByDimension.' + this.dragDrop.segment + '.' + this.dragDrop.dragIndex + '.hidden', false);

						if (!dropElement) return;

						if (dragElement.lineModel.subscriptionScopeEditable) {
							this.dragDrop.dragGroupModel._updateSegmentedSubscriptionScopeEditable(dragElement.lineModel);
							dragElement.domHost.fieldNames = dragElement.domHost._getFields();
							dragElement.domHost._setColumnWidths();
						}
						switch (className) {
							case 'sb-droppable-mdqRows':
								var dropGroupModel = dropElement.lineModel.groupModel,
								    _segment = this.dragDrop.segment,
								    _dropLeGroup = dropElement.domHost.domHost.domHost,
								    _dropSegLinesTable = dropElement.domHost;
								this.dragDrop.dropGroupModel = dropGroupModel;
								if (dragLineModel.subscriptionScopeEditable) {
									this.dragDrop.dropGroupModel.segmentedSubscriptionScopeEditable = true;
								}

								var dropIndex = dropGroupModel.segmentedLinesByDimension[_segment].indexOf(dropElement.lineModel);

								if (dropElementBefore) {
									dropIndex = dropIndex >= 0 ? dropIndex : 0;
								} else {
									++dropIndex;
								}

								dragLineModel.groupModel = dropGroupModel;
								dragLineModel.lineVO.parentGroupKey = dropGroupModel.groupKey;
								dragLineModel.segments.forEach(function (seg) {
									seg.lineVO.parentGroupKey = dropGroupModel.groupKey;
									seg.groupModel = dropGroupModel;
								}.bind(this));

								_dropLeGroup.splice('groupModel.segmentedLinesByDimension.' + _segment, dropIndex, 0, dragLineModel);
								break;

							case 'sb-droppable-emptyTable':
								_dropLeGroup = dropElement.parentNode.parentNode.parentNode.host ? dropElement.parentNode.parentNode.parentNode.host : dropElement.parentNode.parentNode.parentNode;
								_dropSegLinesTable = undefined;
								this.dragDrop.dropGroupModel = _dropLeGroup.groupModel;
								if (dragLineModel.subscriptionScopeEditable) {
									this.dragDrop.dropGroupModel.segmentedSubscriptionScopeEditable = true;
								}
								_dropLeGroup.addSegmentedLineToEmptyTable(dragLineModel);
								break;

							case 'sb-droppable-sidePanelGroups':
								var dropGroupId = 'Group' + dropElement.getAttribute('id');
								var groupContainer = this.dragDrop._findParentCustomElement(dropElement, 'groupContainer', 'id');
								_dropLeGroup = groupContainer.querySelector('#' + dropGroupId), _dropSegLinesTable = undefined;
								this.dragDrop.dropGroupModel = _dropLeGroup.groupModel;
								if (dragLineModel.subscriptionScopeEditable) {
									this.dragDrop.dropGroupModel.segmentedSubscriptionScopeEditable = true;
								}
								if (!this.dragDrop.dropGroupModel.dimensions.includes(this.dragDrop.segment)) {
									_dropLeGroup.addSegmentedLineToEmptyTable(dragLineModel);
								} else {
									_dropLeGroup.addSegmentedLineToExistingTab(dragLineModel);
								}
								break;
						}

						this.removeSegmentedLine(this.dragDrop.dragLineModel);
						if (className === 'sb-droppable-mdqRows') {
							var model = dropLeGroup.groupModel.segmentedLinesByDimension[segment];
							dropElement.domHost.notifyPath('groupModel.segmentedLinesByDimension.' + segment, model.slice());
							dropElement.domHost.notifyPath('lineModels', model.slice());
						}
						this.fire('renumber-lines');
						if (this.editorModel.data.settings.usesClientCalculator) {
							this.editorModel.quoteModel.renumberIndexes(true);
						}
					}
				}, {
					key: '_groupCustomActionsChanged',
					value: function _groupCustomActionsChanged(e) {
						var l = e ? e.length : 0;
						for (var i = 0; i < l; i++) {
							this.notifyPath('editorModel.groupCustomActions.' + i + '.children');
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_groupRecordChanged(groupModel.groupVO.record.*)', '_toggleGrouping(groupModel.groupVO)', '_segmentedPrimaryMobileColsChanged(groupModel.editorModel.segmentedPrimaryMobileCols)', '_updateTableProperties(groupModel.standardLines.splices)', '_updateTableProperties(groupModel.segmentedLinesByDimension.*)', '_createDragDropModel(editorModel)', '_groupCustomActionsChanged(groupModel.editorModel.groupCustomActions)', '_showSubtotal(groupModel.groupVO.record.*)'];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'cseDialog-tapped': '_handleCSEDialogTapped',
							'segmented-changed': '_customSegmentedUpdated',
							'upgrade-asset-quantity-changed': '_setUpgradeQuantity'
						};
					}
				}]);

				return LEGroup;
			}());

			_export('LEGroup', LEGroup);

			Polymer(LEGroup);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-group-layout/LEGroupLayout.js', ['common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js', 'quotes/models/DragDropModel.js', 'common/layout/table-layout-builder/TableLayoutBuilder.js'], function (_export, _context) {
	var PageContainer, AppContext, DragDropModel, removeTopBottomBorderClass, TableLayoutBuilder, _createClass, GHOST_X_OFFSET, GHOST_Y_OFFSET, LEGroupLayout;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_quotesModelsDragDropModelJs) {
			DragDropModel = _quotesModelsDragDropModelJs.DragDropModel;
			removeTopBottomBorderClass = _quotesModelsDragDropModelJs.removeTopBottomBorderClass;
		}, function (_commonLayoutTableLayoutBuilderTableLayoutBuilderJs) {
			TableLayoutBuilder = _commonLayoutTableLayoutBuilderTableLayoutBuilderJs.TableLayoutBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			GHOST_X_OFFSET = 8;
			GHOST_Y_OFFSET = 150;

			_export('LEGroupLayout', LEGroupLayout = function () {
				function LEGroupLayout() {
					_classCallCheck(this, LEGroupLayout);
				}

				_createClass(LEGroupLayout, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-group-layout';
						this.properties = {
							noHeader: {
								type: Boolean,
								value: false
							},
							layoutLink: String,
							layoutWidth: Number,
							layoutLeft: {
								type: String,
								value: '24px'
							},
							drawerState: String,
							lastSelectedGroup: Object
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						Polymer.RenderStatus.afterNextRender(this, function () {
							this._resize = function () {
								this.debounce('resize', function (e) {
									var _this = this;

									this._buildLayout();
									Polymer.RenderStatus.afterNextRender(this, function () {
										_this.fire('iron-signal', { name: 'col-widths-changed', data: { layout: _this.editorModel.layout } });
									});
								}, 200);
							}.bind(this);
							window.addEventListener('resize', this._resize);
						});
					}
				}, {
					key: 'detached',
					value: function detached() {
						window.removeEventListener('resize', this._resize);
					}
				}, {
					key: '_spliceObserver',
					value: function _spliceObserver(splicedRecords) {
						if (!splicedRecords || splicedRecords.indexSplices[0].addedCount == 0) return;
						this.addedIndex = splicedRecords.indexSplices[0].index;
						this.addedKey = splicedRecords.indexSplices[0].object[this.addedIndex].groupVO.key;
						if (!this.observersAttached) {
							this._attachObservers();
						}
					}
				}, {
					key: 'toggle',
					value: function toggle() {
						var _this2 = this;

						if (this.drawerState == 'open') {
							this.closePanel();
						} else {
							this.openPanel();
						}
						Polymer.RenderStatus.afterNextRender(this, function () {
							_this2.fire('iron-signal', { name: 'group-panel-toggled', data: { drawerState: _this2.drawerState } });
						});
					}
				}, {
					key: 'openPanel',
					value: function openPanel() {
						this.$.drawerPanel.style.left = '0px';
						if (!this.isMobile) {
							this.$.mainPanel.style.paddingLeft = '280px';
						}
						this.drawerState = 'open';
					}
				}, {
					key: 'closePanel',
					value: function closePanel() {
						this.$.drawerPanel.style.left = '-256px';
						this.$.mainPanel.style.paddingLeft = !this.isMobile && this.rightSideButton ? '24px' : '0px';
						this.drawerState = 'closed';
					}
				}, {
					key: 'groupPanelCreated',
					value: function groupPanelCreated() {
						if (this.isMobile) {
							this.debounce('resize', function (e) {
								var _this3 = this;

								this._buildLayout();
								Polymer.RenderStatus.afterNextRender(this, function () {
									_this3.fire('iron-signal', { name: 'col-widths-changed', data: { layout: _this3.editorModel.layout } });
								});
							}, 50);
						}
					}
				}, {
					key: '_groupModelsAreChanged',
					value: function _groupModelsAreChanged() {
						if (!this.drawerState) this.drawerState = 'closed';

						this.$.mainPanel.style.paddingLeft = this.rightSideButton && !this.isMobile ? '24px' : '0px';

						if (!this.observersAttached) this._attachObservers();

						this._buildLayout();
					}
				}, {
					key: '_buildLayout',
					value: function _buildLayout() {
						if (this.isMobile) return;
						var layout = {},
						    md = this.editorModel.md.fieldsMap[this.editorModel.data.quoteLineObjectName],
						    actionsOnTheLeft = this.editorModel.actionsOnTheLeft,
						    multiDeleteEnabled = this.editorModel.data.settings.multiLineDeleteEnabled,
						    hasLines = this.editorModel.quoteModel.quoteVO.lineItems.length > 0;
						layout.totalWidth = hasLines ? this._getMaxTableWidth(this._getAvailableWidth(), md, actionsOnTheLeft, multiDeleteEnabled) : this._getAvailableWidth();
						layout.colWidths = this._calculateColWidths(layout, md, actionsOnTheLeft, multiDeleteEnabled);
						this.set('editorModel.layout', layout);
					}
				}, {
					key: '_getAvailableWidth',
					value: function _getAvailableWidth() {
						var pageContainer = document.getElementById('sbPageContainer');

						if (!pageContainer) return;
						var availableWidth = Polymer.dom(pageContainer.root).querySelector('sb-line-editor').clientWidth;

						if (this.editorModel.quoteModel.grouped) {
							availableWidth -= 30 + 2;
							if (this.editorModel.quoteModel.lineGroups.length > 1) {
								availableWidth -= 24;
								if (this.drawerState && this.drawerState == 'open') {
									availableWidth -= 256;
								}
							}
						}
						return availableWidth;
					}
				}, {
					key: '_getMaxTableWidth',
					value: function _getMaxTableWidth(availableWidth, md, actionsOnTheLeft, multiDeleteEnabled) {

						this.tableLayoutBuilder = new TableLayoutBuilder(availableWidth, this._getQuoteStandardFields(), md, actionsOnTheLeft, multiDeleteEnabled);
						this.tableLayoutBuilder.build();
						var maxWidth = this.tableLayoutBuilder.getTotalWidth();

						var cols = this.editorModel.quoteModel.quoteVO.multiSegmentColumns,
						    multiSegmentFieldNames = this._getQuoteSegmentedFields();
						for (var dimension in cols) {
							if (!cols.hasOwnProperty(dimension)) {
								continue;
							}
							var fieldNames = multiSegmentFieldNames.concat(cols[dimension]).concat('total');
							this.tableLayoutBuilder = new TableLayoutBuilder(availableWidth, fieldNames, md, actionsOnTheLeft, multiDeleteEnabled);
							this.tableLayoutBuilder.build();
							var totalWidth = this.tableLayoutBuilder.getTotalWidth();
							if (totalWidth > maxWidth) {
								maxWidth = totalWidth;
							}
						}
						return maxWidth;
					}
				}, {
					key: '_calculateColWidths',
					value: function _calculateColWidths(layout, md, actionsOnTheLeft, multiDeleteEnabled) {
						var colWidths = {};

						var groups = this.editorModel.quoteModel.lineGroups;
						for (var i = 0, len = groups.length; i < len; i++) {
							var groupModel = groups[i],
							    groupKey = groupModel.groupKey,
							    cols = groupModel.quoteModel.grouped ? groupModel.groupVO.multiSegmentColumns : groupModel.quoteModel.quoteVO.multiSegmentColumns;

							this.tableLayoutBuilder = new TableLayoutBuilder(layout.totalWidth, this._getGroupStandardFields(groupKey), md, actionsOnTheLeft, multiDeleteEnabled);
							if (!colWidths[groupKey]) {
								colWidths[groupKey] = {};
							}
							colWidths[groupKey]['Standard'] = this.tableLayoutBuilder.build();
							layout.leftOffset = this.tableLayoutBuilder.getLeftOffset();

							for (var dim in cols) {
								if (!cols.hasOwnProperty(dim)) {
									continue;
								}
								this.tableLayoutBuilder = new TableLayoutBuilder(layout.totalWidth, this._getSegmentedFieldNames(groupModel, cols[dim]), md, actionsOnTheLeft, multiDeleteEnabled);
								colWidths[groupKey][dim] = this.tableLayoutBuilder.build();
							}
						}
						return colWidths;
					}
				}, {
					key: '_getQuoteStandardFields',
					value: function _getQuoteStandardFields() {
						var subsScope = false,
						    groups = this.editorModel.quoteModel.lineGroups;
						for (var i = 0, len = groups.length; i < len; i++) {
							if (groups[i].standardSubscriptionScopeEditable) {
								subsScope = true;
								break;
							}
						}
						return this._getStandardFields(subsScope);
					}
				}, {
					key: '_getGroupStandardFields',
					value: function _getGroupStandardFields(groupKey) {
						var group = this.editorModel.quoteModel.groupsByKey[groupKey];
						return this._getStandardFields(group.standardSubscriptionScopeEditable);
					}
				}, {
					key: '_getStandardFields',
					value: function _getStandardFields(subsScope) {
						var fields = this.editorModel.fieldsetMap.lineFieldNames;
						if (subsScope) {
							fields = [this.editorModel.constants.SUBSCRIPTION_SCOPE_FIELD].concat(fields);
						}
						return fields;
					}
				}, {
					key: '_getQuoteSegmentedFields',
					value: function _getQuoteSegmentedFields() {
						var subsScope = false,
						    groups = this.editorModel.quoteModel.lineGroups;
						for (var i = 0, len = groups.length; i < len; i++) {
							if (groups[i].segmentedSubscriptionScopeEditable) {
								subsScope = true;
								break;
							}
						}
						var multiSegmentSummaryFieldNames = this.editorModel.data.multiSegmentLineSummaryFieldNames;
						return subsScope ? [this.editorModel.constants.SUBSCRIPTION_SCOPE_FIELD].concat(multiSegmentSummaryFieldNames) : multiSegmentSummaryFieldNames;
					}
				}, {
					key: '_getSegmentedFieldNames',
					value: function _getSegmentedFieldNames(groupModel, colNames) {
						var summaryFields = this.editorModel.data.multiSegmentLineSummaryFieldNames,
						    fieldNames = groupModel.segmentedSubscriptionScopeEditable ? [this.editorModel.constants.SUBSCRIPTION_SCOPE_FIELD].concat(summaryFields) : summaryFields.slice();
						for (var i = 0, len = colNames.length; i < len; i++) {
							fieldNames.push(colNames[i].replace(/\W/g, ''));
						}
						fieldNames.push('total');
						return fieldNames;
					}
				}, {
					key: '_attachObservers',
					value: function _attachObservers() {
						if (this.rightSideButton || this.isMobile) {
							this.observersAttached = true;
							this._observeNodes = Polymer.dom(this.$.groups).observeNodes(function (info) {
								var addedNodes = info.addedNodes.filter(function (node) {
									return node.nodeName === "SB-LE-GROUP" && node.groupModel.groupVO.key == this.addedKey;
								}.bind(this));
								var removedNodes = info.removedNodes.filter(function (node) {
									return node.nodeName === "SB-LE-GROUP";
								});
								if (addedNodes[0] === removedNodes[0]) return;
								this.processNewGroups(addedNodes);
								this.processRemovedGroups(removedNodes);
							}.bind(this));
						}
					}
				}, {
					key: 'processNewGroups',
					value: function processNewGroups(addedNodes) {
						if (this.addedKey && addedNodes.length > 0) {
							var groupKey = this.addedKey;
							if (this.isMobile) {
								this.closePanel();
							}
							this.toggleSelectedAndScroll(groupKey);
							Polymer.dom(this.$.groups).unobserveNodes(this._observeNodes);
							this.observersAttached = false;
							this.addedKey = null;
						}
					}
				}, {
					key: 'processRemovedGroups',
					value: function processRemovedGroups(removedNodes) {
						if (this.lastSelectedGroup && removedNodes.length == 1) {
							this.toggleClass('selected-tab', false, this.lastSelectedGroup);
							this.lastSelectedGroup = undefined;
							Polymer.dom(this.$.groups).unobserveNodes(this._observeNodes);
							this.observersAttached = false;
						}
					}
				}, {
					key: 'toggleSelectedAndScroll',
					value: function toggleSelectedAndScroll(key) {
						var groupElement = this.$$('#_' + key);
						if (this.lastSelectedGroup) {
							this.toggleClass('selected-tab', false, this.lastSelectedGroup);
						}
						if (this.drawerState == 'open') {
							this.toggleClass('selected-tab', true, groupElement);
							this.lastSelectedGroup = groupElement;
						}
						if (!this.$$('#Group_' + key)) return;
						this._scrollIntoView(this.$$('#Group_' + key));
						this.$$('#_' + key).scrollIntoView(false);
						if (this.isMobile) {
							this.$$('#Group_' + key).set('groupModel.groupExpanded', true);
							this.$$('#Group_' + key).groupExpanded = true;
						}
					}
				}, {
					key: '_scrollIntoView',
					value: function _scrollIntoView(target) {
						this.$$('#mainPanel').scrollTop = this.isMobile ? target.offsetTop : target.offsetTop - 15;
					}
				}, {
					key: 'navTo',
					value: function navTo(e) {
						var _this4 = this;

						e.stopPropagation();

						if (this.isMobile) {
							var loadingSpinner = e.target.querySelector('.loadingSpinner');
							loadingSpinner.toggleClass('invisible', false);
						}

						Polymer.RenderStatus.afterNextRender(this, function () {
							var groupKey = Polymer.dom(e).rootTarget.id.split('_')[1];
							_this4.toggleSelectedAndScroll(groupKey);
							if (_this4.isMobile) {
								Polymer.RenderStatus.afterNextRender(_this4, function () {
									loadingSpinner.toggleClass('invisible', true);
								});
								_this4.toggle();
							}
						});
					}
				}, {
					key: '_createDragDropModel',
					value: function _createDragDropModel() {
						if (!this.editorModel) return;

						var validTargets = new Set(['sb-droppable-sidePanelGroups']);
						this.dragDrop = new DragDropModel(this, this.editorModel.data.settings.bundleKeptTogether, 'div', validTargets, this.dragFunc.bind(this), this.trackFunc.bind(this), this.dropFunc.bind(this), GHOST_X_OFFSET, GHOST_Y_OFFSET);
					}
				}, {
					key: 'onTrack',
					value: function onTrack(e) {
						if (this.isMobile || !AppContext.isDesktop) {
							return;
						}
						this.dragDrop._onTrack(e);
					}
				}, {
					key: 'dragFunc',
					value: function dragFunc(dragElement) {
						var dd = this.dragDrop;
						dd.ghost = this.dragDrop.lineEditor.$.ghost;

						dd.dragIndex = dragElement.dataIndex;
						dd.dragGroupModel = this.groupModels[dd.dragIndex];
						var groupLayout = this.$$('#groupLayout');
						this.toggleAttribute('hidden', true, this.$.sbDroppableSidePanelGroups.querySelectorAll('.nav-item')[dd.dragIndex]);
					}
				}, {
					key: 'trackFunc',
					value: function trackFunc(hoverElement) {
						var dd = this.dragDrop;
						hoverElement = this.dragDrop._findSidePanelGroupValidTarget(hoverElement);
						if (!hoverElement) {
							dd.hoverOver = null;
							return;
						}
						if (hoverElement.id === 'placeholder') {
							hoverElement = hoverElement.ref === 'before' ? hoverElement.previousElementSibling : hoverElement.nextElementSibling;
						}
						dd.hoverOver = { "comp": hoverElement, "phLoc": 'both' };
						dd.targetHost = this;
						dd.highlightableElements = [];
						dd.highlightableElements.push(dd.hoverOver.comp);
						dd.usePlaceholder = true;
						dd.enableHighLight = false;
					}
				}, {
					key: 'dropFunc',
					value: function dropFunc(dragElement, dropElement, className, dropElementBefore) {
						var dd = this.dragDrop;
						this.toggleAttribute('hidden', false, this.$.sbDroppableSidePanelGroups.querySelectorAll('.nav-item')[dd.dragIndex]);
						if (!dropElement) {
							return;
						}
						var sideGrp = this.$.sbDroppableSidePanelGroups;
						var maxIndex = sideGrp.querySelectorAll('.nav-item').length - 1;

						dd.dropIndex = dropElement.dataIndex;
						if (dropElementBefore) {
							dd.dropIndex = dd.dropIndex >= 0 ? dd.dropIndex : 0;
						} else {
							++dd.dropIndex;
						}

						removeTopBottomBorderClass(dropElement);
						this.splice('groupModels', dd.dragIndex, 1);
						if (dd.dropIndex < maxIndex) {
							this.splice('groupModels', dd.dropIndex, 0, dd.dragGroupModel);
						} else {
							this.push('groupModels', dd.dragGroupModel);
						}

						dd.lineEditor.renumber();
						if (this.editorModel.data.settings.usesClientCalculator) {
							dd.lineEditor.editorModel.quoteModel.renumberIndexes(true);
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return { 'side-toggle-clicked': 'toggle' };
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_groupModelsAreChanged(editorModel, groupModels, rightSideButton)', '_spliceObserver(groupModels.splices)', '_createDragDropModel(groupModels)'];
					}
				}, {
					key: 'isMobile',
					get: function get() {
						return this.editorModel.deviceContext.isMobile;
					}
				}]);

				return LEGroupLayout;
			}());

			_export('LEGroupLayout', LEGroupLayout);

			Polymer(LEGroupLayout);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-summary-row/LESummaryRow.js', [], function (_export, _context) {
	var _createClass, LESummaryRow;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LESummaryRow', LESummaryRow = function () {
				function LESummaryRow() {
					_classCallCheck(this, LESummaryRow);
				}

				_createClass(LESummaryRow, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-summary-row';
						this.properties = {
							editorModel: Object,
							groupModel: Object,
							fieldNames: Array,
							colWidths: Object
						};
					}
				}, {
					key: 'colWidthsChanged',
					value: function colWidthsChanged(e) {
						if (this.editorModel.deviceContext.isMobile) return;

						this.set('colWidths', e.detail.layout.colWidths[this.groupModel.groupKey]['Standard']);
					}
				}, {
					key: '_getColWidth',
					value: function _getColWidth(fieldName) {
						if (!this.colWidths) return;
						return this.colWidths[fieldName] + 'px';
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return LESummaryRow;
			}());

			_export('LESummaryRow', LESummaryRow);

			Polymer(LESummaryRow);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-table-cell/DiscountConverter.js', [], function (_export, _context) {
	var _createClass, DiscountConverter;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DiscountConverter', DiscountConverter = function () {
				function DiscountConverter(lineModel, item) {
					_classCallCheck(this, DiscountConverter);

					this.lineModel = lineModel;
					this.isAdditionalDiscountField = item === lineModel.fieldNames.ADDITIONAL_DISCOUNT_FIELD;
					this._pullValueFromModel();
					this._determineUnitAndDisplayValue();
					this.setDiscountValue(this._displayValue);
				}

				_createClass(DiscountConverter, [{
					key: '_pullValueFromModel',
					value: function _pullValueFromModel() {
						this.value = this.isAdditionalDiscountField ? this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_FIELD) : this.lineModel.getField(this.lineModel.fieldNames.MARKUP_FIELD);
					}
				}, {
					key: '_determineUnitAndDisplayValue',
					value: function _determineUnitAndDisplayValue() {
						if (this.isAdditionalDiscountField) {
							this.units = this.lineModel.editorModel.data.additionalDiscountUnitOptions;
							var activeUnits = {};
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = this.units[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var unit = _step.value;

									activeUnits[unit.value] = true;
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}

							if (this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD) && !activeUnits['Amount']) {
								var nextActiveUnitValue = this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD) && activeUnits['Percent'] ? 'Percent' : this._getFirstActiveUnitValue(activeUnits);
								this.convertDiscountValue(nextActiveUnitValue);
							}
							if (this.lineModel.lineVO.targetCustomerAmount) {
								this.unit = 'UnitOverride';
								this._displayValue = this.lineModel.lineVO.targetCustomerAmount;
							} else if (this.lineModel.lineVO.targetCustomerTotal) {
								this.unit = 'TotalOverride';
								this._displayValue = this.lineModel.lineVO.targetCustomerTotal;
							} else if (this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD) != null) {
								this.unit = 'Amount';
								this._displayValue = this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD);
							} else if (this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD) != null) {
								this.unit = 'Percent';
								this._displayValue = this.lineModel.getField(this.lineModel.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD);
							} else {
								this.unit = this.lineModel.editorModel.data.defaultAdditionalDiscountUnit.replace(/ /g, '');
							}
						} else {
							this.units = this.lineModel.editorModel.data.markupUnitOptions;
							if (this.lineModel.getField(this.fieldNames.MARKUP_AMOUNT_FIELD) != null) {
								this.unit = 'Amount';
								this._displayValue = this.lineModel.getField(this.fieldNames.MARKUP_AMOUNT_FIELD);
							} else if (this.lineModel.getField(this.fieldNames.MARKUP_RATE_FIELD) != null) {
								this.unit = 'Percent';
								this._displayValue = this.lineModel.getField(this.fieldNames.MARKUP_RATE_FIELD);
							} else {
								this.unit = this.lineModel.editorModel.data.defaultMarkupUnit.replace(/ /g, '');
							}
						}
					}
				}, {
					key: '_getFirstActiveUnitValue',
					value: function _getFirstActiveUnitValue(activeUnits) {
						for (var value in activeUnits) {
							if (activeUnits[value]) {
								return value;
							}
						}
					}
				}, {
					key: 'setDiscountValue',
					value: function setDiscountValue(value) {
						var _this = this;

						var setAdditionalDiscountValues = function setAdditionalDiscountValues() {
							if (_this.unit === 'Percent') {
								_this.record[_this.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD] = value;
							} else if (_this.unit === 'Amount') {
								_this.record[_this.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD] = value;
							} else if (_this.unit === 'UnitOverride') {
								_this.lineModel.lineVO.targetCustomerAmount = value;
							} else if (_this.unit === 'TotalOverride') {
								_this.lineModel.lineVO.targetCustomerTotal = value;
							}
							_this.value = _this.unproratedDiscount / (_this.lineModel.lineVO.amountDiscountProrated ? _this.record[_this.fieldNames.PRORATE_MULTIPLIER_FIELD] : 1);
						};
						var setMarkupValues = function setMarkupValues() {
							if (_this.unit === 'Percent') {
								_this.record[_this.fieldNames.MARKUP_RATE_FIELD] = value;
							} else if (_this.unit === 'Amount') {
								_this.record[_this.fieldNames.MARKUP_AMOUNT_FIELD] = value;
							}
							_this.value = _this.record[_this.fieldNames.MARKUP_AMOUNT_FIELD] || (_this.record[_this.fieldNames.UNIT_COST_FIELD] ? _this.record[_this.fieldNames.UNIT_COST_FIELD] * value / 100 : null);
						};

						if (this.isAdditionalDiscountField) {
							setAdditionalDiscountValues();
						} else {
							setMarkupValues();
						}
						this._displayValue = value;

						if (isNaN(this.value)) this.value = 0;
					}
				}, {
					key: 'convertDiscountValue',
					value: function convertDiscountValue(discountUnit) {
						var _this2 = this;

						var previousDisplayValue = this._displayValue;
						if (!discountUnit) {
							return;
						}
						var changeAdditionalDiscountUnit = function changeAdditionalDiscountUnit() {
							var price = _this2.record[_this2.fieldNames.REGULAR_PRICE_FIELD];
							var nullifyAll = function nullifyAll() {
								_this2.record[_this2.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD] = null;
								_this2.record[_this2.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD] = null;
								if (_this2.lineModel.lineVO.targetCustomerAmount) {
									_this2.lineModel.lineVO.targetCustomerAmount = null;
								}
								if (_this2.lineModel.lineVO.targetCustomerTotal) {
									_this2.lineModel.lineVO.targetCustomerTotal = null;
								}
							};

							if (!price) {
								nullifyAll();
								return;
							}

							var unproratedDiscount = _this2.unproratedDiscount;

							nullifyAll();

							if (discountUnit == 'Percent') {
								return _this2.record[_this2.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD] = unproratedDiscount / price * 100;
							} else if (discountUnit == 'Amount') {
								var amountMultiplier = _this2.lineModel.lineVO.amountDiscountProrated ? _this2.record[_this2.fieldNames.PRORATE_MULTIPLIER_FIELD] : 1;
								return _this2.record[_this2.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD] = unproratedDiscount / amountMultiplier;
							} else if (discountUnit == 'UnitOverride') {
								return _this2.lineModel.lineVO.targetCustomerAmount = price - unproratedDiscount;
							} else if (discountUnit == 'TotalOverride') {
								return _this2.lineModel.lineVO.targetCustomerTotal = (price - unproratedDiscount) * _this2.effectiveQuantity;
							}
						};
						var changeMarkupUnit = function changeMarkupUnit() {
							var cost = _this2.record[_this2.fieldNames.UNIT_COST_FIELD];
							if (discountUnit === 'Percent') {
								var markup = _this2.record[_this2.fieldNames.MARKUP_AMOUNT_FIELD];
								if (markup == null) {
									markup = 0;
								}
								_this2.record[_this2.fieldNames.MARKUP_AMOUNT_FIELD] = null;
								return _this2.record[_this2.fieldNames.MARKUP_RATE_FIELD] = cost != null ? markup / cost * 100 : null;
							} else {
								var _markup = _this2.record[_this2.fieldNames.MARKUP_RATE_FIELD];
								if (_markup == null) {
									_markup = 0;
								}
								_this2.record[_this2.fieldNames.MARKUP_RATE_FIELD] = null;
								return _this2.record[_this2.fieldNames.MARKUP_AMOUNT_FIELD] = cost != null ? cost * (_markup / 100) : null;
							}
						};

						if (this.isAdditionalDiscountField) {
							this._displayValue = changeAdditionalDiscountUnit();
						} else {
							this._displayValue = changeMarkupUnit();
						}
						this.unit = discountUnit;

						if (isNaN(this._displayValue)) this._displayValue = !isNaN(previousDisplayValue) ? previousDisplayValue : null;
					}
				}, {
					key: 'displayValue',
					get: function get() {
						return this._displayValue !== undefined ? this._displayValue : null;
					}
				}, {
					key: 'unproratedDiscount',
					get: function get() {
						var price = this.lineModel.getField(this.fieldNames.REGULAR_PRICE_FIELD);

						var rawDiscount = void 0;

						var modifier = void 0;
						if (this.lineModel.getField(this.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD)) {
							rawDiscount = price * (this.lineModel.getField(this.fieldNames.ADDITIONAL_DISCOUNT_RATE_FIELD) / 100);

							modifier = 1;
						} else if (this.lineModel.lineVO.targetCustomerAmount) {
							rawDiscount = price - this.lineModel.lineVO.targetCustomerAmount;
							modifier = 1;
						} else if (this.lineModel.lineVO.targetCustomerTotal) {
							rawDiscount = price - this.lineModel.lineVO.targetCustomerTotal / this.effectiveQuantity;
							modifier = 1;
						} else if (this.lineModel.getField(this.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD)) {
							rawDiscount = this.lineModel.getField(this.fieldNames.ADDITIONAL_DISCOUNT_AMOUNT_FIELD);

							modifier = this.lineModel.lineVO.amountDiscountProrated ? this.lineModel.getField(this.fieldNames.PRORATE_MULTIPLIER_FIELD) : 1;
						}

						return rawDiscount * modifier;
					}
				}, {
					key: 'effectiveQuantity',
					get: function get() {
						var quantity = this.record[this.fieldNames.QUANTITY_FIELD];
						var priorQuantity = this.record[this.fieldNames.PRIOR_QUANTITY_FIELD];
						var actualQuantity = this.record[this.fieldNames.EXISTING_FIELD] ? quantity - priorQuantity : quantity;
						if ((this.record[this.fieldNames.PRICING_METHOD_FIELD] == 'Block' || this.record[this.fieldNames.DISCOUNT_SCHEDULE_TYPE_FIELD] == 'Slab') && this.record[this.fieldNames.EXISTING_FIELD] && priorQuantity != null && quantity - priorQuantity == 0) {
							return 0;
						} else if (this.record[this.fieldNames.PRICING_METHOD_FIELD] == 'Block' || this.record[this.fieldNames.DISCOUNT_SCHEDULE_TYPE_FIELD] == 'Slab') {
							return 1;
						} else if (this.record[this.fieldNames.EXISTING_FIELD] && this.lineModel.dynamicSubscription && this.record[this.fieldNames.LIST_PRICE_FIELD] != 0 && actualQuantity == 0) {
							return quantity;
						} else if (this.lineModel.groupModel.quoteModel.quoteVO.record[this.fieldNames.TYPE_FIELD] == 'Amendment' && !this.lineModel.subscription && actualQuantity < 0) {
							return 0;
						} else {
							return actualQuantity;
						}
					}
				}, {
					key: 'record',
					get: function get() {
						return this.lineModel.lineVO.record;
					}
				}, {
					key: 'fieldNames',
					get: function get() {
						return this.lineModel.fieldNames;
					}
				}]);

				return DiscountConverter;
			}());

			_export('DiscountConverter', DiscountConverter);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-table-cell/LETableCell.js', ['../sb-le-table-cell/Swiper.js', '../sb-le-table-cell/Localizer.js', '../../../common/calculate/asset-upgrade-quantity-calculator/AssetUpgradeQuantityCalculator.js', '../sb-le-table-cell/QuoteLineUpgradeHandler.js', 'quotes/layout/sb-le-table-cell/DiscountConverter.js', 'common/core/AppContext.js', 'common/core/sb-page-container/PageContainer.js', 'common/relationship/RelationshipFieldManager.js'], function (_export, _context) {
	var Swiper, Localizer, AssetUpgradeQuantityCalculator, QuoteLineUpgradeHandler, DiscountConverter, AppContext, PageContainer, RelationshipFieldManager, _createClass, ICON_CLASS, TOP_LEVEL_CLASS, OPTION_CLASS, INDENT_CLASS, LETableCell;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_sbLeTableCellSwiperJs) {
			Swiper = _sbLeTableCellSwiperJs.Swiper;
		}, function (_sbLeTableCellLocalizerJs) {
			Localizer = _sbLeTableCellLocalizerJs.Localizer;
		}, function (_commonCalculateAssetUpgradeQuantityCalculatorAssetUpgradeQuantityCalculatorJs) {
			AssetUpgradeQuantityCalculator = _commonCalculateAssetUpgradeQuantityCalculatorAssetUpgradeQuantityCalculatorJs.AssetUpgradeQuantityCalculator;
		}, function (_sbLeTableCellQuoteLineUpgradeHandlerJs) {
			QuoteLineUpgradeHandler = _sbLeTableCellQuoteLineUpgradeHandlerJs.QuoteLineUpgradeHandler;
		}, function (_quotesLayoutSbLeTableCellDiscountConverterJs) {
			DiscountConverter = _quotesLayoutSbLeTableCellDiscountConverterJs.DiscountConverter;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			ICON_CLASS = 'sf-icon-chevrondown';
			TOP_LEVEL_CLASS = 'top-level';
			OPTION_CLASS = 'option';
			INDENT_CLASS = 'sbIndent';

			_export('LETableCell', LETableCell = function () {
				function LETableCell() {
					_classCallCheck(this, LETableCell);
				}

				_createClass(LETableCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-table-cell';

						this.properties = {
							item: String,
							value: {
								notify: true
							},
							model: {
								type: Object,
								notify: true
							},
							fieldClass: String,
							data: Object,
							display: String,
							index: Number,
							detailsOnHover: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							editable: Boolean,
							calculateImmediately: {
								type: Object,
								value: function value() {
									return AppContext.org.calculateImmediately;
								}
							}
						};
					}
				}, {
					key: '_onTap',
					value: function _onTap() {}
				}, {
					key: 'attached',
					value: function attached() {
						this.isAttached = true;

						if (this.wasModelIsChangedCalledBeforeAttached) this._modelIsChanged();

						if (this.model.lineVO.record[this.constants.UPGRADED_ASSET_FIELD] && this.model.groupModel.quoteModel.isAmendment && this.item === this.constants.QUANTITY_FIELD) {
							this.quoteLineUpgradeHandler = new QuoteLineUpgradeHandler(this.model);
							if (this.quoteLineUpgradeHandler.getSourceLineVO() && this.quoteLineUpgradeHandler.getUpgradeLineVO()) {
								this.addEventListener('value-changed', this._quantityChanged);
								this.assetUpgradeQuantityCalculator = new AssetUpgradeQuantityCalculator(this.quoteLineUpgradeHandler);
							}
						}
					}
				}, {
					key: '_datePickerOpened',
					value: function _datePickerOpened(e) {
						var dateContainer = e.detail.dateContainer,
						    datepicker = e.detail.datepicker,
						    dateRow = datepicker.offsetParent;

						var dateRowRect = dateRow.getBoundingClientRect(),
						    dateContainerRect = dateContainer.getBoundingClientRect();

						datepicker.style.left = -dateRowRect.left + dateContainerRect.left + 'px';
						datepicker.style.top = dateContainerRect.bottom - dateRowRect.top + 'px';

						if (dateContainerRect.left + datepicker.offsetWidth > window.innerWidth) {
							datepicker.style.left = '';
							datepicker.style.right = dateRowRect.right - dateContainerRect.right + 17 + 'px';
						}

						e.stopPropagation();
					}
				}, {
					key: '_modelIsChanged',
					value: function _modelIsChanged() {
						this.wasModelIsChangedCalledBeforeAttached = !this.isAttached;
						if (!this.isAttached || !this.model) return;

						if (this.item === this.constants.SUBSCRIPTION_SCOPE_FIELD && !this.model.subscriptionScopeEditable) return;

						this.isMobile = this.viewport && this.viewport.isMobile();


						var editable = this._setEditable();
						if (this.item === this.constants.ADDITIONAL_DISCOUNT_FIELD || this.item === this.constants.MARKUP_FIELD) {
							this.$.field.discountDetails = new DiscountConverter(this.model, this.item);
							if (!editable && !this.model.groupModel.quoteModel.isAmendment) {
								return;
							}
						}

						var fieldMD = this._setFieldMD();
						if (this._setFieldClassAndFieldContent(fieldMD)) return;

						if (fieldMD.defaultValue && this.value == null && !(fieldMD.controllingPicklist || fieldMD.dependentPicklist)) this.value = fieldMD.defaultValue;

						if (this.data && this.value != this.data[this.item]) {
							this.value = this.data[this.item];
						}

						this.$.field.editing = editable;
						this.$.field.md = fieldMD;
						this.$.field.property = this.item;
					}
				}, {
					key: 'resetDiscount',
					value: function resetDiscount(e) {
						if (this.$.field.discountDetails && (!e.detail.groupKey || e.detail.groupKey == this.model.groupModel.groupVO.key)) {
							this.$.field.discountDetails.setDiscountValue(null);
							this.value = null;
						}
					}
				}, {
					key: '_updateOriginalValue',
					value: function _updateOriginalValue() {
						if (this.model.lineVO) {
							this.model.lineVO._transient_ = this.model.lineVO._transient_ || {};
							this.model.lineVO._transient_.original = this.model.lineVO._transient_.original || JSON.parse(JSON.stringify(this.model.lineVO.record));
						}
						var originalRecord = this.get('model.lineVO._transient_.original');

						this.$.field.originalValue = this.item !== this.constants.ADDITIONAL_DISCOUNT_FIELD ? originalRecord[this.item] : originalRecord[this.item] / originalRecord[this.constants.QUANTITY_FIELD];
					}
				}, {
					key: '_dataOrValueChanged',
					value: function _dataOrValueChanged() {
						if (this.value != this.data[this.item]) return;

						this.internal = true;
						if (this.model && this.item === this.constants.ADDITIONAL_DISCOUNT_FIELD && this.$.field.discountDetails) {
							this.$.field.discountDetails = new DiscountConverter(this.model, this.item);
						} else {
							if (this.userChangedLookupValue) {
								this._updateRelationshipName();
							} else {
								this._updateLookupDisplayValue();
							}
						}
						this.$.field.value = this.value;
						this.internal = false;
						this.userChangedLookupValue = false;
					}
				}, {
					key: '_updateRelationshipName',
					value: function _updateRelationshipName() {
						if (!this.model) return;
						var rfm = new RelationshipFieldManager(this.item, this.data);
						rfm.addRelationshipName(this.value, this.display, this.model.getFieldMD(this.item).referenceTo[0]);
					}
				}, {
					key: '_updateLookupDisplayValue',
					value: function _updateLookupDisplayValue() {
						var rfm = new RelationshipFieldManager(this.item, this.data);
						if (rfm.hasRelationship()) {
							this.display = rfm.getRelationshipName();
						} else {
							this.display = undefined;
						}
					}
				}, {
					key: '_displayChanged',
					value: function _displayChanged() {
						this.userChangedLookupValue = !this.internal;
					}
				}, {
					key: '_setEditable',
					value: function _setEditable() {
						if (this.item == this.constants.SEGMENT_LABEL_FIELD || this.index === 0 && this.isMobile) {
							return false;
						} else {
							return this.model.isEditable(this.item);
						}
					}
				}, {
					key: '_editableChanged',
					value: function _editableChanged() {
						this.$.field.editing = this.model.isEditable(this.item);
					}
				}, {
					key: '_setFieldMD',
					value: function _setFieldMD() {
						var fieldMD = this.model.getFieldMD(this.item) ? this.model.getFieldMD(this.item) : this.model.getFieldMD(this.constants.NET_TOTAL_FIELD);
						fieldMD.CurrencyIsoCode = this.model.groupModel.quoteModel.quoteVO.record.CurrencyIsoCode;

						if (this.constants.QUANTITY_FIELDS && this.constants.QUANTITY_FIELDS.has(this.item)) {
							if (this.model.lineVO.productQuantityScale != null) {
								fieldMD = Object.assign({}, fieldMD, { scale: this.model.lineVO.productQuantityScale });
							}
						}
						return fieldMD;
					}
				}, {
					key: '_setFieldClassAndFieldContent',
					value: function _setFieldClassAndFieldContent(fieldMD) {
						var fieldClass = '';
						if (this.model.editorModel.data.settings.productHierarchyVisualized && !this.model.segmented) {
							if (!this.isMobile) {
								if (this.item === this.constants.PRODUCT_NAME_FIELD) {
									if (this.model.bundle) {
										fieldClass += ICON_CLASS + ' ';
									} else {
										if (!this.model.component) {
											fieldClass += TOP_LEVEL_CLASS + ' ';
										}
									}
									if (this.model.component) {
										if (!this.model.bundle) {
											fieldClass += OPTION_CLASS + ' ';
										}
										fieldClass += '' + INDENT_CLASS + this.record[this.constants.OPTION_LEVEL_FIELD];
									}
								}
							} else {
								if (this.item === this.constants.PRODUCT_NAME_FIELD || this.item === this.constants.NET_TOTAL_FIELD) {
									fieldClass += '' + INDENT_CLASS + this.record[this.constants.OPTION_LEVEL_FIELD];
								}
							}
						}

						if (fieldMD.type == 'number' || fieldMD.type == 'double' || fieldMD.type == 'percent' || fieldMD.type == 'currency') {
							fieldClass += ' right';
						}

						if (fieldMD.type == 'boolean') {
							fieldClass += ' center';
						}

						if (this.model.bundled && this.item === this.constants.LIST_PRICE_FIELD) {
							this.overrideValue = AppContext.properties.i18n.value().l('Included');
							fieldClass += ' overridden';
							this.fieldClass = fieldClass;
							return true;
						}
						var localizedValue = Localizer.getLocalizedValue(this.model, this.item);
						if (localizedValue) {
							this.overrideValue = localizedValue;
							fieldClass += ' overridden';
							this.fieldClass = fieldClass;
							return true;
						}
						this.fieldClass = fieldClass;

						return false;
					}
				}, {
					key: '_quantityChanged',
					value: function _quantityChanged(e) {
						if (this.model.internalUpdate) {
							return;
						}
						this.assetUpgradeQuantityCalculator.setQuantitiesByRatio();
						var indexes = this.quoteLineUpgradeHandler.getIndexes();

						var sourceLineVO = this.quoteLineUpgradeHandler.getSourceLineVO();
						var upgradeLineVO = this.quoteLineUpgradeHandler.getUpgradeLineVO();

						this.fire('upgrade-asset-quantity-changed', {
							sourceIndex: indexes["sourceIndex"],
							upgradeIndex: indexes["upgradeIndex"],
							sourceLineVO: sourceLineVO,
							upgradeLineVO: upgradeLineVO
						});
					}
				}, {
					key: '_handleFieldValueChanged',
					value: function _handleFieldValueChanged() {
						if (this.calculateImmediately) {
							this.fire('calculate-immediately');
						}
						if (this.item == this.constants.PRICE_EDITABLE_FIELD) {
							this.fire('price-editable-changed');
						}
					}
				}, {
					key: '_showDetails',
					value: function _showDetails(e) {
						var type = e.type;
						if (this.model.segmented && !/__c$/.test(this.item) && this.item != 'total') {
							this.detailsOnHover = type == 'mouseenter';
						}
					}
				}, {
					key: '_getLineModel',
					value: function _getLineModel() {
						if (this.item != 'total' && this.model.segmentsByLabel != null) {
							var lineModelKeys = Object.keys(this.model.segmentsByLabel);
							var lineModelKeysLength = lineModelKeys.length;
							for (var i = 0; i < lineModelKeysLength; i++) {
								var key = lineModelKeys[i].replace(/\W/g, '');
								if (key == this.item) {
									return this.model.segmentsByLabel[lineModelKeys[i]];
								}
							}
						}
						return this.model;
					}
				}, {
					key: '_getRecord',
					value: function _getRecord() {
						return this._getLineModel().lineVO.record;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_modelIsChanged(model, index, viewport)', '_displayChanged(display)', '_dataOrValueChanged(data, value, item)', '_updateOriginalValue(model, item)', '_editableChanged(editable, model, item)'];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'tap': '_onTap',
							'datepicker-opened': '_datePickerOpened',
							'sb-field-on-change-field': '_handleFieldValueChanged'
						};
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.model.editorModel.constants;
					}
				}, {
					key: 'record',
					get: function get() {
						return this.model.lineVO.record;
					},
					set: function set(val) {
						this.model.lineVO.record = val;
					}
				}]);

				return LETableCell;
			}());

			_export('LETableCell', LETableCell);

			Polymer(LETableCell);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-table-cell/Localizer.js', [], function (_export, _context) {
	var _createClass, Localizer;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Localizer', Localizer = function () {
				function Localizer() {
					_classCallCheck(this, Localizer);
				}

				_createClass(Localizer, null, [{
					key: 'getLocalizedValue',
					value: function getLocalizedValue(model, item, lookupNameField) {
						var constants = model.editorModel.constants;
						var productLocalization = model.groupModel.quoteModel.quoteVO.localizationByFieldByProductId[model.getField(constants.PRODUCT)];
						var fieldMD = model.getFieldMD(item);
						if (!productLocalization || !fieldMD) {
							return;
						}

						var prefix = model.editorModel.data.developerPrefix;
						var fieldName = fieldMD && fieldMD.calculatedFormula && fieldMD.calculatedFormula.indexOf(prefix + 'Product__r') === 0 ? fieldMD.calculatedFormula.split('.')[1].replace(prefix, '') : fieldMD.name;

						var productFieldLocalization = lookupNameField ? productLocalization[fieldName][lookupNameField] : productLocalization[fieldName];
						if (!productFieldLocalization) {
							return;
						}

						return productFieldLocalization.record[constants.TEXT_FIELD] || productFieldLocalization.record[constants.TEXT_AREA_FIELD] || productFieldLocalization.record[constants.LONG_TEXT_AREA_FIELD] || productFieldLocalization.record[constants.RICH_TEXT_AREA_FIELD];
					}
				}]);

				return Localizer;
			}());

			_export('Localizer', Localizer);
		}
	};
});

"use strict";

System.register("quotes/layout/sb-le-table-cell/QuoteLineUpgradeHandler.js", [], function (_export, _context) {
    var _createClass, QuoteLineUpgradeHandler;

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }

    return {
        setters: [],
        execute: function () {
            _createClass = function () {
                function defineProperties(target, props) {
                    for (var i = 0; i < props.length; i++) {
                        var descriptor = props[i];
                        descriptor.enumerable = descriptor.enumerable || false;
                        descriptor.configurable = true;
                        if ("value" in descriptor) descriptor.writable = true;
                        Object.defineProperty(target, descriptor.key, descriptor);
                    }
                }

                return function (Constructor, protoProps, staticProps) {
                    if (protoProps) defineProperties(Constructor.prototype, protoProps);
                    if (staticProps) defineProperties(Constructor, staticProps);
                    return Constructor;
                };
            }();

            _export("QuoteLineUpgradeHandler", QuoteLineUpgradeHandler = function () {
                function QuoteLineUpgradeHandler(model) {
                    _classCallCheck(this, QuoteLineUpgradeHandler);

                    this.model = model;
                    this.indexes = {};
                }

                _createClass(QuoteLineUpgradeHandler, [{
                    key: "isSourceLine",
                    value: function isSourceLine() {
                        return this.model.existing;
                    }
                }, {
                    key: "getLine",
                    value: function getLine() {
                        return this.model.lineVO;
                    }
                }, {
                    key: "getLines",
                    value: function getLines() {
                        return this.model.groupModel.standardLines;
                    }
                }, {
                    key: "getSourceOrUpgrade",
                    value: function getSourceOrUpgrade(source) {
                        var sourceOrUpgradeLineVO = void 0;
                        if (this.model.editorModel.data.settings.bundleKeptTogether) {
                            sourceOrUpgradeLineVO = this._findLineWithTargetAssetId(source, this.model.groupModel);
                        } else {
                            var groups = this.model.groupModel.quoteModel.lineGroups;
                            for (var i = 0, groupCount = groups.length; i < groupCount; i++) {
                                if (sourceOrUpgradeLineVO) {
                                    break;
                                }
                                sourceOrUpgradeLineVO = this._findLineWithTargetAssetId(source, groups[i]);
                            }
                        }
                        return sourceOrUpgradeLineVO;
                    }
                }, {
                    key: "_findLineWithTargetAssetId",
                    value: function _findLineWithTargetAssetId(source, group) {
                        var seekExistingLine = source ? false : true;
                        var lineVO = void 0;
                        var targetAssetId = this.model.lineVO.record[this.constants.UPGRADED_ASSET_FIELD];

                        for (var i = 0, lineCount = group.standardLines.length; i < lineCount; i++) {
                            var line = group.standardLines[i];
                            if (line.lineVO.record[this.constants.UPGRADED_ASSET_FIELD] === targetAssetId && line.lineVO.record[this.constants.EXISTING_FIELD] === seekExistingLine) {
                                var key = seekExistingLine ? "sourceIndex" : "upgradeIndex";
                                this.indexes[key] = i;
                                lineVO = line.lineVO;
                            }
                            if (this.model.lineVO.key === line.lineVO.key) {
                                var key2 = !this.indexes["sourceIndex"] && this.model.existing ? "sourceIndex" : "upgradeIndex";
                                this.indexes[key2] = i;
                            }
                        }
                        return lineVO;
                    }
                }, {
                    key: "setSourceAndUpgrade",
                    value: function setSourceAndUpgrade(sourceLineVO, upgradeLineVO) {
                        this.sourceLineVO = sourceLineVO;
                        this.upgradeLineVO = upgradeLineVO;
                    }
                }, {
                    key: "getSourceIdField",
                    value: function getSourceIdField() {
                        return this.constants.PRODUCT;
                    }
                }, {
                    key: "getUpgradeConversionRateField",
                    value: function getUpgradeConversionRateField() {
                        return this.constants.UPGRADE_CONVERSION_RATE;
                    }
                }, {
                    key: "getSourceCurrentQuantityField",
                    value: function getSourceCurrentQuantityField(sourceLineVO) {
                        return sourceLineVO.record[this.constants.QUANTITY_FIELD];
                    }
                }, {
                    key: "getUpgradeCurrentQuantityField",
                    value: function getUpgradeCurrentQuantityField(upgradeLineVO) {
                        return upgradeLineVO.record[this.constants.QUANTITY_FIELD];
                    }
                }, {
                    key: "getSourcePriorQuantity",
                    value: function getSourcePriorQuantity(sourceLineVO) {
                        return sourceLineVO.record[this.constants.PRIOR_QUANTITY_FIELD];
                    }
                }, {
                    key: "didSourceQuantityChange",
                    value: function didSourceQuantityChange(didUserChangeSourceLine) {
                        return didUserChangeSourceLine;
                    }
                }, {
                    key: "didUpgradeQuantityChange",
                    value: function didUpgradeQuantityChange(didUserChangeSourceLine) {
                        return !didUserChangeSourceLine;
                    }
                }, {
                    key: "isSelected",
                    value: function isSelected() {
                        return true;
                    }
                }, {
                    key: "setUpdatedQuantity",
                    value: function setUpdatedQuantity(sourceLineVO, upgradeLineVO, sourceQtyAfterUpdate, upgradeQtyAfterUpdate) {
                        sourceLineVO.record[this.constants.QUANTITY_FIELD] = sourceQtyAfterUpdate;
                        upgradeLineVO.record[this.constants.QUANTITY_FIELD] = upgradeQtyAfterUpdate;
                    }
                }, {
                    key: "getIndexes",
                    value: function getIndexes() {
                        return this.indexes;
                    }
                }, {
                    key: "getSourceLineVO",
                    value: function getSourceLineVO() {
                        return this.sourceLineVO;
                    }
                }, {
                    key: "getUpgradeLineVO",
                    value: function getUpgradeLineVO() {
                        return this.upgradeLineVO;
                    }
                }, {
                    key: "constants",
                    get: function get() {
                        return this.model.fieldNames;
                    }
                }]);

                return QuoteLineUpgradeHandler;
            }());

            _export("QuoteLineUpgradeHandler", QuoteLineUpgradeHandler);
        }
    };
});

'use strict';

System.register('quotes/layout/sb-le-table-cell/Swiper.js', [], function (_export, _context) {
	var _createClass, SWIPE_DISTANCE, OPEN_DISTANCE, SWIPE_MARGIN, swiping, Swiper;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			SWIPE_DISTANCE = 75;
			OPEN_DISTANCE = -185;
			SWIPE_MARGIN = 50;
			swiping = false;

			_export('Swiper', Swiper = function () {
				function Swiper(cell) {
					_classCallCheck(this, Swiper);

					this.cell = cell;
					this.primaryCells = cell.parentElement.querySelectorAll('.primary');
				}

				_createClass(Swiper, [{
					key: 'swipe',
					value: function swipe(detail) {
						if (!this.leTableRow) this.leTableRow = this.cell.domHost.domHost;
						var open = this.cell.classList.contains('open');

						switch (detail.state) {
							case 'start':
								if (Math.abs(detail.dy) > SWIPE_MARGIN || !open && detail.dx > 0 || open && detail.dx < 0) return;
								swiping = true;
								this.leTableRow.classFollows('open', null, this.leTableRow.$$('.tr'));
								for (var i = 0, pcLength = this.primaryCells.length; i < pcLength; i++) {
									this.primaryCells[i].style.position = 'relative';
								}break;
							case 'track':
								if (!swiping) return;
								for (var i = 0, pcLength = this.primaryCells.length; i < pcLength; i++) {
									this.primaryCells[i].style.left = (open ? OPEN_DISTANCE : 0) + detail.dx + 'px';
								}break;
							case 'end':
								if (!swiping) return;
								swiping = false;
								for (var i = 0, pcLength = this.primaryCells.length; i < this.primaryCells.length; i++) {
									this.primaryCells[i].style.left = '';
									this.primaryCells[i].style.position = '';
									if (detail.dx < -SWIPE_DISTANCE) {
										this.primaryCells[i].classFollows('open', this.primaryCells[i]);
										open = true;
									} else if (detail.dx > SWIPE_DISTANCE) {
										this.primaryCells[i].classFollows('open', null, this.primaryCells[i]);
										open = false;
									}
								}
								if (open) this.leTableRow.classFollows('open', this.leTableRow.$$('.tr'));
						}
					}
				}]);

				return Swiper;
			}());

			_export('Swiper', Swiper);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-table-header/LETableHeader.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, LETableHeader;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LETableHeader', LETableHeader = function () {
				function LETableHeader() {
					_classCallCheck(this, LETableHeader);
				}

				_createClass(LETableHeader, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-table-header';
						this.properties = {
							lineModels: {
								type: Object,
								notify: true
							},
							fieldNames: Array,
							fieldLabelsMap: Object,
							fieldClasses: {
								type: Object,
								value: {}
							},
							constants: Object,
							fields: Object,
							settings: Object,
							actionsOnTheLeft: {
								type: Boolean,
								default: false,
								computed: '_getActionsPlacement(settings)'
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: '_getActionsPlacement',
					value: function _getActionsPlacement() {
						return this.settings.actionsColumnPlacement == 'Left';
					}
				}, {
					key: '_buildRows',
					value: function _buildRows() {
						var group = [],
						    fieldsRenderedAsNumber = {};

						for (var i = 0, len = this.fieldNames.length; i < len; i++) {
							var fieldName = this.fieldNames[i];
							group.push(fieldName);

							var fieldMD = this.fields[fieldName];
							if (fieldMD && (fieldMD.type == 'number' || fieldMD.type == 'double' || fieldMD.type == 'percent' || fieldMD.type == 'currency')) {
								fieldsRenderedAsNumber[this.fieldLabelsMap[fieldName]] = true;
							} else if (fieldMD && fieldMD.type == 'boolean') {
								this.fieldClasses[fieldMD.name] = 'center';
							}
						}

						if (this.columnNames) {
							for (var j = 0, _len = this.columnNames.length; j < _len; j++) {
								var columnName = this.columnNames[j].replace(/\W/g, '');
								group.push(columnName);
								fieldsRenderedAsNumber[this.fieldLabelsMap[columnName]] = true;
							}

							group.push('total');
							this.fieldClasses[this.constants.SEGMENT_LABEL_FIELD] = 'hiddenInMobile';
							fieldsRenderedAsNumber[this.fieldLabelsMap['total']] = true;
						}

						if (this.header && this.header.group.length != group.length) {
							this.header.destroyGroup();
						}

						this.header = this.$.header;
						this.data = undefined;
						this.header.model = fieldsRenderedAsNumber;
						this.header.model.isStandard = !(this.columnNames && this.columnNames.length > 0);
						this.header.model.settings = this.settings;
						this.header.itemClassMap = this.fieldClasses;
						this.header.groupClass = this.viewport && this.viewport.isMobile() ? 'tgroup' : 'leGroup';
						this.header.columnWidths = this.columnWidths;
						if (!this.header.group) this.header.group = group;
						this.data = this.fieldLabelsMap;

						if (this.columnNames) {
							this.expansionIconClass = 'sf-icon-right';
						}
					}
				}, {
					key: '_columnWidthsChanged',
					value: function _columnWidthsChanged() {
						if (!this.header || this.viewport && this.viewport.isMobile()) return;
						this.header.columnWidths = this.columnWidths;
					}
				}, {
					key: 'toggleAllLinesExpansion',
					value: function toggleAllLinesExpansion() {
						var expanded = this.expansionIconClass != 'sf-icon-right';
						this.expansionIconClass = !expanded ? 'sf-icon-down' : 'sf-icon-right';
						for (var i = 0, l = this.lineModels.length; i < l; i++) {
							this.set('lineModels.' + i + '.lineVO.expanded', !expanded);
							this.set('lineModels.' + i + '.expandedIconClass', this.expansionIconClass);
						}
					}
				}, {
					key: 'toggleAllCheckBoxes',
					value: function toggleAllCheckBoxes() {
						for (var i = 0, l = this.lineModels.length; i < l; i++) {
							this.set('lineModels.' + i + '.selected', this.selected);
						}
					}
				}, {
					key: 'deselectCheckbox',
					value: function deselectCheckbox() {
						this.set('selected', false);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_buildRows(fieldNames, columnNames, fieldLabelsMap, fields, constants, columnWidths, settings)', '_columnWidthsChanged(columnWidths)'];
					}
				}]);

				return LETableHeader;
			}());

			_export('LETableHeader', LETableHeader);

			Polymer(LETableHeader);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-table-header-cell/LETableHeaderCell.js', ['common/core/AppContext.js', 'quotes/models/Constants.js'], function (_export, _context) {
	var AppContext, Constants, _createClass, LETableHeaderCell;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_quotesModelsConstantsJs) {
			Constants = _quotesModelsConstantsJs.Constants;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LETableHeaderCell', LETableHeaderCell = function () {
				function LETableHeaderCell() {
					_classCallCheck(this, LETableHeaderCell);
				}

				_createClass(LETableHeaderCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-table-header-cell';
						this.properties = {
							byOrder: String,
							model: {
								type: Object,
								observer: '_modelChanged'
							},
							showSortableHeader: {
								type: Boolean,
								computed: '_showSortableHeader(model)'
							},
							prefix: {
								type: String,
								value: function value() {
									this.constants = new Constants(AppContext.org.prefix + '__');
									return AppContext.org.prefix;
								}
							},
							overflowTrue: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: '_modelChanged',
					value: function _modelChanged() {
						Polymer.dom(this.$.headerCell).observeNodes(function () {
							var headerNode = this.$$('#header');
							this.toggleClass('right', this.model[this.value], headerNode);
							var bundlesVisualized = this.model.settings && this.model.settings.productHierarchyVisualized && this.model.isStandard && this.getAttribute('item') === this.constants.PRODUCT_NAME_FIELD;
							this.toggleClass('bundlesVisualized', bundlesVisualized, headerNode);
						}.bind(this));
					}
				}, {
					key: 'sortLines',
					value: function sortLines(e) {
						var newSort = "";

						var headers = this.parentElement.children;

						for (var i = 0; i < headers.length; i++) {
							headers[i].toggleClass('asc', false, headers[i].$$('#header'));
							headers[i].toggleClass('desc', false, headers[i].$$('#header'));
							headers[i].$$('#arrow') ? headers[i].toggleClass('sf-icon-arrowup', true, headers[i].$$('#arrow')) : null;
							headers[i].$$('#arrow') ? headers[i].toggleClass('sf-icon-arrowdown', false, headers[i].$$('#arrow')) : null;
							Polymer.dom(headers[i]).classList.remove('column-selected');
						}

						if (!this.byOrder) {
							newSort = 'asc';
							this.toggleClass('sf-icon-arrowup', true, this.$$('#arrow'));
						} else if (this.byOrder === 'asc') {
							newSort = 'desc';
							this.toggleClass('sf-icon-arrowup', false, this.$$('#arrow'));
							this.toggleClass('sf-icon-arrowdown', true, this.$$('#arrow'));
						} else if (this.byOrder === 'desc') {
							newSort = '';
						}

						this.sortByField = newSort ? this._getKeyByValue(this.value, this.data) : null;
						this.toggleClass('column-selected', newSort);
						this.byOrder = newSort;
						if (newSort) {
							this.toggleClass(newSort, true, this.$$('#header'));
						}
						this.fire('table-header-sort-clicked', { order: this.byOrder, field: this.sortByField });
					}
				}, {
					key: '_showSortableHeader',
					value: function _showSortableHeader() {
						if (this.model.lineVO || this.getAttribute('item') === this.constants.ADDITIONAL_DISCOUNT_FIELD || this.classList.contains('hoverFieldHeader')) {
							return false;
						}
						return true;
					}
				}, {
					key: '_getKeyByValue',
					value: function _getKeyByValue(value, object) {
						for (var prop in object) {
							if (object.hasOwnProperty(prop)) {
								if (object[prop] === value) return prop;
							}
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}]);

				return LETableHeaderCell;
			}());

			_export('LETableHeaderCell', LETableHeaderCell);

			Polymer(LETableHeaderCell);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-table-row/LETableRow.js', ['../../../common/core/sb-page-container/PageContainer.js', '../../../common/core/AppContext.js', 'common/signal/RowFocusSignaler.js'], function (_export, _context) {
	var PageContainer, AppContext, RowFocusSignaler, _createClass, LETableRow;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonSignalRowFocusSignalerJs) {
			RowFocusSignaler = _commonSignalRowFocusSignalerJs.RowFocusSignaler;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LETableRow', LETableRow = function () {
				function LETableRow() {
					_classCallCheck(this, LETableRow);
				}

				_createClass(LETableRow, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-table-row';

						this.listeners = {
							'row-swiped': 'onRowSwiped',
							'price-editable-changed': 'handleListPriceEditability'
						};

						this.properties = {
							lineModel: {
								type: Object,
								notify: true
							},
							data: Object,
							fieldNames: Array,
							fieldLabelsMap: Object,
							columnNames: Array,
							columnWidths: Object,
							mobileCols: Array,
							lineNumber: Number,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: {
								type: Boolean,
								value: false,
								computed: '_setIsMobile(viewport)'
							},
							isDesktopAndHasNoActionsOnTheLeft: {
								type: Boolean,
								value: false
							},
							isDesktopAndHasActionsOnTheLeft: {
								type: Boolean,
								value: false
							},
							mdqFields: {
								type: Set,
								value: new Set()
							},
							expandDisabled: {
								type: Boolean,
								value: false
							},
							showCheckbox: Boolean
						};
					}
				}, {
					key: 'onRowSwiped',
					value: function onRowSwiped(e) {
						this.expandDisabled = e.detail.isOpen;
					}
				}, {
					key: '_buildRow',
					value: function _buildRow() {
						var data = {},
						    group = [],
						    itemClassMap = {};

						if (!this.columnNames) {
							data = this.lineModel.lineVO.record;
							group = this.fieldNames;
							for (var l = 0, len = group.length; l < len; l++) {
								var fieldName = this.fieldNames[l];
								if (!this.lineModel.isFieldRendered(fieldName, this.isMobile)) {
									itemClassMap[fieldName] = this.isMobile ? 'hiddenInMobile' : 'hiddenInDesktop';
								}
							}
						} else {
							for (var i = 0, len = this.fieldNames.length; i < len; i++) {
								var _fieldName = this.fieldNames[i];
								data[_fieldName] = this.record[_fieldName];
								if (!this.lineModel.isFieldRendered(_fieldName, this.isMobile)) {
									itemClassMap[_fieldName] = this.isMobile ? 'hiddenInMobile' : 'hiddenInDesktop';
								}
								group.push(_fieldName);
							}

							var totalsByColumns = {};
							for (var j = 0, len = this.lineModel.segments.length; j < len; j++) {
								var segment = this.lineModel.segments[j],
								    label = segment.lineVO.record[this.constants.SEGMENT_LABEL_FIELD].replace(/\W/g, '');
								totalsByColumns[label] = segment.lineVO.record[this.constants.NET_TOTAL_FIELD];
							}

							if (!this.isMobile) {
								for (var k = 0, len = this.columnNames.length; k < len; k++) {
									var _label = this.columnNames[k].replace(/\W/g, '');

									data[_label] = totalsByColumns[_label] >= 0 ? totalsByColumns[_label] : null;
									group.push(_label);
									this.mdqFields.add(_label);
								}
							}

							data['total'] = this.quoteVO.multiSegmentRowTotals[this.record[this.constants.SEGMENT_KEY_FIELD]];
							group.push('total');
							this.mdqFields.add('total');
							itemClassMap['total'] = 'hiddenInMobile';
						}

						this.lineNumber = this.record[this.constants.NUMBER_FIELD];

						this.invalidPricebookEntry = this.lineModel.lineVO.validPricebookEntryExists == false;
						this.opportunityWarning = this.lineModel.groupModel.quoteModel.isPrimary && this.lineModel.lineVO.opportunityLineItemExists == false && this.invalidPricebookEntry;

						this.invalidEntryWarning = this.invalidPricebookEntry && !this.opportunityWarning;

						this.isDesktopAndHasActionsOnTheLeft = !this.isMobile && this.lineModel.editorModel.actionsOnTheLeft;
						this.isDesktopAndHasNoActionsOnTheLeft = !this.isMobile && !this.lineModel.editorModel.actionsOnTheLeft;

						if (this.$$('.tr').classList.contains('open')) this.classFollows('open', null, this.$$('.tr'));

						this.set('lineModel.selected', false);

						this.row = this.$$('#row');

						if (this.row && this.row.group.length != group.length) {
							this.row.destroyGroup();
						}

						if (this.isMobile) {
							Polymer.dom.flush();
						}

						this.data = undefined;
						this.groupClass = this.viewport && this.viewport.isMobile() ? 'tgroup' : 'leGroup';
						this.itemClassMap = itemClassMap;
						this.widths = this.columnWidths;
						this.model = this.lineModel;

						if (this.row && this.row.template) this.row.template.model = this.lineModel;
						this.primaryItems = this.mobileCols || [];
						this.groupDisplay = this.fieldLabelsMap;
						if (!this.row || !this.row.group) this.group = group;
						this.data = data;

						if (this.isMobile && this.row && (this.lineModel.lineVO.expanded || false) != (this.expanded || false)) {
							if (this.expanded == null) {
								this.lineModel.lineVO.expanded = false;
							} else {
								var evt = document.createEvent("HTMLEvents");
								evt.initEvent('tap', true, false);
								var cell = Polymer.dom(this.$$('#row').root).querySelectorAll('sb-le-table-cell')[0];
								if (cell) {
									cell.dispatchEvent(evt);
								}
							}
						}

						if (!this.isMobile) {
							this.listen(this, 'track', 'onTrack');
							this.signaler = this.signaler || new RowFocusSignaler(this, 'row', 'sb-le-table-cell', 'root');
							this.signaler.signalOnFocus('sb-row-focus-signal');
						}
					}
				}, {
					key: '_columnWidthsChanged',
					value: function _columnWidthsChanged() {
						if (!this.row || this.lineModel.editorModel.deviceContext.isMobile) return;
						this.widths = this.columnWidths;
					}
				}, {
					key: 'onTrack',
					value: function onTrack(e) {
						if (this.viewport && this.viewport.isMobile() || !AppContext.isDesktop) {
							return;
						}
						for (var a = 0, l = Polymer.dom(e).path.length; a < l; a++) {
							if (Polymer.dom(e).path[a].nodeName === 'SB-DIALOG') {
								return;
							}
						}
						this.domHost.onTrack(e);
					}
				}, {
					key: '_lineRecordChanged',
					value: function _lineRecordChanged(e) {
						if (e.path === 'lineModel.lineVO.fieldVisibility') this._visibilityChanged();else if (e.path === 'lineModel.lineVO.fieldEditability') this._editabilityChanged();else {
							var path = e.path.split('.')[e.path.split('.').length - 1];
							if (!e.path.endsWith('__c') && !e.path.endsWith('__r') && !this.mdqFields.has(path)) {
								return;
							}
							if (path == this.constants.PRICE_EDITABLE_FIELD) {
								this.handleListPriceEditability();
							}
							this.lineNumber = this.record[this.constants.NUMBER_FIELD];
							this.set('data.' + path, e.value);
						}
					}
				}, {
					key: '_visibilityChanged',
					value: function _visibilityChanged() {
						this.row = this.row || this.$$('#row');
						for (var field in this.lineModel.lineVO.fieldVisibility) {
							var visible = this.lineModel.isFieldRendered(field, this.viewport.isMobile());
							var classes = [{ class: 'hiddenInMobile', value: !visible }, { class: 'hiddenInDesktop', value: !visible }];
							this.row.set('itemClassMap.' + field, classes);
						}
					}
				}, {
					key: '_editabilityChanged',
					value: function _editabilityChanged() {
						this.row = this.row || this.$$('#row');
						this.row.itemEditableMap = this.lineModel.lineVO.fieldEditability;
					}
				}, {
					key: 'expand',
					value: function expand(e) {
						if (!this.viewport || !this.viewport.isMobile() || this.expandDisabled) {
							return;
						}

						this.$$('#row').fire('group-expanded', { path: Polymer.dom(e).path });
					}
				}, {
					key: '_expanded',
					value: function _expanded() {
						if (!this.viewport || !this.viewport.isMobile() || this.expandDisabled) {
							return;
						}

						this.enableEditableFields();
						this.toggleLineExpansion();
					}
				}, {
					key: 'toggleLineExpansion',
					value: function toggleLineExpansion() {
						if (this.lineModel.lineVO.expanded != this.expanded) {
							this.set('lineModel.lineVO.expanded', !this.lineModel.lineVO.expanded);
						}
						this.set('lineModel.expandedIconClass', !this.lineModel.lineVO.expanded ? 'sf-icon-right' : 'sf-icon-down');
					}
				}, {
					key: 'enableEditableFields',
					value: function enableEditableFields() {
						var cells = Polymer.dom(this.$$('#row').root).querySelectorAll('sb-le-table-cell');
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = cells[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var cell = _step.value;

								cell.$$('sb-field').renderReadOnly = false;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'handleListPriceEditability',
					value: function handleListPriceEditability() {
						if (!this.lineModel.lineVO.fieldEditability) {
							this.row = this.row || this.$$('#row');
							var editableMap = {};
							editableMap[this.constants.LIST_PRICE_FIELD] = this.lineModel.isEditable(this.constants.LIST_PRICE_FIELD);
							this.row.itemEditableMap = editableMap;
						}
					}
				}, {
					key: 'toggleOptional',
					value: function toggleOptional(e) {
						if (!e.detail.groupKey || e.detail.groupKey == this.lineModel.groupModel.groupVO.key) {
							this.set('data.' + this.constants.OPTIONAL_FIELD, e.detail.toggleOptionalBoolean);
						}
					}
				}, {
					key: '_setIsMobile',
					value: function _setIsMobile(viewport) {
						if (viewport) {
							return viewport.isMobile();
						}
					}
				}, {
					key: '_toggleSelection',
					value: function _toggleSelection(e) {
						var multiLineDeleteEnabled = this.lineModel ? this.lineModel.editorModel.data.settings.multiLineDeleteEnabled : true;
						var mobileDrawerOpened = this.isMobile && e.detail && e.detail.drawerState === 'open';
						this.showCheckbox = multiLineDeleteEnabled && !this.expandDisabled && !mobileDrawerOpened;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_buildRow(fieldNames, columnNames, lineModel, columnWidths, viewport)', '_lineRecordChanged(lineModel.*)', '_columnWidthsChanged(columnWidths)', '_expanded(expanded)', '_toggleSelection(lineModel, expandDisabled)'];
					}
				}, {
					key: 'quoteVO',
					get: function get() {
						return this.lineModel.editorModel.quoteModel.quoteVO;
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.lineModel.editorModel.constants;
					}
				}, {
					key: 'record',
					get: function get() {
						return this.lineModel.lineVO.record;
					}
				}]);

				return LETableRow;
			}());

			_export('LETableRow', LETableRow);

			Polymer(LETableRow);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-segmented-detail-row/SegmentedDetailRow.js', ['quotes/models/LineModel.js', '../../../common/core/sb-page-container/PageContainer.js', 'common/signal/RowFocusSignaler.js'], function (_export, _context) {
	var LineModel, PageContainer, RowFocusSignaler, _createClass, SegmentedDetailRow;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsLineModelJs) {
			LineModel = _quotesModelsLineModelJs.LineModel;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonSignalRowFocusSignalerJs) {
			RowFocusSignaler = _commonSignalRowFocusSignalerJs.RowFocusSignaler;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SegmentedDetailRow', SegmentedDetailRow = function () {
				function SegmentedDetailRow() {
					_classCallCheck(this, SegmentedDetailRow);
				}

				_createClass(SegmentedDetailRow, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-segmented-detail-row';
						this.properties = {
							lineModel: {
								type: Object,
								notify: true
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							itemClassMap: {
								type: Object,
								value: {}
							},
							highlightRowOnFocus: {
								type: Boolean,
								observer: '_highlightRowOnFocus'
							}
						};
					}
				}, {
					key: '_lineModelChanged',
					value: function _lineModelChanged() {
						this.dimension = this.lineModel.lineVO.dimensionType;
						this.segmentModel = this.lineModel.segmentsByLabel[this.columnName] ? this.lineModel.segmentsByLabel[this.columnName] : new LineModel({ key: null, record: {} }, this.lineModel.groupModel);
						this.itemClassMap[this.constants.SEGMENT_LABEL_FIELD] = 'hiddenInDesktop';

						var column = this.$$('#column');
						if (this.viewport && this.viewport.isMobile() && column && (this.lineModel.lineVO.expanded || false) != (this.expanded || false)) {
							var evt = document.createEvent("HTMLEvents");
							evt.initEvent('tap', true, false);
							var cell = Polymer.dom(column.root).querySelectorAll('sb-le-table-cell')[0];
							if (cell) {
								cell.dispatchEvent(evt);
							}
						}
					}
				}, {
					key: '_setGroup',
					value: function _setGroup() {
						if (!this.$.column.group) this.$.column.group = this.detailFieldNames;
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.expanded = false;
					}
				}, {
					key: '_lineRecordChanged',
					value: function _lineRecordChanged(e) {
						if (this.internal) return;

						var firstIndex = e.path.indexOf('#');
						var lastIndex = e.path.indexOf('.', firstIndex);
						var segmentNumber = e.path.substring(firstIndex + 1, lastIndex);
						if (!this._pathRefersToMySegmentRecord(segmentNumber)) {
							return;
						}
						this.set('segmentRecord.' + e.path.split('.')[e.path.split('.').length - 1], e.value);
					}
				}, {
					key: '_pathRefersToMySegmentRecord',
					value: function _pathRefersToMySegmentRecord(segmentNumber) {
						if (!this.segmentRecord) {
							return false;
						}
						if (!this.lineModel.segments[segmentNumber]) {
							return false;
						}
						var referencedSegmentVO = this.lineModel.segments[segmentNumber].lineVO;
						var referencedKey = referencedSegmentVO.record[this.constants.SEGMENT_KEY_FIELD];
						var referencedIndex = referencedSegmentVO.record[this.constants.SEGMENT_INDEX_FIELD];
						var referencedLabel = referencedSegmentVO.record[this.constants.SEGMENT_LABEL_FIELD];
						var mySegmentKey = this.segmentRecord[this.constants.SEGMENT_KEY_FIELD];
						var mySegmentIndex = this.segmentRecord[this.constants.SEGMENT_INDEX_FIELD];
						var mySegmentLabel = this.segmentRecord[this.constants.SEGMENT_LABEL_FIELD];
						return referencedKey === mySegmentKey && referencedIndex === mySegmentIndex && referencedLabel === mySegmentLabel;
					}
				}, {
					key: 'expand',
					value: function expand(e) {
						if (this.viewport && this.viewport.isMobile()) this.enableEditableFields();
						this.$.column.fire('group-expanded', { path: Polymer.dom(e).path });
					}
				}, {
					key: 'enableEditableFields',
					value: function enableEditableFields() {
						var cells = Polymer.dom(this.$.column.root).querySelectorAll('sb-le-table-cell');
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = cells[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var cell = _step.value;

								cell.$$('sb-field').renderReadOnly = false;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'toggleOptional',
					value: function toggleOptional(e) {
						if (!e.detail.groupKey || e.detail.groupKey == this.lineModel.groupModel.groupVO.key) {
							this.set('segmentRecord.' + this.constants.OPTIONAL_FIELD, e.detail.toggleOptionalBoolean);
						}
					}
				}, {
					key: '_highlightRowOnFocus',
					value: function _highlightRowOnFocus() {
						this.signaler = this.signaler || new RowFocusSignaler(this, 'column', 'sb-le-table-cell');
						this.signaler.signalOnFocus('sb-row-focus-signal', !this.highlightRowOnFocus);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_lineRecordChanged(lineModel.segments.*)', '_lineModelChanged(lineModel)', '_setGroup(detailFieldNames, segmentRecord, segmentModel, mobileCols, fieldLabelsMap)'];
					}
				}, {
					key: 'constants',
					get: function get() {
						return this.lineModel.editorModel.constants;
					}
				}]);

				return SegmentedDetailRow;
			}());

			_export('SegmentedDetailRow', SegmentedDetailRow);

			Polymer(SegmentedDetailRow);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-segmented-line-details/SegmentedLineDetails.js', ['quotes/models/LineModel.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var LineModel, PageContainer, _createClass, SegmentedLineDetails;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsLineModelJs) {
			LineModel = _quotesModelsLineModelJs.LineModel;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SegmentedLineDetails', SegmentedLineDetails = function () {
				function SegmentedLineDetails() {
					_classCallCheck(this, SegmentedLineDetails);
				}

				_createClass(SegmentedLineDetails, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-segmented-line-details';
						this.properties = {
							lineModel: {
								type: Object,
								notify: true
							},
							groupModel: {
								type: Object,
								notify: true
							},
							fieldNames: Array,
							detailFieldNames: Array,
							fieldLabelsMap: Object,
							columnNames: Array,
							actionsOnTheLeft: {
								type: Boolean,
								default: false,
								computed: '_getActionsPlacement(lineModel)'
							},
							itemClassMap: {
								type: Object,
								value: {}
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: '_buildRow',
					value: function _buildRow() {
						this._setColumnWidths();
						this.multiDeleteEnabled = this.lineModel.groupModel.quoteModel.editorModel.data.settings.multiLineDeleteEnabled;

						this.itemClassMap[this.lineModel.editorModel.constants.SEGMENT_LABEL_FIELD] = 'hiddenInDesktop';
						this.$.header.itemClassMap = this.itemClassMap;

						this.detailFieldNamesWithLabel = [this.lineModel.editorModel.constants.SEGMENT_LABEL_FIELD].concat(this.detailFieldNames);
						if (!this.$.header.group) this.$.header.group = this.detailFieldNamesWithLabel;
					}
				}, {
					key: '_setColumnWidths',
					value: function _setColumnWidths() {
						if (this.viewport && this.viewport.isMobile()) return;
						var colWidths = this.columnWidths;
						if (!colWidths || !this.columnNames) {
							return;
						}

						var labelColWidth = 0;
						for (var i = 0, l = this.fieldNames.length; i < l; i++) {
							var field = this.fieldNames[i];
							labelColWidth += colWidths[field];
						}
						this.fieldNamesColWidth = labelColWidth + 'px';

						for (var j = 0, len = this.columnNames.length; j < len; j++) {
							var columnName = this.columnNames[j].replace(/\W/g, '');
							this.colWidth = colWidths[columnName] + 'px';
						}

						this.totalColWidth = colWidths['total'] + 'px';
					}
				}, {
					key: '_columnWidthsChanged',
					value: function _columnWidthsChanged() {
						this._setColumnWidths();
					}
				}, {
					key: '_getActionsPlacement',
					value: function _getActionsPlacement() {
						return this.lineModel.editorModel.data.settings.actionsColumnPlacement == 'Left';
					}
				}, {
					key: 'getSegmentRecord',
					value: function getSegmentRecord(label) {
						return this.lineModel.segmentsByLabel[label] ? this.lineModel.segmentsByLabel[label].lineVO.record : new LineModel({ key: null, record: {} }, this.lineModel.groupModel).lineVO.record;
					}
				}, {
					key: 'segmentExists',
					value: function segmentExists(columnName) {
						return !this.lineModel.segmentsByLabel[columnName] ? 'desktopOnly' : '';
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_buildRow(detailFieldNames, fieldNames, lineModel, columnWidths)', '_columnWidthsChanged(columnWidths)'];
					}
				}]);

				return SegmentedLineDetails;
			}());

			_export('SegmentedLineDetails', SegmentedLineDetails);

			Polymer(SegmentedLineDetails);
		}
	};
});

'use strict';

System.register('quotes/md/sb-le-field-md/LEFieldMD.js', ['common/core/AppContext.js', 'quotes/models/Constants.js'], function (_export, _context) {
	var AppContext, Constants, _createClass, LEFieldMD;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_quotesModelsConstantsJs) {
			Constants = _quotesModelsConstantsJs.Constants;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LEFieldMD', LEFieldMD = function () {
				function LEFieldMD() {
					_classCallCheck(this, LEFieldMD);
				}

				_createClass(LEFieldMD, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-field-md';
						this.properties = {
							data: {
								type: Object
							},
							prefix: {
								type: String,
								value: function value() {
									return AppContext.org.prefix ? AppContext.org.prefix + '__' : '';
								}
							},
							md: {
								type: Object,
								notify: true
							},
							error: {
								type: Object,
								notify: true
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.describe.addEventListener('describe-changed', function (e) {
							var md = e.detail.value.md,
							    fieldsMap = {},
							    fieldLabelsMap = {};

							if (!this.constants) this.constants = new Constants(this.prefix);

							var unitPriceFields = this.constants.UNIT_PRICE_FIELDS;
							var quantityFields = this.constants.QUANTITY_FIELDS;
							for (var item in md) {
								var parts = item.split("."),
								    objName = parts[0],
								    fieldName = parts[1];

								if (!fieldsMap[objName]) {
									fieldsMap[objName] = {};
								}

								if (unitPriceFields.has(md[item].name)) {
									md[item].scale = this.settings.priceScale;
								} else if (md[item].type == 'currency' && this.settings.isMultiCurrencyOrg) {
									md[item].scale = this.settings.currencyDecimalScale;
								} else if (quantityFields.has(md[item].name)) {
									md[item].scale = this.settings.quantityScale || this.settings.quantityScale === 0 ? this.settings.quantityScale : md[item].scale;
								}

								fieldsMap[objName][fieldName] = md[item];
								fieldLabelsMap[fieldName] = md[item].label;
							}

							this.md = { fieldsMap: fieldsMap, fieldLabelsMap: fieldLabelsMap };
						}.bind(this));

						this.$.describe.addEventListener('error-changed', function (e) {
							this.error = e.detail.value;
						}.bind(this));
					}
				}, {
					key: 'getFieldNames',
					value: function getFieldNames() {
						var fieldNames = [];
						for (var obj in this.data) {
							for (var i = 0, l = this.data[obj].length; i < l; i++) {
								var fieldName = this.data[obj][i];
								fieldNames.push(obj + '.' + fieldName);
							}
						}

						this.$.describe.fields = fieldNames;
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['getFieldNames(data, prefix)'];
					}
				}]);

				return LEFieldMD;
			}());

			_export('LEFieldMD', LEFieldMD);

			Polymer(LEFieldMD);
		}
	};
});

'use strict';

System.register('quotes/pages/sb-line-editor/LineEditor.js', ['../../../common/core/Page.js', '../../models/EditorModel.js', 'quotes/models/GroupModel.js', 'quotes/models/DragDropModel.js', 'quotes/precaching/JSQCPrecacheWorkerManager.js', 'common/data/client/OAuthClient.js', 'common/core/AppContext.js'], function (_export, _context) {
	var Page, EditorModel, GroupModel, DragDropModel, isComponent, removeTopBottomBorderClass, JSQCPrecacheWorkerManager, OAuthClient, AppContext, _createClass, GHOST_X_OFFSET, GHOST_Y_OFFSET, LineEditor;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_modelsEditorModelJs) {
			EditorModel = _modelsEditorModelJs.EditorModel;
		}, function (_quotesModelsGroupModelJs) {
			GroupModel = _quotesModelsGroupModelJs.GroupModel;
		}, function (_quotesModelsDragDropModelJs) {
			DragDropModel = _quotesModelsDragDropModelJs.DragDropModel;
			isComponent = _quotesModelsDragDropModelJs.isComponent;
			removeTopBottomBorderClass = _quotesModelsDragDropModelJs.removeTopBottomBorderClass;
		}, function (_quotesPrecachingJSQCPrecacheWorkerManagerJs) {
			JSQCPrecacheWorkerManager = _quotesPrecachingJSQCPrecacheWorkerManagerJs.JSQCPrecacheWorkerManager;
		}, function (_commonDataClientOAuthClientJs) {
			OAuthClient = _commonDataClientOAuthClientJs.OAuthClient;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			GHOST_X_OFFSET = 53;
			GHOST_Y_OFFSET = 77;

			_export('LineEditor', LineEditor = function (_Page) {
				_inherits(LineEditor, _Page);

				function LineEditor() {
					_classCallCheck(this, LineEditor);

					return _possibleConstructorReturn(this, (LineEditor.__proto__ || Object.getPrototypeOf(LineEditor)).apply(this, arguments));
				}

				_createClass(LineEditor, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-line-editor';
						this.properties = Polymer.Base.extend({
							rawData: {
								type: Object,
								observer: '_init' },

							data: {
								type: Object,
								observer: '_dataIsChanged' },

							md: {
								type: Object,
								notify: true
							},

							editorModel: {
								type: Object,
								notify: true
							},

							groupModels: {
								type: Array
							},
							errors: {
								type: Array,
								notify: true
							},
							quoteLevelTabs: {
								type: Array,
								value: []
							},
							pageLoaded: {
								type: Boolean,
								value: false
							}
						}, Page.properties);
					}
				}, {
					key: '_loadObjectMD',
					value: function _loadObjectMD() {
						var prefix = this.app.org.prefix ? this.app.org.prefix + '__' : '';
						this.mdObjects = [prefix + 'QuoteLineGroup__c', prefix + 'QuoteLine__c', prefix + 'Quote__c', prefix + 'DiscountTier__c', prefix + 'DiscountSchedule__c'];
					}
				}, {
					key: '_executeCustomAction',
					value: function _executeCustomAction(e) {
						var customActionName = e.detail.customAction.eventHandlerName,
						    hasPermission = true;

						switch (customActionName) {
							case 'onAddProducts':
								hasPermission = AppContext.user.hasQuoteEditPermission;
								break;
							case 'onSave':
								hasPermission = AppContext.user.hasQuoteEditPermission;
								break;
							case 'onQuickSave':
								hasPermission = AppContext.user.hasQuoteEditPermission;
								break;
							case 'onFlagCalculate':
								hasPermission = AppContext.user.hasQuoteEditPermission;
								break;
						}

						if (hasPermission === false) {
							this.errors = [this.i18n.l("Insufficient privileges to perform that action")];
							return;
						}

						this.eventDetail = e.detail;
					}
				}, {
					key: 'attached',
					value: function attached() {
						document.addEventListener('LineEditor-cached', function () {
							this.needsInit = true;
						}.bind(this));
					}
				}, {
					key: '_createEditorModel',
					value: function _createEditorModel() {
						if (this.ctx.params && this.ctx.params.cmd == 'onFlagCalculate') {
							this.data.quote.calculationRequired = true;
							this.ctx.params.cmd = null;
						}
						if (this.data.quote.calculationRequired) {
							this.$.customActionServices.onFlagCalculate(this.pageLoaded);
							return;
						}

						this.editorModel = new EditorModel(this.data, this.md, this);
						this._updateFieldLabelsMap();

						this._handleGroupCustomActions();

						this.groupModels = this._getGroupModels();
						this.rightSideButton = !this.editorModel.deviceContext.isMobile && this.groupModels.length > 1 && this.editorModel.quoteModel.grouped;
						this.quoteId = this.editorModel.quoteModel.quoteVO.record.Id;

						this.hasQuoteFieldSet = this.editorModel.fieldsetMap.quoteFieldNames.length > 0;

						this._viewportChanged(this.editorModel.deviceContext.isMobile);

						this.renumber();
						this.quoteHasNoLines();

						if (this.ctx.params && this.ctx.params.cmd != null) {
							this._executeCmd(this.ctx.params.cmd);
							this.ctx.params.cmd = null;
						} else if (!this.editorModel.quoteModel.quoteVO.record[this.editorModel.constants.PRICEBOOK_ID_FIELD]) {
							this._handleMissingPricebook();
						} else {
							this._executeDefaultCustomAction();
						}
						this.pageLoaded = true;
					}
				}, {
					key: '_handleGroupCustomActions',
					value: function _handleGroupCustomActions(notify) {
						if (!this.editorModel) return;

						var isExpanded = this.viewport && this.viewport.isDesktop() && this.viewport.M.up;
						this.editorModel.groupCustomActions = !isExpanded ? [this.editorModel.groupMobileMenuButtonAction] : this.editorModel.customActionsByLocation.Group;

						if (!notify && !isExpanded) {
							this.editorModel.groupCustomActions[0].label = this.editorModel.customActionsByLocation.Group[0].label;
							this.editorModel.groupCustomActions[0].first = this.editorModel.customActionsByLocation.Group[0].first;
							this.editorModel.groupCustomActions[0].eventHandlerName = this.editorModel.customActionsByLocation.Group[0].eventHandlerName;
							this.editorModel.groupCustomActions[0].record = this.editorModel.customActionsByLocation.Group[0].record;
						}

						if (!notify || !this.groupModels) return;

						for (var i = 0, l = this.groupModels.length; i < l; i++) {
							this.notifyPath('groupModels.' + i + '.editorModel.groupCustomActions');
						}
					}
				}, {
					key: '_handleMissingPricebook',
					value: function _handleMissingPricebook() {
						this.addEventListener('pricebook-saved', function (e) {
							this.updateQuote(e.detail);
							this._executeDefaultCustomAction();
						}.bind(this));

						var retUrl = window.location.href;
						if (retUrl.indexOf('cp=1') > -1) {
							document.location.assign(this.editorModel.communityPrefix + '/' + this.editorModel.quoteModel.quoteVO.record.Id);
							return;
						}
						var userType = this.data.userType;

						if (userType != "Standard" && userType != "PowerPartner") {
							this.errors = ['A PriceBook Id is missing. Please contact your administrator to resolve the issue.'];
							return;
						}

						this.$.pricebookDialog.open();
					}
				}, {
					key: '_updateFieldLabelsMap',
					value: function _updateFieldLabelsMap() {
						var fieldLabelsMap = this.editorModel.md.fieldLabelsMap,
						    localizedDimensions = this.editorModel.data.quote.localizedMultiSegmentColumns,
						    dimensions = this.editorModel.data.quote.multiSegmentColumns;

						for (var dim in dimensions) {
							var segments = dimensions[dim];
							var localizedSegments = localizedDimensions[dim];
							for (var i = 0, len = segments.length; i < len; i++) {
								fieldLabelsMap[segments[i].replace(/\W/g, '')] = localizedSegments[i];
							}
						}

						fieldLabelsMap['total'] = 'Total';
					}
				}, {
					key: 'renumber',
					value: function renumber() {
						var idx = 1,
						    invisibleIdx = 3000;
						for (var i = 0, numOfGroups = this.groupModels.length; i < numOfGroups; i++) {
							var groupModel = this.groupModels[i];
							for (var j = 0, numOfDimensions = groupModel.dimensions.length; j < numOfDimensions; j++) {
								var dim = groupModel.dimensions[j],
								    segmentedLines = groupModel.segmentedLinesByDimension[dim];
								for (var k = 0, numOfLines = segmentedLines.length; k < numOfLines; k++) {
									var segments = segmentedLines[k].segments;
									if (segmentedLines[k].visible) {
										this.set('groupModels.' + i + '.segmentedLinesByDimension.' + dim + '.' + k + '.lineVO.record.' + this.editorModel.constants.NUMBER_FIELD, idx);
										for (var m = 0, numOfSegments = segments.length; m < numOfSegments; m++) {
											segments[m].lineVO.record[this.editorModel.constants.NUMBER_FIELD] = idx;
										}
										idx++;
									} else {
										segmentedLines[k].lineVO.record[this.editorModel.constants.NUMBER_FIELD] = invisibleIdx;
										for (var _m = 0, _numOfSegments = segments.length; _m < _numOfSegments; _m++) {
											segments[_m].lineVO.record[this.editorModel.constants.NUMBER_FIELD] = invisibleIdx;
										}
										invisibleIdx++;
									}
								}
							}

							for (var n = 0, len = groupModel.standardLines.length; n < len; n++) {
								if (groupModel.standardLines[n].visible) {
									this.set('groupModels.' + i + '.standardLines.' + n + '.lineVO.record.' + this.editorModel.constants.NUMBER_FIELD, idx);
									idx++;
								} else {
									groupModel.standardLines[n].lineVO.record[this.editorModel.constants.NUMBER_FIELD] = invisibleIdx;
									invisibleIdx++;
								}
							}
						}
					}
				}, {
					key: '_updateFieldValidations',
					value: function _updateFieldValidations(e) {
						this.errors = e.detail.error ? [e.detail.error] : null;
					}
				}, {
					key: '_calculateImmediately',
					value: function _calculateImmediately() {
						this.debounce('calculateImmediately', function () {
							this.$.customActionServices.onFlagCalculate(true);
						}.bind(this), 50);
					}
				}, {
					key: '_executeCmd',
					value: function _executeCmd(cmd) {
						var quoteActions = this.editorModel.customActionsByLocation.Quote;
						if (!quoteActions || quoteActions.length === 0) {
							return;
						}

						for (var i = 0, l = quoteActions.length; i < l; i++) {
							if (quoteActions[i].eventHandlerName === cmd) {
								this._executeCustomAction({
									detail: {
										customAction: quoteActions[i],
										model: this.editorModel.quoteModel
									}
								});
							}
						}
					}
				}, {
					key: '_executeDefaultCustomAction',
					value: function _executeDefaultCustomAction() {
						var defaultCustomActions = this.editorModel.defaultCustomActions;
						if (!defaultCustomActions || defaultCustomActions.length === 0 || this.data.quote.lineItems.length > 0 || this.data.quote.lineItemGroups.length > 1 || this.editorModel.quoteModel.grouped) {
							return;
						}
						var eventHandlerName = this.editorModel.quoteModel.isRenewal ? "onRenewSubscriptions" : "onAddProducts";
						for (var i = 0, l = defaultCustomActions.length; i < l; i++) {
							if (defaultCustomActions[i].eventHandlerName === eventHandlerName) {
								this._executeCustomAction({ detail: { customAction: defaultCustomActions[i], model: this.editorModel.quoteModel } });
							}
						}
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged() {
						this._handleGroupCustomActions(true);
						if (this.viewport.isMobile()) {
							this.isMobile = true;
						} else {
							this.isMobile = false;
						}
					}
				}, {
					key: 'buildQuoteTabs',
					value: function buildQuoteTabs() {
						if (!this.editorModel) return;

						var namesForQuoteLayout = [];
						if (this.editorModel.fieldsetMap.quoteFieldNames.length > 0) namesForQuoteLayout.push('details');
						if (this.editorModel.quoteModel.grouped) {
							this.toggleClass('maxHeight', true, this.$$('#quoteTabs'));
							if (this.groupModels.length > 0) {
								namesForQuoteLayout.push('groups');
							}
						} else {
							if (!this.groupModels.length) {
								return;
							}
							this.toggleClass('maxHeight', false, this.$$('#quoteTabs'));
							if (this.groupModels[0]._groupHasSegmentedProducts()) {
								this.buildUngroupedSegmentedTabs();
								namesForQuoteLayout.push('segmented');
							}
							if (this.groupModels[0]._groupHasStandardProducts()) {
								namesForQuoteLayout.push('standard');
							}
						}

						if (!this._renderTabs(namesForQuoteLayout)) {
							return;
						}

						if (this.$$('#quoteTabs')) {
							this.$$('#quoteTabs').destroyTabs();
						}

						var tabs = [];

						for (var i = 0, l = namesForQuoteLayout.length; i < l; i++) {
							var tId = "t" + i,
							    tabName = namesForQuoteLayout[i],
							    bind = void 0;
							switch (tabName) {
								case 'details':
									bind = ['groupModels', 'editorModel'];
									break;
								case 'groups':
									bind = ['groupModels', 'rightSideButton', 'editorModel'];
									break;
								case 'standard':
									bind = ['groupModels'];
									break;
								case 'segmented':
									bind = ['groupModels'];
									break;
							}

							tabs.push({ name: tId, label: tabName, bind: bind });
						}
						this.ungroupedMDQTabs = this.groupModels[0] ? this.groupModels[0].quoteMDQTabs : null;
						this.selectedTabIndex = 0;
						this.hideTabs = tabs.length == 1;
						this.quoteLevelTabs = tabs;
					}
				}, {
					key: '_renderTabs',
					value: function _renderTabs(namesForQuoteLayout) {
						if (this.quoteLevelTabs.length !== namesForQuoteLayout.length) {
							return true;
						}

						if (this.groupModels[0] && this.groupModels[0].quoteMDQTabs && this.ungroupedMDQTabs.length !== this.groupModels[0].quoteMDQTabs.length) {
							return true;
						}

						for (var i = 0, l = this.quoteLevelTabs.length; i < l; i++) {
							if (this.quoteLevelTabs[i].label !== namesForQuoteLayout[i]) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: '_getGroupModels',
					value: function _getGroupModels() {
						return this.editorModel.quoteModel.lineGroups;
					}
				}, {
					key: 'quoteHasNoLines',
					value: function quoteHasNoLines() {
						if (this.data.quote.lineItems.length == 0) {
							var quoteModel = this.editorModel.quoteModel;
							this.groupedQuoteHasNoGroups = quoteModel.grouped && quoteModel.lineGroups.length == 0;
							this.ungroupedQuoteHasNoLines = !quoteModel.grouped;
						}
					}
				}, {
					key: 'updateQuote',
					value: function updateQuote(quote) {
						if (quote != undefined) {
							this.set('data.quote', quote);
							if (this.data.settings.usesClientCalculator && this.data.quote.calculationRequired) {
								this.$.customActionServices.onFlagCalculate(true, true);
								return;
							}

							if (!this.editorModel) this._createEditorModel();

							this.editorModel.createQuoteModel(quote);
							this.editorModel.styleQuoteAndGroupActionButtons();
							var groupModels = this._getGroupModels();
							this._updateFieldLabelsMap();

							this.set('groupModels', groupModels);

							this.rightSideButton = this.viewport && !this.viewport.isMobile() && this.groupModels.length > 1 && this.editorModel.quoteModel.grouped;

							if (this.editorModel.quoteModel.lineGroups.length == 1) {
								this.fire('iron-signal', { name: 'close-group-panel' });
							}

							this.notifyPath('editorModel.quoteModel.lineGroups.length', this.editorModel.quoteModel.lineGroups.length);
							this.set('editorModel.quoteModel', this.editorModel.quoteModel);
							this.renumber();
							if (this.isMobile) {
								this.buildQuoteTabs();
							}
						}

						this.quoteHasNoLines();

						if (this.data.settings.multiLineDeleteEnabled) {
							this.fire('iron-signal', { name: 'deselect-checkbox' });
						}
					}
				}, {
					key: 'updateAfterJSQC',
					value: function updateAfterJSQC(notifier, sortRequired) {
						if (!notifier) {
							return;
						}
						Object.keys(notifier.pathsToNotify).forEach(function (path) {
							var originalValue = notifier.originalPathValues[path];
							var pathsToNotify = notifier.pathsToNotify;
							var value = notifier.pathsToNotify[path].value;
							var root = pathsToNotify[path].root;

							var shouldNotify = !sortRequired || sortRequired && root != 'QuoteLineModel';
							if (originalValue != value && shouldNotify) {
								this.notifyPath(path, undefined);
								this.notifyPath(path, value);
							}
						}.bind(this));

						Object.keys(notifier.pathsToSet).forEach(function (path) {
							var originalValue = notifier.originalPathValues[path];
							var pathsToSet = notifier.pathsToSet;
							var value = pathsToSet[path].value;
							var root = pathsToSet[path].root;

							var shouldNotify = !sortRequired || sortRequired && root != 'QuoteLineModel';
							if (originalValue != value && shouldNotify) {
								this.set(path, undefined);
								this.set(path, value);
							}
						}.bind(this));
					}
				}, {
					key: '_init',
					value: function _init() {
						if (this.needsInit) {
							var inVFPage = typeof Visualforce !== 'undefined';
							if (inVFPage && this.rawData.settings.usesClientCalculator && this.rawData.settings.orgUrl && window.Worker) {
								new JSQCPrecacheWorkerManager(this.rawData).beginPrecaching();
							}
							this.needsInit = false;
						}

						if (typeof SB !== 'undefined' && SB.JSQC) {
							var oauthClient = new OAuthClient(this.app.org.prefix);
							var qc = new SB.JSQC(this.rawData.settings, this.rawData.quote, null);

							var connectionPromiseArray = [oauthClient.getConnection(), oauthClient.getConnection()];
							Promise.all(connectionPromiseArray).then(function (connections) {
								qc.setConnection(connections[0]);
								qc.setCustomerOnlyConnection(connections[1]);
								this.rawData.settings.displayedLookupMap = this.$.customActionServices.getDisplayedLookupNames(this.rawData);
								var promise = qc.onLoad();
								promise.then(function () {
									this.data = this.rawData;
								}.bind(this), function (err) {
									this.errors = [{
										type: 'error',
										msg: err.message || err
									}];
								}.bind(this));
							}.bind(this), function (err) {
								this.errors = [{
									type: 'error',
									msg: err.message || err
								}];
							}.bind(this));
						} else {
							this.data = this.rawData;
						}
					}
				}, {
					key: '_dataIsChanged',
					value: function _dataIsChanged() {
						var prefix = this.data.developerPrefix;
						var fieldNamesByObjectNames = {};
						var fieldNames = [],
						    fieldNameSet = new Set(),
						    fieldSets = ['lineFieldNames', 'lineFieldNamesTablet', 'lineFieldNamesPhone', 'multiSegmentLineFieldNames', 'multiSegmentLineSummaryFieldNames'];
						for (var i = 0, len = fieldSets.length; i < len; i++) {
							var fieldSet = this.data[fieldSets[i]],
							    numOfFields = fieldSet && fieldSet.length;
							if (numOfFields) {
								for (var j = 0; j < numOfFields; j++) {
									var name = fieldSet[j];
									if (!fieldNameSet.has(name)) {
										fieldNameSet.add(name);
										fieldNames.push(name);
									}
								}
							}
						}

						var additionalFields = [prefix + 'SubscriptionScope__c', prefix + 'SegmentLabel__c', prefix + 'StartDate__c', prefix + 'EndDate__c', prefix + 'PriceEditable__c'];
						for (var k = 0, ln = additionalFields.length; k < ln; k++) {
							var _name = additionalFields[k];
							if (!fieldNameSet.has(_name)) {
								fieldNameSet.add(_name);
								fieldNames.push(_name);
							}
						}

						fieldNamesByObjectNames[this.data.quoteLineObjectName] = [].concat(fieldNames);
						var lineEditorSubtotalsField = this.data.settings.lineEditorSubtotalsField;
						if (!lineEditorSubtotalsField || lineEditorSubtotalsField == 'Default') {
							fieldNamesByObjectNames[this.data.quoteLineObjectName].push(prefix + 'NetTotal__c');
							fieldNameSet.add(prefix + 'NetTotal__c');
						} else {
							fieldNamesByObjectNames[this.data.quoteLineObjectName].push(lineEditorSubtotalsField);
							fieldNameSet.add(lineEditorSubtotalsField);
						}

						fieldNamesByObjectNames[this.data.quoteObjectName] = [].concat(this.data.quoteFieldNames);
						for (var m = 0, n = this.data.quoteFieldNames.length; m < n; m++) {
							fieldNameSet.add(this.data.quoteFieldNames[m]);
						}
						var lineEditorTotalsField = this.data.settings.lineEditorTotalsField;
						if (!lineEditorTotalsField || lineEditorTotalsField == 'Default') {
							if (this.data.quote.applyAdditionalDiscountLast) {
								fieldNamesByObjectNames[this.data.quoteObjectName].push(prefix + 'CustomerAmount__c');
								fieldNameSet.add(prefix + 'CustomerAmount__c');
							} else {
								fieldNamesByObjectNames[this.data.quoteObjectName].push(prefix + 'NetAmount__c');
								fieldNameSet.add(prefix + 'NetAmount__c');
							}
						} else {
							fieldNamesByObjectNames[this.data.quoteObjectName].push(lineEditorTotalsField);
							fieldNameSet.add(lineEditorTotalsField);
						}

						fieldNamesByObjectNames[prefix + 'QuoteLineGroup__c'] = [].concat(this.data.groupFieldNames);
						for (var o = 0, p = this.data.groupFieldNames.length; o < p; o++) {
							fieldNameSet.add(this.data.groupFieldNames[o]);
						}
						var lineEditorGroupSubtotalsField = this.data.settings.lineEditorGroupSubtotalsField;
						if (!lineEditorGroupSubtotalsField || lineEditorGroupSubtotalsField == 'Default') {
							fieldNamesByObjectNames[prefix + 'QuoteLineGroup__c'].push(prefix + 'NetTotal__c');
							fieldNameSet.add(prefix + 'NetTotal__c');
						} else {
							fieldNamesByObjectNames[prefix + 'QuoteLineGroup__c'].push(lineEditorGroupSubtotalsField);
							fieldNameSet.add(lineEditorGroupSubtotalsField);
						}

						fieldNamesByObjectNames[prefix + 'DiscountTier__c'] = this.data.discountScheduleModalFieldNames;
						fieldNamesByObjectNames[prefix + 'DiscountSchedule__c'] = ['Name', prefix + 'DiscountUnit__c'];

						this.fieldNameSet = fieldNameSet;
						this.$.md.data = fieldNamesByObjectNames;
					}
				}, {
					key: '_errorEventHandled',
					value: function _errorEventHandled() {
						if (this.error) {
							if (this.error.validations) {
								this.errors = this.error.validations;
							} else {
								this.errors = [this.error.message];
							}
						}
						this.$.customActionServices.showSpinner = false;
					}
				}, {
					key: '_handleMobileCSE',
					value: function _handleMobileCSE(e) {
						this._openDialog({ dialog: 'cseDialog', groupModelKey: null });
					}
				}, {
					key: '_handleCSE',
					value: function _handleCSE(e) {
						this._openDialog(e.detail);
					}
				}, {
					key: '_handleCSEResponse',
					value: function _handleCSEResponse(e) {
						this.updateQuote(e.detail.quoteVO);
						this.$.customActionServices.onFlagCalculate(true);
						this.$.cseDialog.$.dialog.toggle();
					}
				}, {
					key: '_openDialog',
					value: function _openDialog(action) {
						if (action.dialog === 'cseDialog') {
							var cseDialog = this.$.cseDialog;
							var segments = this.editorModel.quoteModel.groupsByKey[action.groupModelKey].segmentedLinesByDimension.Custom[0].segmentsByLabel;
							var segmentsArray = [];
							Object.keys(segments).forEach(function (key) {
								var lineModel = segments[key];
								if (lineModel.lineVO.dimensionType == lineModel.groupModel.editorModel.constants.CUSTOM_VALUE) {
									segmentsArray.push(lineModel);
								}
							});
							cseDialog.dataLineModels = segmentsArray;
						}
						this.$[action.dialog].$.dialog.toggle();
					}
				}, {
					key: 'toggleGroupPanel',
					value: function toggleGroupPanel() {
						if (this.viewport.isMobile()) {
							this.fire('iron-signal', { name: 'toggle-panel-clicked' });
						}
					}
				}, {
					key: '_viewportChanged',
					value: function _viewportChanged(isMobile) {
						if (!this.editorModel) {
							return;
						}
						this.toggleClass('hidden', !isMobile, Polymer.dom(this.root).querySelector('.fixedActions'));

						var standardPrimaryMobileColsLength = this.editorModel.standardPrimaryMobileCols.length;
						this.editorModel.standardPrimaryMobileCols = isMobile ? [this.editorModel.constants.PRODUCT_NAME_FIELD, this.editorModel.constants.NET_TOTAL_FIELD] : [];

						var segmentedPrimaryMobileColsLength = this.editorModel.segmentedPrimaryMobileCols.length;
						this.editorModel.segmentedPrimaryMobileCols = isMobile ? [this.editorModel.constants.PRODUCT_NAME_FIELD, 'total'] : [];
						this.editorModel.segmentedDetailsPrimaryMobileCols = isMobile ? [this.editorModel.constants.SEGMENT_LABEL_FIELD, this.editorModel.constants.NET_TOTAL_FIELD] : [];

						if (this.groupModels && (standardPrimaryMobileColsLength !== this.editorModel.standardPrimaryMobileCols.length || segmentedPrimaryMobileColsLength !== this.editorModel.segmentedPrimaryMobileCols.length)) {
							for (var i = 0; i < this.groupModels.length; i++) {
								this.notifyPath('groupModels.' + i + '.editorModel.standardPrimaryMobileCols');
								this.notifyPath('groupModels.' + i + '.editorModel.segmentedPrimaryMobileCols');
								this.notifyPath('groupModels.' + i + '.editorModel.segmentedDetailsPrimaryMobileCols');
							}
						}

						if (isMobile) {
							this.buildQuoteTabs();
						}

						this.isMobileRendered = isMobile;
						this.isDesktopRendered = !isMobile;
					}
				}, {
					key: 'buildUngroupedSegmentedTabs',
					value: function buildUngroupedSegmentedTabs() {
						if (!this.groupModels || this.groupModels.length == 0) {
							return;
						}
						var tabs = [],
						    dimensions = this.groupModels[0].dimensions;

						for (var i = 0, len = dimensions.length; i < len; i++) {
							var dimension = dimensions[i];
							if (this.groupModels[0].hasVisibleSegmentedLines[dimension]) {
								var tId = "t" + i;
								var tab = { name: tId, key: dimension, label: this.groupModels[0].quoteModel.quoteVO.localizedDimensionNames[dimension], bind: ['groupModel'] };
								if (dimension == 'Custom') {
									tab.iconId = tId + '-' + this.groupModels[0].groupKey;
									tab.iconClass = 'sb-icon-pencil';
									tab.iconEvent = 'cseMobile';
								}
								tabs.push(tab);
							}
						}
						this.groupModels[0].quoteMDQTabs = tabs;
						if (!this.ungroupedMDQTabs) {
							this.ungroupedMDQTabs = tabs;
						}
					}
				}, {
					key: '_openCSE',
					value: function _openCSE() {
						var e = {
							dialog: event.currentTarget.attributes.dialog.value
						};
						this.$.cseDialog.$.dialog.toggle();
					}
				}, {
					key: '_displayUpgradeQuantityToast',
					value: function _displayUpgradeQuantityToast(e) {
						var invalidQuantity = e.detail.invalidQuantity;
						var validQuantity = e.detail.validQuantity;

						this.errors = null;

						if (invalidQuantity > 0) {
							var errorMessage = this.i18n.l('Exceeded maximum quantity available. Value has been reduced to {0}', [validQuantity]);
							this.errors = [{
								type: 'warning',
								msg: errorMessage
							}];
						}
					}
				}, {
					key: 'destampGroups',
					value: function destampGroups() {
						this.isMobileRendered = false;
						this.isDesktopRendered = false;
					}
				}, {
					key: 'handleProductRuleAlertModal',
					value: function handleProductRuleAlertModal(serviceType, guidedMessages) {
						var _this2 = this;

						if (!guidedMessages || guidedMessages.length === 0) {
							return;
						}
						this.$.productAlertModal.cancelCB = null;
						if (serviceType === 'saveService') {
							this.$.productAlertModal.displayContinueButton = true;
							this.$.productAlertModal.continueCB = function () {
								_this2.$.customActionServices.navigateToReturnUrl(true);
							};
						}
						this.$.productAlertModal.alerts = guidedMessages;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'le-action-tapped': '_executeCustomAction',
							'cseMobile-tapped': '_handleMobileCSE',
							'cse-tapped': '_handleCSE',
							'segmented-changed': '_handleCSEResponse',
							'change-ghost': '_handleGhostChanges',
							'renumber-lines': 'renumber',
							'validate-quantity-changed': '_displayUpgradeQuantityToast',
							'field-change-validated': '_updateFieldValidations',
							'calculate-immediately': '_calculateImmediately'
						};
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_createEditorModel(data, md)', '_errorEventHandled(error)', '_loadObjectMD(app.org)'];
					}
				}]);

				return LineEditor;
			}(Page));

			_export('LineEditor', LineEditor);

			Polymer(LineEditor);
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheSequenceRunners/DiscountScheduleSequenceRunner.js', [], function (_export, _context) {
	var convertTo18;

	function runnerFactory(apex, prefix, resultPoster, quote, accountId) {

		function executeSequence() {
			var scheduleMap = extractScheduleMapFromQuote();
			if (Object.keys(scheduleMap).length != 0) {
				var context = {
					'schedules': scheduleMap,
					'overrides': {},
					'account': accountId
				};
				return apex.load(prefix, 'DiscountAndAccountCallout', 'AllDiscountsAndAccounts', context).then(function (results) {
					resultPoster({ successful: true, provider: 'DiscountAndAccountCallout', uid: 'AllDiscountsAndAccounts', results: results });
				}, function (err) {
					self.postMessage({ err: true, sequence: 'DiscountScheduleSequence', msg: err.message || err });
				});
			} else {
				return Promise.resolve();
			}
		}

		function extractScheduleMapFromQuote() {
			var fieldPrefix = prefix == 'SBQQ' ? 'SBQQ__' : '';
			var scheduleMap = {};
			var volumeDiscountField = fieldPrefix + 'DiscountSchedule__c';
			var termDiscountField = fieldPrefix + 'TermDiscountSchedule__c';
			var productField = fieldPrefix + 'Product__c';
			quote.lineItems.forEach(function (line) {
				var vId = line.record[volumeDiscountField];
				var tId = line.record[termDiscountField];
				var cId = line.costScheduleId;

				if (vId != null) {
					if (scheduleMap[vId] == null) {
						scheduleMap[vId] = [];
					}
					scheduleMap[vId].push(line.record[productField]);
				}

				if (tId != null) {
					if (scheduleMap[tId] == null) {
						scheduleMap[tId] = [];
					}
					scheduleMap[tId].push(line.record[productField]);
				}

				if (cId != null) {
					if (scheduleMap[convertTo18(cId)] == null) {
						scheduleMap[convertTo18(cId)] = [];
					}
					scheduleMap[convertTo18(cId)].push(line.record[productField]);
				}
			});
			return scheduleMap;
		}

		return {
			executeSequence: executeSequence
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = runnerFactory;
			convertTo18 = require('../IdConverter.js');
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheSequenceRunners/MetadataSequenceRunner.js', [], function (_export, _context) {
	function runnerFactory(apex, prefix, resultPoster, referencedFieldMap) {

		function executeSequence() {
			var fullNames = determineMetadataFullNames();
			if (fullNames.length == 0) {
				return Promise.resolve();
			} else {
				return apex.md('CustomField', fullNames).then(function (mdResults) {
					var uid = fullNames.join(',');
					resultPoster({ successful: true, provider: 'CustomField', uid: uid, results: mdResults });
				});
			}
		}

		function determineMetadataFullNames() {
			if (referencedFieldMap == null) {
				return [];
			}

			var objectPrefix = prefix == 'SBQQ' ? 'SBQQ__' : '';
			var fullNames = [];
			var lineType = objectPrefix + 'QuoteLine__c';
			var quoteType = objectPrefix + 'Quote__c';
			var groupType = objectPrefix + 'QuoteLineGroup__c';

			for (var key in referencedFieldMap) {
				var typeName;
				if (key === 'Quote Line') {
					typeName = lineType;
				} else if (key === 'Group') {
					typeName = groupType;
				} else if (key === 'Quote') {
					typeName = quoteType;
				} else {
					typeName = key;
				}
				if (referencedFieldMap.hasOwnProperty(key)) {
					referencedFieldMap[key].forEach(function (fieldName) {
						fullNames.push(typeName + '.' + fieldName);
					});
				}
			}
			return fullNames;
		}

		return {
			executeSequence: executeSequence
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = runnerFactory;
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheSequenceRunners/OptionSequenceRunner.js', [], function (_export, _context) {
	function runnerFactory(apex, prefix, resultPoster, quote, referencedFields) {
		var fieldPrefix = prefix == '' ? '' : 'SBQQ__';

		function executeSequence() {
			var optionIds = getOptionIdsFromLines();
			var context = {
				'requiredIds': optionIds,
				'requiredFields': referencedFields || []
			};
			apex.setOptions({ escape: false });
			return apex.load(prefix, 'ProductOptionServiceProvider.ProductOptionLoader', 'AllOptions', context).then(function (results) {
				resultPoster({ successful: true, provider: 'ProductOptionServiceProvider.ProductOptionLoader', uid: 'AllOptions', results: results });
			}, function (err) {
				resultPoster({ err: true, sequence: 'OptionSequence', msg: err.message || err });
			});
		}

		function getOptionIdsFromLines() {
			var uniquenessMap = {};
			var values = [];
			var fieldName = fieldPrefix + 'ProductOption__c';
			quote.lineItems.forEach(function (line) {
				var value = line.record[fieldName];
				if (value && !uniquenessMap[value]) {
					uniquenessMap[value] = true;
					values.push(value);
				}
			});
			return values;
		}

		return {
			executeSequence: executeSequence
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = runnerFactory;
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheSequenceRunners/PriceRuleSequenceRunner.js', [], function (_export, _context) {
	function runnerFactory(apex, prefix, resultPoster, accountId) {
		function executeSequence() {
			return loadPriceRules().then(function (ruleRecords) {
				resultPoster({ successful: true, provider: 'PriceRuleServiceProvider.PriceRuleReader', uid: 'PriceRules', results: ruleRecords });
				return loadSummaryVariables(ruleRecords);
			}).then(function (svRecords) {
				resultPoster({ successful: true, provider: 'SummaryVariableServiceProvider.SummaryVariableLoader', uid: 'SummaryVariables', results: svRecords });
				return loadAssetsAndSubscriptions(svRecords);
			}).then(function (assetAndSubRecs) {
				resultPoster({ successful: true, provider: 'AssetAndSubscriptionServiceProvider.AssetAndSubLoader', uid: 'AssetsAndSubs', results: assetAndSubRecs });
			}).catch(function (err) {
				self.postMessage({ err: true, sequence: 'Price Rule Sequence', msg: err.msg || err });
			});
		}

		function loadPriceRules() {
			return apex.read(prefix, 'PriceRuleServiceProvider.PriceRuleReader', 'PriceRules');
		}

		function loadSummaryVariables(ruleRecords) {
			var neededIds = getSummaryVariableIds(ruleRecords);
			var svContext = {
				'svIds': neededIds
			};
			return apex.load(prefix, 'SummaryVariableServiceProvider.SummaryVariableLoader', 'SummaryVariables', svContext);
		}

		function getSummaryVariableIds(ruleRecords) {
			var recordPrefix = prefix == '' ? '' : 'SBQQ__';
			var filterVarField = recordPrefix + 'FilterVariable__c';
			var testedVarField = recordPrefix + 'TestedVariable__c';
			var sourceVarField = recordPrefix + 'SourceVariable__c';
			var condRelationship = recordPrefix + 'PriceConditions__r';
			var actionRelationship = recordPrefix + 'PriceActions__r';
			var svIds = [];
			var condIdCollector = function condIdCollector(condRecord) {
				if (condRecord[filterVarField]) {
					svIds.push(condRecord[filterVarField]);
				}
				if (condRecord[testedVarField]) {
					svIds.push(condRecord[testedVarField]);
				}
			};
			var actionIdCollector = function actionIdCollector(action) {
				if (action[sourceVarField]) {
					svIds.push(action[sourceVarField]);
				}
			};
			if (ruleRecords.length > 0) {
				ruleRecords.forEach(function (rule) {
					if (rule[condRelationship] && rule[condRelationship].records.length > 0) {
						rule[condRelationship].records.forEach(condIdCollector);
					}
					if (rule[actionRelationship] && rule[actionRelationship].records.length > 0) {
						rule[actionRelationship].records.forEach(actionIdCollector);
					}
				});
			}
			return svIds;
		}

		function loadAssetsAndSubscriptions(svRecords) {
			if (!accountId) {
				return Promise.resolve([]);
			}
			var recordPrefix = prefix == '' ? '' : 'SBQQ__';
			var targetObjectField = recordPrefix + 'TargetObject__c';
			var filterField = recordPrefix + 'FilterField__c';
			var constraintField = recordPrefix + 'ConstraintField__c';
			var aggregateField = recordPrefix + 'AggregateField__c';

			var assetFields = [];
			var subscriptionFields = [];
			for (var svId in svRecords) {
				if (svRecords.hasOwnProperty(svId)) {
					var svRec = svRecords[svId];
					if (svRec[targetObjectField] == 'Asset') {
						if (svRec[filterField] != null) {
							assetFields.push(svRec[filterField]);
						}
						if (svRec[constraintField] != null) {
							assetFields.push(svRec[constraintField]);
						}
						if (svRec[aggregateField] != null) {
							assetFields.push(svRec[aggregateField]);
						}
					} else if (svRec[targetObjectField] == 'Subscription') {
						if (svRec[filterField] != null) {
							subscriptionFields.push(svRec[filterField]);
						}
						if (svRec[constraintField] != null) {
							subscriptionFields.push(svRec[constraintField]);
						}
						if (svRec[aggregateField] != null) {
							subscriptionFields.push(svRec[aggregateField]);
						}
					}
				}
			}

			var context = {
				'accountId': accountId,
				'assetFields': assetFields,
				'subscriptionFields': subscriptionFields
			};

			return apex.load(prefix, 'AssetAndSubscriptionServiceProvider.AssetAndSubLoader', 'AssetsAndSubs', context);
		}

		return {
			executeSequence: executeSequence
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = runnerFactory;
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheSequenceRunners/ProductSequenceRunner.js', [], function (_export, _context) {
	function runnerFactory(apex, prefix, resultPoster, quote, referencedFields) {
		var fieldPrefix = prefix == '' ? '' : 'SBQQ__';
		function executeSequence() {
			var productIds = getProductIdsFromLines();
			var pricebookFilter = [];
			if (quote.record[fieldPrefix + 'PricebookId__c']) {
				pricebookFilter.push(quote.record[fieldPrefix + 'PricebookId__c']);
			}
			var currencyFilter = [];
			if (quote.record['CurrencyIsoCode']) {
				currencyFilter.push(quote.record['CurrencyIsoCode']);
			}
			var context = {
				'requiredIds': productIds,
				'productFields': referencedFields,
				'pricebookFilter': pricebookFilter,
				'currencyFilter': currencyFilter
			};
			apex.setOptions({ escape: false });
			return apex.load(prefix, 'ProductServiceProvider.ProductLoader', 'AllProducts', context).then(function (results) {
				resultPoster({
					successful: true,
					provider: 'ProductServiceProvider.ProductLoader',
					uid: 'AllProducts',
					results: results
				});
			}, function (err) {
				resultPoster({ err: true, sequence: 'ProductSequence', msg: err.message || err });
			});
		}

		function getProductIdsFromLines() {
			var uniquenessMap = {};
			var values = [];
			var fieldName = fieldPrefix + 'Product__c';
			quote.lineItems.forEach(function (line) {
				var value = line.record[fieldName];
				if (value != null && uniquenessMap[value] == null) {
					uniquenessMap[value] = true;
					values.push(value);
				}
			});
			return values;
		}

		return {
			executeSequence: executeSequence
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = runnerFactory;
		}
	};
});

'use strict';

System.register('quotes/precaching/PrecacheSequenceRunners/RelatedRecordSequenceRunner.js', [], function (_export, _context) {
	var convertTo18;

	function runnerFactory(apex, prefix, resultPoster, quote, lookupFieldMap, referencedFieldMap) {
		function executeSequence() {
			var context = {
				'queryInfo': {}
			};

			sweepModelsForLookupIds(context, lookupFieldMap.quoteLookups, [quote]);
			sweepModelsForLookupIds(context, lookupFieldMap.groupLookups, quote.lineItemGroups);
			sweepModelsForLookupIds(context, lookupFieldMap.lineLookups, quote.lineItems);

			return apex.load(prefix, 'JSQCLookupFieldServiceProvider.JSQCLookupFieldLoader', 'AllAdditionalLookups', context).then(function (results) {
				resultPoster({ successful: true, provider: 'JSQCLookupFieldServiceProvider.JSQCLookupFieldLoader', uid: 'AllAdditionalLookups', results: results });
			}, function (err) {
				resultPoster({ err: true, sequence: 'RelatedRecordSequence', msg: err.message || err });
			});
		}

		function sweepModelsForLookupIds(context, lookupFields, models) {
			if (lookupFields && models && models.length > 0) {
				for (var key in lookupFields) {
					if (lookupFields.hasOwnProperty(key)) {
						var targetType = lookupFields[key];

						models.forEach(function (model) {
							var id = model.record[key];
							if (id) {
								var convertedId = convertTo18(id);
								if (!convertedId) {
									return;
								} else if (!context.queryInfo[targetType]) {
									context.queryInfo[targetType] = {
										'referencedFields': referencedFieldMap[targetType],
										'referencedIds': [convertedId]
									};
								} else {
									context.queryInfo[targetType]['referencedIds'].push(convertedId);
								}
							}
						});
					}
				}
			}
		}

		return {
			executeSequence: executeSequence
		};
	}
	return {
		setters: [],
		execute: function () {
			module.exports = runnerFactory;
			convertTo18 = require('../IdConverter.js');
		}
	};
});

'use strict';

System.register('quotes/tables/sb-segmented-lines/SegmentedLines.js', ['quotes/models/LineModel.js', 'quotes/sb-line-sort/QuoteLineSort.js', 'quotes/models/DragDropModel.js', 'common/layout/table-layout-builder/TableLayoutBuilder.js', 'common/core/sb-page-container/PageContainer.js', 'common/relationship/RelationshipFieldManager.js'], function (_export, _context) {
	var LineModel, depthFirstLineItemsTreeSort, DragDropModel, TableLayoutBuilder, PageContainer, RelationshipFieldManager, _createClass, SegmentedLines;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesModelsLineModelJs) {
			LineModel = _quotesModelsLineModelJs.LineModel;
		}, function (_quotesSbLineSortQuoteLineSortJs) {
			depthFirstLineItemsTreeSort = _quotesSbLineSortQuoteLineSortJs.depthFirstLineItemsTreeSort;
		}, function (_quotesModelsDragDropModelJs) {
			DragDropModel = _quotesModelsDragDropModelJs.DragDropModel;
		}, function (_commonLayoutTableLayoutBuilderTableLayoutBuilderJs) {
			TableLayoutBuilder = _commonLayoutTableLayoutBuilderTableLayoutBuilderJs.TableLayoutBuilder;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SegmentedLines', SegmentedLines = function () {
				function SegmentedLines() {
					_classCallCheck(this, SegmentedLines);
				}

				_createClass(SegmentedLines, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-segmented-lines';
						this.properties = {
							fieldNames: {
								type: Object
							},

							quoteLineFields: {
								type: Object
							},

							columnNames: {
								type: Array
							},

							currencyMd: {
								type: Object,
								computed: '_getNetTotalFieldMd(groupModel)'
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('table-header-sort-clicked', this._onSortLinesByHeader);
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: 'groupPanelToggled',
					value: function groupPanelToggled(e) {
						this.drawerState = e.detail.drawerState;
						this._setColumnWidths();
					}
				}, {
					key: 'groupPanelCreated',
					value: function groupPanelCreated(e) {
						this._setColumnWidths();
					}
				}, {
					key: '_segmentedLinesByDimensionChanged',
					value: function _segmentedLinesByDimensionChanged(e) {
						var parts = void 0,
						    isCurrentDimension = void 0;

						parts = e.path.split('.');
						isCurrentDimension = parts.indexOf(this.dimension) >= 0 ? true : false;
						if (parts[parts.length - 1] == 'splices' && isCurrentDimension) {
							var spliceChanges = e.value.indexSplices;
							if (spliceChanges[0].removed && spliceChanges[0].object.length === 0) {
								this.hasVisibleSegmentedLines = false;
							} else if (spliceChanges[0].addedCount > 0) {
								this.hasVisibleSegmentedLines = true;
							}
						}
					}
				}, {
					key: '_render',
					value: function _render() {
						if (!this.groupModel) return;
						this.dimension = this.attributes.key.value;
						this.hasVisibleSegmentedLines = this.groupModel.hasVisibleSegmentedLines[this.dimension];
						this.fieldNames = this._getFields();
						this.lineModels = this.groupModel.segmentedLinesByDimension[this.dimension];
						this.linkPaths('groupModel.segmentedLinesByDimension.' + this.dimension, 'lineModels');
						this.fieldLabelsMap = this.editorModel.md.fieldLabelsMap;
						this.quoteLineFields = this.editorModel.md.fieldsMap[this.editorModel.data.quoteLineObjectName];
						this.settings = this.editorModel.data.settings;
						this.detailFieldNames = this.editorModel.fieldsetMap.multiSegmentLineFieldNames;

						var multiSegmentColumns = this.groupModel.groupVO.multiSegmentColumns;
						if (multiSegmentColumns && Object.keys(multiSegmentColumns).length > 0) {
							this.columnNames = multiSegmentColumns[this.dimension];
							this.headerColumnNames = this.groupModel.groupVO.localizedMultiSegmentColumns[this.dimension];
						} else {
							this.columnNames = this.groupModel.quoteModel.quoteVO.multiSegmentColumns[this.dimension];
							this.headerColumnNames = this.editorModel.quoteModel.quoteVO.localizedMultiSegmentColumns[this.dimension];
						}

						this.netMultiSegmentTotalField = this.editorModel.constants.NET_TOTAL_FIELD;
						this.columnWidths = {};
						this._setColumnWidths();
					}
				}, {
					key: '_getFields',
					value: function _getFields() {
						var fields = this.editorModel.fieldsetMap.multiSegmentLineSummaryFieldNames;
						return this.groupModel.segmentedSubscriptionScopeEditable ? [this.editorModel.constants.SUBSCRIPTION_SCOPE_FIELD].concat(fields) : fields;
					}
				}, {
					key: '_setColumnWidths',
					value: function _setColumnWidths() {
						var colWidths = null;

						if (!this.editorModel.deviceContext.isMobile && this.editorModel.layout && this.groupModel.segmentedLinesByDimension[this.dimension]) {
							colWidths = this.editorModel.layout.colWidths[this.groupModel.groupKey][this.dimension];
							this._setSubtotalColumnWidth(colWidths, this.editorModel.layout.leftOffset);
						}
						this.set('columnWidths', colWidths);
					}
				}, {
					key: '_setSubtotalColumnWidth',
					value: function _setSubtotalColumnWidth(columnWidths, offset) {
						var labelColWidth = offset;
						for (var i = 0, l = this.fieldNames.length; i < l; i++) {
							var field = this.fieldNames[i];
							labelColWidth += columnWidths[field];
						}
						this.labelColWidth = labelColWidth + 'px';

						for (var j = 0, len = this.columnNames.length; j < len; j++) {
							var columnName = this.columnNames[j].replace(/\W/g, '');
							this.subtotalColWidth = columnWidths[columnName] + 'px';
						}

						this.totalColWidth = columnWidths['total'] + 'px';
					}
				}, {
					key: 'colWidthsChanged',
					value: function colWidthsChanged() {
						this._setColumnWidths();
					}
				}, {
					key: 'onTrack',
					value: function onTrack(e) {
						this.domHost.domHost._onTrack(e);
					}
				}, {
					key: 'getMultiSegmentColumnTotal',
					value: function getMultiSegmentColumnTotal(columnName) {
						if (this.groupModel.multiSegmentColumnTotals[this.dimension]) return [this.groupModel.multiSegmentColumnTotals[this.dimension][columnName]];
					}
				}, {
					key: 'getMultiSegmentTotalField',
					value: function getMultiSegmentTotalField() {
						if (this.groupModel.netMultiSegmentTotal) return this.groupModel.netMultiSegmentTotal[this.dimension];
					}
				}, {
					key: '_showSubtotal',
					value: function _showSubtotal() {
						if (!this.currencyMd) {
							this.currencyMd = { type: "currency", scale: this._getPriceScale(), CurrencyIsoCode: this.groupModel.quoteModel.quoteVO.record.CurrencyIsoCode };
						}
						if (this.editorModel.data.settings.lineEditorSubtotalsField != "doNotDisplay") {
							this._getNetTotalFieldMd();
							this.showSubtotal = true;
						} else {
							this.showSubtotal = false;
						}
					}
				}, {
					key: '_getNetTotalFieldMd',
					value: function _getNetTotalFieldMd() {
						var priceScale = void 0;
						var settings = this.editorModel.data.settings;
						var subtotalField = settings.lineEditorSubtotalsField;
						if (settings.isMultiCurrencyOrg) {
							priceScale = settings.currencyDecimalScale;
						} else {
							if (subtotalField == 'Default' || subtotalField == 'doNotDisplay' || subtotalField == null) {
								priceScale = this.editorModel.md.fieldsMap[settings.developerPrefix + 'QuoteLine__c'][this.editorModel.constants.NET_TOTAL_FIELD].scale;
							} else {
								priceScale = this.editorModel.md.fieldsMap[settings.developerPrefix + 'QuoteLine__c'][subtotalField].scale;
							}
						}
						return { type: "currency", scale: priceScale, CurrencyIsoCode: this.groupModel.quoteModel.quoteVO.record.CurrencyIsoCode };
					}
				}, {
					key: '_onSortLinesByHeader',
					value: function _onSortLinesByHeader(e) {
						this.sortLines(this.groupModel.segmentedLinesByDimension[this.dimension], e.detail.field, e.detail.order, false, true);
					}
				}, {
					key: 'sortLinesRequired',
					value: function sortLinesRequired(e) {
						var notify = e.detail.notify;
						var lineSortField = e.detail.lineSortField;
						this.sortLines(this.groupModel.segmentedLinesByDimension[this.dimension], lineSortField, 'asc', false, notify);
					}
				}, {
					key: 'sortLines',
					value: function sortLines(lines, lineSortField, order, bundleKeptTogether, notify) {
						var nameField = void 0;
						if (lineSortField && this.settings.lineLookups[lineSortField]) {
							var lineSortRelationshipField = RelationshipFieldManager.getRelationshipField(lineSortField, this.settings.lineLookups[lineSortField]),
							    fieldNames = lineSortRelationshipField.split(".");
							nameField = fieldNames[1];
							lineSortField = fieldNames[0];
						}
						var model = depthFirstLineItemsTreeSort(lines, lineSortField, order, bundleKeptTogether, nameField);
						if (notify) {
							this.set('groupModel.segmentedLinesByDimension.' + this.dimension, model.slice());

							this.notifyPath('lineModels', model.slice());
						} else {
							this.groupModel.segmentedLinesByDimension[this.dimension] = model;
						}
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_render(groupModel)', '_segmentedLinesByDimensionChanged(groupModel.segmentedLinesByDimension.*)', '_showSubtotal(groupModel.*)'];
					}
				}, {
					key: 'editorModel',
					get: function get() {
						return this.groupModel.quoteModel.editorModel;
					}
				}, {
					key: 'quoteVO',
					get: function get() {
						return this.editorModel.quoteModel.quoteVO;
					}
				}]);

				return SegmentedLines;
			}());

			_export('SegmentedLines', SegmentedLines);

			Polymer(SegmentedLines);
		}
	};
});

'use strict';

System.register('quotes/tables/sb-standard-lines/StandardLines.js', ['quotes/sb-line-sort/QuoteLineSort.js', 'common/core/sb-page-container/PageContainer.js', 'quotes/models/DragDropModel.js', 'common/layout/fields/FieldSetHandler.js', 'common/layout/table-layout-builder/TableLayoutBuilder.js', 'common/relationship/RelationshipFieldManager.js'], function (_export, _context) {
	var depthFirstLineItemsTreeSort, PageContainer, DragDropModel, isComponent, ifLineElementsShareParent, ifLineElementsAreParentChild, removeTableRowBorderClass, FieldSetHandler, TableLayoutBuilder, RelationshipFieldManager, _createClass, GHOST_X_OFFSET, GHOST_Y_OFFSET, StandardLines;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_quotesSbLineSortQuoteLineSortJs) {
			depthFirstLineItemsTreeSort = _quotesSbLineSortQuoteLineSortJs.depthFirstLineItemsTreeSort;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_quotesModelsDragDropModelJs) {
			DragDropModel = _quotesModelsDragDropModelJs.DragDropModel;
			isComponent = _quotesModelsDragDropModelJs.isComponent;
			ifLineElementsShareParent = _quotesModelsDragDropModelJs.ifLineElementsShareParent;
			ifLineElementsAreParentChild = _quotesModelsDragDropModelJs.ifLineElementsAreParentChild;
			removeTableRowBorderClass = _quotesModelsDragDropModelJs.removeTableRowBorderClass;
		}, function (_commonLayoutFieldsFieldSetHandlerJs) {
			FieldSetHandler = _commonLayoutFieldsFieldSetHandlerJs.FieldSetHandler;
		}, function (_commonLayoutTableLayoutBuilderTableLayoutBuilderJs) {
			TableLayoutBuilder = _commonLayoutTableLayoutBuilderTableLayoutBuilderJs.TableLayoutBuilder;
		}, function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			GHOST_X_OFFSET = 9;
			GHOST_Y_OFFSET = 147;

			_export('StandardLines', StandardLines = function () {
				function StandardLines() {
					_classCallCheck(this, StandardLines);
				}

				_createClass(StandardLines, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-standard-lines';
						this.properties = {
							groupModel: {
								type: Object,
								notify: true
							},
							settings: Object,
							fieldNames: Array,
							quoteLineFields: Object,
							fieldLabelsMap: {
								type: Object,
								notify: true
							},
							subtotal: {
								type: Number
							},
							subtotalMd: Object,
							dragDrop: Object,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}

						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.addEventListener('table-header-sort-clicked', this._onSortLinesByHeader);
						this.summaries = this.groupModel.quoteModel.grouped ? this.groupModel.groupVO.summaries : this.groupModel.quoteModel.quoteVO.summaries;
						var validTargets = new Set(['sb-droppable-standardRows', 'sb-droppable-emptyTable', 'sb-droppable-sidePanelGroups']);
						this.dragDrop = new DragDropModel(this, this.editorModel.data.settings.bundleKeptTogether, 'sb-le-table-row', validTargets, this.dragFunc.bind(this), this.trackFunc.bind(this), this.dropFunc.bind(this), GHOST_X_OFFSET, GHOST_Y_OFFSET);
					}
				}, {
					key: '_buildRows',
					value: function _buildRows() {
						this.actionsOnTheLeft = this.editorModel.actionsOnTheLeft;
						this.multiLineDeleteEnabled = this.editorModel.data.settings.multiLineDeleteEnabled;
						this.fieldSetHandler = new FieldSetHandler(this.editorModel.fieldsetMap, 'lineFieldNames', 'lineFieldNamesTablet', 'lineFieldNamesPhone');
						this._setFieldNames();
						this.columnWidths = {};
						this._setColumnWidths();
						this.columnNames = null;
						this.fieldLabelsMap = this.editorModel.md.fieldLabelsMap;
						this.quoteLineFields = this.editorModel.md.fieldsMap[this.editorModel.data.quoteLineObjectName];
						this.settings = this.editorModel.data.settings;
					}
				}, {
					key: '_setColumnWidths',
					value: function _setColumnWidths() {
						var colWidths = null;

						if (!this.editorModel.deviceContext.isMobile && this.editorModel.layout) {
							colWidths = this.editorModel.layout.colWidths[this.groupModel.groupKey]['Standard'];
							this._setSubtotalColumnWidth(colWidths, this.editorModel.layout.leftOffset);
						}
						this.set('columnWidths', colWidths);
					}
				}, {
					key: '_setSubtotalColumnWidth',
					value: function _setSubtotalColumnWidth(columnWidths, offset) {
						var labelColWidth = offset;

						var len = this.fieldNames.length;
						for (var i = 0; i < len - 1; i++) {
							var field = this.fieldNames[i];
							labelColWidth += columnWidths[field];
						}
						this.labelColWidth = labelColWidth + 'px';

						var lastColWidth = columnWidths[this.editorModel.constants.NET_TOTAL_FIELD];
						this.subtotalColWidth = lastColWidth + 'px';
					}
				}, {
					key: 'colWidthsChanged',
					value: function colWidthsChanged() {
						this._setColumnWidths();
					}
				}, {
					key: 'getStandardColWidths',
					value: function getStandardColWidths() {
						if (this.editorModel.deviceContext.isMobile) return;
						return this.editorModel.layout.colWidths[this.groupModel.groupKey]['Standard'];
					}
				}, {
					key: '_showSubtotal',
					value: function _showSubtotal() {
						var settings = this.editorModel.data.settings;
						if (!this.subtotalMd) {
							this.subtotalMd = { type: "currency", scale: this._getPriceScale(), CurrencyIsoCode: this.groupModel.quoteModel.quoteVO.record.CurrencyIsoCode };
						}
						if (settings.lineEditorSubtotalsField != "doNotDisplay" && this.groupModel.standardLines.length > 0) {
							this._getSubtotal();
							this.showSubtotal = true;
						} else {
							this.showSubtotal = false;
						}
					}
				}, {
					key: '_getPriceScale',
					value: function _getPriceScale() {
						var settings = this.editorModel.data.settings;
						var subtotalField = settings.lineEditorSubtotalsField;
						if (settings.isMultiCurrencyOrg) {
							return settings.currencyDecimalScale;
						}
						if (subtotalField == 'Default' || subtotalField == 'doNotDisplay' || subtotalField == null) {
							return this.editorModel.md.fieldsMap[this.prefix + 'QuoteLine__c'][this.editorModel.constants.NET_TOTAL_FIELD].scale;
						} else {
							return this.editorModel.md.fieldsMap[this.prefix + 'QuoteLine__c'][subtotalField].scale;
						}
					}
				}, {
					key: '_getSubtotal',
					value: function _getSubtotal() {
						var subtotalField = void 0,
						    subtotal = void 0,
						    settings = this.editorModel.data.settings,
						    priceScale = this._getPriceScale(),
						    lines = this.groupModel.standardLines;

						if (settings.lineEditorSubtotalsField == 'Default' || settings.lineEditorSubtotalsField == null) {
							subtotalField = this.editorModel.constants.NET_TOTAL_FIELD;
						} else {
							subtotalField = settings.lineEditorSubtotalsField;
						}

						subtotal = lines.reduce(function (prev, curr) {
							if (isNaN(curr.lineVO.record[subtotalField])) {
								return prev;
							} else {
								return prev + curr.lineVO.record[subtotalField];
							}
						}, 0);

						this.subtotal = subtotal.toFixed(priceScale);
					}
				}, {
					key: 'onTrack',
					value: function onTrack(e) {
						this.dragDrop._onTrack(e);
					}
				}, {
					key: 'dragFunc',
					value: function dragFunc(dragElement) {
						var dd = this.dragDrop;

						dd.ghost = dd.lineEditor.$.ghost;

						this.lineModelsByKey = this.groupModel.quoteModel.lineModelsByKey;

						dd.dragKeys = [];
						dd.dragStandardIndexes = [];
						dd.dragMdqIndexesByDim = {};
						dd.dragLineModels = [];
						dd.dragGroupModel = dragElement.lineModel.groupModel;

						dd.dragKeys.push(dragElement.lineModel.lineVO.key);

						if (dd.keepBundleTogether) this._getBundleWithChildren(dd.dragKeys[0], dd.dragKeys);

						dd.dragKeys.forEach(function (key) {
							var lm = this.lineModelsByKey[key];
							dd.dragLineModels.push(lm);
							if (!this.lineModelsByKey[key].segmented) {
								dd.dragStandardIndexes.push(this._getLineIndexFromKey(this.groupModel.standardLines, key));
							} else {
								if (dd.dragMdqIndexesByDim[lm.dimensionType]) {
									dd.dragMdqIndexesByDim[lm.dimensionType].push(this._getLineIndexFromKey(this.groupModel.segmentedLinesByDimension[lm.dimensionType], key));
								} else {
									dd.dragMdqIndexesByDim[lm.dimensionType] = [this._getLineIndexFromKey(this.groupModel.segmentedLinesByDimension[lm.dimensionType], key)];
								}
							}
						}.bind(this));

						dd.dragTargetElementIndex = this._getLineIndexFromKey(this.groupModel.standardLines, dragElement.lineModel.lineVO.key);

						for (var j = 0, index; j < dd.dragStandardIndexes.length; j++) {
							index = dd.dragStandardIndexes[j];
							this.set('groupModel.standardLines.' + index + '.hidden', true);
						}

						if (Object.keys(dd.dragMdqIndexesByDim).length != 0) {
							for (var k in dd.dragMdqIndexesByDim) {
								for (var l = 0, _index; l < dd.dragMdqIndexesByDim[k].length; l++) {
									_index = dd.dragMdqIndexesByDim[k][l];
									this.set('groupModel.segmentedLinesByDimension.' + k + '.' + _index + '.hidden', true);
								}
							}
						}

						dd.ghostField = dragElement.lineModel.lineVO.record[this.editorModel.constants.PRODUCT_CODE_FIELD];
					}
				}, {
					key: 'trackFunc',
					value: function trackFunc(hoverElement) {
						var dd = this.dragDrop,
						    keepBundleTogether = this.groupModel.editorModel.data.settings.bundleKeptTogether,
						    lastIndex = this.groupModel.standardLines.length - 1;

						hoverElement = dd._findTableRowValidTarget(hoverElement);
						if (!hoverElement) {
							dd.hoverOver = null;
							return;
						}
						switch (dd.targetClass) {
							case 'sb-droppable-standardRows':
								dd._updateTableRowHoverOverObject(hoverElement, lastIndex);
								if (!dd.hoverOver) {
									return;
								}
								dd.targetHost = dd.hoverOver.comp.domHost;
								dd.usePlaceholder = true;
								dd.enableHighLight = true;
								break;
							case 'sb-droppable-emptyTable':
								dd.hoverOver = dd.sourceElement.lineModel.component ? null : { "comp": hoverElement };
								dd.usePlaceholder = false;
								dd.enableHighLight = true;
								break;
							case 'sb-droppable-sidePanelGroups':
								if (!isComponent(dd.sourceElement)) {
									dd.hoverOver = { "comp": hoverElement };
								} else {
									dd.hoverOver = null;
									return;
								}
								dd.targetHost = dd.hoverOver.comp.parentNode.parentNode;
								dd.usePlaceholder = false;
								dd.enableHighLight = true;
								break;
						}
					}
				}, {
					key: 'dropFunc',
					value: function dropFunc(dragElement, dropElement, className, dropElementBefore) {
						var dropLeGroup = void 0,
						    dragLeGroup = dragElement.domHost.domHost,
						    dd = this.dragDrop;
						dd.dropKey = null;
						dd.dropIndex = null;
						dd.dropGroupModel = null;

						for (var k = 0, indH, l = dd.dragStandardIndexes ? dd.dragStandardIndexes.length : 0; k < l; k++) {
							indH = dd.dragStandardIndexes[k];
							this.set('groupModel.standardLines.' + indH + '.hidden', false);
						}

						if (Object.keys(dd.dragMdqIndexesByDim).length != 0) {
							for (var _k in dd.dragMdqIndexesByDim) {
								for (var _l = 0, index; _l < dd.dragMdqIndexesByDim[_k].length; _l++) {
									index = dd.dragMdqIndexesByDim[_k][_l];
									this.set('groupModel.segmentedLinesByDimension.' + _k + '.' + index + '.hidden', false);
								}
							}
						}
						if (!dropElement) return;

						if (dragElement.lineModel.subscriptionScopeEditable) {
							dd.dragGroupModel._updateStandardSubscriptionScopeEditable(dragElement.lineModel);
							this._setFieldNames();
							this._setColumnWidths();
						}

						this.splice('groupModel.standardLines', dd.dragTargetElementIndex, dd.dragStandardIndexes.length);

						switch (className) {
							case 'sb-droppable-standardRows':
								dd.dropKey = dropElement.lineModel.lineVO.key;
								dd.dropGroupModel = dropElement.lineModel.groupModel;
								dd.dropIndex = this._getLineIndexFromKey(dd.dropGroupModel.standardLines, dd.dropKey);
								dropLeGroup = dropElement.domHost.domHost;
								if (dropElementBefore) {
									dd.dropIndex = dd.dropIndex >= 0 ? dd.dropIndex : 0;
								} else {
									++dd.dropIndex;
								}
								break;
							case 'sb-droppable-emptyTable':
								dropLeGroup = dropElement.parentNode.parentNode.parentNode.host ? dropElement.parentNode.parentNode.parentNode.host : dropElement.parentNode.parentNode.parentNode;
								dd.dropGroupModel = dropLeGroup.groupModel;
								break;
							case 'sb-droppable-sidePanelGroups':
								var dropGroupId = 'Group' + dropElement.getAttribute('id');
								var groupContainer = dd._findParentCustomElement(dropElement, 'groupContainer', 'id');
								dropLeGroup = groupContainer.querySelector('#' + dropGroupId);
								dd.dropGroupModel = dropLeGroup.groupModel;
								break;
						}

						for (var _l2 = 0; _l2 < dd.dragLineModels.length; _l2++) {
							if (!dd.dragLineModels[_l2].segmented) {
								if (dd.dragLineModels[_l2].subscriptionScopeEditable) {
									dd.dropGroupModel.standardSubscriptionScopeEditable = true;
									Polymer.RenderStatus.afterNextRender(Polymer.dom(dropLeGroup.root).querySelector('#standardLines'), function () {
										Polymer.dom(dropLeGroup.root).querySelector('#standardLines')._setFieldNames();
										Polymer.dom(dropLeGroup.root).querySelector('#standardLines')._setColumnWidths();
									});
								}
								switch (className) {
									case 'sb-droppable-standardRows':
										dropElement.domHost.splice('groupModel.standardLines', dd.dropIndex, 0, dd.dragLineModels[_l2]);
										break;
									case 'sb-droppable-emptyTable':
										dropLeGroup.push('groupModel.standardLines', dd.dragLineModels[_l2]);
										break;
									case 'sb-droppable-sidePanelGroups':
										dropLeGroup.push('groupModel.standardLines', dd.dragLineModels[_l2]);
										break;
								}

								dd.dragLineModels[_l2].groupModel = dd.dropGroupModel;
								dd.dragLineModels[_l2].lineVO.parentGroupKey = dd.dropGroupModel.groupKey;
								dd.dropIndex++;
							} else {
								if (dd.dragGroupModel.groupKey === dd.dropGroupModel.groupKey) return;
								if (!dd.dropGroupModel.dimensions.includes(dd.dragLineModels[_l2].segmentType)) {
									dropLeGroup.addSegmentedLineToEmptyTable(dd.dragLineModels[_l2]);
								} else {
									dropLeGroup.addSegmentedLineToExistingTab(dd.dragLineModels[_l2]);
								}
							}
						}

						if (Object.keys(dd.dragMdqIndexesByDim).length != 0) {
							for (var _k2 in dd.dragMdqIndexesByDim) {
								dd.dragMdqIndexesByDim[_k2].reverse();
								for (var _l3 = 0, _index2; _l3 < dd.dragMdqIndexesByDim[_k2].length; _l3++) {
									_index2 = dd.dragMdqIndexesByDim[_k2][_l3];
									this.set('groupModel.segmentedLinesByDimension.' + _k2 + '.' + _index2 + '.hidden', false);
									if (dd.dragGroupModel.groupKey !== dd.dropGroupModel.groupKey) {
										var mdqLm = dragLeGroup.groupModel.segmentedLinesByDimension[_k2][_index2];
										dragLeGroup.removeSegmentedLine(mdqLm);
									}
								}
							}
						}

						this.fire('renumber-lines');
						if (this.editorModel.data.settings.usesClientCalculator) {
							this.editorModel.quoteModel.renumberIndexes(true);
						}
					}
				}, {
					key: '_getBundleWithChildren',
					value: function _getBundleWithChildren(key, keyArray) {
						var length = void 0;
						if (this.dragDrop.linesByParentKey[key]) {
							length = this.dragDrop.linesByParentKey[key].length;
						} else {
							return;
						}
						for (var j = 0; j < length; j++) {
							var nextKey = this.dragDrop.linesByParentKey[key][j].lineVO.key;
							keyArray.push(nextKey);
							if (this.dragDrop.linesByParentKey[nextKey]) {
								this._getBundleWithChildren(nextKey, keyArray);
							}
						}
					}
				}, {
					key: '_getLineIndexFromKey',
					value: function _getLineIndexFromKey(lines, key) {
						var index = void 0;
						for (var i = 0; i < lines.length; i++) {
							if (lines[i].lineVO.key === key) {
								index = i;
								return index;
							}
						}
					}
				}, {
					key: '_getStandardLineIndexesFromKeys',
					value: function _getStandardLineIndexesFromKeys(lines, keys) {
						var indexes = [];
						for (var j = 0; j < keys.length; j++) {
							indexes.push(this._getStandardLineIndexFromKey(lines, keys[j]));
						}
						return indexes;
					}
				}, {
					key: '_setFieldNames',
					value: function _setFieldNames() {
						this.fieldSet = this.fieldSetHandler.getByViewport(this.viewport);
						if (this.fieldSetName != this.fieldSet.name) {
							this.fieldSetName = this.fieldSet.name;
						}
						this.fieldNames = this._getFields();
					}
				}, {
					key: '_getFields',
					value: function _getFields() {
						return this.groupModel.standardSubscriptionScopeEditable ? [this.editorModel.constants.SUBSCRIPTION_SCOPE_FIELD].concat(this.fieldSet.fields) : this.fieldSet.fields;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
						this._setFieldNames();
					}
				}, {
					key: 'groupPanelToggled',
					value: function groupPanelToggled(e) {
						this.drawerState = e.detail.drawerState;
						this._setColumnWidths();
					}
				}, {
					key: 'groupPanelCreated',
					value: function groupPanelCreated(e) {
						this._setColumnWidths();
					}
				}, {
					key: '_onSortLinesByHeader',
					value: function _onSortLinesByHeader(e) {
						var bundleKeptTogether = this.editorModel.data.settings.bundleKeptTogether;
						this.sortLines(this.groupModel.standardLines, e.detail.field, e.detail.order, bundleKeptTogether, true);
					}
				}, {
					key: 'sortLinesRequired',
					value: function sortLinesRequired(e) {
						var notify = e.detail.notify;
						var lineSortField = e.detail.lineSortField;
						this.sortLines(this.groupModel.standardLines, lineSortField, 'asc', false, notify);
					}
				}, {
					key: 'sortLines',
					value: function sortLines(lines, lineSortField, order, bundleKeptTogether, notify) {
						var nameField = void 0;
						if (lineSortField && this.settings.lineLookups[lineSortField]) {
							var lineSortRelationshipField = RelationshipFieldManager.getRelationshipField(lineSortField, this.settings.lineLookups[lineSortField]),
							    fieldNames = lineSortRelationshipField.split(".");
							nameField = fieldNames[1];
							lineSortField = fieldNames[0];
						}
						var model = depthFirstLineItemsTreeSort(lines, lineSortField, order, bundleKeptTogether, nameField);
						if (notify) {
							this.set('groupModel.standardLines', model.slice());
						} else {
							this.groupModel.standardLines = model;
						}
					}
				}, {
					key: '_updatePrimaryMobileColumns',
					value: function _updatePrimaryMobileColumns() {
						if (this.groupModel.editorModel.standardPrimaryMobileCols && this.groupModel.editorModel.standardPrimaryMobileCols.length > 0 && this.fieldSet.name.endsWith('Phone')) this.groupModel.editorModel.standardPrimaryMobileCols[0] = this.fieldSet.fields[0];
					}
				}, {
					key: '_lineSplicesListener',
					value: function _lineSplicesListener(changeRecord) {
						if (!changeRecord) return;
						this.set('groupModel.hasVisibleStandardLines', this.groupModel._groupHasStandardProducts());
						this._showSubtotal();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_buildRows(groupModel)', '_updatePrimaryMobileColumns(fieldSet, groupModel.editorModel.standardPrimaryMobileCols)', '_lineSplicesListener(groupModel.standardLines.splices)', '_showSubtotal(groupModel.*)'];
					}
				}, {
					key: 'editorModel',
					get: function get() {
						return this.groupModel.quoteModel.editorModel;
					}
				}, {
					key: 'md',
					get: function get() {
						return this.editorModel.md;
					}
				}, {
					key: 'prefix',
					get: function get() {
						return this.editorModel.data.developerPrefix;
					}
				}]);

				return StandardLines;
			}());

			_export('StandardLines', StandardLines);

			Polymer(StandardLines);
		}
	};
});

'use strict';

System.register('assets/selection/routes/sb-asset-lookup/AssetLookup.js', ['common/core/Page.js', 'common/filter/searcher/Searcher.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, Searcher, ErrorFormatter, _createClass, AssetLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonFilterSearcherSearcherJs) {
			Searcher = _commonFilterSearcherSearcherJs.Searcher;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('AssetLookup', AssetLookup = function (_Page) {
				_inherits(AssetLookup, _Page);

				function AssetLookup() {
					_classCallCheck(this, AssetLookup);

					return _possibleConstructorReturn(this, (AssetLookup.__proto__ || Object.getPrototypeOf(AssetLookup)).apply(this, arguments));
				}

				_createClass(AssetLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-asset-lookup';
						this.properties = Polymer.Base.extend({
							selectedProducts: {
								type: Object,
								value: {}
							},
							lineEditorModel: Object,
							totalCount: String,
							hasTotalCount: Boolean,
							quote: Object,
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							error: {
								type: Array,
								value: []
							},
							groupKey: {
								type: String,
								computed: 'getGroupKey(ctx.params)'
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.preLoadObjects();
					}
				}, {
					key: 'handleProductsLoadServerResponse',
					value: function handleProductsLoadServerResponse() {
						this.$.qo.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
							this.$.smLoadService.quote = this.quote = e.detail.value.quote;
						}.bind(this));

						this.$.smLoadService.addEventListener('search-model-changed', function (e) {
							this.searchModel = e.detail.value;
							this.primaryMobileColumn = this.searchModel.resultFieldNames[0];
							this.searcher = new Searcher(this.searchModel);
							this.hasTotalCount = this.searchModel.totalCount > 0;
							this.totalCount = this.searchModel.totalCount;
						}.bind(this));
					}
				}, {
					key: 'toggleFilter',
					value: function toggleFilter() {
						this.$$('sb-page-header')._closeMenu();
						this.$.drawer.$.drawer.togglePanel();
					}
				}, {
					key: 'removeFilter',
					value: function removeFilter() {
						this.$$('.actions').removeChild(this.$$('#fb'));
					}
				}, {
					key: 'deSelectAll',
					value: function deSelectAll() {
						this.$.lookupLayout.deSelectAll();
					}
				}, {
					key: 'onSelect',
					value: function onSelect() {
						if (this.selectedProducts && Object.keys(this.selectedProducts).length > 0) return this.navigateToAssetUpgradeRoute();

						this.onCancel();
					}
				}, {
					key: 'navigateToAssetUpgradeRoute',
					value: function navigateToAssetUpgradeRoute() {
						var queryParams = {
							qId: this.lineEditorModel.quote.record.Id,
							pIds: Object.keys(this.selectedProducts)
						};

						if (this.groupKey !== undefined) queryParams.groupKey = this.groupKey;
						return this.nav('#', queryParams, ['asset', 'upgrade'], false);
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.spinner = true;
						this.nav('#', { 'qId': this.lineEditorModel.quote.record.Id }, ['quote', 'le'], false);
					}
				}, {
					key: 'runSearcher',
					value: function runSearcher() {
						this.$$('#submit').focus();
						this.$.af.runService(this.actionId);
						this.$.drawer.$.drawer.closeDrawer();
					}
				}, {
					key: 'bindFilterEnterCallBacks',
					value: function bindFilterEnterCallBacks() {
						this.$.af.enterCallback = this.runSearcher.bind(this);
					}
				}, {
					key: 'clearFilterFields',
					value: function clearFilterFields() {
						this.filterData = this.searcher.clearFields();
					}
				}, {
					key: 'preLoadObjects',
					value: function preLoadObjects() {
						this.assetLookupObjects = ['Asset'];
					}
				}, {
					key: 'getGroupKey',
					value: function getGroupKey() {
						return this.ctx.params.groupKey;
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.error = new ErrorFormatter(this.errors).truncate();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior, window.CommonBehaviors.LookupBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}, {
					key: 'actionId',
					get: function get() {
						return this.ctx.params.aId;
					}
				}]);

				return AssetLookup;
			}(Page));

			_export('AssetLookup', AssetLookup);

			Polymer(AssetLookup);
		}
	};
});

'use strict';

System.register('assets/upgrade/routes/sb-asset-upgrade/AssetUpgrade.js', ['common/layout/tables/TableClassBuilder.js', 'common/layout/data/RecordGrouper.js', 'common/core/Page.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var TableClassBuilder, RecordGrouper, Page, ErrorFormatter, _createClass, AssetUpgrade;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonLayoutDataRecordGrouperJs) {
			RecordGrouper = _commonLayoutDataRecordGrouperJs.RecordGrouper;
		}, function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('AssetUpgrade', AssetUpgrade = function () {
				function AssetUpgrade() {
					_classCallCheck(this, AssetUpgrade);
				}

				_createClass(AssetUpgrade, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-asset-upgrade';
						this.properties = Polymer.Base.extend({
							upgrades: Array,
							upgradeSourceMap: Object,
							upgradeTargetMap: Object,
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							validationMessages: {
								type: Array,
								value: []
							},
							assetHeaderSelectable: {
								type: Boolean,
								value: false
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.initializeServiceSpinners();
						this.initializeProperties();
						this.preLoadObjects();
						this.handleUpgradeSelected();
						this.handleMetaDataResponse();
						this.handleAddProductResponse();
						this.handleLineEditorModelResponse();
						this.handleSelectionResponse();
					}
				}, {
					key: 'initializeProperties',
					value: function initializeProperties() {
						this.upgradeSourceMap = {};
						this.upgradeTargetMap = {};
					}
				}, {
					key: 'initializeServiceSpinners',
					value: function initializeServiceSpinners() {
						this.$.addProducts.background = false;
						this.$.smSelectService.background = false;
					}
				}, {
					key: 'onSelect',
					value: function onSelect() {
						var upgrades = this.getSelectedUpgrades();
						if (upgrades === false) return;

						this.$.addProducts.products = upgrades;
					}
				}, {
					key: 'navigateToLineEditor',
					value: function navigateToLineEditor() {
						var quoteId = this.lineEditorModel ? this.lineEditorModel.quote.record.Id : this.ctx.params.qId;
						this.nav('#', { 'qId': quoteId }, ['quote', 'le'], false);
					}
				}, {
					key: 'renderUpgrades',
					value: function renderUpgrades() {
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.upgrades[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var upgrade = _step.value;

								this.upgradeSourceMap[upgrade.record.Product2Id] = {
									upgradeSelected: false,
									Id: upgrade.record.Id,
									name: upgrade.record.Name
								};
								var _iteratorNormalCompletion2 = true;
								var _didIteratorError2 = false;
								var _iteratorError2 = undefined;

								try {
									for (var _iterator2 = upgrade.availableUpgrades[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
										var upgradeTarget = _step2.value;

										var upgradeProduct2Id = upgrade.record.Product2Id;

										if (this.upgradeTargetMap.hasOwnProperty(upgradeTarget.record.Id)) {
											this.upgradeTargetMap[upgradeTarget.record.Id].sourceProducts[upgradeProduct2Id] = { 'upgradeSelected': false };
										} else {
											var sourceProductObject = {};
											sourceProductObject[upgradeProduct2Id] = { 'upgradeSelected': false };

											this.upgradeTargetMap[upgradeTarget.record.Id] = {
												sourceProducts: sourceProductObject
											};
										}
									}
								} catch (err) {
									_didIteratorError2 = true;
									_iteratorError2 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion2 && _iterator2.return) {
											_iterator2.return();
										}
									} finally {
										if (_didIteratorError2) {
											throw _iteratorError2;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						this.upgradeResults = this.upgrades;
					}
				}, {
					key: 'getUpgrades',
					value: function getUpgrades() {
						if (this.ctx.params.pIds === undefined) this.navigateToLineEditor();
						this.$.smSelectService.selectedProducts = this.ctx.params.pIds.split(',');
					}
				}, {
					key: 'getSelectedProducts',
					value: function getSelectedProducts() {
						var selectedUpgrades = this.getSelectedUpgrades(),
						    selectedProducts = {};

						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = (selectedUpgrades || [])[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var upgrade = _step3.value;

								selectedProducts[upgrade.record.Id] = {
									record: upgrade.record,
									upgradedAssetId: upgrade.upgradedAssetId
								};
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						return selectedProducts;
					}
				}, {
					key: 'applyUpgrades',
					value: function applyUpgrades() {
						var upgrades = this.$.upgrades.getUpgrades();
						if (upgrades === false) return;

						this.$.addProducts.products = upgrades;
					}
				}, {
					key: 'getSelectedUpgrades',
					value: function getSelectedUpgrades() {
						var addProductsArray = [],
						    validationMessages = [];

						for (var i in this.upgradeTargetMap) {
							var targetProduct = this.upgradeTargetMap[i];

							for (var sourceProductId in targetProduct.sourceProducts) {
								var sourceProduct = this.upgradeSourceMap[sourceProductId];

								if (sourceProduct.upgradeSelected === true) continue;

								sourceProduct.upgradeSelected = targetProduct.sourceProducts[sourceProductId].upgradeSelected;
								sourceProduct.upgrade = targetProduct.rowData;
							}
						}

						for (var _i in this.upgradeSourceMap) {
							if (this.upgradeSourceMap[_i].upgradeSelected === false) {
								validationMessages.push('You must select and upgrade for ' + this.upgradeSourceMap[_i].name);
								continue;
							}

							addProductsArray.push({
								record: this.upgradeSourceMap[_i].upgrade,
								upgradedAssetId: this.upgradeSourceMap[_i].Id });
						}
						this.validationMessages = validationMessages;

						if (validationMessages.length > 0) return;

						return addProductsArray;
					}
				}, {
					key: 'handleUpgradeSelected',
					value: function handleUpgradeSelected() {
						this.addEventListener('selection-changed', function (e) {
							this.ifRadioSelectedClearOtherRadioSelections(e);
							var selected = e.detail.selected,
							    upgradeTargetMap = this.upgradeTargetMap[e.detail.rowData.Id];
							upgradeTargetMap.sourceProducts[e.detail.rowData._transient_.sourceProduct].upgradeSelected = selected;
							upgradeTargetMap.rowData = selected === true ? e.detail.rowData : undefined;
						}.bind(this));
					}
				}, {
					key: 'handleMetaDataResponse',
					value: function handleMetaDataResponse() {
						this.$.md.addEventListener('md-changed', function (e) {
							var recordKeys = [],
							    fieldLabels = [],
							    fieldLabelMap = {},
							    typeMap = {},
							    labelTypeMap = {},
							    itemTypeMap = {},
							    fields = e.detail.value.fields;
							fields.forEach(function (field) {
								var key = field.name;
								recordKeys.push(key);
								fieldLabels.push(field.label);
								fieldLabelMap[key] = field.label;
								typeMap[key] = { type: field.type };
								labelTypeMap[field.label.replace(/\W/g, '')] = field.type;
								itemTypeMap[key] = field.type;
							}.bind(this));
							this.headerClassMap = new TableClassBuilder(Object.keys(labelTypeMap), 'Th', labelTypeMap).build();
							this.rowClassMap = new TableClassBuilder(recordKeys, 'Td', itemTypeMap).build();
							this.typeMap = typeMap;
							this.recordKeys = recordKeys;
							this.fieldLabels = fieldLabels;
							this.fieldLabelMap = fieldLabelMap;
						}.bind(this));
					}
				}, {
					key: 'handleAddProductResponse',
					value: function handleAddProductResponse() {
						this.$.addProducts.addEventListener('psm-response-changed', function (e) {
							if (e.detail.value.quote === undefined) return;

							this.lineEditorModel.quote = e.detail.value.quote;
							if (e.detail.value.configuredProducts !== undefined && e.detail.value.configuredProducts.length > 0) this.handleConfigurableProducts(e);else this.navigateToLineEditor();
						}.bind(this));
					}
				}, {
					key: 'handleConfigurableProducts',
					value: function handleConfigurableProducts(e) {
						var response = e.detail.value;
						var queryParams = {};
						var configProductIds = this.getConfigProductIds(response);
						queryParams.qId = e.detail.value.quote.record.Id;
						if (this.ctx.params.groupKey !== undefined) queryParams.groupKey = this.ctx.params.groupKey;
						queryParams.pId = configProductIds;
						response.selectedProducts = this.getSelectedProducts();
						this.nav('#', queryParams, ['product', 'pc'], false);
					}
				}, {
					key: 'getConfigProductIds',
					value: function getConfigProductIds(products) {
						var productIds = [];
						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = products.configuredProducts[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var product = _step4.value;

								productIds.push(product.record.Id);
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}

						return productIds.join(',');
					}
				}, {
					key: 'handleLineEditorModelResponse',
					value: function handleLineEditorModelResponse() {
						this.$.qo.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
							this.$.addProducts.quote = this.$.smSelectService.quote = this.quote = e.detail.value.quote;
						}.bind(this));
					}
				}, {
					key: 'handleSelectionResponse',
					value: function handleSelectionResponse() {
						this.$.smSelectService.useCache = false;
						this.$.smSelectService.addEventListener('result-changed', function (e) {
							if (e.detail.value[0] === undefined || Array.isArray(e.detail.value[0].availableUpgrades) === false) return this.navigateToLineEditor();
							this.upgrades = e.detail.value;
						}.bind(this));
					}
				}, {
					key: 'preLoadObjects',
					value: function preLoadObjects() {
						this.assetUpgradeObjects = ['Product2'];
					}
				}, {
					key: 'ifRadioSelectedClearOtherRadioSelections',
					value: function ifRadioSelectedClearOtherRadioSelections(e) {
						if (e.detail.selected === false || e.detail.selected === undefined) return;
						var root = Polymer.dom(e).rootTarget,
						    rows = Polymer.dom(root.parentElement).querySelectorAll('sb-table-row');var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {

							for (var _iterator5 = rows[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var row = _step5.value;

								if (row.selectionType === 'radio' && row !== root) row.selected = false;
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.validationMessages = new ErrorFormatter(this.errors).truncate();
					}
				}, {
					key: 'buildRowDataArray',
					value: function buildRowDataArray(upgrade) {
						var availableUpgrades = [];

						var _iteratorNormalCompletion6 = true;
						var _didIteratorError6 = false;
						var _iteratorError6 = undefined;

						try {
							for (var _iterator6 = (upgrade.availableUpgrades || [])[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
								var availableUpgrade = _step6.value;

								availableUpgrade.record._transient_ = { sourceProduct: upgrade.record.Product2Id };
								availableUpgrades.push(availableUpgrade);
							}
						} catch (err) {
							_didIteratorError6 = true;
							_iteratorError6 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion6 && _iterator6.return) {
									_iterator6.return();
								}
							} finally {
								if (_didIteratorError6) {
									throw _iteratorError6;
								}
							}
						}

						return availableUpgrades;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['renderUpgrades(upgrades, recordKeys)', 'getUpgrades(ctx.params.pIds)'];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}, {
					key: 'fieldPrefix',
					get: function get() {
						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}]);

				return AssetUpgrade;
			}());

			_export('AssetUpgrade', AssetUpgrade);

			Polymer(AssetUpgrade);
		}
	};
});

'use strict';

System.register('common/forms/sb-checkbox/factory/CheckboxFactory.js', ['common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var FormField, _createClass, CheckboxFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('CheckboxFactory', CheckboxFactory = function () {
				function CheckboxFactory(value, disabled, hidden) {
					_classCallCheck(this, CheckboxFactory);

					this.value = value;
					this.disabled = disabled;
					this.hidden = hidden;
				}

				_createClass(CheckboxFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						var ff = new FormField('sb-checkbox');
						ff.addAttribute('value', 2, 'value', this.value);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('hide', 1, 'hide', this.hidden);

						ff.formattedValue = { value: this.value, label: '' };
						return ff;
					}
				}]);

				return CheckboxFactory;
			}());

			_export('CheckboxFactory', CheckboxFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-datepicker/factory/DatePickerFactory.js', ['common/forms/sb-field/factory/SimpleFieldFactory.js', 'common/core/sb-page-container/PageContainer.js', 'common/forms/sb-input/factory/InputFactory.js', 'common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var SimpleFieldFactory, PageContainer, InputFactory, FormField, _createClass, DatePickerFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonFormsSbInputFactoryInputFactoryJs) {
			InputFactory = _commonFormsSbInputFactoryInputFactoryJs.InputFactory;
		}, function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DatePickerFactory', DatePickerFactory = function () {
				function DatePickerFactory(value, editable, disabled, i18n, renderReadOnly, type, viewport) {
					_classCallCheck(this, DatePickerFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.i18n = i18n;
					this.renderReadOnly = renderReadOnly;
					this.type = type;
					this.viewport = viewport || PageContainer.getViewport();
				}

				_createClass(DatePickerFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						if (!this.editable) return this.newFormattedDate();

						if (this.viewport && this.viewport.isMobile()) return this.newMobileDatePicker();

						return this.newDatePicker();
					}
				}, {
					key: 'newMobileDatePicker',
					value: function newMobileDatePicker() {
						return new InputFactory(this.value, this.editable, this.disabled, this.type, 'dateInput', this.type).newFormField();
					}
				}, {
					key: 'newDatePicker',
					value: function newDatePicker() {
						var ff = new FormField('sb-datepicker');
						ff.addAttribute('selected-date', 2, 'value', this.value);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('is-blank', 1, 'isBlank', true);
						ff.addAttribute('use-mask', 1, 'useMask', !this.renderReadOnly);

						ff.readOnlyKeyEvent = 'sb-date-esc';
						ff.readOnlyBlurEvent = 'sb-date-blur';
						ff.changeEvent = 'selected-date-changed';

						this.setFormattedValue(ff, this.getFormattedValue());
						return ff;
					}
				}, {
					key: 'newFormattedDate',
					value: function newFormattedDate() {
						var formattedValue = this.getFormattedValue();
						var ff = new SimpleFieldFactory(formattedValue, this.type).newFormField();
						this.setFormattedValue(ff, formattedValue);
						return ff;
					}
				}, {
					key: 'getFormattedValue',
					value: function getFormattedValue() {
						return this.i18n.format(this.value, { date: true });
					}
				}, {
					key: 'setFormattedValue',
					value: function setFormattedValue(ff, formattedDate) {
						ff.formattedValue = { value: this.value, label: formattedDate };
					}
				}]);

				return DatePickerFactory;
			}());

			_export('DatePickerFactory', DatePickerFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-discount/factory/DiscountFactory.js', ['common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var FormField, _createClass, DiscountFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DiscountFactory', DiscountFactory = function () {
				function DiscountFactory(disabled, renderReadOnly, discountDetails, inputType, pattern, numberFormatter) {
					_classCallCheck(this, DiscountFactory);

					this.disabled = disabled;
					this.renderReadOnly = renderReadOnly;
					this.discountDetails = discountDetails;
					this.inputType = inputType;
					this.pattern = pattern;
					this.numberFormatter = numberFormatter;
				}

				_createClass(DiscountFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						var ff = new FormField('sb-discount');
						ff.addAttribute('discount-details', 1, 'discountDetails', this.discountDetails);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('render-read-only', 1, 'renderReadOnly', this.renderReadOnly);
						ff.addAttribute('input-type', 1, 'inputType', this.inputType);
						ff.addAttribute('pattern', 1, 'pattern', this.pattern);
						ff.addAttribute('formatter', 1, 'formatter', this.numberFormatter);

						ff.readOnlyBlurEvent = 'sb-discount-blur';
						ff.changeEvent = 'sb-discount-change';

						var label = this.numberFormatter.format(this.discountDetails.displayValue);
						var discountUnit = this.getDiscountUnit();
						var unit = label != null && label !== '' ? discountUnit.label : '';
						ff.formattedValue = { value: this.discountDetails.value, label: label, unit: unit, unitValue: discountUnit.value };

						ff.addAttribute('display-value', 1, 'displayValue', label);
						ff.addAttribute('original', 1, 'original', ff.formattedValue);
						return ff;
					}
				}, {
					key: 'getDiscountUnit',
					value: function getDiscountUnit() {
						if (!this.discountDetails || !this.discountDetails.units || this.isNil(this.discountDetails.value)) return { label: '', value: '' };

						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.discountDetails.units[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var unit = _step.value;

								if (unit.value === this.discountDetails.unit) return { label: unit.label, value: unit.value };
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'isNil',
					value: function isNil(value) {
						return value === undefined || value === null || value === '' || isNaN(value);
					}
				}]);

				return DiscountFactory;
			}());

			_export('DiscountFactory', DiscountFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-field/factory/FieldFactory.js', ['common/forms/sb-checkbox/factory/CheckboxFactory.js', 'common/forms/sb-datepicker/factory/DatePickerFactory.js', 'common/forms/sb-field/factory/NumericFieldFactory.js', 'common/forms/sb-field/factory/SimpleFieldFactory.js', 'common/forms/sb-lookup/factory/LookupFactory.js', 'common/forms/sb-select/factory/SelectFactory.js', 'common/forms/sb-field/factory/TextFieldFactory.js'], function (_export, _context) {
	var CheckboxFactory, DatePickerFactory, NumericFieldFactory, SimpleFieldFactory, LookupFactory, SelectFactory, TextFieldFactory, _createClass, FieldFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbCheckboxFactoryCheckboxFactoryJs) {
			CheckboxFactory = _commonFormsSbCheckboxFactoryCheckboxFactoryJs.CheckboxFactory;
		}, function (_commonFormsSbDatepickerFactoryDatePickerFactoryJs) {
			DatePickerFactory = _commonFormsSbDatepickerFactoryDatePickerFactoryJs.DatePickerFactory;
		}, function (_commonFormsSbFieldFactoryNumericFieldFactoryJs) {
			NumericFieldFactory = _commonFormsSbFieldFactoryNumericFieldFactoryJs.NumericFieldFactory;
		}, function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}, function (_commonFormsSbLookupFactoryLookupFactoryJs) {
			LookupFactory = _commonFormsSbLookupFactoryLookupFactoryJs.LookupFactory;
		}, function (_commonFormsSbSelectFactorySelectFactoryJs) {
			SelectFactory = _commonFormsSbSelectFactorySelectFactoryJs.SelectFactory;
		}, function (_commonFormsSbFieldFactoryTextFieldFactoryJs) {
			TextFieldFactory = _commonFormsSbFieldFactoryTextFieldFactoryJs.TextFieldFactory;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('FieldFactory', FieldFactory = function () {
				function FieldFactory(value, editable, disabled, hidden, index, metadata, i18n, renderReadOnly, selectOptions, referenceDetails, discountDetails, preventNumericAlignment) {
					_classCallCheck(this, FieldFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.hidden = hidden;
					this.index = index;
					this.metadata = metadata;
					this.i18n = i18n;
					this.renderReadOnly = renderReadOnly;
					this.selectOptions = selectOptions;
					this.referenceDetails = referenceDetails;
					this.discountDetails = discountDetails;
					this.preventNumericAlignment = preventNumericAlignment;
				}

				_createClass(FieldFactory, [{
					key: 'newFormField',
					value: function newFormField(type) {
						switch (type) {
							case 'boolean':
							case 'checkbox':
								return new CheckboxFactory(this.value, this.disabled, this.hidden).newFormField();
							case 'date':
							case 'datetime':
								return new DatePickerFactory(this.value, this.editable, this.disabled, this.i18n, this.renderReadOnly, type).newFormField();
							case 'double':
							case 'number':
							case 'currency':
							case 'percent':
								return new NumericFieldFactory(this.value, this.editable, this.disabled, this.metadata, this.i18n, this.renderReadOnly, this.discountDetails, this.index == 0 ? 'first numberInput' : 'numberInput', type).newFormField();
							case 'id':
							case 'reference':
								return new LookupFactory(this.value, this.editable, this.disabled, this.metadata, this.referenceDetails, this.renderReadOnly, type).newFormField();
							case 'picklist':
							case 'multipicklist':
								return new SelectFactory(this.value, this.editable, this.disabled, type, this.metadata, this.i18n, !this.renderReadOnly, this.selectOptions).newFormField();
							case 'string':
							case 'textarea':
								return new TextFieldFactory(this.value, this.editable, this.disabled, this.metadata, this.renderReadOnly, type).newFormField();
							default:
								return new SimpleFieldFactory(this.value, type).newFormField();
						}
					}
				}]);

				return FieldFactory;
			}());

			_export('FieldFactory', FieldFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-field/factory/FormField.js', [], function (_export, _context) {
	var _createClass, FRONT_BINDING, BACK_BINDING, FormField;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			FRONT_BINDING = { 0: '', 1: '[[', 2: '{{' };
			BACK_BINDING = { 0: '', 1: ']]', 2: '}}' };

			_export('FormField', FormField = function () {
				function FormField(name) {
					_classCallCheck(this, FormField);

					this.name = name;
					this.attributes = [];
					this.events = [];
				}

				_createClass(FormField, [{
					key: 'addAttribute',
					value: function addAttribute(name, binding, variable, value, equals) {
						this.attributes.push({ name: name, binding: binding, variable: variable, value: value, equals: equals || '=' });
					}
				}, {
					key: 'addEvent',
					value: function addEvent(event, variable, handler) {
						this.events.push({ event: event, variable: variable, handler: handler });
					}
				}, {
					key: 'setInnerText',
					value: function setInnerText(variable, binding, value) {
						this.innerText = { variable: variable, binding: binding, value: value };
					}
				}, {
					key: 'attachTo',
					value: function attachTo(template, readOnlyKeyHandler, readOnlyBlurHandler, changeHandler, hiddenField, focusOnAttached) {
						this._html = '<' + this.name;

						for (var i in this.attributes) {
							var attribute = this.attributes[i];
							this._html += ' ' + attribute.name + attribute.equals + '"' + FRONT_BINDING[attribute.binding] + attribute.variable + BACK_BINDING[attribute.binding] + '"';
							template[attribute.variable] = attribute.value;
						}

						for (var j in this.events) {
							var event = this.events[j];
							this._html += ' on-' + event.event + '="' + event.variable + '"';
							template[event.variable] = event.handler;
						}

						if (readOnlyKeyHandler) this._html += ' on-' + this.readOnlyKeyEvent + '="' + readOnlyKeyHandler + '"';

						if (readOnlyBlurHandler) this._html += ' on-' + this.readOnlyBlurEvent + '="' + readOnlyBlurHandler + '"';

						if (changeHandler) this._html += ' on-' + this.changeEvent + '="' + changeHandler + '"';

						if (hiddenField) this._html += ' hidden$="[[' + hiddenField + ']]"';

						if (focusOnAttached) this._html += ' focus-on-attached="true"';

						this._html += ' apply-focus="[[applyFocus]]"';

						this._html += '>';

						if (this.innerText) {
							this._html += '' + FRONT_BINDING[this.innerText.binding] + this.innerText.variable + BACK_BINDING[this.innerText.binding];
							template[this.innerText.variable] = this.innerText.value;
						}

						this._html += '</' + this.name + '>';
					}
				}, {
					key: 'formattedValue',
					get: function get() {
						return this._formattedValue;
					},
					set: function set(formattedValue) {
						this._formattedValue = formattedValue != null && Object.keys(formattedValue).indexOf('label') !== -1 ? formattedValue : { value: formattedValue, label: formattedValue };
					}
				}, {
					key: 'defaultValue',
					get: function get() {
						return this._defaultValue;
					},
					set: function set(defaultValue) {
						this._defaultValue = defaultValue;
					}
				}, {
					key: 'readOnlyKeyEvent',
					get: function get() {
						return this._readOnlyKeyEvent || 'keyup';
					},
					set: function set(readOnlyKeyEvent) {
						this._readOnlyKeyEvent = readOnlyKeyEvent;
					}
				}, {
					key: 'readOnlyBlurEvent',
					get: function get() {
						return this._readOnlyBlurEvent || 'blur';
					},
					set: function set(readOnlyBlurEvent) {
						this._readOnlyBlurEvent = readOnlyBlurEvent;
					}
				}, {
					key: 'changeEvent',
					get: function get() {
						return this._changeEvent || 'change';
					},
					set: function set(changeEvent) {
						this._changeEvent = changeEvent;
					}
				}, {
					key: 'numeric',
					get: function get() {
						return !!this._numeric;
					},
					set: function set(numeric) {
						this._numeric = numeric;
					}
				}, {
					key: 'html',
					get: function get() {
						return this._html;
					}
				}]);

				return FormField;
			}());

			_export('FormField', FormField);
		}
	};
});

'use strict';

System.register('common/forms/sb-field/factory/NumericFieldFactory.js', ['common/forms/sb-discount/factory/DiscountFactory.js', 'common/forms/sb-input/factory/InputFactory.js', 'common/forms/NumberFormatter.js', 'common/core/sb-page-container/PageContainer.js', 'common/forms/Locale.js'], function (_export, _context) {
	var DiscountFactory, InputFactory, NumberFormatter, PageContainer, Locale, _createClass, NumericFieldFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbDiscountFactoryDiscountFactoryJs) {
			DiscountFactory = _commonFormsSbDiscountFactoryDiscountFactoryJs.DiscountFactory;
		}, function (_commonFormsSbInputFactoryInputFactoryJs) {
			InputFactory = _commonFormsSbInputFactoryInputFactoryJs.InputFactory;
		}, function (_commonFormsNumberFormatterJs) {
			NumberFormatter = _commonFormsNumberFormatterJs.NumberFormatter;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonFormsLocaleJs) {
			Locale = _commonFormsLocaleJs.Locale;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('NumericFieldFactory', NumericFieldFactory = function () {
				function NumericFieldFactory(value, editable, disabled, metadata, i18n, renderReadOnly, discountDetails, inputClass, type, viewport) {
					_classCallCheck(this, NumericFieldFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.renderReadOnly = renderReadOnly;
					this.discountDetails = discountDetails;
					this.inputClass = inputClass;
					this.type = type;
					this.viewport = viewport || PageContainer.getViewport();
					this.numberFormatter = new NumberFormatter(editable, metadata, i18n, type, viewport);
				}

				_createClass(NumericFieldFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						var inputType = this.isMobile() && !Locale.isCommaDecimal() ? 'number' : 'text';
						if (this.discountDetails) {
							var _ff = new DiscountFactory(this.disabled, this.renderReadOnly, this.discountDetails, inputType, null, this.numberFormatter).newFormField();
							_ff.numeric = true;
							return _ff;
						}

						var formattedValueAllowCurrency = this.numberFormatter.format(this.value, true);
						var formattedValue = !this.editable ? formattedValueAllowCurrency : this.numberFormatter.format(this.value, false);
						var ff = new InputFactory(formattedValue, this.editable, this.disabled, this.type, this.inputClass, inputType, this.renderReadOnly).newFormField();
						ff.formattedValue = { value: this.value, label: formattedValueAllowCurrency };
						ff.numeric = true;
						return ff;
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}]);

				return NumericFieldFactory;
			}());

			_export('NumericFieldFactory', NumericFieldFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-field/factory/SimpleFieldFactory.js', ['common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var FormField, _createClass, SimpleFieldFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SimpleFieldFactory', SimpleFieldFactory = function () {
				function SimpleFieldFactory(value, type, fieldClass) {
					_classCallCheck(this, SimpleFieldFactory);

					this.value = value;
					this.type = type;
					this.fieldClass = fieldClass;
				}

				_createClass(SimpleFieldFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						var ff = new FormField('sb-html');
						ff.addAttribute('value', 1, 'value', this.value);
						ff.addAttribute('type', 1, 'type', this.type);
						if (this.fieldClass) ff.addAttribute('class', 1, 'fieldClass', this.fieldClass, '$=');

						return ff;
					}
				}]);

				return SimpleFieldFactory;
			}());

			_export('SimpleFieldFactory', SimpleFieldFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-field/factory/TextFieldFactory.js', ['common/forms/sb-textarea/factory/TextareaFactory.js', 'common/forms/sb-input/factory/InputFactory.js', 'common/forms/sb-rte/factory/RichTextEditorFactory.js'], function (_export, _context) {
	var TextareaFactory, InputFactory, RichTextEditorFactory, _createClass, TextFieldFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbTextareaFactoryTextareaFactoryJs) {
			TextareaFactory = _commonFormsSbTextareaFactoryTextareaFactoryJs.TextareaFactory;
		}, function (_commonFormsSbInputFactoryInputFactoryJs) {
			InputFactory = _commonFormsSbInputFactoryInputFactoryJs.InputFactory;
		}, function (_commonFormsSbRteFactoryRichTextEditorFactoryJs) {
			RichTextEditorFactory = _commonFormsSbRteFactoryRichTextEditorFactoryJs.RichTextEditorFactory;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TextFieldFactory', TextFieldFactory = function () {
				function TextFieldFactory(value, editable, disabled, metadata, renderReadOnly, type) {
					_classCallCheck(this, TextFieldFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.metadata = metadata;
					this.renderReadOnly = renderReadOnly;
					this.type = type;
				}

				_createClass(TextFieldFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						if (this.metadata.extraTypeInfo === 'richtextarea') return new RichTextEditorFactory(this.value, this.editable, this.disabled, this.type, this.renderReadOnly, this.metadata).newFormField();

						if (this.metadata.maxLength > 255 || this.metadata.format === 'multiline' || this.type === 'textarea') return new TextareaFactory(this.value, this.editable, this.disabled, this.type, this.renderReadOnly).newFormField();

						return new InputFactory(this.value, this.editable, this.disabled, this.type, 'textInput', 'text', this.renderReadOnly).newFormField();
					}
				}]);

				return TextFieldFactory;
			}());

			_export('TextFieldFactory', TextFieldFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-input/factory/InputFactory.js', ['common/forms/sb-field/factory/SimpleFieldFactory.js', 'common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var SimpleFieldFactory, FormField, _createClass, InputFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}, function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('InputFactory', InputFactory = function () {
				function InputFactory(value, editable, disabled, type, inputClass, inputType, renderReadOnly, pattern) {
					_classCallCheck(this, InputFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.inputClass = inputClass;
					this.type = type;
					this.inputType = inputType || 'text';
					this.renderReadOnly = renderReadOnly;
					this.pattern = pattern;
				}

				_createClass(InputFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						if (this.editable) return this.newInput();

						return new SimpleFieldFactory(this.value, this.type).newFormField();
					}
				}, {
					key: 'newInput',
					value: function newInput() {
						var ff = new FormField('sb-input');
						ff.addAttribute('value', 2, 'value', this.value);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('input-class', 1, 'inputClass', this.inputClass);
						ff.addAttribute('input-type', 1, 'inputType', this.inputType);
						ff.addAttribute('render-read-only', 1, 'renderReadOnly', this.renderReadOnly);
						ff.addAttribute('pattern', 1, 'pattern', this.pattern);

						ff.readOnlyKeyEvent = 'sb-input-key';
						return ff;
					}
				}]);

				return InputFactory;
			}());

			_export('InputFactory', InputFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-lookup/factory/LookupFactory.js', ['common/forms/sb-field/factory/SimpleFieldFactory.js', 'common/core/sb-page-container/PageContainer.js', 'common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var SimpleFieldFactory, PageContainer, FormField, _createClass, LookupFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LookupFactory', LookupFactory = function () {
				function LookupFactory(value, editable, disabled, metadata, referenceDetails, renderReadOnly, type) {
					_classCallCheck(this, LookupFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.metadata = metadata;
					this.referenceDetails = referenceDetails;
					this.renderReadOnly = renderReadOnly;
					this.type = type;
				}

				_createClass(LookupFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						if (!this.editable) return this.newReferenceLink();

						return this.newLookup();
					}
				}, {
					key: 'newLookup',
					value: function newLookup() {
						var ff = new FormField('sb-lookup');
						var label = this.getLabel();
						ff.formattedValue = { value: this.value, label: label };

						ff.addAttribute('id', 0, 'lookup');
						ff.addAttribute('value', 2, 'value', this.value);
						ff.addAttribute('label', 1, this.referenceDetails.refDisplayName, ff.formattedValue.label);
						ff.addAttribute('label-name', 1, 'labelName', this.referenceDetails.refDisplayName);
						ff.addAttribute('table-name', 1, 'refTable', this.referenceDetails.refTable);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('field-full-name', 1, 'fieldFullName', this.metadata.tableName + '.' + this.metadata.name);
						ff.addAttribute('field-label', 1, 'fieldLabel', this.metadata.label);
						ff.addAttribute('revert-on-escape', 1, 'revertOnEscape', this.renderReadOnly);
						ff.addAttribute('calculate-list-position', 1, 'calculateListPosition', false);
						ff.addAttribute('has-filter', 1, 'hasFilter', !!this.metadata.filteredLookupInfo);
						ff.addAttribute('record', 1, 'record', this.referenceDetails.record);

						ff.readOnlyKeyEvent = 'sb-type-esc';
						ff.readOnlyBlurEvent = 'sb-type-blur';
						ff.changeEvent = 'lookup-value-changed';

						return ff;
					}
				}, {
					key: 'newReferenceLink',
					value: function newReferenceLink() {
						var ff = new FormField('span');
						var label = this.getLabel(true);
						ff.addAttribute('value', 2, '_value_', this.value);
						ff.addAttribute('class', 1, 'link', 'link', '$=');
						ff.setInnerText(this.referenceDetails.refDisplayName, 1, label);
						ff.formattedValue = { value: this.value, label: label };

						ff.addEvent('tap', 'refClick', function (e) {
							window.open(window.location.origin + '/' + e.target.value);
						});
						return ff;
					}
				}, {
					key: 'extractRefDisplay',
					value: function extractRefDisplay() {
						var property = this.referenceDetails.property;
						var obj = this.referenceDetails.obj;
						var refObjects = this.referenceDetails.refObjects;

						var fieldName = property.Name ? property.Name : this.metadata.name;
						if (!fieldName) return;

						var pos = fieldName.lastIndexOf('Id');
						var refObj = pos >= 0 ? fieldName.substring(0, pos) : fieldName.lastIndexOf('__c') >= 0 ? fieldName.replace('__c', '__r') : null;

						var refType = obj[refObj] ? obj[refObj].attributes.type : null;

						if (refObj && obj[refObj] && refObjects && refType && refObjects[refType]) {
							var nameProp = refObjects[refType].nameField.fieldName;
							if (this.obj[refObj][nameProp]) return this.obj[refObj][nameProp];

							return obj[refObj].Id;
						}
					}
				}, {
					key: 'getLabel',
					value: function getLabel(extractRefDisplay) {
						var label = this.referenceDetails[this.referenceDetails.refDisplayName];
						if (label) return label;

						if (extractRefDisplay) label = this.extractRefDisplay();

						return label || this.value || '';
					}
				}]);

				return LookupFactory;
			}());

			_export('LookupFactory', LookupFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-lookup/map/LookupNameMapper.js', [], function (_export, _context) {
	var _createClass, NAME_MAP, LookupNameMapper;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			NAME_MAP = {
				Contract: 'ContractNumber',
				Case: 'CaseNumber'
			};

			_export('LookupNameMapper', LookupNameMapper = function () {
				function LookupNameMapper(tableName) {
					_classCallCheck(this, LookupNameMapper);

					this.tableName = tableName;
				}

				_createClass(LookupNameMapper, [{
					key: 'getNameField',
					value: function getNameField() {
						return NAME_MAP[this.tableName] || 'Name';
					}
				}]);

				return LookupNameMapper;
			}());

			_export('LookupNameMapper', LookupNameMapper);
		}
	};
});

'use strict';

System.register('common/forms/sb-lookup/query/LookupQueryBuilder.js', ['common/relationship/RelationshipFieldManager.js', 'common/core/AppContext.js'], function (_export, _context) {
	var RelationshipFieldManager, AppContext, _createClass, LookupQueryBuilder;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LookupQueryBuilder', LookupQueryBuilder = function () {
				function LookupQueryBuilder(tableName, searchField, hasFilter, lookupFieldFullName, resultsLimit, currentRecordFields, currentRecord, applyMruOptimization, fields) {
					_classCallCheck(this, LookupQueryBuilder);

					this.tableName = tableName;
					this.searchField = searchField;
					this.hasFilter = hasFilter;
					this.lookupFieldFullName = lookupFieldFullName;
					this.resultsLimit = resultsLimit;
					this.currentRecordFields = currentRecordFields;
					this.currentRecord = currentRecord;
					this.applyMruOptimization = applyMruOptimization;
					this.selectFields = fields && fields.fieldNames ? LookupQueryBuilder._buildFields(fields) : [this.searchField];
				}

				_createClass(LookupQueryBuilder, [{
					key: 'build',
					value: function build() {
						var searchValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

						var searchCriteria = '%';
						if (searchValue != null && searchValue !== '') {
							searchCriteria = searchValue.replace(/\\/g, '\\\\').replace(/"/g, '\\"').replace(/'/g, "\\'").replace(/%/g, '\\%').replace(/[*]+/g, '%');
							if (!searchCriteria.endsWith('%')) searchCriteria += '%';
						}

						var noWildcardSearchValue = searchValue.replace(/\*/g, '');
						var scope = this.getScope(noWildcardSearchValue);
						var scopeClause = '';

						if (this.hasFilter) scopeClause = ' USING SCOPE ' + scope + ', LOOKUP ' + this.lookupFieldFullName;else if (scope === 'mru') scopeClause = ' USING SCOPE mru';

						var orderByClause = scope === 'mru' ? 'ORDER BY LastViewedDate DESC' : 'ORDER BY ' + this.searchField;
						var query = 'SELECT Id, ' + this.selectFields.join(',') + ' FROM ' + this.tableName + scopeClause + ' WHERE ' + this.searchField + ' LIKE \'' + searchCriteria + '\' ' + orderByClause + ' LIMIT ' + this.resultsLimit;

						if (this.hasFilter && this.currentRecordFields && Object.keys(this.currentRecordFields).length > 0 && this.currentRecord) {
							var index = 0;
							for (var currentRecordField in this.currentRecordFields) {
								var value = typeof this.currentRecord.getValue === 'function' ? this.currentRecord.getValue(currentRecordField) : this.currentRecord[currentRecordField];
								var type = this.currentRecordFields[currentRecordField];
								if (this.omitField(value, type)) continue;
								if (index === 0) query += ' BIND ';
								if (index++ > 0) query += ', ';
								query += currentRecordField + ' = ' + this.getBindValue(value, type);
							}
						}
						return query;
					}
				}, {
					key: 'getScope',
					value: function getScope(searchValue) {
						if (!this.applyMruOptimization) return 'everything';

						var searchValueLength = searchValue == null ? 0 : searchValue.length;
						if (searchValueLength > 2) return 'everything';

						var lang = AppContext.user.lang;

						if (searchValueLength > 0 && (lang === 'zh_CN' || lang === 'zh_TW' || lang === 'ja' || lang === 'ko' || lang === 'th')) return 'everything';

						return 'mru';
					}
				}, {
					key: 'omitField',
					value: function omitField(value, type) {
						return value == null && (this.isNumericType(type) || this.isLookupType(type));
					}
				}, {
					key: 'getBindValue',
					value: function getBindValue(value, type) {
						if (value == null) return "''";

						if (value === true || value === false) return value;

						if (this.isNumericType(type)) return value;

						return '\'' + value + '\'';
					}
				}, {
					key: 'isNumericType',
					value: function isNumericType(type) {
						switch (type) {
							case 'double':
							case 'number':
							case 'currency':
							case 'percent':
								return true;
						}
						return false;
					}
				}, {
					key: 'isLookupType',
					value: function isLookupType(type) {
						switch (type) {
							case 'id':
							case 'reference':
								return true;
						}
						return false;
					}
				}], [{
					key: '_buildFields',
					value: function _buildFields(fields) {
						var fieldNames = [].concat(fields.fieldNames);

						var relationships = [];
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = fields.fieldsOfTypeLookup[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var lookupField = _step.value;

								relationships.push(RelationshipFieldManager.getRelationshipField(lookupField.name, lookupField.table));
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						if (relationships.length > 0) fieldNames = fieldNames.concat(relationships);

						return fieldNames;
					}
				}]);

				return LookupQueryBuilder;
			}());

			_export('LookupQueryBuilder', LookupQueryBuilder);
		}
	};
});

'use strict';

System.register('common/forms/sb-rte/dialog/RichTextEditorDialog.js', ['common/core/AppContext.js', 'common/core/sb-i18n/I18n.js'], function (_export, _context) {
	var AppContext, I18n, _createClass, config, FONTS, RichTextEditorDialog;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbI18nI18nJs) {
			I18n = _commonCoreSbI18nI18nJs.I18n;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			config = {
				inline: false,
				font_formats: 'Arial=Arial,sans-serif;Courier=Courier,monospace;Dosis=Dosis,sans-serif;Droid Sans=Droid Sans,sans-serif;Droid Serif=Droid Serif,serif;Helvetica=Helvetica,sans-serif;Merriweather=Merriweather,sans-serif;Montserrat=Montserrat,sans-serif;Noto Sans JP=Noto Sans JP,sans-serif;Noto Sans KR=Noto Sans KR,sans-serif;Noto Sans SC=Noto Sans SC,sans-serif;Noto Sans TC=Noto Sans TC,sans-serif;Open Sans=Open Sans,sans-serif;PT Sans=PT Sans,sans-serif;PT Serif=PT Serif,serif;Roboto=Roboto,sans-serif;Roboto Light=Roboto:300,sans-serif;Times=Times,serif;Titillium Web=Titillium Web,sans-serif;',
				forced_root_block: '',
				menubar: false,
				toolbar1: 'cut copy paste | undo redo | styleselect formatselect fontselect fontsizeselect | link image table',
				toolbar2: 'bold italic underline strikethrough subscript superscript removeformat | numlist bullist | outdent indent | blockquote | alignleft aligncenter alignright alignjustify | code',
				plugins: 'link image code table'
			};
			FONTS = "//fonts.googleapis.com/css?family=Dosis|Droid+Sans|Droid+Serif|Merriweather|Montserrat|Open+Sans|PT+Sans|PT+Serif|Roboto:300,400|Titillium+Web";


			tinymce.baseURL = '/common/staticresources/tinymce';
			tinymce.suffix = '.min';

			_export('RichTextEditorDialog', RichTextEditorDialog = function () {
				function RichTextEditorDialog() {
					_classCallCheck(this, RichTextEditorDialog);
				}

				_createClass(RichTextEditorDialog, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-rte-dialog';
						this.properties = {
							value: {
								type: String,
								observer: '_valueChanged',
								notify: true
							},
							i18n: {
								type: Object,
								value: function value() {
									return AppContext.properties.i18n.value();
								}
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						var sheets = document.querySelectorAll('head > link[rel=stylesheet]'),
						    len = sheets ? sheets.length : 0;

						for (var i = 0; i < len; i++) {
							if (sheets[i].getAttribute('href') == FONTS) return;
						}

						var link = document.createElement('link');
						link.setAttribute('rel', 'stylesheet');
						link.setAttribute('href', FONTS);
						document.head.appendChild(link);
					}
				}, {
					key: '_initialize',
					value: function _initialize() {
						config.inline = true;
						config.target = Polymer.dom(this.root).querySelector('#rte');

						tinymce.init(config).then(function (editors) {
							this.editor = editors[0];
							try {
								this.editor.setContent(this.value);
							} catch (e) {}

							this.editor.on('blur', function (e) {
								setTimeout(function () {
									if (this.$.dialog.show) this.$.rte.focus();
								}.bind(this), 10);
							}.bind(this));

							this.$.rte.focus();
						}.bind(this)).catch(function (err) {
							console.error(err);
						});
					}
				}, {
					key: 'onSave',
					value: function onSave() {
						var content = this.editor.getContent();
						this.value = content !== "Click to edit description." ? content : null;
						this.rte.value = this.value;
						this.rte.fire('rte-value-changed');
						this.close();
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.rte.fire('rte-esc', { keyCode: 27 });
						this.close();
					}
				}, {
					key: 'open',
					value: function open() {
						this.$.dialog.open();
						if (this.value === "Click to edit description." || this.value == undefined) this.value = null;
						this.$.rte.focus();
						Polymer.dom(this.root).querySelector('.title').innerHTML = this.i18n.l('Edit ' + this.rte.label);
						this._initialize();

						this.addEventListener('sb-rte-cancel', this.onCancel);
					}
				}, {
					key: 'close',
					value: function close() {
						this.rte.fire('rte-blur');
						this.$.dialog.close();
						if (this.value === "Click to edit description.") this.value = null;
						this.$.rte.blur();

						tinymce.remove();

						this.removeEventListener('sb-rte-cancel', this.onCancel);
					}
				}, {
					key: '_valueChanged',
					value: function _valueChanged() {
						Polymer.dom(this.$.rte).innerHTML = this.value;
					}
				}], [{
					key: 'setBaseUrl',
					value: function setBaseUrl(u) {
						if (u) tinymce.baseURL = u;
					}
				}]);

				return RichTextEditorDialog;
			}());

			_export('RichTextEditorDialog', RichTextEditorDialog);

			Polymer(RichTextEditorDialog);
		}
	};
});

'use strict';

System.register('common/forms/sb-rte/factory/RichTextEditorFactory.js', ['common/forms/sb-field/factory/FormField.js', 'common/core/sb-page-container/PageContainer.js', 'common/forms/sb-field/factory/SimpleFieldFactory.js'], function (_export, _context) {
	var FormField, PageContainer, SimpleFieldFactory, _createClass, RichTextEditorFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('RichTextEditorFactory', RichTextEditorFactory = function () {
				function RichTextEditorFactory(value, editable, disabled, type, renderReadOnly, metadata, viewport) {
					_classCallCheck(this, RichTextEditorFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.type = type;
					this.renderReadOnly = renderReadOnly;
					this.metadata = metadata;
					this.viewport = viewport || PageContainer.getViewport();
				}

				_createClass(RichTextEditorFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						this.isMobile = this.viewport && this.viewport.isMobile();
						if (this.editable && !this.isMobile) {
							return this.newRichTextEditor();
						}

						return new SimpleFieldFactory(this.value, this.type).newFormField();
					}
				}, {
					key: 'newRichTextEditor',
					value: function newRichTextEditor() {
						var ff = new FormField('sb-rte');
						ff.addAttribute('value', 1, 'value', this.value);
						ff.addAttribute('render-read-only', 1, 'renderReadOnly', this.renderReadOnly);
						ff.addAttribute('label', 1, 'label', this.metadata.label);

						ff.readOnlyKeyEvent = 'rte-esc';
						ff.readOnlyBlurEvent = 'rte-blur';
						ff.changeEvent = 'rte-value-changed';

						return ff;
					}
				}]);

				return RichTextEditorFactory;
			}());

			_export('RichTextEditorFactory', RichTextEditorFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-select/factory/SelectFactory.js', ['common/forms/sb-field/factory/SimpleFieldFactory.js', 'common/forms/sb-field/factory/FormField.js', 'common/forms/sb-select/Select.js'], function (_export, _context) {
	var SimpleFieldFactory, FormField, Select, _createClass, SelectFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}, function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}, function (_commonFormsSbSelectSelectJs) {
			Select = _commonFormsSbSelectSelectJs.Select;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SelectFactory', SelectFactory = function () {
				function SelectFactory(value, editable, disabled, type, metadata, i18n, useNoneLabel, options) {
					_classCallCheck(this, SelectFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.type = type;
					this.metadata = metadata;
					this.i18n = i18n;
					this.useNoneLabel = useNoneLabel;
					this.options = options;
				}

				_createClass(SelectFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						var multiSelect = this.type === 'multipicklist';
						if (this.editable) return this.newSelectList(multiSelect);

						return new SimpleFieldFactory(this.getLabel(multiSelect), this.type).newFormField();
					}
				}, {
					key: 'newSelectList',
					value: function newSelectList(multiSelect) {
						var ff = new FormField('sb-select');
						if (this.metadata.defaultValue && !this.value && !this.metadata.controllerName && !this.metadata.restrictedPicklist) {
							this.value = this.metadata.defaultValue;
							ff.defaultValue = this.value;
						}
						ff.addAttribute('id', 0, 'picklist');
						ff.addAttribute('value', 2, 'value', this.value);
						ff.addAttribute('md', 1, 'md', this.metadata);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('options', 1, 'options', this.options);
						ff.addAttribute('is-required', 1, 'isRequired', !!this.metadata.required);
						ff.addAttribute('multi-select', 1, 'multiSelect', multiSelect);
						if (this.useNoneLabel) ff.addAttribute('none-label', 1, 'noneLabel', '--' + this.i18n.l("None") + '--');
						if (this.metadata.precision != null) ff.addAttribute('size', 1, 'size', this.metadata.precision);

						ff.formattedValue = { value: this.value, label: this.getLabel(multiSelect) };
						return ff;
					}
				}, {
					key: 'getLabel',
					value: function getLabel(multiSelect) {
						if (!this.options) return this.value;

						var values = Select.getValues(this.value, multiSelect);
						if (values.length === 0) return this.value;

						var label = null;
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = this.options[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var option = _step.value;

								if (values.indexOf(option.value) !== -1) {
									if (multiSelect && label != null) label += ';' + option.label;else label = option.label;
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return label || this.value;
					}
				}]);

				return SelectFactory;
			}());

			_export('SelectFactory', SelectFactory);
		}
	};
});

'use strict';

System.register('common/forms/sb-textarea/factory/TextareaFactory.js', ['common/forms/sb-field/factory/SimpleFieldFactory.js', 'common/forms/sb-field/factory/FormField.js'], function (_export, _context) {
	var SimpleFieldFactory, FormField, _createClass, TextareaFactory;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonFormsSbFieldFactorySimpleFieldFactoryJs) {
			SimpleFieldFactory = _commonFormsSbFieldFactorySimpleFieldFactoryJs.SimpleFieldFactory;
		}, function (_commonFormsSbFieldFactoryFormFieldJs) {
			FormField = _commonFormsSbFieldFactoryFormFieldJs.FormField;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('TextareaFactory', TextareaFactory = function () {
				function TextareaFactory(value, editable, disabled, type, renderReadOnly) {
					_classCallCheck(this, TextareaFactory);

					this.value = value;
					this.editable = editable;
					this.disabled = disabled;
					this.type = type;
					this.renderReadOnly = renderReadOnly;
				}

				_createClass(TextareaFactory, [{
					key: 'newFormField',
					value: function newFormField() {
						if (this.editable) return this.newTextarea();

						return new SimpleFieldFactory(this.value, this.type).newFormField();
					}
				}, {
					key: 'newTextarea',
					value: function newTextarea() {
						var ff = new FormField('sb-textarea');
						ff.addAttribute('value', 2, 'value', this.value);
						ff.addAttribute('disabled', 1, 'disabled', this.disabled);
						ff.addAttribute('render-read-only', 1, 'renderReadOnly', this.renderReadOnly);

						ff.readOnlyKeyEvent = 'sb-textarea-key';
						return ff;
					}
				}]);

				return TextareaFactory;
			}());

			_export('TextareaFactory', TextareaFactory);
		}
	};
});

'use strict';

System.register('products/config/actions/sb-custom-actions/CustomActions.js', ['common/Util.js', 'common/core/AppContext.js', 'common/core/sb-page-container/PageContainer.js', 'common/core/sb-page-header/PageHeader.js', 'products/config/message/ProductMessenger.js'], function (_export, _context) {
	var Util, AppContext, PageContainer, PageHeader, ProductMessenger, _createClass, API_FIELD_NAME_MAP, CustomActions;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonUtilJs) {
			Util = _commonUtilJs.Util;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreSbPageHeaderPageHeaderJs) {
			PageHeader = _commonCoreSbPageHeaderPageHeaderJs.PageHeader;
		}, function (_productsConfigMessageProductMessengerJs) {
			ProductMessenger = _productsConfigMessageProductMessengerJs.ProductMessenger;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			API_FIELD_NAME_MAP = { 'Product Code': 'ProductCode' };

			_export('CustomActions', CustomActions = function () {
				function CustomActions() {
					_classCallCheck(this, CustomActions);
				}

				_createClass(CustomActions, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-custom-actions';
						this.properties = {
							customActions: Array,
							products: Array,
							isClassic: Boolean,
							productIndex: Number,
							firstItem: Object,
							remainingItems: Array,
							prefix: String,
							customActionsExist: Boolean,
							moreThanOneCustomActionsExist: {
								type: Boolean,
								value: false
							},
							menuClosed: {
								type: Boolean,
								value: true
							},
							viewport: {
								type: Object,
								observer: '_viewportChanged',
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							buttonsCollapsed: {
								type: Boolean,
								notify: true
							},

							messenger: {
								type: Object,
								computed: '_newMessenger(quote, products, productIndex, prefix)'
							},
							quote: {
								type: Object,
								notify: true
							},
							popupResponse: {
								type: Object,
								notify: true,
								observer: '_updateQuoteFromPopupResponse'
							},
							launchExternalName: {
								type: String,
								value: "Launch External"
							}
						};
					}
				}, {
					key: 'init',
					value: function init() {
						var _this = this;

						if (this.isClassic && this.products.length > 1) {
							this.classList.add("hide");
							this.customActionsExist = false;
							return;
						}

						var showExternalAction = this.products[this.productIndex].record[this.prefix + 'ExternallyConfigurable__c'];
						var urlKey = this.prefix + "URL__c";
						var labelKey = this.prefix + "Label__c";
						var page = this.prefix + "Page__c";
						var targetKey = this.prefix + "URLTarget__c";
						var labelUrlMap = [];
						this.customActions.forEach(function (customAction) {
							if (customAction[urlKey] !== undefined && customAction[page] === 'Product Configurator' && _this.checkCustomActionsConditionsMet(customAction, showExternalAction)) {
								labelUrlMap.push({
									label: customAction[labelKey],
									url: customAction[urlKey],
									target: customAction[targetKey]
								});
							}
						});

						if (labelUrlMap.length == 0) {
							this.classList.add("hide");
							this.customActionsExist = false;
							return;
						}
						this.firstItem = labelUrlMap[0];
						if (labelUrlMap.length > 1) {
							this.remainingItems = labelUrlMap.slice(1);
							this.moreThanOneCustomActionsExist = true;
						}
						this.customActionsExist = true;
						this.buttonsCollapsed = this.viewport && !this.viewport.isMobile() && this.viewport.M.up ? false : true;
						this.classList.remove("hide");
					}
				}, {
					key: '_itemSelected',
					value: function _itemSelected(e) {
						var id = e.target.id;
						var targetItem = id === "firstItem" ? this.firstItem : this.remainingItems[id];
						if (targetItem.target === 'Popup') this.handlePopup(targetItem.url);else this.handleNav(targetItem.url);
					}
				}, {
					key: 'handlePopup',
					value: function handlePopup(url, autoLaunched) {
						this.$.popup.url = url;
						this.$.popup.autoLaunched = autoLaunched;
						this.$.popup.messenger = this.messenger;
						this.$.popup.open();
					}
				}, {
					key: 'handleNav',
					value: function handleNav(url) {
						if (this._isLightningExperience()) {
							sforce.one.navigateToURL(url);
						} else {
							window.location.href = url;
						}
					}
				}, {
					key: '_isLightningExperience',
					value: function _isLightningExperience() {
						return typeof sforce !== 'undefined' && sforce && !!sforce.one;
					}
				}, {
					key: 'checkCustomActionsConditionsMet',
					value: function checkCustomActionsConditionsMet(customAction, showExternalAction) {
						var _this2 = this;

						var conditionsKey = this.prefix + "Custom_Action_Conditions__r";
						var fieldKey = this.prefix + "Field__c";
						var operatorKey = this.prefix + "Operator__c";
						var filterValueKey = this.prefix + "FilterValue__c";

						if (customAction.Name === this.launchExternalName && !showExternalAction) return false;

						return customAction[conditionsKey] === undefined || customAction[conditionsKey].records.some(function (val) {
							if (val[fieldKey] === undefined || val[filterValueKey] === undefined || val[operatorKey] === undefined) return false;

							var fieldName = API_FIELD_NAME_MAP[val[fieldKey]] || val[fieldKey];

							return Util.arithmeticOperatorConversion(_this2.products[_this2.productIndex].record[fieldName], val[filterValueKey], val[operatorKey]);
						});
					}
				}, {
					key: '_changeMenu',
					value: function _changeMenu(e) {
						this.menuClosed = PageHeader.changeMenu(e, this.menuClosed, this.$$('#remainingItems'), 'open', this);
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: '_viewportChanged',
					value: function _viewportChanged() {
						this.buttonsCollapsed = this.viewport && !this.viewport.isMobile() && this.viewport.M.up ? false : true;
					}
				}, {
					key: '_newMessenger',
					value: function _newMessenger() {
						return new ProductMessenger(this.quote, this.products[this.productIndex], this.prefix, this.currencyIsoCode, Polymer.Base);
					}
				}, {
					key: '_updateQuoteFromPopupResponse',
					value: function _updateQuoteFromPopupResponse() {
						this.quote = this.popupResponse.quote;
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['init(customActions, products, prefix, productIndex, isClassic, menuClosed)'];
					}
				}]);

				return CustomActions;
			}());

			_export('CustomActions', CustomActions);

			Polymer(CustomActions);
		}
	};
});

'use strict';

System.register('products/config/attribute/sb-attribute-item/AttributeItem.js', [], function (_export, _context) {
	var _createClass, AttributeItem;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('AttributeItem', AttributeItem = function () {
				function AttributeItem() {
					_classCallCheck(this, AttributeItem);
				}

				_createClass(AttributeItem, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-attribute-item';
						this.properties = {
							value: {
								notify: true,
								observer: '_notifyAttributeChanged'
							},
							item: String,
							model: Object,
							md: Object,
							data: {
								type: Object,
								notify: true
							}
						};
					}
				}, {
					key: 'setRequired',
					value: function setRequired() {
						if (this.attributeMD.required === false || this.attributeMD.autoSelect === true) return;
						this.toggleClass('mandatory-no-value', this.isValidValue() === false, this.$.attributeField);
					}
				}, {
					key: 'isValidValue',
					value: function isValidValue() {
						return !!(this.value !== undefined && this.value !== null && this.value !== '');
					}
				}, {
					key: 'setAttributeMD',
					value: function setAttributeMD() {
						this.attributeMD = this.model.attributeMD[this.item];
						this.$.field.disabled = this.attributeMD.autoSelect;
						this.hidden = this.attributeMD.hidden;
						var md = JSON.parse(JSON.stringify(this.model.fields[this.targetField]));
						if (md.type === 'picklist') md.picklistValues = this.getPicklistValues(md.picklistValues);

						this.md = md;
					}
				}, {
					key: 'setTargetField',
					value: function setTargetField() {
						this.$.field.record = this;
						this.targetField = this.model.attributeMD[this.item].targetFieldName;
					}
				}, {
					key: 'setLabel',
					value: function setLabel() {
						this.label = this.md.label;
					}
				}, {
					key: 'getPicklistValues',
					value: function getPicklistValues(defaultValues) {
						if (this.attributeMD === undefined) return defaultValues;

						if (!this.attributeMD.shownValues && !this.attributeMD.hiddenValues) return defaultValues;

						var shownValues = this.attributeMD.shownValues || [];
						if (!this.attributeMD.shownValues) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = defaultValues[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var item = _step.value;

									shownValues.push(item.value);
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}

						var hiddenValues = this.attributeMD.hiddenValues || [];
						return defaultValues.filter(function (item) {
							return shownValues.indexOf(item.value) !== -1 && hiddenValues.indexOf(item.value) === -1;
						});
					}
				}, {
					key: '_notifyAttributeChanged',
					value: function _notifyAttributeChanged(e) {
						if (!this.model) return;
						this.fire('sb-config-attribute-changed', {
							Id: this.item,
							bundleId: this.model.attributeMD[this.item].bundleId,
							changed: true,
							path: true });
					}
				}, {
					key: 'getValue',
					value: function getValue(name) {
						var ids = this.model.attributeFieldMD[name];
						if (ids && ids.length > 0) return this.data[ids[0]];
					}
				}, {
					key: 'setValue',
					value: function setValue(path, value) {
						this.set('data.' + path, value);
					}
				}, {
					key: 'equals',
					value: function equals(attributeItem) {
						return this.data === attributeItem.data;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setAttributeMD(item, model, targetField)', 'setTargetField(item, model)', 'setRequired(value, model, attributeMD)', 'setLabel(md)'];
					}
				}]);

				return AttributeItem;
			}());

			_export('AttributeItem', AttributeItem);

			Polymer(AttributeItem);
		}
	};
});

'use strict';

System.register('products/config/attribute/sb-attribute-table/AttributeTable.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, AttributeTable;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('AttributeTable', AttributeTable = function () {
				function AttributeTable() {
					_classCallCheck(this, AttributeTable);
				}

				_createClass(AttributeTable, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-attribute-table';
						this.properties = {
							featureId: String,
							position: String,
							model: Object,
							configAttributes: Object,
							addedClass: String,
							md: Object,
							showTable: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.optionFieldMetadata.addEventListener('md-changed', function (e) {
							this.setMD(e);
						}.bind(this));
					}
				}, {
					key: 'getMD',
					value: function getMD() {
						var attributeFields = {},
						    attributeModelData = this.model.configurationAttributeModelMap;
						for (var i in attributeModelData) {
							attributeFields[attributeModelData[i].targetFieldName] = null;
						}this.$.optionFieldMetadata.fields = Object.keys(attributeFields);
					}
				}, {
					key: 'setMD',
					value: function setMD(e) {
						this.md = {
							fields: e.detail.value.fieldsByObject[this.model.prefix + 'ProductOption__c'],
							attributeMD: this.model.configurationAttributeModelMap,
							attributeFieldMD: this.model.configurationAttributeTargetFieldMap
						};
					}
				}, {
					key: 'generateColumns',
					value: function generateColumns() {
						var column1Group = [],
						    column2Group = [],
						    column3Group = [];
						var featureAttributes = this.model.configAttributesByFeatureId[this.featureId] || [];
						var numAttributes = featureAttributes.length;
						var featureAttributesByFieldName = {};
						for (var i = 0; i < numAttributes; i++) {
							var targetAttribute = featureAttributes[i].myId;
							this.md.attributeMD[targetAttribute].processed = true;
							var targetFieldName = featureAttributes[i].targetFieldName;

							var featureAttributeIds = featureAttributesByFieldName[targetFieldName] || [];
							featureAttributeIds.push(targetAttribute);
							featureAttributesByFieldName[targetFieldName] = featureAttributeIds;

							if (featureAttributes[i].position == this.position || !this.position) {
								if (featureAttributes[i].columnOrder == 1) column1Group.push(targetAttribute);else if (featureAttributes[i].columnOrder == 2) column2Group.push(targetAttribute);else column3Group.push(targetAttribute);
							}
						}
						this.normalizeData(featureAttributesByFieldName);

						this.setColumns(column1Group, column2Group, column3Group);
					}
				}, {
					key: 'normalizeData',
					value: function normalizeData(featureAttributesByFieldName) {
						for (var targetFieldName in featureAttributesByFieldName) {
							var featureAttributes = featureAttributesByFieldName[targetFieldName];
							var bundleAttributes = this.md.attributeFieldMD[targetFieldName];

							if (bundleAttributes.length <= featureAttributes.length) return;

							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = bundleAttributes[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var bundleAttribute = _step.value;

									if (featureAttributes.indexOf(bundleAttribute) !== -1) continue;

									if (!this.md.attributeMD[bundleAttribute].processed) continue;

									var _iteratorNormalCompletion2 = true;
									var _didIteratorError2 = false;
									var _iteratorError2 = undefined;

									try {
										for (var _iterator2 = featureAttributes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
											var featureAttribute = _step2.value;

											this.configAttributes[featureAttribute] = this.configAttributes[bundleAttribute];
										}
									} catch (err) {
										_didIteratorError2 = true;
										_iteratorError2 = err;
									} finally {
										try {
											if (!_iteratorNormalCompletion2 && _iterator2.return) {
												_iterator2.return();
											}
										} finally {
											if (_didIteratorError2) {
												throw _iteratorError2;
											}
										}
									}

									break;
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}
					}
				}, {
					key: 'setColumns',
					value: function setColumns(column1Group, column2Group, column3Group) {
						if (column1Group.length > 0) {
							this.showTable = true;
							this.$.firstColumn.overridePropagateFromParentToChild(this.captureCallBack);
							this.$.firstColumn.setFromChildToParentExtension(this.captureCallBack);
							this.$.firstColumn.model = this.md;
							if (!this.$.firstColumn.group) this.$.firstColumn.group = column1Group;
						}
						if (column2Group.length > 0) {
							this.showTable = true;
							this.$.secondColumn.overridePropagateFromParentToChild(this.captureCallBack);
							this.$.secondColumn.setFromChildToParentExtension(this.captureCallBack);
							this.$.secondColumn.model = this.md;
							if (!this.$.secondColumn.group) this.$.secondColumn.group = column2Group;
						}
						if (column3Group.length > 0) {
							this.showTable = true;
							this.$.thirdColumn.overridePropagateFromParentToChild(this.captureCallBack);
							this.$.thirdColumn.setFromChildToParentExtension(this.captureCallBack);
							this.$.thirdColumn.model = this.md;
							if (!this.$.thirdColumn.group) this.$.thirdColumn.group = column3Group;
						}
					}
				}, {
					key: 'captureCallBack',
					value: function captureCallBack(e) {
						var elements = this.elements,
						    attributeId = e.path.split('.')[1];
						if (attributeId === undefined) return;

						var targetField = this.model.attributeMD[attributeId].targetFieldName;
						for (var i = 0, l = elements.length; i < l; i++) {
							var elementId = elements[i].item.split('.')[0];
							if (elementId === attributeId) continue;

							if (this.model.attributeMD[elements[i].item].targetFieldName === targetField) elements[i].value = e.value;
						}
					}
				}, {
					key: 'bindDataToModel',
					value: function bindDataToModel(e) {
						if (e.path === undefined || e.path === 'configAttributes') return;

						var targetField = this.model.configurationAttributeModelMap[e.path.split('.')[1]].targetFieldName;
						this.model.product.configuration.configurationData[targetField] = e.value;
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['generateColumns(featureId, model, configAttributes, md)', 'getMD(configAttributes, model)', 'bindDataToModel(configAttributes.*)'];
					}
				}]);

				return AttributeTable;
			}());

			_export('AttributeTable', AttributeTable);

			Polymer(AttributeTable);
		}
	};
});

'use strict';

System.register('products/config/bundles/sb-product-bundles-filter-item/ProductBundlesFilterItem.js', [], function (_export, _context) {
	var _createClass, ProductBundlesFilterItem;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductBundlesFilterItem', ProductBundlesFilterItem = function () {
				function ProductBundlesFilterItem() {
					_classCallCheck(this, ProductBundlesFilterItem);
				}

				_createClass(ProductBundlesFilterItem, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-bundles-filter-item';
						this.properties = {
							value: {
								notify: true
							},
							item: String,
							model: Object,
							label: String
						};
					}
				}, {
					key: 'setFieldData',
					value: function setFieldData() {
						var md = void 0;
						for (var i = 0, numFields = this.model.length; i < numFields; i++) {
							if (this.model[i].name === this.item) {
								this.label = this.model[i].label;

								md = this.model[i].type === 'picklist' ? this.model[i] : { type: 'string' };
								break;
							}
						}
						this.$.field.editing = true;
						this.$.field.property = this.item;
						this.$.field.md = md;
					}
				}, {
					key: 'clear',
					value: function clear() {
						this.value = null;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setFieldData(model)'];
					}
				}]);

				return ProductBundlesFilterItem;
			}());

			_export('ProductBundlesFilterItem', ProductBundlesFilterItem);

			Polymer(ProductBundlesFilterItem);
		}
	};
});

'use strict';

System.register('products/config/bundles/sb-product-bundles-layout/ProductBundlesLayout.js', ['../../search/ConfiguratorSearch.js', '../../../../common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var ConfiguratorSearch, PageContainer, _createClass, ProductBundlesLayout;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_searchConfiguratorSearchJs) {
			ConfiguratorSearch = _searchConfiguratorSearchJs.ConfiguratorSearch;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductBundlesLayout', ProductBundlesLayout = function () {
				function ProductBundlesLayout() {
					_classCallCheck(this, ProductBundlesLayout);
				}

				_createClass(ProductBundlesLayout, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-bundles-layout';
						this.properties = {
							productIndex: {
								type: Number,
								notify: true
							},
							selectedTabIndex: {
								type: Number,
								value: 0
							},
							configuredProducts: Array,
							setToSections: {
								type: Boolean,
								value: true
							},
							isClassic: Boolean,
							noHeader: {
								type: Boolean,
								value: false
							},
							hasSelected: {
								type: Boolean,
								value: false
							},
							hasMultipleBundles: {
								type: Boolean,
								value: false,
								observer: 'formatBundlesLayout'
							},
							drawerState: String,
							qId: String,
							searchFilters: Array,
							searchValuesByFilter: Object,
							searchFieldMD: Object,
							configSearch: Object,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: {
								type: Boolean,
								value: false,
								computed: '_setIsMobile(viewport)'
							}
						};
					}
				}, {
					key: '_resize',
					value: function _resize() {
						this.resize();
					}
				}, {
					key: 'initSearchFilter',
					value: function initSearchFilter() {
						this.$.group.group = this.searchFilters;
						this.$.group.model = this.searchFieldMD;
						this.$.group.data = this.searchValuesByFilter;
						this.configSearch = new ConfiguratorSearch(this.searchValuesByFilter, this.prefix);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.handleResize();
						this.handlePanelSlide();
						this.handlePanelEvents();
						this.handleMD();
					}
				}, {
					key: 'handlePanelEvents',
					value: function handlePanelEvents() {
						this.addEventListener('side-toggle-clicked', function () {
							this.toggle();
						}.bind(this));
						this.addEventListener('iron-select', function () {
							if (this.$.drawer.selected == 'drawer') this.drawerState = 'open';else this.drawerState = 'closed';
						}.bind(this));
						this.addEventListener('x-clicked', function () {
							this.$.search.closeDrawer();
						}.bind(this));
						this.addEventListener('enter-keypress', function () {
							if (this.searchFilters) this.applyFilters();
						}.bind(this));
					}
				}, {
					key: 'handleMD',
					value: function handleMD() {
						this.$.md.addEventListener('md-changed', function (e) {
							this.searchFieldMD = e.detail.value.fields;
							this.selectBundle();
						}.bind(this));
					}
				}, {
					key: 'navTo',
					value: function navTo(e) {
						var target = Polymer.dom(e).rootTarget.id.split('_')[1];
						var numBundles = this.configuredProducts.length;
						var index = this.productIndex;
						for (var i = 0; i < numBundles; i++) {
							if (this.getProductId(i) === target) index = i;
						}

						this.setSelected(target, true);

						if (!this.isMobile && this.isClassic) this.$$('#Bundle' + target).scrollIntoView();else this.fire('bundle-panel-clicked', index);
					}
				}, {
					key: 'toggle',
					value: function toggle() {
						this.toggleTransition(true);
						this.$.drawer.togglePanel();
					}
				}, {
					key: 'classicOrSelectedIndex',
					value: function classicOrSelectedIndex(item, configuredProductIndex) {
						return this.isClassic && !this.isMobile || this.configuredProducts[this.productIndex] === item || !this.productIndex && configuredProductIndex === 0 || this.productIndex >= this.configuredProducts.length && configuredProductIndex === 0;
					}
				}, {
					key: 'handleResize',
					value: function handleResize() {
						var sfSidebar = document.querySelector('#sidebarCell');
						if (sfSidebar) {
							sfSidebar.addEventListener('click', this.resize.bind(this));
						}
						window.addEventListener('resize', this.resize.bind(this));
					}
				}, {
					key: 'resize',
					value: function resize() {
						this.toggleTransition(false);
						if (this.$.drawer.selected === 'drawer') {
							this._setBundleContainerWidth(false);
						} else {
							this._setBundleContainerWidth(true);
						}
					}
				}, {
					key: 'handlePanelSlide',
					value: function handlePanelSlide() {
						if (!this.isMobile) {
							this.addEventListener('iron-select', function () {
								if (this.$.drawer.selected === 'drawer') {
									this._setBundleContainerWidth(false);
								} else {
									this._setBundleContainerWidth(true);
								}
							}.bind(this));
						}

						if (this.isMobile) {
							this.addEventListener('iron-deselect', function (e) {
								if (e.detail.item.id === 'drawer') {
									document.activeElement.blur();
								}
							}.bind(this));
						}
					}
				}, {
					key: 'selectBundle',
					value: function selectBundle() {
						this.$.search.$$('#scrim').style.width = '100%';

						if (this.isMobile) {
							this.navWidth = 0;

							this.$.drawer.$$('#scrim').style.width = '100%';
						}
						if (this.configuredProducts.length === 1) this.navWidth = 0;

						this.buildPanelIfMultipleBundesAndNotMobile();

						if (!this.isClassic || this.isMobile) {
							var targetId = this.getProductId(this.productIndex);

							this.fire('bundle-name-changed', { name: this.configuredProducts[this.productIndex].record.Name });
							Polymer.dom(this.$.panel).observeNodes(function () {
								this.setSelected(targetId, false);
							}.bind(this));
						}
						this.resize();
					}
				}, {
					key: 'buildPanelIfMultipleBundesAndNotMobile',
					value: function buildPanelIfMultipleBundesAndNotMobile() {
						if (this.configuredProducts.length === 1 || this.isMobile) return;

						this.panelWidth = 256;
						this.navWidth = 24;
						this.$.panel.rightSideButton = true;
						this.toggleTransition(false);
						if (this.isOpen === "1") {
							this.$.drawer.selected = 'drawer';
							this.drawerState = 'open';
							this._setBundleContainerWidth(false);
						} else {
							this.$.drawer.selected = 'main';
							this.drawerState = 'closed';
							this._setBundleContainerWidth(true);
						}
					}
				}, {
					key: '_setBundleContainerWidth',
					value: function _setBundleContainerWidth(isDrawerOpen) {
						if (this.configuredProducts && this.configuredProducts.length < 2) {
							return;
						}
						this.toggleClass('open', !isDrawerOpen, this.$.bundleContainer);
						this.toggleClass('close', isDrawerOpen, this.$.bundleContainer);
					}
				}, {
					key: 'toggleTransition',
					value: function toggleTransition(enable) {
						this.$.drawer._transition = enable;

						this.toggleClass('transition', enable, this.$.bundleContainer);
					}
				}, {
					key: 'defaultState',
					value: function defaultState() {
						if (this.isOpen === "1") return 'drawer';
						return 'main';
					}
				}, {
					key: 'toggleSearch',
					value: function toggleSearch() {
						this.$.search.togglePanel();
					}
				}, {
					key: 'refocus',
					value: function refocus() {
						this.$.search.querySelector('#searchPanel').querySelector('sb-group').$$('sb-product-bundles-filter-item').$$('sb-field').$$('div#f').firstChild.focus();
					}
				}, {
					key: 'reverseFocus',
					value: function reverseFocus() {
						this.$.clear.focus();
					}
				}, {
					key: 'setMD',
					value: function setMD() {
						this.$.md.object = 'ProductOption__c';
						this.$.md.fields = this.searchFilters;
					}
				}, {
					key: 'applyFilters',
					value: function applyFilters() {
						this.$.clear.focus();
						this.$.search.closeDrawer();
						this.configSearch = new ConfiguratorSearch(this.searchValuesByFilter, this.prefix);
					}
				}, {
					key: 'clearFields',
					value: function clearFields() {
						this.fire('iron-signal', { name: 'sb-clear-product-filter' });
						this.blur();
						this.configSearch = new ConfiguratorSearch(this.searchValuesByFilter, this.prefix);
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: 'getProductId',
					value: function getProductId(productIndex, underscorePrefix) {
						var product = this.configuredProducts[productIndex];

						var id = product.productKey || product.record.Id;
						var prefix = underscorePrefix ? '_' : '';
						return prefix + id;
					}
				}, {
					key: 'setSelected',
					value: function setSelected(targetId, clearPrevious) {
						if (clearPrevious) this.removeAllSelected();
						this.toggleClass('selected-tab', true, this.$$('#_' + targetId));
					}
				}, {
					key: 'removeAllSelected',
					value: function removeAllSelected() {
						var navItems = Polymer.dom(this.root).querySelectorAll('div.nav-item');
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = navItems[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var navItem = _step.value;

								this.toggleClass('selected-tab', false, navItem);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: '_setIsMobile',
					value: function _setIsMobile(viewport) {
						if (viewport) {
							return viewport.isMobile();
						}
					}
				}, {
					key: '_updateProductFromPopupResponse',
					value: function _updateProductFromPopupResponse() {
						var products = this.popupResponse.products;
						if (!products || products.length === 0) return;

						var numConfiguredProducts = this.configuredProducts.length;
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = products[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var product = _step2.value;

								this.push('configuredProducts', product);
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						if (numConfiguredProducts === 1) this.buildPanelIfMultipleBundesAndNotMobile();
					}
				}, {
					key: 'formatBundlesLayout',
					value: function formatBundlesLayout() {
						this.toggleClass('multiple-bundles', this.hasMultipleBundles, this.$.bundleContainer);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setMD(searchFilters)', 'initSearchFilter(searchFieldMD, prefix)', '_updateProductFromPopupResponse(popupResponse, configuredProducts)', '_resize(configuredProducts.*)'];
					}
				}]);

				return ProductBundlesLayout;
			}());

			_export('ProductBundlesLayout', ProductBundlesLayout);

			Polymer(ProductBundlesLayout);
		}
	};
});

'use strict';

System.register('products/config/feature/sb-product-feature/ProductFeature.js', ['../../../../common/layout/fields/FieldSetHandler.js', '../../../../common/core/sb-page-container/PageContainer.js', 'common/core/AppContext.js'], function (_export, _context) {
	var FieldSetHandler, PageContainer, AppContext, _createClass, ProductFeature;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonLayoutFieldsFieldSetHandlerJs) {
			FieldSetHandler = _commonLayoutFieldsFieldSetHandlerJs.FieldSetHandler;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductFeature', ProductFeature = function () {
				function ProductFeature() {
					_classCallCheck(this, ProductFeature);
				}

				_createClass(ProductFeature, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = "sb-product-feature";

						this.listeners = {
							'selection-changed': 'handleSelectionCounter'
						};

						this.properties = {
							featureId: String,
							model: Object,
							maxOptions: Object,
							feature: Object,
							fieldSetKey: String,
							fieldSetHandler: Object,
							tabNames: {
								type: Array,
								readOnly: true,
								value: ["options", "attributes"]
							},
							tabs: {
								type: Array,
								value: []
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							configSearch: Object,
							isMobile: {
								type: Boolean,
								value: false,
								computed: "_setIsMobile(viewport)"
							},
							hasConfigAttributes: {
								type: Boolean,
								value: false,
								computed: "_setHasConfigAttributes(model, featureId)"
							},
							mobileHasConfigAttributes: {
								type: Boolean,
								value: false
							},
							hasOptions: {
								type: Boolean,
								computed: "_setHasOptions(model, featureId)"
							},
							mobileHasOptions: Boolean,
							hasOptionsAndConfigAttributes: {
								type: Boolean,
								value: false,
								computed: '_setHasOptionsAndConfigAttributes(hasConfigAttributes, hasOptions)'
							},
							mobileHasOptionsAndConfigAttributes: Boolean,
							hasInstructions: {
								type: Boolean,
								computed: '_setHasInstructions(feature)'
							},
							mobileHasInstructions: Boolean,
							expanded: {
								type: Boolean,
								value: false
							},
							selectedOptions: {
								type: Number,
								value: 0
							},
							hasSelectedOptions: {
								type: Boolean,
								value: false,
								computed: '_hasSelectedOptions(selectedOptions)'
							},
							featureIndex: Number,
							configAttributes: {
								type: Object,
								notify: true
							},
							hasUpgradeOptions: {
								type: Boolean,
								computed: '_setHasUpgradedOptions(feature)'
							},
							mobileRendering: {
								type: Boolean,
								value: false
							},
							mobileExpanded: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: '_setHasUpgradedOptions',
					value: function _setHasUpgradedOptions() {
						return this.model.getHasUpgradeOptions(this.feature);
					}
				}, {
					key: '_hasSelectedOptions',
					value: function _hasSelectedOptions(selectedOptions) {
						return !selectedOptions;
					}
				}, {
					key: 'render',
					value: function render() {
						if (!this.model.featureIdsWithOptionsOrConfigAttr[this.featureId]) return;
						this.setFeatureAndOptionSelectionMethod();
						this.setOptionsDetails();
						this.setFieldSetHandler();
						this.renderFeatureInDesktopOrMobileView();
						this.initSelectedOptions();
						this.handleDeleteOptions();
						this.handleOptionChangedByRule();
					}
				}, {
					key: 'buildTabs',
					value: function buildTabs() {
						if (!this.isMobile) return;

						var i18n = AppContext.properties.i18n.value();
						var optionsTab = {
							name: "t1",
							label: i18n.l("Options"),
							pageComponent: "sb-product-option-table",
							attributes: [{ name: 'id', value: 'ot' }],
							bind: ["model", "featureId", "fieldSet", "fieldSetName", "routeSource", "isClickSelection", "disabledStateMap", "configSearch", "hasUpgradeOptions"]
						};
						var attributesTab = {
							name: "t2",
							label: i18n.l("Attributes"),
							pageComponent: "sb-attribute-table",
							attributes: [{ name: 'id', value: 'configAttributesTop' }, { name: 'added-class', value: 'header-attributes' }],
							bind: ["featureId", "model", "configAttributes"]
						};
						this.tabs = [optionsTab, attributesTab];
					}
				}, {
					key: 'setFieldSetHandler',
					value: function setFieldSetHandler() {
						this.fieldSetHandler = new FieldSetHandler(this.model.product.optionFieldSets, 'OptionConfiguration', 'OptionConfigurationTablet', 'OptionConfigurationPhone');
					}
				}, {
					key: 'setFeatureAndOptionSelectionMethod',
					value: function setFeatureAndOptionSelectionMethod() {
						this.feature = this.model.getFeature(this.featureId);
					}
				}, {
					key: 'setOptionsDetails',
					value: function setOptionsDetails() {
						this.isClickSelection = this.feature.optionSelectionMethod === 'Click';
						this.routeSource = 'Configurator';
					}
				}, {
					key: 'featureChanged',
					value: function featureChanged() {
						var configurationFieldSet = this.feature.record[this.model.prefix + 'ConfigurationFieldSet__c'];
						this.fieldSetKey = configurationFieldSet === undefined ? null : configurationFieldSet;
					}
				}, {
					key: 'setFieldSetFromViewport',
					value: function setFieldSetFromViewport() {
						var fs = this.fieldSetHandler.getByViewport(this.viewport);
						this.fieldSet = fs.fields;
						this.fieldSetName = fs.name;
					}
				}, {
					key: 'initFieldSet',
					value: function initFieldSet() {
						if (this.fieldSetKey) {
							this.fieldSet = this.model.product.optionFieldSets[this.fieldSetKey];
							this.fieldSetName = this.fieldSetKey;
						} else {
							this.setFieldSetFromViewport();
						}
					}
				}, {
					key: '_setIsMobile',
					value: function _setIsMobile(viewport) {
						if (viewport) {
							return viewport.isMobile();
						}
					}
				}, {
					key: '_setHasConfigAttributes',
					value: function _setHasConfigAttributes(model, featureId) {
						var configAttributes = this.model.configAttributesByFeatureId[featureId];

						if (!configAttributes) {
							return false;
						}

						for (var i = 0; i < configAttributes.length; i++) {
							if (!configAttributes[i].hidden) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: '_setHasOptions',
					value: function _setHasOptions() {
						return !!this.model.optionsByFeatureId[this.featureId] || this.model.featureIdsWIthSelectionMethodDynamic[this.featureId];
					}
				}, {
					key: '_setHasOptionsAndConfigAttributes',
					value: function _setHasOptionsAndConfigAttributes(hasConfigAttributes, hasOptions) {
						return hasConfigAttributes && hasOptions;
					}
				}, {
					key: '_setHasInstructions',
					value: function _setHasInstructions() {
						return !!this.feature.instructionsText || !!this.feature.additionalInstructions;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;

						if (!this.fieldSetKey) {
							this.setFieldSetFromViewport();
						}
					}
				}, {
					key: 'renderFeatureInDesktopOrMobileView',
					value: function renderFeatureInDesktopOrMobileView() {
						this.toggleClass("group", !this.isMobile, this.$.feature);
					}
				}, {
					key: 'applyFilters',
					value: function applyFilters() {
						var featureOptions = this.model.getOptionsByFeatureId(this.featureId);
						var configSearch = new ConfiguratorSearch(this.searchFilters, featureOptions);
						this.filtered = !configSearch.hasOptions || !configSearch.containsFeature(this.feature);
					}
				}, {
					key: 'mobileExpand',
					value: function mobileExpand(e) {
						var _this = this;

						if (this.mobileExpanded) {
							this.expand(e);
							return;
						}

						if (this.mobileRendering) return;
						this.mobileRendering = true;

						this.toggleClass('first', false, this.$$('header'));

						Polymer.RenderStatus.afterNextRender(this, function () {
							_this.mobileHasInstructions = _this.hasInstructions;
							_this.mobileHasOptionsAndConfigAttributes = _this.hasOptionsAndConfigAttributes;
							_this.mobileHasConfigAttributes = _this.hasConfigAttributes;
							_this.mobileHasOptions = _this.hasOptions;
							Polymer.dom(_this.$.feature).observeNodes(function () {
								this.mobileExpanded = true;
								this.mobileRendering = false;

								this.toggleClass('first', true, this.$$('header'));
								this.expand(e);
							}.bind(_this));
						});
					}
				}, {
					key: 'expand',
					value: function expand(e) {
						this.expanded = !this.expanded;
						this.fire('feature-expanded', { expanded: this.expanded, path: Polymer.dom(e).path });
					}
				}, {
					key: 'initSelectedOptions',
					value: function initSelectedOptions() {
						var prefix = AppContext.org.prefix !== '' ? AppContext.org.prefix + '__' : '';
						var options = this.model.getOptionsByFeatureId(this.featureId);
						for (var i = 0, l = options.length; i < l; i++) {
							if (options[i].selected) this.selectedOptions++;

							if (options[i].record[prefix + 'UnitPrice__c'] === undefined) {
								console.warn('Option is missing entry in selected pricebook => ' + options[i].record[prefix + 'ProductCode__c'] + ': ' + options[i].record[prefix + 'ProductName__c']);
								return true;
							}
						}
					}
				}, {
					key: 'handleSelectionCounter',
					value: function handleSelectionCounter(e) {
						if (!e.detail.changed) return;

						if (e.detail.selectionType === 'radio') {
							this.selectedOptions = e.detail.selected ? 1 : 0;
							return;
						}

						if (!this.selectedOptions && !e.detail.selected) {
							return;
						}

						this.selectedOptions += e.detail.selected ? 1 : -1;
					}
				}, {
					key: 'handleDeleteOptions',
					value: function handleDeleteOptions(e) {
						this.addEventListener('delete-tapped', function (e) {
							if (this.selectedOptions > 0) this.selectedOptions--;
						});
					}
				}, {
					key: 'handleOptionChangedByRule',
					value: function handleOptionChangedByRule(e) {
						this.addEventListener('option-changed-by-rule', function (e) {
							e.detail.added ? this.selectedOptions++ : this.selectedOptions--;
						});
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['render(featureId, model)', 'buildTabs(viewport, model, featureId)', 'featureChanged(feature)', 'initFieldSet(model, fieldSetKey, fieldSetHandler)'];
					}
				}]);

				return ProductFeature;
			}());

			_export('ProductFeature', ProductFeature);

			Polymer(ProductFeature);
		}
	};
});

'use strict';

System.register('products/config/feature/sb-product-feature-category-list/ProductFeatureCategoryList.js', [], function (_export, _context) {
	var _createClass, ProductFeatureCategoryList;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductFeatureCategoryList', ProductFeatureCategoryList = function () {
				function ProductFeatureCategoryList() {
					_classCallCheck(this, ProductFeatureCategoryList);
				}

				_createClass(ProductFeatureCategoryList, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-feature-category-list';
						this.properties = {
							categoryNamesOrFeatures: Array,
							hasCategories: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'setHasCategories',
					value: function setHasCategories(model) {
						this.hasCategories = model.checkAtLeastOneFeatureHasCategory();
					}
				}, {
					key: 'setCategoryNamesOrFeatures',
					value: function setCategoryNamesOrFeatures(model, hasCategories) {
						if (hasCategories) {
							this.categoryNamesOrFeatures = Object.keys(model.getTabFeaturesMap());
						} else {
							this.categoryNamesOrFeatures = model.featuresWithOptionsOrConfigAttr;
						}
					}
				}, {
					key: 'getFeaturesByCategory',
					value: function getFeaturesByCategory(categoryName) {
						var map = this.model.getTabFeaturesMap();

						return map[categoryName];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setHasCategories(model)', 'setCategoryNamesOrFeatures(model, hasCategories)'];
					}
				}]);

				return ProductFeatureCategoryList;
			}());

			_export('ProductFeatureCategoryList', ProductFeatureCategoryList);

			Polymer(ProductFeatureCategoryList);
		}
	};
});

'use strict';

System.register('products/config/feature/sb-product-feature-layout/ProductFeatureLayout.js', ['../../../../common/core/Page.js', '../../../../common/core/sb-page-container/PageContainer.js', '../../viewmodel/ProductViewModel.js', '../../../resources/optionConstraints/OptionConstraintsHandler.js'], function (_export, _context) {
	var Page, PageContainer, ProductViewModel, OptionConstraintsHandler, _createClass, ProductFeatureLayout;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_viewmodelProductViewModelJs) {
			ProductViewModel = _viewmodelProductViewModelJs.ProductViewModel;
		}, function (_resourcesOptionConstraintsOptionConstraintsHandlerJs) {
			OptionConstraintsHandler = _resourcesOptionConstraintsOptionConstraintsHandlerJs.OptionConstraintsHandler;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductFeatureLayout', ProductFeatureLayout = function (_Page) {
				_inherits(ProductFeatureLayout, _Page);

				function ProductFeatureLayout() {
					_classCallCheck(this, ProductFeatureLayout);

					return _possibleConstructorReturn(this, (ProductFeatureLayout.__proto__ || Object.getPrototypeOf(ProductFeatureLayout)).apply(this, arguments));
				}

				_createClass(ProductFeatureLayout, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-feature-layout';
						this.properties = Polymer.Base.extend({
							qId: String,
							product: Object,
							model: Object,
							configAttributes: {
								type: Object,
								notify: true
							},
							features: {
								type: Object,
								value: {},
								computed: '_setFeatures(model)'
							},
							vp: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							isMobile: {
								type: Boolean,
								value: false,
								computed: '_setIsMobile(vp)'
							},
							hasConfigAttributes: {
								type: Boolean,
								computed: '_setHasConfigAttributes(configAttributes)'
							},
							hasFeaturelessConfigAttributes: {
								type: Boolean,
								computed: '_setHasFeaturelessConfigAttributes(configAttributes)'
							},
							isMobileAndHasConfigAttributes: {
								type: Boolean,
								value: false,
								computed: '_setIsMobileAndHasFeaturelessConfigAttributes(isMobile, hasFeaturelessConfigAttributes)'
							},
							isSectionLayout: {
								type: Boolean,
								value: false
							},
							isPaginationRequired: {
								type: Boolean,
								value: false
							},
							tabsForFeatureLayout: Object,
							tabsForTabsAndWizardLayout: Object,
							selectedTabIndex: {
								type: Number,
								notify: true
							},
							optionConstraintsHandler: {
								type: Object,
								value: {},
								computed: 'setOptionConstraintsHandler(model)'
							},
							disabledStateMap: {
								type: Object,
								value: {}
							},
							configSearch: Object,
							listenersAttached: {
								type: Boolean,
								value: false
							}
						}, Page.properties);
					}
				}, {
					key: 'buildModel',
					value: function buildModel() {
						this.model = new ProductViewModel(this.qId, this.product, this.app.org.prefix, this.currencyIsoCode);
					}
				}, {
					key: '_setConfigAttributes',
					value: function _setConfigAttributes() {
						this.configAttributes = this.model.configurationAttributeValueMap;
					}
				}, {
					key: '_setHasFeaturelessConfigAttributes',
					value: function _setHasFeaturelessConfigAttributes() {
						var featurelessConfigAttributes = this.model.configAttributesByFeatureId['featureless'];

						if (!featurelessConfigAttributes) {
							return false;
						}

						for (var i = 0; i < featurelessConfigAttributes.length; i++) {
							if (!featurelessConfigAttributes[i].hidden) {
								return true;
							}
						}
						return false;
					}
				}, {
					key: '_setFeatures',
					value: function _setFeatures(model) {
						return model.featuresWithOptionsOrConfigAttr;
					}
				}, {
					key: '_setIsMobile',
					value: function _setIsMobile(vp) {
						if (vp) {
							return vp.isMobile();
						}
					}
				}, {
					key: '_setHasConfigAttributes',
					value: function _setHasConfigAttributes(configAttributes) {
						return !!Object.keys(configAttributes).length;
					}
				}, {
					key: '_setIsMobileAndHasFeaturelessConfigAttributes',
					value: function _setIsMobileAndHasFeaturelessConfigAttributes(isMobile, hasFeaturelessConfigAttributes) {
						return isMobile && hasFeaturelessConfigAttributes;
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.vp = e.detail.viewport;
					}
				}, {
					key: 'render',
					value: function render() {
						var optionLayout = this.model.getOptionLayout();
						if (this.isMobile) {
							optionLayout = 'Sections';

							if (this.hasFeaturelessConfigAttributes) {
								this.buildFeatureLayoutTabs();
								this.handleOptionSelectionChanged();
								return;
							}
						}

						if (this.isSectionLayout) {
							optionLayout = 'Sections';
						}

						if (!this.isMobile && (optionLayout === 'Tabs' || this.model.checkAtLeastOneFeatureHasCategory())) {
							this.buildTabsAndWizardLayoutTabs();
							this.isPaginationRequired = false;
						} else if (optionLayout === 'Wizard') {
							this.buildTabsAndWizardLayoutTabs();
							this.isPaginationRequired = true;
						} else if (optionLayout === 'Sections' || optionLayout === 'None') {
							this.isSectionLayout = true;
						}
						this.handleOptionSelectionChanged();
						this.listenersAttached = true;
					}
				}, {
					key: 'buildFeatureLayoutTabs',
					value: function buildFeatureLayoutTabs() {
						var featuresTab = {
							name: "t1",
							label: this.i18n.l("Features"),
							pageComponent: "sb-product-feature-category-list",
							bind: ["model", "configAttributes", "disabledStateMap", "configSearch"]
						};

						var attributesTab = {
							name: "t2",
							label: this.i18n.l("Attributes"),
							pageComponent: "sb-attribute-table",
							attributes: [{ name: 'id', value: 'globalConfigAttributes' }, { name: 'added-class', value: 'header-attributes' }, { name: 'feature-id', value: 'featureless' }],
							bind: ["model", "configAttributes"]
						};

						this.tabsForFeatureLayout = [featuresTab, attributesTab];
					}
				}, {
					key: 'buildTabsAndWizardLayoutTabs',
					value: function buildTabsAndWizardLayoutTabs() {
						var tabFeaturesMap = this.model.getTabFeaturesMap(),
						    featureKeys = Object.keys(tabFeaturesMap),
						    tabs = [];
						for (var i = 0, l = featureKeys.length; i < l; i++) {
							var tId = "t" + i;
							tabs.push({ name: tId, label: featureKeys[i] });
						}
						this.isSectionLayout = false;
						this.tabsForTabsAndWizardLayout = tabs;
					}
				}, {
					key: 'setOptionConstraintsHandler',
					value: function setOptionConstraintsHandler() {
						return new OptionConstraintsHandler(this.model.product, this.model.prefix);
					}
				}, {
					key: 'handleOptionSelectionChanged',
					value: function handleOptionSelectionChanged() {
						if (this.listenersAttached) return;
						this.addEventListener('selection-changed', function (e) {
							if (e && e.detail) {
								if (e.detail.selected === false && this.model.getOption(e.detail.Id).added) {
									var option = this.model.getOption(e.detail.Id);
									option.added = false;
									option.removed = true;
								}
								this.handleOptionConstraints(e.detail.Id, e.detail.selected);
							}
						});
						this.addEventListener('delete-tapped', function (e) {
							if (e && e.detail && !this.hasSameOptionAdded(e.detail.Id)) {
								var option = this.model.getOption(e.detail.Id);
								option.added = false;
								option.removed = true;
								this.handleOptionConstraints(e.detail.Id, false);
							}
						}.bind(this));
						this.fireSelectionStatesForAddFeatures();
					}
				}, {
					key: 'hasSameOptionAdded',
					value: function hasSameOptionAdded(optionId) {
						var fId = this.model.getOption(optionId).record[this.model.prefix + 'Feature__c'],
						    feature = this.model.getFeature(fId),
						    options = feature ? feature._transient_.optionConfigurations : [];

						for (var i = 0, l = options.length; i < l; i++) {
							if (options[i].record.Id === optionId) return true;
						}
						return false;
					}
				}, {
					key: 'fireSelectionStatesForAddFeatures',
					value: function fireSelectionStatesForAddFeatures() {
						var _this2 = this;

						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = Object.keys(this.model.featureIdsWithSelectionMethodAdd)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var featureId = _step.value;

								var options = this.model.optionsByFeatureId[featureId];
								if (options !== undefined) options.forEach(function (option) {
									_this2.handleOptionConstraints(option.record.Id, option.selected);
								});
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: 'handleOptionConstraints',
					value: function handleOptionConstraints(optionId, selected) {
						var _this3 = this;

						var disabledStateChanges = this.optionConstraintsHandler.handleOptionConstraints(optionId, selected);
						if (disabledStateChanges) {
							disabledStateChanges.forEach(function (change) {
								_this3.set('disabledStateMap.' + change.optionId, change.disabledState);
							});
						}
					}
				}, {
					key: 'handleProductRulesResponse',
					value: function handleProductRulesResponse() {
						if (!this.domHost || !this.product.configuration.productRulesActions) return;
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = Object.keys(this.product.configuration.productRulesActions.enableOptions)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var id = _step2.value;

								if (!this.model.optionSystemOrRequired(id)) this.product.configuration.productRulesActions.enableOptions[id] = !this.optionConstraintsHandler.optionShouldBeDisabled(id);else delete this.product.configuration.productRulesActions.enableOptions[id];
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = Object.keys(this.product.configuration.productRulesActions.disableOptions)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var id = _step3.value;

								if (!this.model.optionSystemOrRequired(id)) this.product.configuration.productRulesActions.disableOptions[id] = this.optionConstraintsHandler.optionShouldBeDisabled(id);else delete this.product.configuration.productRulesActions.enableOptions[id];
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = Object.keys(this.product.configuration.productRulesActions.hideOptions)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var id = _step4.value;

								this.handleShownAndHiddenOptions(this.model.featureIdByOptionId[id], true);
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}

						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = Object.keys(this.product.configuration.productRulesActions.showOptions)[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var id = _step5.value;

								this.handleShownAndHiddenOptions(this.model.featureIdByOptionId[id], false);
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}

						this.set('model.productRulesActions', this.product.configuration.productRulesActions);
						delete this.product.configuration.productRulesActions;
					}
				}, {
					key: 'handleShownAndHiddenOptions',
					value: function handleShownAndHiddenOptions(featureId, hideOption) {
						var checkVisibleOptions = hideOption ? this.featureContainsOneVisibleOptions : this.featureContainsNoVisibleOptions;
						if (checkVisibleOptions.call(this, featureId)) {
							var index = this.features.findIndex(function (feature) {
								return feature.record.Id === featureId;
							});
							this.set(['features', index, 'hidden'], hideOption);
						}
					}
				}, {
					key: '_setOptionData',
					value: function _setOptionData() {
						if (!this.domHost) return;
						this.set('model.optionDataByOptionIds', this.product.configuration.optionDataByOptionIds);
						delete this.product.configuration.optionDataByOptionIds;
					}
				}, {
					key: 'featureContainsOneVisibleOptions',
					value: function featureContainsOneVisibleOptions(featureId) {
						var visibleOptions = 0,
						    options = this.model.optionsByFeatureId[featureId],
						    l = options.length,
						    i = 0;

						while (visibleOptions <= 1 && i < l) {
							if (!options[i].hidden) visibleOptions++;
							i++;
						}

						return visibleOptions === 1;
					}
				}, {
					key: 'featureContainsNoVisibleOptions',
					value: function featureContainsNoVisibleOptions(featureId) {
						var noVisibleOptions = true,
						    options = this.model.optionsByFeatureId[featureId],
						    l = options.length,
						    i = 0;

						while (noVisibleOptions && i < l) {
							if (!options[i].hidden) noVisibleOptions = false;
							i++;
						}

						return noVisibleOptions;
					}
				}, {
					key: '_updateProductFromPopupResponse',
					value: function _updateProductFromPopupResponse() {
						this.model.init(this.popupResponse.product);
						this._setConfigAttributes();
						this.set('model.optionNotifications', this.popupResponse.optionNotifications);
					}
				}, {
					key: '_createConstraintsHoverMessages',
					value: function _createConstraintsHoverMessages() {
						if (this.model.optionConstraintsByConstrained) return;

						this.model.createConstraintsHoverMessages(this.optionConstraintsHandler.optionConstraints.byConstrained);
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['_setConfigAttributes(model)', 'render(model, isSectionLayout)', 'buildModel(product, qId, currencyIsoCode)', 'handleProductRulesResponse(model, disabledStateMap, product.configuration.*)', '_setOptionData(model, product.configuration.optionDataByOptionIds)', '_updateProductFromPopupResponse(popupResponse, model)', '_createConstraintsHoverMessages(model, optionConstraintsHandler)'];
					}
				}]);

				return ProductFeatureLayout;
			}(Page));

			_export('ProductFeatureLayout', ProductFeatureLayout);

			Polymer(ProductFeatureLayout);
		}
	};
});

'use strict';

System.register('products/config/feature/sb-product-feature-list/ProductFeatureList.js', ['common/core/AppContext.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var AppContext, PageContainer, _createClass, ProductFeatureList;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductFeatureList', ProductFeatureList = function () {
				function ProductFeatureList() {
					_classCallCheck(this, ProductFeatureList);
				}

				_createClass(ProductFeatureList, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-feature-list';
						this.properties = {
							features: Object,
							configSearch: Object,
							model: Object,
							label: String,
							spinner: {
								type: Boolean,
								value: false
							},
							show: {
								type: Boolean,
								value: false
							},
							tabs: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'initLazyTabRendering',
					value: function initLazyTabRendering() {
						this.show = this.isMobile() === true || this.tabs === false;
						if (this.show === false) {
							this.addEventListener('sb-tab-selected', this.handleTabSelected.bind(this));

							this.addEventListener('sb-options-attached-after-actions', this.filterFeatureHandler.bind(this));
						}
					}
				}, {
					key: 'initFeatures',
					value: function initFeatures() {
						this.features = this.features || this.model.getTabFeaturesMap()[this.label];
					}
				}, {
					key: 'filterFeatures',
					value: function filterFeatures() {
						if (!this.show) return;

						for (var i = 0, numFeatures = this.features.length; i < numFeatures; i++) {
							this.filterFeatureByIndex(i);
						}
					}
				}, {
					key: 'filterFeatureHandler',
					value: function filterFeatureHandler(e) {
						this.filterFeatureById(e.detail.featureId);
					}
				}, {
					key: 'filterFeatureById',
					value: function filterFeatureById(featureId) {
						for (var i = 0, l = this.features.length; i < l; i++) {
							if (this.features[i].record.Id === featureId) {
								this.filterFeatureByIndex(i);
								return;
							}
						}
					}
				}, {
					key: 'filterFeatureByIndex',
					value: function filterFeatureByIndex(featureIndex) {
						var featureOptions = this.configSearch.setOptionVisibility(this.model.optionsByFeatureId[this.features[featureIndex].record.Id] || []);
						var isHidden = !this.configSearch.hasRequiredConfigAttributes(this.features[featureIndex], this.model);
						var selectionMethod = this.features[featureIndex].record[this.prefix + 'OptionSelectionMethod__c'];

						if (this.configSearch.allOptionsHiddenByRule(featureOptions) && (selectionMethod !== 'Dynamic' || selectionMethod === 'Dynamic' && this.model.maxOptionsMet(this.features[featureIndex]))) isHidden = !this.configSearch.hasConfigAttributes(this.features[featureIndex], this.model);else {
							if (selectionMethod === "Click") isHidden = isHidden && (!this.configSearch.containsFeature(this.features[featureIndex]) || !this.configSearch.hasVisibleOptions(featureOptions));else {
								if (this.model.maxOptionsMet(this.features[featureIndex])) isHidden = isHidden && (!this.configSearch.containsFeature(this.features[featureIndex]) || !this.configSearch.hasVisibleOptions(this.features[featureIndex]._transient_.optionConfigurations));else isHidden = isHidden && (!this.configSearch.containsFeature(this.features[featureIndex]) || !this.configSearch.hasVisibleOptions(featureOptions));
							}
						}
						this.set('features.' + featureIndex + '.hidden', isHidden);
					}
				}, {
					key: 'handleFeatureExpandEvent',
					value: function handleFeatureExpandEvent() {
						this.addEventListener('feature-expanded', function (e) {
							var nodes = e.detail.path;

							nodes.forEach(function (node) {

								if (node.id === 'feature-header') {
									while (node.nextElementSibling) {
										node.classList.toggle('expanded', e.detail.expanded);
										node = node.nextElementSibling;
									}
								}
							}.bind(this));
						}.bind(this));
					}
				}, {
					key: 'handleTabSelected',
					value: function handleTabSelected() {
						if (this.show === true) return;
						this.spinner = true;
						this.async(this.renderComponent.bind(this), 0);
					}
				}, {
					key: 'renderComponent',
					value: function renderComponent() {
						if (this.renderingComponent) return;

						this.renderingComponent = true;
						Polymer.RenderStatus.afterNextRender(this, function () {
							this.show = true;
							this.spinner = false;
							this.renderingComponent = false;
						}.bind(this));
					}
				}, {
					key: 'isMobile',
					value: function isMobile() {
						return !!(this.viewport && this.viewport.isMobile());
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['initFeatures(label, model)', 'filterFeatures(configSearch, features, model, model.productRulesActions, show)', 'handleFeatureExpandEvent(features)', 'initLazyTabRendering(tabs, viewport)'];
					}
				}, {
					key: 'prefix',
					get: function get() {
						return AppContext.org.prefix ? AppContext.org.prefix + '__' : '';
					}
				}]);

				return ProductFeatureList;
			}());

			_export('ProductFeatureList', ProductFeatureList);

			Polymer(ProductFeatureList);
		}
	};
});

'use strict';

System.register('products/config/option/sb-option-cell/OptionCell.js', ['common/core/AppContext.js', 'common/relationship/RelationshipFieldManager.js', 'common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var AppContext, RelationshipFieldManager, PageContainer, _createClass, OptionCell;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonRelationshipRelationshipFieldManagerJs) {
			RelationshipFieldManager = _commonRelationshipRelationshipFieldManagerJs.RelationshipFieldManager;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OptionCell', OptionCell = function () {
				function OptionCell() {
					_classCallCheck(this, OptionCell);
				}

				_createClass(OptionCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-option-cell';
						this.properties = {
							item: String,
							itemLabel: String,
							value: {
								notify: true
							},
							model: Object,
							data: Object,
							prefix: {
								type: String,
								value: function value() {
									return AppContext.org.prefix ? AppContext.org.prefix + '__' : '';
								}
							},
							selected: {
								type: Boolean,
								value: false
							},
							index: Number,
							display: String,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: 'buildCell',
					value: function buildCell() {
						this.field = this.getField();
						if (this.itemLabel === this.prefix + 'Quantity__c') this.initQuantityCell();else if (this.itemLabel === this.prefix + 'UnitPrice__c') this.initUnitPriceCell();else this.initCell();
					}
				}, {
					key: 'getQuantityEditable',
					value: function getQuantityEditable() {
						return this.getFieldRecordValue('QuantityEditable__c') || this.data.recordHasQuantity === false;
					}
				}, {
					key: 'getPriceEditable',
					value: function getPriceEditable() {
						return this.getFieldRecordValue('PriceEditable__c') === 'Yes' && this.getFieldRecordValue('Bundled__c') === false;
					}
				}, {
					key: 'getField',
					value: function getField() {
						return this.model.fieldDetails[this.item];
					}
				}, {
					key: 'initQuantityCell',
					value: function initQuantityCell() {
						if (this.data.hasDimension === true && this.data.isSegmented === true && this.data.configured === true) return this.mdqWarningIcon = true;
						this.editable = this.getQuantityEditable();
						if (this.getFieldRecordValue('ProductQuantityScale__c') !== undefined) this.field.scale = this.getFieldRecordValue('ProductQuantityScale__c');else if (AppContext.org.quantityScale !== undefined) this.field.scale = AppContext.org.quantityScale;

						this.$.field.preventNumericAlignment = true;
						this.attachQuantityChangeCallback();
						this.initCell();
					}
				}, {
					key: 'initUnitPriceCell',
					value: function initUnitPriceCell() {
						this.editable = this.getPriceEditable();
						this.initCell();
					}
				}, {
					key: 'initCell',
					value: function initCell() {
						if (this.index === 0 && this.viewport && this.viewport.isMobile()) this.editable = false;

						if (this.editable === undefined) this.editable = this.field.updateable && this.quoteLineHasField(this.itemLabel);

						if (this.value === undefined) this.value = '';

						this.setDisplayIfRelationshipItem();
						this.attachValueChangedCallback();
						this.handleOriginalValues();
						this.$.field.md = this.field;
					}
				}, {
					key: 'attachQuantityChangeCallback',
					value: function attachQuantityChangeCallback() {
						this.addEventListener('value-changed', function (e) {
							this.fire('sb-quantity-changed', {
								Id: this.data.record.Id,
								bundleId: this.getBundleId(),
								changed: true,
								invalidQuantity: this.data.invalidQuantity,
								validQuantity: this.data.validQuantity,
								path: e.path
							});
						}.bind(this));
					}
				}, {
					key: 'attachValueChangedCallback',
					value: function attachValueChangedCallback() {
						this.addEventListener('value-changed', this.syncValueChangeWithOptionConfiguration.bind(this));
					}
				}, {
					key: 'getBundleId',
					value: function getBundleId() {
						return this.data.parentProductKey || this.getFieldRecordValue('ConfiguredSKU__c');
					}
				}, {
					key: 'getFieldRecordValue',
					value: function getFieldRecordValue(field) {
						return this.data.record[this.prefix + field];
					}
				}, {
					key: 'quoteLineHasField',
					value: function quoteLineHasField(field) {
						return !!this.model.quoteLineFields[field];
					}
				}, {
					key: 'setItemLabel',
					value: function setItemLabel() {
						if (this.item.startsWith('record.')) this.itemLabel = this.item.split('.')[1];else this.itemLabel = this.item;
					}
				}, {
					key: 'syncValueChangeWithOptionConfiguration',
					value: function syncValueChangeWithOptionConfiguration() {
						if (!this.data.configuration || this.data.configuration.length == 0) return;

						if (this.data.configuration.length > 1) return;

						var optionData = this.data.configuration[0].optionData;
						if (!optionData) return;

						var parts = this.item.split('.');
						var key = parts[parts.length - 1];
						if (optionData[key] === undefined) return;

						optionData[key] = this.value;
					}
				}, {
					key: 'handleOriginalValues',
					value: function handleOriginalValues() {
						if (!this.data._transient_.original && this.data.record) {
							this.data._transient_.original = {};
							this.data._transient_.original.record = JSON.parse(JSON.stringify(this.data.record));
						}

						if (this.data._transient_.original) {
							if (!this.data._transient_.original.record.hasOwnProperty(this.item.split('.')[1])) this.set('data._transient_.original.' + this.item, this.value);
							this.$.field.originalValue = this.get('data._transient_.original.' + this.item);
						}
					}
				}, {
					key: 'setDisplayIfRelationshipItem',
					value: function setDisplayIfRelationshipItem() {
						var rfm = new RelationshipFieldManager(this.item, function (field) {
							return this.get('data.' + field);
						}.bind(this));

						if (rfm.hasRelationship()) this.display = rfm.getRelationshipName();
					}
				}, {
					key: '_displayChanged',
					value: function _displayChanged() {
						var rfm = new RelationshipFieldManager(this.item, function (field, value) {
							if (!value) return this.get('data.' + field);else this.set('data.' + field, value);
						}.bind(this));
						rfm.addRelationshipName(this.value, this.display, this.field.referenceTo[0]);
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildCell(itemLabel, model, data, prefix)', 'setItemLabel(item)', '_displayChanged(value, display, item, data, field)'];
					}
				}]);

				return OptionCell;
			}());

			_export('OptionCell', OptionCell);

			Polymer(OptionCell);
		}
	};
});

'use strict';

System.register('products/config/option/sb-product-option-table/ProductOptionTable.js', ['../../../../common/core/AppContext.js', 'common/layout/tables/ImageCellSizer.js', 'common/layout/tables/TableClassBuilder.js', 'common/core/sb-page-container/PageContainer.js', 'products/resources/optionUpgrades/OptionUpgradeHandler.js', '../../../../common/calculate/asset-upgrade-quantity-calculator/AssetUpgradeQuantityCalculator.js'], function (_export, _context) {
	var AppContext, ImageCellSizer, TableClassBuilder, PageContainer, OptionUpgradeHandler, AssetUpgradeQuantityCalculator, _slicedToArray, _createClass, ProductOptionTable;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonLayoutTablesImageCellSizerJs) {
			ImageCellSizer = _commonLayoutTablesImageCellSizerJs.ImageCellSizer;
		}, function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_productsResourcesOptionUpgradesOptionUpgradeHandlerJs) {
			OptionUpgradeHandler = _productsResourcesOptionUpgradesOptionUpgradeHandlerJs.OptionUpgradeHandler;
		}, function (_commonCalculateAssetUpgradeQuantityCalculatorAssetUpgradeQuantityCalculatorJs) {
			AssetUpgradeQuantityCalculator = _commonCalculateAssetUpgradeQuantityCalculatorAssetUpgradeQuantityCalculatorJs.AssetUpgradeQuantityCalculator;
		}],
		execute: function () {
			_slicedToArray = function () {
				function sliceIterator(arr, i) {
					var _arr = [];
					var _n = true;
					var _d = false;
					var _e = undefined;

					try {
						for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
							_arr.push(_s.value);

							if (i && _arr.length === i) break;
						}
					} catch (err) {
						_d = true;
						_e = err;
					} finally {
						try {
							if (!_n && _i["return"]) _i["return"]();
						} finally {
							if (_d) throw _e;
						}
					}

					return _arr;
				}

				return function (arr, i) {
					if (Array.isArray(arr)) {
						return arr;
					} else if (Symbol.iterator in Object(arr)) {
						return sliceIterator(arr, i);
					} else {
						throw new TypeError("Invalid attempt to destructure non-iterable instance");
					}
				};
			}();

			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductOptionTable', ProductOptionTable = function () {
				function ProductOptionTable() {
					_classCallCheck(this, ProductOptionTable);
				}

				_createClass(ProductOptionTable, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-option-table';
						this.properties = {
							featureId: String,
							model: Object,
							isClickSelection: Boolean,
							index: String,
							routeSource: String,
							options: {
								type: Array,
								computed: 'initOptions(model, featureId, isClickSelection, fieldSet)'
							},
							showAddOptionsButton: Boolean,
							md: Object,
							fieldSet: Array,
							featureless: {
								type: Boolean,
								computed: 'isOptionFeatureless(options)'
							},
							prefix: {
								type: String,
								computed: 'getPrefix(model)'
							},
							primaryMobileCol: {
								type: Array,
								computed: "_getPrimaryMobileColumns(prefix, fieldSet, fieldSetName)"
							},
							parentIdDataPath: {
								type: String,
								computed: 'setParentIdDataPath(model, prefix)'
							},
							disabledStateMap: Object,
							configSearch: Object,
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							showUpgradeOptions: {
								type: Boolean,
								value: false
							},
							upgradeOptionButtonText: {
								type: String,
								value: 'Show Available Upgrades'
							},
							hasUpgradeOptions: Boolean,
							headerActions: {
								type: Array,
								value: []
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.header.selectable = false;
						this.handleSelectionChanged();
						this.handleMetadataChanged();
						this.handleDeleteOption();
						this.handleConfigureOption();
						if (!this.viewport || !this.viewport.isMobile()) this.editFirstWhenSelected = 'sb-field';
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (this._actionsProcessed) this.fire('sb-options-attached-after-actions', { featureId: this.featureId });
					}
				}, {
					key: 'handleSelectionChanged',
					value: function handleSelectionChanged() {
						this.addEventListener('selection-changed', function (e) {
							this.model.setOptionSelected(e.detail.Id, e.detail.selected);
							this.ifRadioSelectedClearOtherRadioSelections(e);

							var optionIndex = e.detail.index != undefined ? e.detail.index : this.getOptionIndex(e.detail.Id);

							if (optionIndex < 0) {
								return;
							}

							if (e.detail.selected === true && this.routeSource === 'Configurator') {
								this._displayAvailableRowActions(optionIndex, false);
								this.set(['options', optionIndex, 'selected'], e.detail.selected);
							} else {
								this._displayAvailableRowActions(optionIndex, true);
							}

							if (!e.detail.selected && e.detail.changed) {
								var changedOption = this.model.originalDataByOptionIds[e.detail.Id];

								if (changedOption.priceRule) {
									this.set(['options', optionIndex, 'record', this.prefix + 'Discount__c'], changedOption.discountRate);
									this.set(['options', optionIndex, 'record', this.prefix + 'DiscountAmount__c'], changedOption.discountAmount);
									this.set(['options', optionIndex, 'record', this.prefix + 'UnitPrice__c'], changedOption.unitPrice);
									this.set(['options', optionIndex, 'record', this.prefix + 'Quantity__c'], changedOption.quantity);
								}
							}

							if (this.routeSource === 'Configurator' && e.detail.path && (!!this.options[optionIndex].upgradedAssetId || !!this.options[optionIndex].sourceProductIds)) {
								this._handleOptionUpgrades(e, optionIndex);
							}
						}.bind(this));

						this.addEventListener('sb-quantity-changed', this._handleOptionUpgrades.bind(this));
					}
				}, {
					key: '_displayAvailableRowActions',
					value: function _displayAvailableRowActions(index, actionsHidden) {
						for (var i = 0; i < this.options[index]._transient_.rowActions.length; i++) {
							this.set(['options', index, '_transient_.rowActions', i, 'invisible'], actionsHidden);

							if (this.routeSource === 'OptionLookup') {
								this.set(['options', index, '_transient_.rowActions', i, 'hidden'], actionsHidden);
							}

							if (this.options[index]._transient_.rowActions[i].title === 'Configure' && this.options[index].configurable !== true) {
								this.set(['options', index, '_transient_.rowActions', i, 'invisible'], true);
							}
						}
					}
				}, {
					key: 'handleMetadataChanged',
					value: function handleMetadataChanged() {
						this.$.fieldMetaData.addEventListener('md-changed', function (e) {
							var md = this.initFieldMetadata(e.detail.value.fieldsByObject);
							this.rowClassMap = md.rowClassMap;
							this.md = md;
						}.bind(this));
					}
				}, {
					key: '_handleOptionUpgrades',
					value: function _handleOptionUpgrades(e, optionIndex) {
						var _this = this;

						if (this.model.product.quoteType !== 'Amendment') {
							return;
						}

						var option = this.options[optionIndex || this.getOptionIndex(e.detail.Id)];
						var optionUpgradeHandler = new OptionUpgradeHandler(this.prefix, this.options, option);
						var assetUpgradeQauntityCalculator = new AssetUpgradeQuantityCalculator(optionUpgradeHandler);

						assetUpgradeQauntityCalculator.setQuantitiesByRatio();

						if (!optionUpgradeHandler.getSourceOption() && !optionUpgradeHandler.getUpgradeOption()) {
							return;
						}

						var sourceOptionIndex = this.getOptionIndex(optionUpgradeHandler.getSourceOption().record.Id);
						var upgradeOptionIndex = this.getOptionIndex(optionUpgradeHandler.getUpgradeOption().record.Id);

						this.debounce('Wait for function to finish', function () {
							var sourceOption = optionUpgradeHandler.getSourceOption();
							var upgradeOption = optionUpgradeHandler.getUpgradeOption();

							if (sourceOption.invalidQuantity) {
								_this._notifyQuantityChange(sourceOptionIndex, upgradeOptionIndex, sourceOption, true);
							} else if (upgradeOption.invalidQuantity) {
								_this._notifyQuantityChange(upgradeOptionIndex, sourceOptionIndex, upgradeOption, true);
							} else {
								_this._notifyQuantityChange(sourceOptionIndex, upgradeOptionIndex);
							}

							sourceOption.invalidQuantity = null;
							upgradeOption.invalidQuantity = null;
						}, 10);
					}
				}, {
					key: '_notifyQuantityChange',
					value: function _notifyQuantityChange(index1, index2, option, invalidQuantity) {
						if (invalidQuantity) {
							option.record[this.prefix + 'Quantity__c'] = option.invalidQuantity;
							this.notifyPath(['options', index1, 'record', this.prefix + 'Quantity__c']);
							option.record[this.prefix + 'Quantity__c'] = option.validQuantity;
						}

						this.notifyPath(['options', index2, 'record', this.prefix + 'Quantity__c']);
						this.notifyPath(['options', index1, 'record', this.prefix + 'Quantity__c']);
					}
				}, {
					key: '_getPrimaryMobileColumns',
					value: function _getPrimaryMobileColumns() {
						var primaryMobileCols = ["record." + this.prefix + "ProductName__c"];

						if (primaryMobileCols && primaryMobileCols.length > 0 && this.fieldSetName.endsWith('Phone')) primaryMobileCols = ["record." + this.fieldSet[0]];

						return primaryMobileCols;
					}
				}, {
					key: 'setMetadataRequest',
					value: function setMetadataRequest() {
						var mdFields = [];
						for (var i = 0, l = this.fieldSet.length; i < l; i++) {
							mdFields.push('ProductOption__c.' + this.fieldSet[i]);

							mdFields.push('QuoteLine__c.' + this.fieldSet[i]);
						}

						if (JSON.stringify(this.$.fieldMetaData.fields) === JSON.stringify(mdFields)) return;
						this.$.fieldMetaData.fields = mdFields;
					}
				}, {
					key: 'initFieldMetadata',
					value: function initFieldMetadata(md) {
						var fieldLabelMap = {},
						    recordKeys = [],
						    fieldLabels = [],
						    fieldDetails = {},
						    labelTypeMap = {},
						    itemTypeMap = {};
						for (var i in md[this.prefix + 'ProductOption__c']) {
							var mdItem = md[this.prefix + 'ProductOption__c'][i];
							if (mdItem.type.toLowerCase() === 'currency') mdItem.CurrencyIsoCode = this.model.currencyIsoCode;
							fieldLabels.push(mdItem.label);
							recordKeys.push('record.' + mdItem.name);
							fieldLabelMap[mdItem.name] = mdItem.label;
							fieldDetails['record.' + i] = mdItem;

							var type = mdItem.type;
							if (!this._isMobile()) {
								var isQuantity = i === this.prefix + 'Quantity__c';
								if (isQuantity) type = 'string';

								var imageWidth = new ImageCellSizer(mdItem).getImageWidth(20);

								if (imageWidth) type += ':' + imageWidth;
							}

							labelTypeMap[mdItem.label.replace(/\W/g, '')] = type;
							itemTypeMap['record.' + i] = type;
						}
						return {
							recordKeys: recordKeys,
							fieldLabels: fieldLabels,
							fieldLabelMap: fieldLabelMap,
							fieldDetails: fieldDetails,
							quoteLineFields: md[this.prefix + 'QuoteLine__c'],
							headerClassMap: new TableClassBuilder(Object.keys(labelTypeMap), 'Th', labelTypeMap).build(),
							rowClassMap: new TableClassBuilder(recordKeys, 'Td', itemTypeMap, ['initial']).build()
						};
					}
				}, {
					key: 'initOptions',
					value: function initOptions() {
						if (!this.model.optionsByFeatureId[this.featureId]) return;
						return this.model.getOptionsByFeatureId(this.featureId);
					}
				}, {
					key: 'notify',
					value: function notify(paths) {
						for (var i = 0, l = this.options.length; i < l; i++) {
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = paths[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var path = _step.value;

									this.notifyPath('options.' + i + '.' + path);
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}
					}
				}, {
					key: 'getOptionIndex',
					value: function getOptionIndex(optionId) {
						var index = -1,
						    i = 0,
						    length = this.options.length;
						while (index < 0 && i < length) {
							if (this.options[i].record.Id === optionId) index = i;
							i++;
						}
						return index;
					}
				}, {
					key: 'ifRadioSelectedClearOtherRadioSelections',
					value: function ifRadioSelectedClearOtherRadioSelections(e) {
						if (!e.detail.selected) return;
						var root = Polymer.dom(e).rootTarget;
						if (root.selectionType !== 'radio') return;
						var rows = Polymer.dom(this.$.tbody).querySelectorAll('sb-table-row');

						if (!rows || rows.length == 0) return;
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = rows[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var row = _step2.value;

								if (row.selectionType == 'radio' && row !== root) {
									row.$.row.fire('group-selected', { selected: false });
									row.selected = false;
								}
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}
					}
				}, {
					key: 'setParentIdDataPath',
					value: function setParentIdDataPath() {
						return 'record.' + this.prefix + 'ConfiguredSKU__c';
					}
				}, {
					key: 'navigationChanged',
					value: function navigationChanged() {
						this.reset();
					}
				}, {
					key: 'setOptionsDisabledData',
					value: function setOptionsDisabledData() {
						if (!this.options.length || !this.disabledStateMap || !Object.keys(this.disabledStateMap).length) return;

						this.options.forEach(function (option, idx) {
							if (this.optionShouldChange(option)) this.changeOptionDisabled(option, idx);
						}.bind(this));
					}
				}, {
					key: 'disabledStateMapChanged',
					value: function disabledStateMapChanged(newVal) {
						if (!this.options || !this.options.length || !Object.keys(this.disabledStateMap).length) return;

						var optionId = newVal.path.split('.')[1],
						    option = this.model.optionsById[optionId],
						    idx = this.options.findIndex(function (opt) {
							return opt.record.Id === optionId;
						});

						if (idx >= 0 && this.optionShouldChange(option)) {
							this.changeOptionDisabled(option, idx);
						}
					}
				}, {
					key: 'optionShouldChange',
					value: function optionShouldChange(option) {
						return option.disabledData && this.disabledStateMap[option.record.Id] !== option.disabledData.constrained;
					}
				}, {
					key: 'changeOptionDisabled',
					value: function changeOptionDisabled(option, idx) {
						var constrained = !!this.disabledStateMap[option.record.Id],
						    disabled = option.disabledData.disabled;
						this.set('options.' + idx + '.disabledData', { 'disabled': disabled, 'constrained': constrained });
						if (!this.isClickSelection && this.disabledStateMap[option.record.Id] == true) this.deleteOption(option.record.Id, idx, true);
					}
				}, {
					key: 'reset',
					value: function reset() {
						Polymer._collections.delete(this.options);
					}
				}, {
					key: 'routeToLookup',
					value: function routeToLookup() {
						var queryParams = {
							qId: this.model.qId,
							pId: this.model.product.record.Id,
							fId: this.featureId
						};
						if (this.model.getFeature(this.featureId).optionSelectionMethod === 'Dynamic') queryParams.path = ['product', 'dl'];
						this.fire('add-option-clicked', queryParams);
					}
				}, {
					key: 'isOptionFeatureless',
					value: function isOptionFeatureless() {
						if (!this.options) return;
						if (this.options.length === 0) return 'featureless';else return null;
					}
				}, {
					key: 'isOptionSelected',
					value: function isOptionSelected(option) {
						if (this.routeSource === 'OptionLookup') return false;
						return !!option.selected;
					}
				}, {
					key: 'handleDeleteOption',
					value: function handleDeleteOption() {
						this.addEventListener('delete-tapped', function (e) {
							this.deleteOption(e.detail.Id, e.detail.index);
						}.bind(this));
					}
				}, {
					key: 'deleteOption',
					value: function deleteOption(id, index, deleteMultiple) {
						var copy = this.sameOptionAdded(id, index, true);
						if (!copy) this.model.optionsById[id].selected = false;

						this.fire('sb-option-deleted', this.options[index]);
						this.splice('options', index, 1);
						this.showOrHideAddOptionsButton();
						if (deleteMultiple && copy) this.deleteOption(copy.id, copy.index, true);
					}
				}, {
					key: 'sameOptionAdded',
					value: function sameOptionAdded(optionId, index) {
						var sameOption = null;
						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = this.options.entries()[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var _step3$value = _slicedToArray(_step3.value, 2),
								    idx = _step3$value[0],
								    option = _step3$value[1];

								if (idx === index) continue;
								if (option.record.Id === optionId) {
									sameOption = { 'id': optionId, 'index': idx };
									option.index--;
								}
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						return sameOption;
					}
				}, {
					key: 'handleConfigureOption',
					value: function handleConfigureOption() {
						this.addEventListener('configure-tapped', function (e) {
							var index = this.isClickSelection ? null : e.detail.index;

							var option = this.isClickSelection ? this.model.optionsById[e.detail.Id] : this.model.getFeature(this.featureId)._transient_.optionConfigurations[e.detail.index];
							var tabIndex = void 0;
							if (this.model.product.record[this.prefix + 'OptionLayout__c'] === 'Tabs' || this.model.product.featureCategories.length > 0) tabIndex = this.getTabIndex();
							this.fire('configure-option-tapped', {
								addedIndex: option.index || 0,
								index: index,
								optionId: option.record.Id,
								optionalSKU: option.record[this.prefix + 'OptionalSKU__c'],
								productId: this.model.product.record.Id,
								tabIndex: tabIndex
							});
						}.bind(this));
					}
				}, {
					key: 'getTabIndex',
					value: function getTabIndex() {
						var categoryName = void 0;
						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = this.model.product.features.entries()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var _step4$value = _slicedToArray(_step4.value, 2),
								    idx = _step4$value[0],
								    feature = _step4$value[1];

								if (feature.record.Id !== this.featureId) continue;
								if (this.model.product.featureCategories.length > 0) {
									categoryName = feature.record[this.prefix + 'Category__c'];
									if (categoryName == null) return this.model.product.featureCategories.length;
									break;
								} else return idx;
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}

						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = this.model.product.featureCategories.entries()[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var _step5$value = _slicedToArray(_step5.value, 2),
								    index = _step5$value[0],
								    category = _step5$value[1];

								if (category === categoryName) return index;
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}
					}
				}, {
					key: 'filterOptions',
					value: function filterOptions() {
						var _options = this.configSearch.setOptionVisibility(this.options);
						for (var i = 0; i < this.options.length; i++) {
							if (!this.options[i].hiddenByRule) this.set('options.' + i + '.hidden', _options[i].hidden);
						}
					}
				}, {
					key: 'setOptionIndex',
					value: function setOptionIndex() {
						var optionCount = {};

						for (var i = 0; i < this.options.length; i++) {
							if (!optionCount[this.options[i].record.Id]) optionCount[this.options[i].record.Id] = 0;
							this.set('options.' + i + '.index', optionCount[this.options[i].record.Id]);

							var nodeId = '_' + this.options[i].record.Id + '_' + this.options[i].index;
							var configured = this.model.product.configuration.configuredOptions && this.model.product.configuration.configuredOptions[nodeId];
							this.set('options.' + i + '.configured', configured);
							optionCount[this.options[i].record.Id]++;
						}
					}
				}, {
					key: 'setProductRulesActions',
					value: function setProductRulesActions() {
						if (Object.keys(this.model.productRulesActions).length == 0 || !this.model.optionsByFeatureId[this.featureId]) return;

						if (this.isClickSelection == false) this.setUnaddedOptionsRulesActions();
						if (this.options[0] !== undefined) this.setDisplayedOptionsRulesActions();

						this._actionsProcessed = true;
					}
				}, {
					key: 'setUnaddedOptionsRulesActions',
					value: function setUnaddedOptionsRulesActions() {
						var addedOptions = this.model.optionsByFeatureId[this.featureId];
						for (var h = 0; h < addedOptions.length; h++) {
							var option = addedOptions[h];
							if (this.model.productRulesActions.selectOptions[option.record.Id] && !this.sameOptionAdded(option.record.Id, h)) {
								option.selected = true;
								option.added = true;
								this.push('options', option);
								this.showOrHideAddOptionsButton();
								this.fireOptionChangedByRule(true);
							}
							if (this.model.productRulesActions.showOptions[option.record.Id]) {
								option.hidden = false;
								option.hiddenByRule = false;
							}
							if (this.model.productRulesActions.hideOptions[option.record.Id]) {
								option.hidden = true;
								option.hiddenByRule = true;
							}
							if (this.model.productRulesActions.disableOptions[option.record.Id] === true) {
								option.disabledData = { 'disabled': true, 'constrained': true };
							}
							if (this.model.productRulesActions.disableOptions[option.record.Id] === false) {
								option.disabledData = { 'disabled': true, 'constrained': false };
							}
							if (this.model.productRulesActions.enableOptions[option.record.Id] === true) {
								option.disabledData = { 'disabled': false, 'constrained': false };
							}
							if (this.model.productRulesActions.enableOptions[option.record.Id] === false) {
								option.disabledData = { 'disabled': false, 'constrained': true };
							}
						}
					}
				}, {
					key: 'setDisplayedOptionsRulesActions',
					value: function setDisplayedOptionsRulesActions() {
						for (var i = 0; i < this.options.length; i++) {
							if (this.isClickSelection && this.model.productRulesActions.selectOptions[this.options[i].record.Id]) {
								this.set('options.' + i + '.selected', true);
								this.fireOptionChangedByRule(true);
							}
							if (this.model.productRulesActions.deselectOptions[this.options[i].record.Id]) {
								if (this.isClickSelection) {
									this.set('options.' + i + '.selected', false);
									this.fireOptionChangedByRule(false);
								} else {
									this.deleteOption(this.options[i].record.Id, i);
									if (this.options[i] === undefined) return;
								}
							}
							if (this.model.productRulesActions.hideOptions[this.options[i].record.Id]) {
								this.set('options.' + i + '.hidden', true);
								this.options[i].hiddenByRule = true;
							}
							if (this.model.productRulesActions.showOptions[this.options[i].record.Id]) {
								this.set('options.' + i + '.hidden', false);
								this.options[i].hiddenByRule = false;
							}
							if (this.model.productRulesActions.disableOptions[this.options[i].record.Id] === true) {
								this.set('options.' + i + '.disabledData', { 'disabled': true, 'constrained': true });
							}
							if (this.model.productRulesActions.disableOptions[this.options[i].record.Id] === false) {
								this.set('options.' + i + '.disabledData', { 'disabled': true, 'constrained': false });
							}
							if (this.model.productRulesActions.enableOptions[this.options[i].record.Id] === true) {
								this.set('options.' + i + '.disabledData', { 'disabled': false, 'constrained': false });
							}
							if (this.model.productRulesActions.enableOptions[this.options[i].record.Id] === false) {
								this.set('options.' + i + '.disabledData', { 'disabled': false, 'constrained': true });
							}
						}
					}
				}, {
					key: 'fireOptionChangedByRule',
					value: function fireOptionChangedByRule(added) {
						if (this.viewport && !this.viewport.isMobile()) return;

						this.fire('option-changed-by-rule', {
							added: added
						});
					}
				}, {
					key: '_firePriceRules',
					value: function _firePriceRules() {
						var optionDataByOptionIds = this.model.optionDataByOptionIds;
						var options = this.options;

						if (options != null) {
							for (var i = 0; i < options.length; i++) {
								var optionId = options[i].optionId || options[i].record.Id;

								if (optionDataByOptionIds[optionId] != null) {
									var priceActions = this._getPriceActions(options[i], optionId);

									for (var priceAction in priceActions) {
										if (priceActions.hasOwnProperty(priceAction)) {
											options[i].record[priceAction] = priceActions[priceAction];
											this.notifyPath(['options', i, 'record', priceAction]);
										}
									}
								}
							}
						}
					}
				}, {
					key: '_getPriceActions',
					value: function _getPriceActions(option, optionId) {
						var priceActions = {};
						var optionData = this.model.optionDataByOptionIds[optionId].optionData;
						var listPrice = this.model.optionDataByOptionIds[optionId].listPrice || this.model.originalDataByOptionIds[optionId].unitPrice;

						for (var priceAction in optionData) {
							if (optionData.hasOwnProperty(priceAction) && priceAction != 'attributes') {
								if (option.record[priceAction] != optionData[priceAction]) {
									priceActions[priceAction] = optionData[priceAction];
								}
							}
						}

						this._calculateUnitPrice(priceActions, optionData, listPrice);

						return priceActions;
					}
				}, {
					key: '_calculateUnitPrice',
					value: function _calculateUnitPrice(priceActions, optionData, listPrice) {
						var prefix = this.getPrefix();
						var discountRate = optionData[prefix + 'Discount__c'];
						var discountAmount = optionData[prefix + 'DiscountAmount__c'];

						if (discountRate) {
							priceActions[prefix + 'UnitPrice__c'] = listPrice * ((100 - discountRate) / 100);
						} else if (discountAmount) {
							priceActions[prefix + 'UnitPrice__c'] = listPrice - discountAmount;
						}
					}
				}, {
					key: 'setUpgradeOptionClass',
					value: function setUpgradeOptionClass() {
						Polymer.dom(this.$.tbody).observeNodes(function () {
							var upgradeOptions = Polymer.dom(this.$.tbody).node.querySelectorAll('#row[hidden]');

							for (var i = 0; i < upgradeOptions.length; i++) {
								if (upgradeOptions[i].rowData.isUpgrade) this.toggleClass('upgradeOption', true, upgradeOptions[i]);
							}
						}.bind(this));
					}
				}, {
					key: 'toggleUpgradeOptions',
					value: function toggleUpgradeOptions() {
						var options = this.options;
						this.showUpgradeOptions = !this.showUpgradeOptions;

						if (this.showUpgradeOptions) {
							this.upgradeOptionButtonText = 'Hide Available Upgrades';
						} else {
							this.upgradeOptionButtonText = 'Show Available Upgrades';
						}

						for (var i = 0; i < options.length; i++) {
							if (options[i].isUpgrade === true) {
								if (this.showUpgradeOptions) {
									this.set('options.' + i + '.hidden', false);
								} else {
									this.set('options.' + i + '.hidden', true);
								}
							}
						}
					}
				}, {
					key: 'showOrHideAddOptionsButton',
					value: function showOrHideAddOptionsButton() {
						this.showAddOptionsButton = !this.isClickSelection && !this.model.maxOptionsMet(this.model.getFeature(this.featureId));
					}
				}, {
					key: 'getPrefix',
					value: function getPrefix() {
						return this.model.prefix;
					}
				}, {
					key: 'setHasUpgradeOptions',
					value: function setHasUpgradeOptions(hasUpgradeOptions, showAddOptionsButton) {
						this.hasUpgradeOptions = hasUpgradeOptions && !showAddOptionsButton;
					}
				}, {
					key: '_setHeaderActions',
					value: function _setHeaderActions() {
						if (this.routeSource === 'OptionLookup' || this.options.length === 0 || !this.options[0]._transient_.rowActions) {
							return;
						} else {
							this.headerActions = JSON.parse(JSON.stringify(this.options[0]._transient_.rowActions));

							for (var i = this.headerActions.length - 1; i >= 0; i--) {
								this.headerActions[i].invisible = true;
							}

							if (!this.isClickSelection) {
								this.headerActions[0].hidden = true;
							}
						}
					}
				}, {
					key: '_showUpgradeOptionIfSelectionMethodAdd',
					value: function _showUpgradeOptionIfSelectionMethodAdd() {
						if (this.isClickSelection) {
							return;
						}

						for (var i = 0; i < this.options.length; i++) {
							if (this.options[i].isUpgrade) {
								this.set('options.' + i + '.hidden', false);
							}
						}
					}
				}, {
					key: '_isMobile',
					value: function _isMobile() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['setMetadataRequest(model, fieldSet, prefix)', 'disabledStateMapChanged(disabledStateMap.*)', 'setOptionsDisabledData(disabledStateMap, options)', 'setUpgradeOptionClass(options)', 'filterOptions(configSearch, options)', 'setProductRulesActions(options, model.productRulesActions.*)', '_firePriceRules(options, model.optionDataByOptionIds.*)', 'notify(model.optionNotifications, options)', 'showOrHideAddOptionsButton(model, featureId, isClickSelection)', 'setHasUpgradeOptions(hasUpgradeOptions, showAddOptionsButton)', '_setHeaderActions(options)', '_showUpgradeOptionIfSelectionMethodAdd(options, isClickSelection)', 'setOptionIndex(options)'];
					}
				}]);

				return ProductOptionTable;
			}());

			_export('ProductOptionTable', ProductOptionTable);

			Polymer(ProductOptionTable);
		}
	};
});

'use strict';

System.register('products/config/routes/sb-dynamic-lookup/DynamicLookup.js', ['common/core/Page.js', 'common/layout/tables/TableClassBuilder.js', 'common/filter/searcher/Searcher.js', 'common/core/sb-page-container/PageContainer.js', 'products/localization/LocalizeFields.js', '../../viewmodel/ProductViewModel.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, TableClassBuilder, Searcher, PageContainer, LocalizeFields, ProductViewModel, ErrorFormatter, _createClass, DynamicLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonFilterSearcherSearcherJs) {
			Searcher = _commonFilterSearcherSearcherJs.Searcher;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_productsLocalizationLocalizeFieldsJs) {
			LocalizeFields = _productsLocalizationLocalizeFieldsJs.LocalizeFields;
		}, function (_viewmodelProductViewModelJs) {
			ProductViewModel = _viewmodelProductViewModelJs.ProductViewModel;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('DynamicLookup', DynamicLookup = function (_Page) {
				_inherits(DynamicLookup, _Page);

				function DynamicLookup() {
					_classCallCheck(this, DynamicLookup);

					return _possibleConstructorReturn(this, (DynamicLookup.__proto__ || Object.getPrototypeOf(DynamicLookup)).apply(this, arguments));
				}

				_createClass(DynamicLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-dynamic-lookup';
						this.properties = Polymer.Base.extend({
							quote: Object,
							model: Object,
							feature: Object,
							selectedProducts: {
								type: Object,
								value: {}
							},
							productIds: {
								type: String,
								computed: 'getProductIds(ctx)'
							},
							lineEditorModel: Object,
							redirectUrl: String,
							hiddenByGroup: {
								type: Object,
								value: {}
							},
							defaultFilters: {
								type: Object,
								value: {}
							},
							internal: {
								type: Boolean,
								value: false
							},
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							error: {
								type: Array,
								value: []
							},
							hasInstructions: {
								type: Boolean,
								computed: 'setHasInstructions(feature)'
							}
						}, Page.properties);
					}
				}, {
					key: 'searchModelChanged',
					value: function searchModelChanged() {
						this.deSelectAll();
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.lookupLayout.additionalFields = ['PricebookEntry.UnitPrice'];
						this.$.drawer.$.drawer.addEventListener('transitionend', this.refocus.bind(this));
						this.addEventListener('iron-deselect', this.handleDrawerClosed.bind(this));
					}
				}, {
					key: 'cancel',
					value: function cancel() {
						this.spinner = true;
						var queryParams = this._createQueryParams();
						this.nav('#', queryParams, ['product', 'pc'], false);
					}
				}, {
					key: 'add',
					value: function add() {
						var featureOptionIds = [];
						for (var key in this.selectedProducts) {
							featureOptionIds.push(this.ctx.params.fId + ':' + key);
						}
						this.$.productLoader.featureOptionIds = featureOptionIds;
						this.$.productLoader.ignoreCache = true;
					}
				}, {
					key: 'convertProductsToOptions',
					value: function convertProductsToOptions(results) {
						for (var key in results) {
							var option = results[key];
							option.record[this.prefix + 'UnitPrice__c'] = this.selectedProducts[key].record.UnitPrice;
							option.isDynamicOption = true;
							this.push('product.options', option);
							this.push('feature._transient_.optionConfigurations', option);
						}

						this.syncConfigurationAttributesToProduct(option);
						var queryParams = this._createQueryParams();
						this.nav('#', queryParams, ['product', 'pc'], false);
					}
				}, {
					key: 'syncConfigurationAttributesToProduct',
					value: function syncConfigurationAttributesToProduct(product) {
						if (this.autoSelectAttributes === undefined) {
							this.autoSelectAttributes = {};
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = this.product.configurationAttributes[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var attribute = _step.value;

									if (attribute.autoSelect === true && this.autoSelectAttributes[attribute.targetFieldName] === undefined) this.autoSelectAttributes[attribute.targetFieldName] = true;
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}
						}

						for (var _attribute in this.autoSelectAttributes) {
							this.product.configuration.configurationData[_attribute] = product.record[_attribute];
						}
					}
				}, {
					key: '_createQueryParams',
					value: function _createQueryParams() {
						var queryParams = { qId: this.model.qId },
						    params = this.ctx.params;

						if (!params) return queryParams;

						if (params.pId) queryParams.pId = params.pId;
						if (params.oId) {
							queryParams.oId = params.oId;
							queryParams.origin = 'dl';
						}
						if (params.lineKey) queryParams.lineKey = params.lineKey;
						if (params.redirectUrl) queryParams.redirectUrl = params.redirectUrl;
						if (params.productIdx) queryParams.productIdx = params.productIdx;
						if (params.tab) queryParams.tab = params.tab;
						if (params.groupKey) queryParams.groupKey = params.groupKey;
						if (params.aId) queryParams.aId = params.aId;

						return queryParams;
					}
				}, {
					key: 'handleProductsLoadServerResponse',
					value: function handleProductsLoadServerResponse() {
						this.$.qo.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
							this.isoCode = this.lineEditorModel.quote.record.CurrencyIsoCode || null;
							this.quote = e.detail.value.quote;
							this.$.productLoader.productIds = this.productIds;
							this.$.productLoader.quote = this.quote;
							this.headerSubtitle = e.detail.value.headerSubtitle;
						}.bind(this));

						this.$.productLoader.addEventListener('product-load-model-changed', function (e) {
							if (Object.keys(this.selectedProducts).length > 0) return this.convertProductsToOptions(e.detail.value);
							this.product = this.ctx.params.productIdx ? e.detail.value.configuredProducts[this.ctx.params.productIdx] : e.detail.value.configuredProducts[0];
							this.localizer = new LocalizeFields(this.prefix);
							this.model = new ProductViewModel(this.quote.record.Id, this.product, this.orgPrefix, this.isoCode, this.ctx.params.fId);
							this.feature = this.model.getFeature(this.ctx.params.fId);
							if (this.feature === undefined) {
								this.error = ["Attempted to access a feature not associated with this bundle."];
								return;
							}
							var filters = [];
							var filtersLoaded = false;
							if (this.feature.searchFilters) {
								if (this.defaultFilters[this.feature.record.Id] != null) filtersLoaded = true;else this.defaultFilters[this.feature.record.Id] = [];
								var _iteratorNormalCompletion2 = true;
								var _didIteratorError2 = false;
								var _iteratorError2 = undefined;

								try {
									for (var _iterator2 = this.feature.searchFilters[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
										var searchFilter = _step2.value;

										if (searchFilter.valueObject === 'Configuration Attributes') searchFilter.stringValue = this.product.configuration.configurationData[searchFilter.targetFieldName];
										filters.push(JSON.stringify(searchFilter));
										if (!filtersLoaded) this.defaultFilters[this.feature.record.Id].push(searchFilter);
									}
								} catch (err) {
									_didIteratorError2 = true;
									_iteratorError2 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion2 && _iterator2.return) {
											_iterator2.return();
										}
									} finally {
										if (_didIteratorError2) {
											throw _iteratorError2;
										}
									}
								}
							}
							this.$.smLoadService.filters = filters;
							this.$.smLoadService.fieldSet = this.feature.record[this.prefix + 'DynamicProductFilterFieldSet__c'];
							this.$.smLoadService.quote = this.quote;
						}.bind(this));

						this.$.smLoadService.addEventListener('search-model-changed', function (e) {
							var searchModel = this.localizer.localizeSearchModel(e.detail.value);
							var layoutFieldSet = this.product.productFieldSets[this.feature.record[this.prefix + 'DynamicProductLookupFieldSet__c']];
							if (layoutFieldSet) searchModel.resultFieldNames = layoutFieldSet;
							this.$.lookupLayout.fieldPrefix = searchModel.targetObjectName + '.';
							this.searchModel = searchModel;
							this.buildDelegator();
						}.bind(this));
					}
				}, {
					key: 'buildDelegator',
					value: function buildDelegator() {
						var searcher = new Searcher(this.searchModel);
						searcher.dynamicSearchFilters = this.defaultFilters[this.feature.record.Id] ? this.defaultFilters[this.feature.record.Id] : [];
						searcher.dynamicFieldSet = this.feature.record[this.prefix + 'DynamicProductLookupFieldSet__c'];
						this.searcher = searcher;
					}
				}, {
					key: 'toggleFilter',
					value: function toggleFilter() {
						this.$$('sb-page-header')._closeMenu();
						this.panelHeader = 'Product Filter';
						this.$.drawer.$.drawer.togglePanel();
						this.refocus();
					}
				}, {
					key: 'refocus',
					value: function refocus() {
						this.$.pf.focusFirstField();
					}
				}, {
					key: 'reverseFocus',
					value: function reverseFocus() {
						this.$.clearfilter.focus();
					}
				}, {
					key: 'runSearcher',
					value: function runSearcher() {
						this.$$('#submit').focus();
						this.lastSubmit = 'pf';
						this.$.pf.runService();
						this.$.drawer.$.drawer.closeDrawer();
					}
				}, {
					key: 'removeFilter',
					value: function removeFilter() {
						this.$$('.actions').removeChild(this.$$('#fb'));
					}
				}, {
					key: 'getConfigProductIds',
					value: function getConfigProductIds(e) {
						var productIds = [];
						var _iteratorNormalCompletion3 = true;
						var _didIteratorError3 = false;
						var _iteratorError3 = undefined;

						try {
							for (var _iterator3 = e.detail.value.configuredProducts[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
								var product = _step3.value;

								productIds.push(product.record.Id);
							}
						} catch (err) {
							_didIteratorError3 = true;
							_iteratorError3 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion3 && _iterator3.return) {
									_iterator3.return();
								}
							} finally {
								if (_didIteratorError3) {
									throw _iteratorError3;
								}
							}
						}

						return productIds.join(',');
					}
				}, {
					key: 'deSelectAll',
					value: function deSelectAll() {
						this.$.lookupLayout.deSelectAll();
					}
				}, {
					key: 'getOrderedSelectedProducts',
					value: function getOrderedSelectedProducts() {
						var orderedSelectedProductIds = Object.keys(this.selectedProducts).sort(function (id1, id2) {
							return this.selectedProducts[id1].index - this.selectedProducts[id2].index;
						}.bind(this));

						var orderedSelectedProducts = [];
						var _iteratorNormalCompletion4 = true;
						var _didIteratorError4 = false;
						var _iteratorError4 = undefined;

						try {
							for (var _iterator4 = orderedSelectedProductIds[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
								var selectedProductId = _step4.value;

								orderedSelectedProducts.push(this.selectedProducts[selectedProductId]);
							}
						} catch (err) {
							_didIteratorError4 = true;
							_iteratorError4 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion4 && _iterator4.return) {
									_iterator4.return();
								}
							} finally {
								if (_didIteratorError4) {
									throw _iteratorError4;
								}
							}
						}

						return orderedSelectedProducts;
					}
				}, {
					key: 'handleDrawerClosed',
					value: function handleDrawerClosed() {
						if (this.$.drawer.$.drawer.selected === 'main') {
							this.fire('iron-signal', { name: 'sb-panel-closed' });
						}
					}
				}, {
					key: 'clearFilterFields',
					value: function clearFilterFields() {
						this.filterData = this.searcher.clearFields();
					}
				}, {
					key: 'bindFilterEnterCallBacks',
					value: function bindFilterEnterCallBacks() {
						this.$.pf.enterCallback = this.runSearcher.bind(this);
					}
				}, {
					key: 'getProductIds',
					value: function getProductIds() {
						return this.ctx.params ? this.ctx.params.pId || '' : '';
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.error = new ErrorFormatter(this.errors).truncate();
					}
				}, {
					key: 'setHasInstructions',
					value: function setHasInstructions() {
						return !!this.feature.instructionsText || !!this.feature.additionalInstructions;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior, window.CommonBehaviors.LookupBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['searchModelChanged(searchModel)'];
					}
				}, {
					key: 'prefix',
					get: function get() {
						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}, {
					key: 'orgPrefix',
					get: function get() {
						return this.app.org.prefix ? this.app.org.prefix : '';
					}
				}]);

				return DynamicLookup;
			}(Page));

			_export('DynamicLookup', DynamicLookup);

			Polymer(DynamicLookup);
		}
	};
});

'use strict';

System.register('products/config/routes/sb-option-lookup/OptionLookup.js', ['../../../../common/core/Page.js', '../../../resources/rules/RuleProcessor.js', '../../viewmodel/ProductViewModel.js', '../../../resources/optionConstraints/OptionConstraintsHandler.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, RuleProcessor, ProductViewModel, OptionConstraintsHandler, ErrorFormatter, _createClass, OptionLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_resourcesRulesRuleProcessorJs) {
			RuleProcessor = _resourcesRulesRuleProcessorJs.RuleProcessor;
		}, function (_viewmodelProductViewModelJs) {
			ProductViewModel = _viewmodelProductViewModelJs.ProductViewModel;
		}, function (_resourcesOptionConstraintsOptionConstraintsHandlerJs) {
			OptionConstraintsHandler = _resourcesOptionConstraintsOptionConstraintsHandlerJs.OptionConstraintsHandler;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OptionLookup', OptionLookup = function (_Page) {
				_inherits(OptionLookup, _Page);

				function OptionLookup() {
					_classCallCheck(this, OptionLookup);

					return _possibleConstructorReturn(this, (OptionLookup.__proto__ || Object.getPrototypeOf(OptionLookup)).apply(this, arguments));
				}

				_createClass(OptionLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-option-lookup';
						this.properties = Polymer.Base.extend({
							topLevelBundle: Object,
							currentProductModel: Object,
							feature: Object,
							disabledStateMap: {
								type: Object,
								value: {}
							},
							optionConstraintsHandler: Object,
							headerSubtitle: String,
							selectedOptions: Object,
							productIds: {
								type: String,
								computed: 'getProductIds(ctx)'
							},
							lineKey: {
								type: Number,
								computed: 'getLineKey(ctx)'
							},
							ignoreCache: {
								type: Boolean,
								computed: 'getIgnoreCache(ctx)'
							},
							hasUpgradeOptions: {
								type: Boolean,
								computed: 'setHasUpgradeOptions(feature)'
							},
							optionId: {
								type: String,
								computed: 'getOptionId(ctx)'
							},
							validationMessages: Array,
							errors: {
								type: Array,
								value: [],
								notify: true
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.preLoadObjects();
						this._handleLineEditorModelResponse();
						this._handleProductLoadResponse();
						this.handleOptionConfiguratorResponse();
						this.addEventListener('selection-changed', this._handleOptionSelection);
					}
				}, {
					key: 'add',
					value: function add() {
						this.validationMessages = [];
						if (this._validateMaximumOptionsNotExceeded()) {
							this.validationMessages = ["Too many options selected."];
							return;
						}
						this._addSelected();
						this._routeToConfig();
					}
				}, {
					key: 'cancel',
					value: function cancel() {
						for (var key in this.selectedOptions) {
							this.currentProductModel.optionsById[key].added = false;
							this.currentProductModel.optionsById[key].selected = false;
						}
						this._routeToConfig();
					}
				}, {
					key: '_handleLineEditorModelResponse',
					value: function _handleLineEditorModelResponse() {
						this.$.lineEditorRead.addEventListener('line-editor-model-changed', function (e) {
							this.$.productLoad.quote = this.$.optionConfigure.quote = e.detail.value.quote;
							this.headerSubtitle = e.detail.value.headerSubtitle;
							this.currencyIsoCode = e.detail.value.quote.record.CurrencyIsoCode || null;
						}.bind(this));
					}
				}, {
					key: '_handleProductLoadResponse',
					value: function _handleProductLoadResponse() {
						this.$.productLoad.addEventListener('product-load-model-changed', function (e) {
							var products = e.detail && e.detail.value ? e.detail.value.configuredProducts : null,
							    idx = this.ctx.params && this.ctx.params.productIdx ? this.ctx.params.productIdx : 0,
							    product = products ? products[idx] : e.detail.value;
							if (!product.rulesProcessed) {
								var processor = new RuleProcessor(product.configuration, product);
								processor.initProductRulesActions(this.optionId === '' ? 'load' : 'reconfigure');
							}
							this.topLevelBundle = product;
							if (this.optionId !== '') return this.$.optionConfigure.product = product;

							this.setCurrentProductModel(product);
						}.bind(this));
					}
				}, {
					key: 'handleOptionConfiguratorResponse',
					value: function handleOptionConfiguratorResponse() {
						this.$.optionConfigure.addEventListener('option-configurator-response-changed', function (e) {
							this.setCurrentProductModel(e.detail.value.configuredProducts[0]);
						}.bind(this));
					}
				}, {
					key: 'setCurrentProductModel',
					value: function setCurrentProductModel(product) {
						this.currentProductModel = new ProductViewModel(this.$.productLoad.quote.record.Id, product, this.app.org.prefix, this.currencyIsoCode, this.ctx.params.fId);
						this.feature = this.currentProductModel.getFeature(this.ctx.params.fId);
						if (this.feature === undefined) {
							this.validationMessages = ["Attempted to access a feature not associated with this bundle."];
							return;
						}
						this.selectedOptions = {};
						this.optionConstraintsHandler = new OptionConstraintsHandler(this.currentProductModel.product, this.currentProductModel.prefix);
						this.$.optionTable.fieldSetName = "OptionLookup";
						this.$.optionTable.fieldSet = this.currentProductModel.product.optionFieldSets[this.$.optionTable.fieldSetName];
						this.$.optionTable.displayDelete = false;
						this._createConstraintsHoverMessages();
						this._fireSelectionStatesForOtherFeatures();
					}
				}, {
					key: '_handleOptionSelection',
					value: function _handleOptionSelection(e) {
						if (e && e.detail) {
							this._toggleOptionSelection(e.detail.Id, e.detail.selected);
							this._handleOptionConstraints(e.detail.Id, e.detail.selected);
						}
					}
				}, {
					key: '_fireSelectionStatesForOtherFeatures',
					value: function _fireSelectionStatesForOtherFeatures() {
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = Object.keys(this.currentProductModel.featureIdsWithSelectionMethodClick)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var featureId = _step.value;
								var _iteratorNormalCompletion2 = true;
								var _didIteratorError2 = false;
								var _iteratorError2 = undefined;

								try {
									for (var _iterator2 = this.currentProductModel.optionsByFeatureId[featureId][Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
										var option = _step2.value;

										this._handleOptionConstraints(option.record.Id, option.selected);
									}
								} catch (err) {
									_didIteratorError2 = true;
									_iteratorError2 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion2 && _iterator2.return) {
											_iterator2.return();
										}
									} finally {
										if (_didIteratorError2) {
											throw _iteratorError2;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}
					}
				}, {
					key: '_toggleOptionSelection',
					value: function _toggleOptionSelection(optionId, selected) {
						if (!selected && this.selectedOptions[optionId]) {
							delete this.selectedOptions[optionId];
						} else if (selected && !this.selectedOptions[optionId]) {
							this.selectedOptions[optionId] = this.currentProductModel.getOption(optionId);
						}
					}
				}, {
					key: '_handleOptionConstraints',
					value: function _handleOptionConstraints(optionId, selected) {
						var _this2 = this;

						var addedOption = this.feature._transient_.optionConfigurations.find(function (option) {
							return option.record.Id === optionId;
						}),
						    previouslySelected = addedOption && addedOption.selected,
						    disabledStateChanges = this.optionConstraintsHandler.handleOptionConstraints(optionId, selected || previouslySelected);

						if (disabledStateChanges) {
							disabledStateChanges.forEach(function (change) {
								_this2.set('disabledStateMap.' + change.optionId, change.disabledState);
							});
						}
					}
				}, {
					key: '_addSelected',
					value: function _addSelected() {
						var _this3 = this;

						var _loop = function _loop(key) {
							var productOption = _this3.currentProductModel.optionsById[key];
							var clonedOption = JSON.parse(JSON.stringify(_this3.currentProductModel.optionsById[key]));
							_this3.currentProductModel.initOptionActions(clonedOption, true);

							clonedOption.addedManually = true;
							clonedOption.index = _this3.feature._transient_.optionConfigurations.filter(function (option) {
								return option.record.Id === key;
							}).length;
							clonedOption.configured = false;
							_this3.currentProductModel.setOptionDisabledData(clonedOption);
							_this3.push('feature._transient_.optionConfigurations', clonedOption);
							_this3.currentProductModel.optionsById[key].added = true;
							_this3.currentProductModel.optionsById[key].selected = true;
						};

						for (var key in this.selectedOptions) {
							_loop(key);
						}
					}
				}, {
					key: '_validateMaximumOptionsNotExceeded',
					value: function _validateMaximumOptionsNotExceeded() {
						return this.feature._transient_.optionConfigurations.length + Object.keys(this.selectedOptions).length > this.feature.record[this.prefix + 'MaxOptionCount__c'];
					}
				}, {
					key: '_routeToConfig',
					value: function _routeToConfig() {
						this.selectedOptions = {};
						var queryParams = this._createQueryParams();
						this.nav('#', queryParams, ['product', 'pc'], false);
					}
				}, {
					key: '_createQueryParams',
					value: function _createQueryParams() {
						var queryParams = { qId: this.currentProductModel ? this.currentProductModel.qId : this.ctx.params.qId },
						    params = this.ctx.params;

						if (!params) return queryParams;

						if (params.pId) queryParams.pId = params.pId;
						if (params.oId) {
							queryParams.oId = params.oId;
							queryParams.origin = 'ol';
						}
						if (params.lineKey) queryParams.lineKey = params.lineKey;
						if (params.redirectUrl) queryParams.redirectUrl = params.redirectUrl;
						if (params.productIdx) queryParams.productIdx = params.productIdx;
						if (params.tab) queryParams.tab = params.tab;
						if (params.groupKey) queryParams.groupKey = params.groupKey;
						if (params.aId) queryParams.aId = params.aId;

						return queryParams;
					}
				}, {
					key: 'preLoadObjects',
					value: function preLoadObjects() {
						this.optionLookupObjects = [this.prefix + 'ProductOption__c', this.prefix + 'QuoteLine__c'];
					}
				}, {
					key: 'getProductIds',
					value: function getProductIds() {
						return this.ctx.params ? this.ctx.params.pId || '' : '';
					}
				}, {
					key: 'getLineKey',
					value: function getLineKey() {
						return this.ctx.params ? parseInt(this.ctx.params.lineKey || -1) : -1;
					}
				}, {
					key: 'getIgnoreCache',
					value: function getIgnoreCache() {
						return this.ctx.params ? this.ctx.params.ignoreCache === 'true' : false;
					}
				}, {
					key: 'setHasUpgradeOptions',
					value: function setHasUpgradeOptions() {
						return this.currentProductModel.getHasUpgradeOptions(this.feature);
					}
				}, {
					key: '_createConstraintsHoverMessages',
					value: function _createConstraintsHoverMessages() {
						this.currentProductModel.createConstraintsHoverMessages(this.optionConstraintsHandler.optionConstraints.byConstrained);
					}
				}, {
					key: 'getOptionId',
					value: function getOptionId() {
						return this.ctx.params ? this.ctx.params.oId || '' : '';
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.validationMessages = new ErrorFormatter(this.errors).truncate();
						this.spinner = false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}, {
					key: 'prefix',
					get: function get() {
						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}]);

				return OptionLookup;
			}(Page));

			_export('OptionLookup', OptionLookup);

			Polymer(OptionLookup);
		}
	};
});

'use strict';

System.register('products/config/routes/sb-product-config/ProductConfig.js', ['../../../../common/core/Page.js', '../../../resources/rules/RuleProcessor.js', 'products/resources/reconfigure/ProductReconfigurer.js', 'products/resources/optionUpgrades/OptionUpgradeHandler.js', '../../../resources/model/nestedOptions/NestedOptionsModel.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, RuleProcessor, ProductReconfigurer, OptionUpgradeHandler, NestedOptionsModel, ErrorFormatter, _slicedToArray, _createClass, ProductConfig;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_resourcesRulesRuleProcessorJs) {
			RuleProcessor = _resourcesRulesRuleProcessorJs.RuleProcessor;
		}, function (_productsResourcesReconfigureProductReconfigurerJs) {
			ProductReconfigurer = _productsResourcesReconfigureProductReconfigurerJs.ProductReconfigurer;
		}, function (_productsResourcesOptionUpgradesOptionUpgradeHandlerJs) {
			OptionUpgradeHandler = _productsResourcesOptionUpgradesOptionUpgradeHandlerJs.OptionUpgradeHandler;
		}, function (_resourcesModelNestedOptionsNestedOptionsModelJs) {
			NestedOptionsModel = _resourcesModelNestedOptionsNestedOptionsModelJs.NestedOptionsModel;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_slicedToArray = function () {
				function sliceIterator(arr, i) {
					var _arr = [];
					var _n = true;
					var _d = false;
					var _e = undefined;

					try {
						for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
							_arr.push(_s.value);

							if (i && _arr.length === i) break;
						}
					} catch (err) {
						_d = true;
						_e = err;
					} finally {
						try {
							if (!_n && _i["return"]) _i["return"]();
						} finally {
							if (_d) throw _e;
						}
					}

					return _arr;
				}

				return function (arr, i) {
					if (Array.isArray(arr)) {
						return arr;
					} else if (Symbol.iterator in Object(arr)) {
						return sliceIterator(arr, i);
					} else {
						throw new TypeError("Invalid attempt to destructure non-iterable instance");
					}
				};
			}();

			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductConfig', ProductConfig = function (_Page) {
				_inherits(ProductConfig, _Page);

				function ProductConfig() {
					_classCallCheck(this, ProductConfig);

					return _possibleConstructorReturn(this, (ProductConfig.__proto__ || Object.getPrototypeOf(ProductConfig)).apply(this, arguments));
				}

				_createClass(ProductConfig, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-config';
						this.properties = Polymer.Base.extend({
							lineEditorModel: Object,
							productSelectionModel: Object,
							topLevelBundle: Object,
							currentTarget: Object,
							productIndex: Number,
							headerSubtitle: String,
							hasMultipleBundles: Boolean,
							isClassic: Boolean,
							searchValuesByFilter: Object,
							searchFilters: Array,
							validationMessages: Array,
							headerTitle: String,
							isMobileAndHasMultipleBundles: {
								type: Boolean,
								value: false,
								computed: "_setIsMobileAndHasMultipleBundles(viewport, hasMultipleBundles)"
							},
							productIds: {
								type: String,
								computed: 'getProductIds(ctx)'
							},
							lineKey: {
								type: Number,
								computed: 'getLineKey(ctx)'
							},
							groupKey: {
								type: Number,
								computed: 'getGroupKey(ctx)'
							},
							ignoreCache: {
								type: Boolean,
								computed: 'getIgnoreCache(ctx)'
							},
							prefix: {
								type: String,
								computed: 'getPrefix(app.org)'
							},
							optionId: {
								type: String,
								computed: 'getOptionId(ctx)'
							},
							spinner: {
								type: Boolean,
								value: false
							},
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							preventPreLoadObjects: {
								type: Boolean,
								value: false
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.handleLineEditorModelResponse();
						this.handleProductLoadResponse();
						this.handleOptionSaveResponse();
						this.handleProductRulesInvokerResponse();
						this.handleCustomActionsCollapsed();
						this.handleOnAddOptionClick();
						this.handleBundlePanelClick();
						this.handleChangeEvents();
						this.handleBundleNameChange();
						this.handleExternalConfiguration();
						this.handleConfigureOptionEvent();
						this.handleOptionConfiguratorResponse();
					}
				}, {
					key: 'attached',
					value: function attached() {
						if (!this.preventPreLoadObjects) this.preLoadObjects();
					}
				}, {
					key: 'handleLineEditorModelResponse',
					value: function handleLineEditorModelResponse() {
						this.$.lineEditorRead.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
							this.isoCode = this.lineEditorModel.quote.record.CurrencyIsoCode || null;
							this.$.productLoad.quote = this.$.optionSave.quote = this.$.productRulesInvoke.quote = this.$.optionConfigure.quote = e.detail.value.quote;
							this.headerSubtitle = e.detail.value.headerSubtitle;
						}.bind(this));
					}
				}, {
					key: 'handleProductLoadResponse',
					value: function handleProductLoadResponse() {
						this.$.productLoad.addEventListener('product-load-model-changed', function (e) {
							var model = this.handleProductConfigurationInitializer(e.detail.value);

							if (model.returnToQuote) {
								this.$.productAlerts.displayContinueButton = false;
								this.$.productAlerts.cancelCB = function () {
									return this.nav('#', { qId: this.lineEditorModel.quote.record.Id }, ['quote', 'le'], false);
								}.bind(this);
								return this.$.productAlerts.alerts = [model.returnToQuote];
							}

							if (this.optionId !== '') return this.setOptionConfigurationDetails(model);
							if (this.loadedModelIsReconfigure(model)) new ProductReconfigurer(model.configuredProducts[0], this.lineEditorModel.quote.record[this.prefix + 'Type__c']).reconfigure();
							var _iteratorNormalCompletion = true;
							var _didIteratorError = false;
							var _iteratorError = undefined;

							try {
								for (var _iterator = model.configuredProducts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
									var prod = _step.value;

									if (!prod.rulesProcessed) {
										var processor = new RuleProcessor(prod.configuration, prod);
										processor.initProductRulesActions(true);
									}
									if (prod.configuration != null && prod.nestedOptionModel == null) {
										prod.nestedOptionModel = new NestedOptionsModel(prod.configuration);
									}
									prod.configuration.configuredOptions = prod.nestedOptionModel.getConfiguredOptionsFromPath();
								}
							} catch (err) {
								_didIteratorError = true;
								_iteratorError = err;
							} finally {
								try {
									if (!_iteratorNormalCompletion && _iterator.return) {
										_iterator.return();
									}
								} finally {
									if (_didIteratorError) {
										throw _iteratorError;
									}
								}
							}

							this.productSelectionModel = undefined;
							this.productSelectionModel = model;
							this.hasMultipleBundles = this.productSelectionModel.configuredProducts.length > 1;
							this.isClassic = this.hasMultipleBundles && this.lineEditorModel.settings.multipleBundlesView === 'Classic';
							this.currentTarget = this.productSelectionModel;

							for (var i = 0; i < this.productSelectionModel.configuredProducts.length; i++) {
								this.productIndex = i;
							}this.productIndex = this.getProductIndex();

							this.searchFilters = this.productSelectionModel.configuredProducts[0].optionFieldSets.SearchFilters;
							var filterMap = {};
							if (this.searchFilters && !this.productSelectionModel.searchValuesByFilter) {
								for (var _i = 0, numFilters = this.searchFilters.length; _i < numFilters; _i++) {
									filterMap[this.searchFilters[_i]] = null;
								}

								this.productSelectionModel.searchValuesByFilter = filterMap;
							}
							this.$.bundles.searchValuesByFilter = this.productSelectionModel.searchValuesByFilter;
							this.$.bundles.searchFilters = this.searchFilters;

							this.checkForExternalConfiguration();
						}.bind(this));
					}
				}, {
					key: 'handleOptionSaveResponse',
					value: function handleOptionSaveResponse() {
						this.$.optionSave.addEventListener('psm-response-changed', function (e) {
							this.validationMessages = null;
							var response = e.detail.value;
							var ruleProcessor = new RuleProcessor(response);
							ruleProcessor.initValidationMessages();
							this.validationMessages = ruleProcessor.getValidationMessages();
							if (this.validationMessages.length > 0) {
								this.spinner = false;
								return;
							}

							if (response.guidedMessages && response.guidedMessages.length > 0) {
								this.$.productAlerts.cancelCB = null;
								this.$.productAlerts.displayContinueButton = true;
								this.$.productAlerts.continueCB = this.afterSaveNavigate.bind(this, response, ruleProcessor);
								this.spinner = false;
								this.$.productAlerts.alerts = response.guidedMessages;
								return;
							}

							this.afterSaveNavigate(response, ruleProcessor);
						}.bind(this));
					}
				}, {
					key: 'afterSaveNavigate',
					value: function afterSaveNavigate(response, ruleProcessor) {
						var optionId = 'none',
						    tabIndex = void 0;
						if (this.optionId !== '') {
							var latestData = this.topLevelBundle.nestedOptionModel.getLastFromPath();
							tabIndex = latestData.tabIndex;
							optionId = this.topLevelBundle.nestedOptionModel.popFromPathAndGetNextSKU() || 'none';
							ruleProcessor.initDescendantLevelRules(this.topLevelBundle);
						}
						var redirectUrl = this.ctx.params ? this.ctx.params.redirectUrl : null,
						    pathParams = this.createPathParams(redirectUrl),
						    queryParams = void 0;

						if (this.optionId !== '') queryParams = this.createQueryParams({ oId: optionId, ignoreCache: false }, tabIndex);else {
							queryParams = { qId: response.quote.record.Id };
							if (this.ctx.params.groupKey != null) queryParams.groupKey = this.ctx.params.groupKey;
							if (this.ctx.params.aId && pathParams[0] !== 'quote') queryParams.aId = this.ctx.params.aId;
						}

						if (response.quote) this.lineEditorModel.quote = response.quote;
						this.nav('#', queryParams, pathParams, false);
					}
				}, {
					key: 'handleProductRulesInvokerResponse',
					value: function handleProductRulesInvokerResponse() {
						this.$.productRulesInvoke.addEventListener('config-response-changed', function (e) {
							var response = e.detail.value;
							var productIndex = this.currentTarget.configuredProducts.findIndex(function (product) {
								var productKey = product.productKey || product.record.Id;
								return productKey === response.configuredProductKey;
							});
							var currentProduct = this.currentTarget.configuredProducts[productIndex];
							var ruleProcessor = new RuleProcessor(response, currentProduct);
							ruleProcessor.init();
							this.validationMessages = ruleProcessor.getValidationMessages();
							response.productRulesActions = ruleProcessor.getProductRulesActions();
							response.optionDataByOptionIds = ruleProcessor.getOptionDataByOptionIds();

							if (currentProduct.configuration !== undefined && currentProduct.configuration.configurationData !== undefined) response.configurationData = currentProduct.configuration.configurationData;
							this.$.bundles.set('configuredProducts.' + productIndex + '.configuration', response);
						}.bind(this));
					}
				}, {
					key: 'handleCustomActionsCollapsed',
					value: function handleCustomActionsCollapsed() {
						this.changeAllActions(this.$.customActions.buttonsCollapsed);
						this.$.customActions.addEventListener('buttons-collapsed-changed', function (e) {
							var val = e.detail.value;
							this.changeAllActions(val);
						}.bind(this));
					}
				}, {
					key: 'handleOnAddOptionClick',
					value: function handleOnAddOptionClick() {
						var tabIndex = void 0;

						this.addEventListener('selected-page-changed', function (e) {
							tabIndex = e.detail;
						}.bind(this));

						this.addEventListener('add-option-clicked', function (e) {
							var query = this.optionId === '' ? e.detail : Object.assign({}, e.detail, { oId: this.optionId });
							var index = void 0;
							if (query.path && this.optionId === '') index = this.getProductIndex(e.detail.pId);
							var queryParams = this.createQueryParams(query, tabIndex),
							    path = query.path != null ? query.path : ['product', 'ol'];
							if (index) queryParams.productIdx = index;
							this.nav('#', queryParams, path, false);
						}.bind(this));
					}
				}, {
					key: 'handleBundlePanelClick',
					value: function handleBundlePanelClick() {
						this.addEventListener('bundle-panel-clicked', function (e) {
							var queryParams = this.createQueryParams(this.ctx.params);
							queryParams.productIdx = e.detail;
							queryParams.open = 1;
							if (queryParams.tab) delete queryParams.tab;
							this.nav('#', queryParams, ['product', 'pc'], false);
						}.bind(this));
					}
				}, {
					key: 'handleChangeEvents',
					value: function handleChangeEvents() {
						this.addEventListener('selection-changed', function (e) {
							this.handleChangeEvent(e, 'On Selection');
						}.bind(this));

						this.addEventListener('sb-quantity-changed', function (e) {
							this.handleChangeEvent(e, 'On Quantity Change');
						}.bind(this));

						this.addEventListener('sb-config-attribute-changed', function (e) {
							this.handleChangeEvent(e, 'On Attribute Change');
						}.bind(this));

						this.addEventListener('sb-option-deleted', function (e) {
							var prod = this.topLevelBundle || this.productSelectionModel.configuredProducts[this.productIndex];
							if (prod.nestedOptionModel) prod.nestedOptionModel.remove(e.detail);
						}.bind(this));
					}
				}, {
					key: 'handleBundleNameChange',
					value: function handleBundleNameChange() {
						if (!this.isMobileViewport()) {
							this.headerTitle = 'Configure Products';
							return;
						}

						this.addEventListener('bundle-name-changed', function (e) {
							this.headerTitle = e.detail.name;
						}.bind(this));
					}
				}, {
					key: 'handleExternalConfiguration',
					value: function handleExternalConfiguration() {
						this.addEventListener('sb-close-popup', function (e) {
							if (this.productSelectionModel.configuredProducts.length !== 1) return;

							if (!e.detail.redirect || !e.detail.redirect.auto) return;

							if (e.detail.redirect.save) this.save();else this.cancel();
						});
					}
				}, {
					key: 'handleProductConfigurationInitializer',
					value: function handleProductConfigurationInitializer(model) {
						if (this.isReconfigure(model)) return model;
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = model.configuredProducts[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var c_product = _step2.value;

								var configuration = c_product.configuration;var _iteratorNormalCompletion3 = true;
								var _didIteratorError3 = false;
								var _iteratorError3 = undefined;

								try {
									for (var _iterator3 = configuration.optionConfigurations[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
										var o_config = _step3.value;

										var optionId = o_config.optionData.Id;var _iteratorNormalCompletion4 = true;
										var _didIteratorError4 = false;
										var _iteratorError4 = undefined;

										try {
											for (var _iterator4 = c_product.options[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
												var option = _step4.value;

												if (option.record.Id === optionId) for (var data in o_config.optionData) {
													if (option.record[data] && option.record[data] != o_config.optionData[data]) option.record[data] = o_config.optionData[data];
												}
											}
										} catch (err) {
											_didIteratorError4 = true;
											_iteratorError4 = err;
										} finally {
											try {
												if (!_iteratorNormalCompletion4 && _iterator4.return) {
													_iterator4.return();
												}
											} finally {
												if (_didIteratorError4) {
													throw _iteratorError4;
												}
											}
										}
									}
								} catch (err) {
									_didIteratorError3 = true;
									_iteratorError3 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion3 && _iterator3.return) {
											_iterator3.return();
										}
									} finally {
										if (_didIteratorError3) {
											throw _iteratorError3;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						return model;
					}
				}, {
					key: 'save',
					value: function save() {
						if (this.configurationAttributesValid() === false) {
							this.validationMessages = [this.i18n.l('Please review required configuration attributes') + this.getConfigurationAttributeMissingFeaturesMessage()];
							return;
						}

						this.validationMessages = null;
						if (this.optionId !== '') {
							var configuredProduct = this.prepareProductForServer(this.currentTarget.configuredProducts[0]);
							if (this.validationMessages) return;
							this.spinner = true;
							this.$.optionSave.configuration = undefined;
							return this.$.optionSave.configuration = configuredProduct.configuration;
						}

						var addedProducts = this.isReconfigure(this.productSelectionModel) ? this.getConfiguredProductsToSave() : this.getSelectedProductsToSave();

						if (this.validationMessages) return;
						this.spinner = true;
						this.$.optionSave.products = undefined;
						this.$.optionSave.products = addedProducts;
					}
				}, {
					key: 'cancel',
					value: function cancel() {
						this.spinner = true;
						if (this.optionId === '') return this.nav('#', { qId: this.lineEditorModel.quote.record.Id }, ['quote', 'le'], false);

						this.topLevelBundle.nestedOptionModel.cancel();
						var tabIndex = this.topLevelBundle.nestedOptionModel.getLastFromPath().tabIndex;
						var optionId = this.topLevelBundle.nestedOptionModel.popFromPathAndGetNextSKU();
						var queryParams = optionId ? this.createQueryParams({ oId: optionId, ignoreCache: false }, tabIndex) : this.createQueryParams({ qId: this.lineEditorModel.quote.record.Id }, tabIndex);
						this.nav('#', queryParams, ['product', 'pc'], false);
					}
				}, {
					key: 'getConfiguredProductsToSave',
					value: function getConfiguredProductsToSave() {
						var _this2 = this;

						var productsToSave = [];
						this.productSelectionModel.configuredProducts.forEach(function (product) {
							productsToSave.push(_this2.prepareProductForServer(product));
						});
						return productsToSave;
					}
				}, {
					key: 'getSelectedProductsToSave',
					value: function getSelectedProductsToSave() {
						var configuredProducts = this.productSelectionModel.configuredProducts;
						var configuredProductsById = {};

						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = configuredProducts[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var configuredProduct = _step5.value;

								var productToSave = this.prepareProductForServer(configuredProduct);
								var productId = configuredProduct.record.Id;
								var _configuredProducts = configuredProductsById[productId];
								if (!_configuredProducts) _configuredProducts = [];
								_configuredProducts.push(productToSave);
								configuredProductsById[productId] = _configuredProducts;
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}

						var selectedProducts = this.productSelectionModel.selectedProducts;
						var orderedSelectedProductIds = Object.keys(selectedProducts).sort(function (id1, id2) {
							return selectedProducts[id1].index - selectedProducts[id2].index;
						});

						var productsToSave = [];
						var _iteratorNormalCompletion6 = true;
						var _didIteratorError6 = false;
						var _iteratorError6 = undefined;

						try {
							for (var _iterator6 = orderedSelectedProductIds[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
								var selectedProductId = _step6.value;

								var selectedProduct = selectedProducts[selectedProductId];
								var _configuredProducts2 = configuredProductsById[selectedProductId];
								if (_configuredProducts2) productsToSave = productsToSave.concat(_configuredProducts2);else if (!selectedProduct.invalid) productsToSave.push(selectedProduct);
							}
						} catch (err) {
							_didIteratorError6 = true;
							_iteratorError6 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion6 && _iterator6.return) {
									_iterator6.return();
								}
							} finally {
								if (_didIteratorError6) {
									throw _iteratorError6;
								}
							}
						}

						return productsToSave;
					}
				}, {
					key: 'checkForExternalConfiguration',
					value: function checkForExternalConfiguration() {
						var product = this.productSelectionModel.configuredProducts[this.productIndex],
						    externalKey = this.prefix + 'ExternallyConfigurable__c',
						    externalURL = this.lineEditorModel.settings.externalConfiguratorUrl;

						if (product.record[externalKey] && !product.visitedExternal && !this.isClassic && externalURL !== null) {
							product.visitedExternal = true;
							this.$.customActions.handlePopup(externalURL, true);
						}
					}
				}, {
					key: 'handleChangeEvent',
					value: function handleChangeEvent(e, eventContext) {
						if (e && e.detail && e.detail.bundleId && e.detail.changed && e.detail.path) {
							var product = this.getProductById(e.detail.bundleId);
							this.handleApplyImmediatelyProductRules(product, e.detail, eventContext);
						}

						if (eventContext === 'On Quantity Change') {
							this.validationMessages = null;
							if (e.detail.invalidQuantity > 0) {
								var errorMessage = this.i18n.l('Exceeded maximum quantity available. Value has been reduced to {0}', [e.detail.validQuantity]);
								this.validationMessages = [{
									type: 'warning',
									msg: errorMessage
								}];
							}
						}
					}
				}, {
					key: 'handleApplyImmediatelyProductRules',
					value: function handleApplyImmediatelyProductRules(product, detail, eventContext) {
						if (!product || !this.isAppliedImmediately(product, detail, eventContext)) return;

						this.debounce('ApplyImmediatelyProductRules', function () {
							this.$.productRulesInvoke.product = undefined;
							this._updateProductConfigurationHiddenOptions(product);
							product = this.prepareProductForServer(product, true);
							this.$.productRulesInvoke.upgradeAssetId = product.upgradedAssetId || null;
							this.$.productRulesInvoke.product = product;
						}, 250);
					}
				}, {
					key: '_updateProductConfigurationHiddenOptions',
					value: function _updateProductConfigurationHiddenOptions(product) {
						var hiddenOptionIds = product.configuration.hiddenOptionIds || [];
						var _iteratorNormalCompletion7 = true;
						var _didIteratorError7 = false;
						var _iteratorError7 = undefined;

						try {
							for (var _iterator7 = product.options[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {
								var option = _step7.value;

								var optionIsHidden = option.hiddenByRule;
								var optionWasHiddenIndex = hiddenOptionIds.indexOf(option.record.Id);
								var optionWasHidden = optionWasHiddenIndex !== -1;

								if (optionIsHidden && !optionWasHidden) hiddenOptionIds.push(option.record.Id);

								if (!optionIsHidden && optionWasHidden) hiddenOptionIds.splice(optionWasHiddenIndex, 1);
							}
						} catch (err) {
							_didIteratorError7 = true;
							_iteratorError7 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion7 && _iterator7.return) {
									_iterator7.return();
								}
							} finally {
								if (_didIteratorError7) {
									throw _iteratorError7;
								}
							}
						}

						product.configuration.hiddenOptionIds = hiddenOptionIds;
					}
				}, {
					key: 'isAppliedImmediately',
					value: function isAppliedImmediately(product, detail, eventContext) {
						var appliedImmediately = this.prefix + 'AppliedImmediately__c',
						    context = this.prefix + 'AppliedImmediatelyContext__c',
						    item = void 0,
						    applyImmediatelyContext = void 0;

						if (eventContext === 'On Attribute Change') {
							item = product.configurationAttributes.find(function (attribute) {
								return attribute.myId === detail.Id;
							});
							return item.appliedImmediately;
						} else {
							item = product.options.find(function (option) {
								return option.record.Id === detail.Id;
							});
							applyImmediatelyContext = item.record[context];
							if (applyImmediatelyContext === 'Always' || applyImmediatelyContext === eventContext || applyImmediatelyContext === undefined && eventContext === 'On Selection') return item.record[appliedImmediately];
						}

						return false;
					}
				}, {
					key: 'handleConfigureOptionEvent',
					value: function handleConfigureOptionEvent() {
						this.addEventListener('configure-option-tapped', function (e) {
							var product = this.prepareProductForNestedConfigure(e.detail);
							var queryParams = this.createQueryParams({ oId: product.nestedOptionModel.getLastFromPath().optionalSKU, ignoreCache: false });
							this.nav('#', queryParams, ['product', 'pc'], false);
						}.bind(this));
					}
				}, {
					key: 'prepareProductForNestedConfigure',
					value: function prepareProductForNestedConfigure(nested) {
						var product = void 0;
						if (this.optionId === '') {
							var index = this.productSelectionModel.currentIndex = this.getProductIndex(nested.productId);
							product = this.productSelectionModel.configuredProducts[index];
						} else {
							product = this.topLevelBundle;
						}
						product.nestedOptionModel = product.nestedOptionModel || new NestedOptionsModel();
						product.nestedOptionModel.addToPath(nested.optionId, nested.optionalSKU, nested.addedIndex, nested.tabIndex);
						return product;
					}
				}, {
					key: 'handleOptionConfiguratorResponse',
					value: function handleOptionConfiguratorResponse() {
						this.$.optionConfigure.addEventListener('option-configurator-response-changed', function (e) {
							this.currentTarget = e.detail.value;
							var nestedProduct = this.currentTarget.configuredProducts[0];

							if (this.ctx.params.oId && nestedProduct.options.length == 0 && nestedProduct.configurationAttributes.length == 0 && !this.hasDynamicFeature(nestedProduct)) {
								var tabIndex = this.topLevelBundle.nestedOptionModel.getLastFromPath().tabIndex;
								var optionId = this.topLevelBundle.nestedOptionModel.popFromPathAndGetNextSKU();
								var queryParams = optionId ? this.createQueryParams({ oId: optionId, ignoreCache: false }, tabIndex) : this.createQueryParams({ qId: this.lineEditorModel.quote.record.Id }, tabIndex);

								this.$.productAlerts.displayContinueButton = false;
								this.$.productAlerts.cancelCB = function () {
									return this.nav('#', queryParams, ['product', 'pc'], false);
								}.bind(this);
								return this.$.productAlerts.alerts = [this.i18n.l('This product has no options and configurations. To add this product, add options/configurations or change Configuration Type to not be Required.')];
							} else {
								if (!nestedProduct.rulesProcessed) {
									var processor = new RuleProcessor(nestedProduct.configuration, nestedProduct);
									processor.initProductRulesActions(true);
								}

								if (this.topLevelBundle.nestedOptionModel) {
									if (this.topLevelBundle.nestedOptionModel.descendLevel) {
										var configuration = this.topLevelBundle.nestedOptionModel.configure(nestedProduct.configuration);
										new ProductReconfigurer(nestedProduct).reconfigure(configuration);
										if (this.ctx.params.tab) this.ctx.params.tab = 0;
									} else {
										nestedProduct.configuration = this.topLevelBundle.nestedOptionModel.getCurrentLevel();
										nestedProduct.configuration.configuredOptions = this.topLevelBundle.nestedOptionModel.getConfiguredOptionsFromPath();
									}
								}
								var filters = this.topLevelBundle.optionFieldSets.SearchFilters;
								var searchValuesByFilter = {};
								var _iteratorNormalCompletion8 = true;
								var _didIteratorError8 = false;
								var _iteratorError8 = undefined;

								try {
									for (var _iterator8 = filters[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {
										var filter = _step8.value;

										searchValuesByFilter[filter] = null;
									}
								} catch (err) {
									_didIteratorError8 = true;
									_iteratorError8 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion8 && _iterator8.return) {
											_iterator8.return();
										}
									} finally {
										if (_didIteratorError8) {
											throw _iteratorError8;
										}
									}
								}

								this.productIndex = 0;
								this.$.bundles.searchValuesByFilter = searchValuesByFilter;
								this.$.bundles.searchFilters = filters;
								this.$.bundles.set('configuredProducts', this.currentTarget.configuredProducts);
							}
						}.bind(this));
					}
				}, {
					key: 'getProductById',
					value: function getProductById(id) {
						return this.currentTarget.configuredProducts.find(function (product) {
							var productId = product.productKey || product.record.Id;
							return productId === id;
						});
					}
				}, {
					key: 'getProductIndex',
					value: function getProductIndex(id) {
						if (id) {
							for (var i = 0; i < this.productSelectionModel.configuredProducts.length; i++) {
								if (this.productSelectionModel.configuredProducts[i].record.Id === id) return i;
							}
						}

						if (!this.ctx.params || !this.ctx.params.productIdx) return 0;

						var productIdx = +this.ctx.params.productIdx;
						if (Number.isNaN(productIdx) || productIdx < 0 || productIdx >= this.currentTarget.configuredProducts.length) return 0;

						return productIdx;
					}
				}, {
					key: 'hasDynamicFeature',
					value: function hasDynamicFeature(product) {
						var _iteratorNormalCompletion9 = true;
						var _didIteratorError9 = false;
						var _iteratorError9 = undefined;

						try {
							for (var _iterator9 = product.features[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {
								var feature = _step9.value;

								if (feature.record[this.prefix + 'OptionSelectionMethod__c'] === 'Dynamic') return true;
							}
						} catch (err) {
							_didIteratorError9 = true;
							_iteratorError9 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion9 && _iterator9.return) {
									_iterator9.return();
								}
							} finally {
								if (_didIteratorError9) {
									throw _iteratorError9;
								}
							}
						}

						return false;
					}
				}, {
					key: 'changeAllActions',
					value: function changeAllActions(buttonsCollapsed) {
						if (buttonsCollapsed) this.$$('#allActions').classList.add("actionsCollapsed");else this.$$('#allActions').classList.remove("actionsCollapsed");
					}
				}, {
					key: 'prepareProductForServer',
					value: function prepareProductForServer(configuredProduct, applyImmediately) {
						var minimalProduct = { record: {} },
						    nestedOptionModel = this.topLevelBundle ? this.topLevelBundle.nestedOptionModel : configuredProduct.nestedOptionModel;
						minimalProduct.upgradedAssetId = configuredProduct.upgradedAssetId;
						var selectedProducts = this.getSelectedOptions(configuredProduct, applyImmediately, nestedOptionModel);
						minimalProduct.configuration = nestedOptionModel.save(selectedProducts, applyImmediately);
						minimalProduct.configuration.configurationData = configuredProduct.configuration.configurationData;
						minimalProduct.configuration.configuredProductId = minimalProduct.record.Id = configuredProduct.record.Id;
						return minimalProduct;
					}
				}, {
					key: 'getSelectedOptions',
					value: function getSelectedOptions(configuredProduct, skipValidations, nestedOptionModel) {
						var selectedOptionList = [];
						var _iteratorNormalCompletion10 = true;
						var _didIteratorError10 = false;
						var _iteratorError10 = undefined;

						try {
							for (var _iterator10 = configuredProduct.features[Symbol.iterator](), _step10; !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {
								var feature = _step10.value;
								var _iteratorNormalCompletion11 = true;
								var _didIteratorError11 = false;
								var _iteratorError11 = undefined;

								try {
									for (var _iterator11 = feature._transient_.optionConfigurations.entries()[Symbol.iterator](), _step11; !(_iteratorNormalCompletion11 = (_step11 = _iterator11.next()).done); _iteratorNormalCompletion11 = true) {
										var _step11$value = _slicedToArray(_step11.value, 2),
										    index = _step11$value[0],
										    option = _step11$value[1];

										if (option.selected) {
											var product = this.optionId ? this.topLevelBundle : configuredProduct;
											if (!skipValidations && option.configurationRequired && option.configured !== true) this.validationMessages = [this.i18n.l('Some or all options require further configuration. Look for configuration icon next to options that must be configured.')];
											if (option.isUpgrade) {
												var optionUpgradeHandler = new OptionUpgradeHandler(this.prefix, configuredProduct.options, option);
												optionUpgradeHandler.setUpgradedAssetId();
											}
											var clonedOption = JSON.parse(JSON.stringify(option));
											this.buildOptionForLineEditor(clonedOption, selectedOptionList);
										} else if (nestedOptionModel) {
											nestedOptionModel.remove(option);
										}
									}
								} catch (err) {
									_didIteratorError11 = true;
									_iteratorError11 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion11 && _iterator11.return) {
											_iterator11.return();
										}
									} finally {
										if (_didIteratorError11) {
											throw _iteratorError11;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError10 = true;
							_iteratorError10 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion10 && _iterator10.return) {
									_iterator10.return();
								}
							} finally {
								if (_didIteratorError10) {
									throw _iteratorError10;
								}
							}
						}

						return selectedOptionList;
					}
				}, {
					key: 'buildOptionForLineEditor',
					value: function buildOptionForLineEditor(clonedOption, array) {
						clonedOption.optionConfigurations = clonedOption.optionConfigurations || [];
						clonedOption.optionId = clonedOption.record.Id;
						clonedOption.optionData = clonedOption.record;
						if (clonedOption.configurationData === undefined) clonedOption.configurationData = {};
						clonedOption.isDynamicOption = clonedOption.isDynamicOption || clonedOption.isUpgrade;
						delete clonedOption.record;
						array.push(clonedOption);
					}
				}, {
					key: 'createQueryParams',
					value: function createQueryParams(queryParams, tabIndex) {
						var params = this.ctx.params;
						if (!params) return queryParams;

						if (params.pId) queryParams.pId = params.pId;else queryParams.pId = this.getAllProductIds();

						if (params.redirectUrl) queryParams.redirectUrl = params.redirectUrl;

						if (queryParams.oId) {
							queryParams.qId = params.qId;
							if (queryParams.oId === 'none') delete queryParams.oId;
						}

						if (params.productIdx) queryParams.productIdx = params.productIdx;else if (params.pId != null && typeof params.pId !== 'string' && params.pId.length > 1) queryParams.productIdx = 0;

						if (params.lineKey) queryParams.lineKey = params.lineKey;

						if (queryParams.ignoreCache == null && params.ignoreCache) queryParams.ignoreCache = false;

						if (tabIndex || tabIndex == 0) queryParams.tab = tabIndex;else if (params.tab) queryParams.tab = params.tab;

						if (params.groupKey) queryParams.groupKey = params.groupKey;

						if (params.aId) queryParams.aId = params.aId;

						return queryParams;
					}
				}, {
					key: 'getAllProductIds',
					value: function getAllProductIds() {
						var ids = [];
						var _iteratorNormalCompletion12 = true;
						var _didIteratorError12 = false;
						var _iteratorError12 = undefined;

						try {
							for (var _iterator12 = this.currentTarget.configuredProducts[Symbol.iterator](), _step12; !(_iteratorNormalCompletion12 = (_step12 = _iterator12.next()).done); _iteratorNormalCompletion12 = true) {
								var product = _step12.value;

								ids.push(product.record.Id);
							}
						} catch (err) {
							_didIteratorError12 = true;
							_iteratorError12 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion12 && _iterator12.return) {
									_iterator12.return();
								}
							} finally {
								if (_didIteratorError12) {
									throw _iteratorError12;
								}
							}
						}

						return ids.join();
					}
				}, {
					key: 'createPathParams',
					value: function createPathParams(redirectUrl) {
						if (this.optionId !== '') return ['product', 'pc'];
						return redirectUrl === 'ProductLookup' ? ['product', 'lookup'] : ['quote', 'le'];
					}
				}, {
					key: 'toggle',
					value: function toggle() {
						if (this.viewport.isMobile() && this.hasMultipleBundles) this.$.bundles.toggle();
					}
				}, {
					key: 'isMobileViewport',
					value: function isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: '_setIsMobileAndHasMultipleBundles',
					value: function _setIsMobileAndHasMultipleBundles(viewport, hasMultipleBundles) {
						return viewport.isMobile() && hasMultipleBundles;
					}
				}, {
					key: 'getRequiredConfigurationAttributes',
					value: function getRequiredConfigurationAttributes() {
						if (this.requiredConfigAttributes) return this.requiredConfigAttributes;

						var configuredProducts = this.currentTarget.configuredProducts,
						    requiredConfigAttributes = {};

						for (var i = 0, l = configuredProducts.length; i < l; i++) {
							var productConfigAttributes = configuredProducts[i].configurationAttributes;
							var requiredProductConfigAttributes = {};

							for (var j = 0, ll = productConfigAttributes.length; j < ll; j++) {
								var productConfigAttribute = productConfigAttributes[j];

								if (productConfigAttribute.required === true && Object.keys(requiredProductConfigAttributes).indexOf(productConfigAttribute.targetFieldName) === -1) requiredProductConfigAttributes[productConfigAttribute.targetFieldName] = productConfigAttribute;
							}
							requiredConfigAttributes[i] = requiredProductConfigAttributes;
						}
						this.requiredConfigAttributes = requiredConfigAttributes;
						return this.requiredConfigAttributes;
					}
				}, {
					key: 'configurationAttributesValid',
					value: function configurationAttributesValid() {
						var requiredConfigurations = this.getRequiredConfigurationAttributes();
						var missingAttributes = {};

						var configuredProducts = this.currentTarget.configuredProducts;
						for (var i = 0, l = configuredProducts.length; i < l; i++) {
							var productConfigData = configuredProducts[i].configuration.configurationData;
							var productRequiredConfigAttributes = requiredConfigurations[i];

							for (var attr in productRequiredConfigAttributes) {
								if (!this.requiredConfigurationAttributeValid(productConfigData[attr])) missingAttributes[attr] = true;
							}
						}
						this.requiredAttributeMissingValue = missingAttributes;
						return Object.keys(missingAttributes).length === 0;
					}
				}, {
					key: 'getConfigurationAttributeMissingFeaturesMessage',
					value: function getConfigurationAttributeMissingFeaturesMessage() {
						var featuresWithRequiredMissingAttributes = {};
						if (this.requiredAttributeMissingValue === undefined) this.getRequiredConfigurationAttributes();

						for (var attrs in this.requiredConfigAttributes) {
							for (var attr in this.requiredConfigAttributes[attrs]) {
								if (this.requiredAttributeMissingValue[attr] !== true) continue;
								var featureName = this.getFeatureNameFromId(this.requiredConfigAttributes[attrs][attr].featureId);
								if (featureName === undefined) continue;
								featuresWithRequiredMissingAttributes[featureName] = undefined;
							}
						}
						var featureNames = Object.keys(featuresWithRequiredMissingAttributes);
						if (featureNames.length === 0) return '';

						return ' in the following features: ' + featureNames;
					}
				}, {
					key: 'getFeatureNameFromId',
					value: function getFeatureNameFromId(id) {
						if (id === undefined) return;

						var _iteratorNormalCompletion13 = true;
						var _didIteratorError13 = false;
						var _iteratorError13 = undefined;

						try {
							for (var _iterator13 = this.currentTarget.configuredProducts[Symbol.iterator](), _step13; !(_iteratorNormalCompletion13 = (_step13 = _iterator13.next()).done); _iteratorNormalCompletion13 = true) {
								var prod = _step13.value;
								var _iteratorNormalCompletion14 = true;
								var _didIteratorError14 = false;
								var _iteratorError14 = undefined;

								try {
									for (var _iterator14 = prod.features[Symbol.iterator](), _step14; !(_iteratorNormalCompletion14 = (_step14 = _iterator14.next()).done); _iteratorNormalCompletion14 = true) {
										var feat = _step14.value;

										if (feat.record.Id === id) return feat.record.Name;
									}
								} catch (err) {
									_didIteratorError14 = true;
									_iteratorError14 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion14 && _iterator14.return) {
											_iterator14.return();
										}
									} finally {
										if (_didIteratorError14) {
											throw _iteratorError14;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError13 = true;
							_iteratorError13 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion13 && _iterator13.return) {
									_iterator13.return();
								}
							} finally {
								if (_didIteratorError13) {
									throw _iteratorError13;
								}
							}
						}
					}
				}, {
					key: 'requiredConfigurationAttributeValid',
					value: function requiredConfigurationAttributeValid(value) {
						return !this.isNil(value);
					}
				}, {
					key: 'search',
					value: function search() {
						this.$.bundles.toggleSearch();
					}
				}, {
					key: 'setOptionConfigurationDetails',
					value: function setOptionConfigurationDetails(model) {
						this.topLevelBundle = model.currentIndex ? model.configuredProducts[model.currentIndex] : model.configuredProducts[0];
						if (this.topLevelBundle.nestedOptionModel == null) {
							delete this.ctx.params.oId;
							return this.nav('#', this.ctx.params, ['product', 'pc'], false);
						}

						var config = this.topLevelBundle.nestedOptionModel.getCurrentLevel();
						if (this.topLevelBundle.nestedOptionModel && config && config.configured) this.$.optionConfigure.configuration = config;
						if (this.topLevelBundle.nestedOptionModel) this.$.optionConfigure.ignoreCache = this.ctx.params.origin === 'ol' ? false : this.topLevelBundle.nestedOptionModel.descendLevel;else this.$.optionConfigure.ignoreCache = true;
						this.$.optionConfigure.product = undefined;
						this.$.optionConfigure.product = this.topLevelBundle;
					}
				}, {
					key: 'preLoadObjects',
					value: function preLoadObjects() {
						this.configuratorObjects = [this.prefix + 'DiscountSchedule__c', this.prefix + 'ProductOption__c', this.prefix + 'QuoteLine__c'];
					}
				}, {
					key: 'getProductIds',
					value: function getProductIds() {
						return this.ctx.params ? this.ctx.params.pId || '' : '';
					}
				}, {
					key: 'getLineKey',
					value: function getLineKey() {
						return this.ctx.params ? parseInt(this.ctx.params.lineKey || -1) : -1;
					}
				}, {
					key: 'getGroupKey',
					value: function getGroupKey() {
						return this.ctx.params ? parseInt(this.ctx.params.groupKey || -1) : -1;
					}
				}, {
					key: 'getIgnoreCache',
					value: function getIgnoreCache() {
						return this.ctx.params ? this.ctx.params.ignoreCache === 'true' : false;
					}
				}, {
					key: 'getPrefix',
					value: function getPrefix() {
						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}, {
					key: 'getOptionId',
					value: function getOptionId() {
						return this.ctx.params ? this.ctx.params.oId || '' : '';
					}
				}, {
					key: 'isNil',
					value: function isNil(value) {
						return value == null || value === '';
					}
				}, {
					key: 'loadedModelIsReconfigure',
					value: function loadedModelIsReconfigure(model) {
						return !model.quote && model.configuredProducts.length == 1;
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.validationMessages = new ErrorFormatter(this.errors).truncate();
						this.spinner = false;
					}
				}, {
					key: 'isReconfigure',
					value: function isReconfigure(model) {
						return !model.selectedProducts;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}]);

				return ProductConfig;
			}(Page));

			_export('ProductConfig', ProductConfig);

			Polymer(ProductConfig);
		}
	};
});

'use strict';

System.register('products/prototype/notify/sb-one/one.js', [], function (_export, _context) {
	var _createClass, One;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('One', One = function () {
				function One() {
					_classCallCheck(this, One);
				}

				_createClass(One, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-one';
						this.properties = {
							string: {
								type: String
							},
							object: {
								type: Object,
								value: { string: '' }
							}
						};
					}
				}, {
					key: 'objectNotify',
					value: function objectNotify(e) {
						this.$.sbTwo.set(e.path, e.value);
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['objectNotify(object.*)'];
					}
				}]);

				return One;
			}());

			_export('One', One);

			Polymer(One);
		}
	};
});

'use strict';

System.register('products/prototype/notify/sb-three/three.js', [], function (_export, _context) {
	var _createClass, Three;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Three', Three = function () {
				function Three() {
					_classCallCheck(this, Three);
				}

				_createClass(Three, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-three';
						this.properties = {
							string: {
								type: String
							},
							object: {
								type: Object
							}
						};
					}
				}]);

				return Three;
			}());

			_export('Three', Three);

			Polymer(Three);
		}
	};
});

'use strict';

System.register('products/prototype/notify/sb-two/two.js', [], function (_export, _context) {
	var _createClass, Two;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Two', Two = function () {
				function Two() {
					_classCallCheck(this, Two);
				}

				_createClass(Two, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-two';
						this.properties = {
							string: {
								type: String
							},
							object: {
								type: Object
							}
						};
					}
				}]);

				return Two;
			}());

			_export('Two', Two);

			Polymer(Two);
		}
	};
});

'use strict';

System.register('products/resources/model/nestedOptions/NestedOptionsModel.js', ['products/resources/tree/ConfigTree.js'], function (_export, _context) {
	var ConfigTree, _createClass, NestedOptionsModel;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_productsResourcesTreeConfigTreeJs) {
			ConfigTree = _productsResourcesTreeConfigTreeJs.ConfigTree;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('NestedOptionsModel', NestedOptionsModel = function () {
				function NestedOptionsModel(configuration, isReconfigure) {
					_classCallCheck(this, NestedOptionsModel);

					this.init(configuration, isReconfigure);
				}

				_createClass(NestedOptionsModel, [{
					key: 'init',
					value: function init(configuration, isReconfigure) {
						this.path = [];
						this.descendLevel = false;
						this.configTree = new ConfigTree(configuration);
						this._setConfiguredOptionsObject(isReconfigure);
					}
				}, {
					key: 'configure',
					value: function configure(obj) {
						var data = this.getLastFromPath(),
						    parent = this._getPreviousLevel();
						obj.index = obj.index || data.index;
						obj.optionId = obj.optionId || data.optionId;
						this._appendSubtree(obj, parent, false);
						obj.staged = true;
						obj.configuredOptions = this.getConfiguredOptionsFromPath();
						this.descendLevel = false;
						return obj;
					}
				}, {
					key: 'save',
					value: function save() {
						var _this = this;

						var optionsToAdd = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
						var applyImmediately = arguments[1];

						var currentLevel = this.getCurrentLevel();
						optionsToAdd.forEach(function (option) {
							_this._appendSubtree(option, currentLevel, true);
						});
						if (!applyImmediately) this._setConfigured(currentLevel);
						return currentLevel;
					}
				}, {
					key: 'remove',
					value: function remove(option) {
						var parent = this.getCurrentLevel();
						if (!parent.getChildren || parent.getChildren().length < 1) return;
						option.optionId = option.record ? option.record.Id : option.optionId;
						option.index = option.index || 0;
						this._removeSubtree(option, this.getCurrentLevel());
					}
				}, {
					key: 'cancel',
					value: function cancel() {
						var currentLevel = this.getCurrentLevel(),
						    children = currentLevel.getChildren(),
						    i = 0;
						while (i < children.length) {
							if (children[i].staged) this._removeConfiguration(currentLevel, i, children[i].nodeId);else i++;
						}
					}
				}, {
					key: 'handleDescendantRules',
					value: function handleDescendantRules(configPath, configsToAdd, hiddenOptionIds, disabledOptionIds) {
						var _this2 = this;

						var level = this.configTree.getFromPath(this.path.concat(configPath)),
						    existingConfigs = void 0;
						if (!level) return;

						existingConfigs = level.getChildren();
						configsToAdd.forEach(function (config) {
							config.index = config.index || 0;
							var existingConfig = existingConfigs.find(function (existing) {
								return _this2._buildId(config) === existing.nodeId;
							});
							if (existingConfig === undefined) {
								_this2.configTree.buildSubtree(config);
								existingConfigs.push(config);
							}
						});
						existingConfigs.forEach(function (config) {
							var configToAdd = configsToAdd.find(function (configToAdd) {
								return config.nodeId === _this2._buildId(configToAdd);
							});
							if (configToAdd === undefined) _this2._removeSubtree(config, level);
						});
						level.hiddenOptionIds = hiddenOptionIds;
						level.disabledOptionIds = disabledOptionIds;
					}
				}, {
					key: 'getCurrentLevel',
					value: function getCurrentLevel() {
						return this.configTree.getFromPath(this.path);
					}
				}, {
					key: 'addToPath',
					value: function addToPath(id, sku, index, tabIndex) {
						this.path.push({ optionId: id, optionalSKU: sku, index: index, tabIndex: tabIndex });
						this.descendLevel = true;
					}
				}, {
					key: 'popFromPathAndGetNextSKU',
					value: function popFromPathAndGetNextSKU() {
						this.path.pop();
						this.descendLevel = false;
						var optionInfo = this.getLastFromPath();
						return optionInfo ? optionInfo.optionalSKU : optionInfo;
					}
				}, {
					key: 'getLastFromPath',
					value: function getLastFromPath() {
						return this.path[this.path.length - 1];
					}
				}, {
					key: 'getConfiguredOptionsFromPath',
					value: function getConfiguredOptionsFromPath() {
						return this.configuredOptions[this._buildPathString(true)] || {};
					}
				}, {
					key: '_getPreviousLevel',
					value: function _getPreviousLevel() {
						return this.configTree.getFromPath(this.path.slice(0, this.path.length - 1));
					}
				}, {
					key: '_setConfiguredOptionsObject',
					value: function _setConfiguredOptionsObject(isReconfigure) {
						this.configuredOptions = {};
						if (!isReconfigure) return;
						this._addConfigsToConfigurationObject(this.configTree.root, []);
						this.configTree.root.configuredOptions = this.getConfiguredOptionsFromPath();
					}
				}, {
					key: '_addConfigsToConfigurationObject',
					value: function _addConfigsToConfigurationObject(configuration, path) {
						var _this3 = this;

						configuration.getChildren().forEach(function (nestedConfig) {
							var obj = { 'optionId': nestedConfig.optionId, 'index': nestedConfig.index };
							_this3._addConfigsToConfigurationObject(nestedConfig, path.concat([obj]));
						});
						this._setConfigured(configuration, path);
					}
				}, {
					key: '_setConfigured',
					value: function _setConfigured(configuration, path) {
						var key = this._buildPathString(false, path);
						configuration.configured = true;
						if (key) {
							this.configuredOptions[key] = this.configuredOptions[key] || {};
							this.configuredOptions[key][configuration.nodeId] = true;
						}
					}
				}, {
					key: '_appendSubtree',
					value: function _appendSubtree(obj, parent, onSave) {
						var _this4 = this;

						var existingObj = this._findOnLevel(obj, parent);
						if (existingObj) {
							if (onSave) delete existingObj.staged;else if (obj.optionConfigurations.length > 0) {
									var indices = {};
									obj.optionConfigurations.forEach(function (nestedConfig) {
										indices[nestedConfig.optionId] = indices[nestedConfig.optionId] === undefined ? 0 : indices[nestedConfig.optionId] + 1;
										nestedConfig.index = indices[nestedConfig.optionId];
										_this4._appendSubtree(nestedConfig, existingObj, false);
									});
								}
							existingObj.optionData = obj.optionData;
							existingObj.externalConfigurationData = obj.externalConfigurationData;
							return;
						}
						if (onSave) {
							this._addIndexProperty(obj, parent);
						}
						this.configTree.buildSubtree(obj);
						parent.getChildren().push(obj);
					}
				}, {
					key: '_removeSubtree',
					value: function _removeSubtree(child, parent) {
						var childIndex = this._getChildIndexAndAdjustIndices(child.optionId, child.index, parent.getChildren());
						if (childIndex >= 0) {
							this._removeConfiguration(parent, childIndex, this._buildId(child));
						}
					}
				}, {
					key: '_removeConfiguration',
					value: function _removeConfiguration(parent, index, childId) {
						var key = this._buildPathString(true);
						parent.getChildren().splice(index, 1);
						if (key && this.configuredOptions[key] && this.configuredOptions[key][childId] && !this._findOnLevel(childId, parent)) {
							delete this.configuredOptions[key][childId];
						}
					}
				}, {
					key: '_findOnLevel',
					value: function _findOnLevel(idProperties, parent) {
						var id = idProperties.constructor === String ? idProperties : this._buildId(idProperties);
						return parent.getChildren().find(function (child) {
							return child.nodeId === id;
						});
					}
				}, {
					key: '_addIndexProperty',
					value: function _addIndexProperty(obj, parent) {
						var i = obj.index || 0;
						while (this._findOnLevel({ 'optionId': obj.optionId, 'index': i }, parent)) {
							i++;
						}
						obj.index = i;
					}
				}, {
					key: '_getChildIndexAndAdjustIndices',
					value: function _getChildIndexAndAdjustIndices(optionId, index, children) {
						var i = 0,
						    childIndex = -1,
						    id = this._buildId({ 'optionId': optionId, 'index': index });
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = children[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var child = _step.value;

								if (child.nodeId === id) childIndex = i;else if (child.optionId === optionId && child.index > index) this._alterIndexPropertyAndNodeId(child);
								i++;
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return childIndex;
					}
				}, {
					key: '_alterIndexPropertyAndNodeId',
					value: function _alterIndexPropertyAndNodeId(obj) {
						var prevId = obj.nodeId;
						obj.index--;
						obj.nodeId = this._buildId(obj);

						var key = this._buildPathString(true);
						if (key && this.configuredOptions[key]) {
							this.configuredOptions[key][obj.nodeId] = true;
							delete this.configuredOptions[key][prevId];
						}
					}
				}, {
					key: '_buildId',
					value: function _buildId(obj) {
						return '_' + obj.optionId + '_' + obj.index;
					}
				}, {
					key: '_buildPathString',
					value: function _buildPathString(includeLast) {
						var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.path;

						var string = this.configTree.root.nodeId,
						    n = includeLast ? 0 : 1;
						for (var i = 0; i < path.length - n; i++) {
							string += '-' + this._buildId(path[i]);
						}
						return string;
					}
				}]);

				return NestedOptionsModel;
			}());

			_export('NestedOptionsModel', NestedOptionsModel);
		}
	};
});

'use strict';

System.register('products/selection/filter/sb-suggester/Suggester.js', ['../../../../common/Util.js', 'common/data/client/ServiceClient.js', 'common/core/AppContext.js', 'common/forms/sb-lookup/map/LookupNameMapper.js'], function (_export, _context) {
	var Util, ServiceClient, AppContext, LookupNameMapper, _createClass, Suggester;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonUtilJs) {
			Util = _commonUtilJs.Util;
		}, function (_commonDataClientServiceClientJs) {
			ServiceClient = _commonDataClientServiceClientJs.ServiceClient;
		}, function (_commonCoreAppContextJs) {
			AppContext = _commonCoreAppContextJs.AppContext;
		}, function (_commonFormsSbLookupMapLookupNameMapperJs) {
			LookupNameMapper = _commonFormsSbLookupMapLookupNameMapperJs.LookupNameMapper;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('Suggester', Suggester = function () {
				function Suggester(prefix, searchModel, quoteProcess) {
					_classCallCheck(this, Suggester);

					this.prefix = prefix;
					this.searchModel = searchModel;
					this.searchFilterData = {};
					this.filterContext = quoteProcess;
				}

				_createClass(Suggester, [{
					key: 'buildFields',
					value: function buildFields(fields) {
						var gsfields = [];
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = fields[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var field = _step.value;

								gsfields.push(field.replace('Product2', 'ProcessInput__c'));
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return gsfields;
					}
				}, {
					key: 'getSearchTable',
					value: function getSearchTable() {
						return this.prefix + 'ProcessInput__c';
					}
				}, {
					key: 'getGroupKey',
					value: function getGroupKey(filter) {
						return filter.record.Id;
					}
				}, {
					key: 'setDefaultFilterValues',
					value: function setDefaultFilterValues(group, searchFilterModel) {
						var searchFilterData = {};
						var promises = [];
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = group[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var id = _step2.value;
								var _iteratorNormalCompletion4 = true;
								var _didIteratorError4 = false;
								var _iteratorError4 = undefined;

								try {
									for (var _iterator4 = this.searchModel.quoteProcess.inputs[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
										var process = _step4.value;

										if (process.record.Id === id) {
											if (!this.searchModel.processInputValues[id]) {} else if (searchFilterModel && this.isLookupType(searchFilterModel[id].model.type) && this.searchModel.processInputValues[id][this.prefix + 'Value__c']) promises.push(this.queryLookupFilterName(this.searchModel.processInputValues[id][this.prefix + 'Value__c'], searchFilterModel[id].model.referenceTo[0]));
											var value = null;
											if (this.searchModel.processInputValues[id]) value = this.searchModel.processInputValues[id][this.prefix + 'Value__c'] || null;else value = process.record[process.record[this.prefix + 'InputField__c']] || null;
											searchFilterData[id] = { value: value, hidden: false, field: process.targetFieldName };
											break;
										}
									}
								} catch (err) {
									_didIteratorError4 = true;
									_iteratorError4 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion4 && _iterator4.return) {
											_iterator4.return();
										}
									} finally {
										if (_didIteratorError4) {
											throw _iteratorError4;
										}
									}
								}
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						return new Promise(function (resolve) {
							if (promises.length === 0) {
								this.searchFilterData = searchFilterData;
								resolve(searchFilterData);
							} else {
								Promise.all(promises).then(function (responses) {
									var _iteratorNormalCompletion3 = true;
									var _didIteratorError3 = false;
									var _iteratorError3 = undefined;

									try {
										for (var _iterator3 = responses[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
											var response = _step3.value;

											var record = response.records[0];
											if (!record) continue;
											var name = new LookupNameMapper(record.attributes.type).getNameField();
											for (var id in searchFilterData) {
												var searchFilter = searchFilterData[id];
												if (!searchFilter.value) continue;
												if (searchFilter.value.substring(0, 15) === record.Id.substring(0, 15)) {
													searchFilter.label = record[name];
													break;
												}
											}
										}
									} catch (err) {
										_didIteratorError3 = true;
										_iteratorError3 = err;
									} finally {
										try {
											if (!_iteratorNormalCompletion3 && _iterator3.return) {
												_iterator3.return();
											}
										} finally {
											if (_didIteratorError3) {
												throw _iteratorError3;
											}
										}
									}

									this.searchFilterData = searchFilterData;
									this.evaluateProcessInputConditions();
									resolve(searchFilterData);
								}.bind(this));
							}
						}.bind(this));
					}
				}, {
					key: 'getFilterContext',
					value: function getFilterContext() {
						var quoteProcess = JSON.parse(JSON.stringify(this.filterContext));
						var _iteratorNormalCompletion5 = true;
						var _didIteratorError5 = false;
						var _iteratorError5 = undefined;

						try {
							for (var _iterator5 = quoteProcess.inputs[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
								var input = _step5.value;

								if (this.searchFilterData[input.record.Id].hidden) {
									input.record[input.targetFieldName] = null;
									input.hidden = true;
									continue;
								}

								if (this.searchFilterData[input.record.Id]) {
									if (this.searchFilterData[input.record.Id].value === '') input.record[input.targetFieldName] = null;else input.record[input.targetFieldName] = this.searchFilterData[input.record.Id].value;
								}
							}
						} catch (err) {
							_didIteratorError5 = true;
							_iteratorError5 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion5 && _iterator5.return) {
									_iterator5.return();
								}
							} finally {
								if (_didIteratorError5) {
									throw _iteratorError5;
								}
							}
						}

						var length = quoteProcess.inputs.length;
						for (var i = 0; i < length; i++) {
							if (quoteProcess.inputs[i].hidden) {
								quoteProcess.inputs.splice(i, 1);
								length--;
								i--;
							}
						}
						return quoteProcess;
					}
				}, {
					key: 'getAdditionalProperties',
					value: function getAdditionalProperties() {
						return null;
					}
				}, {
					key: 'evaluateProcessInputConditions',
					value: function evaluateProcessInputConditions() {
						var searchFilterData = JSON.parse(JSON.stringify(this.searchFilterData));
						var _iteratorNormalCompletion6 = true;
						var _didIteratorError6 = false;
						var _iteratorError6 = undefined;

						try {
							for (var _iterator6 = this.filterContext.inputs[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
								var input = _step6.value;

								var numPass = 0;
								if (input.conditions.length === 0) {
									searchFilterData[input.record.Id].hidden = false;
									continue;
								}

								var _iteratorNormalCompletion7 = true;
								var _didIteratorError7 = false;
								var _iteratorError7 = undefined;

								try {
									for (var _iterator7 = input.conditions[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {
										var condition = _step7.value;

										var masterProcessInput = condition[this.prefix + 'MasterProcessInput__c'];
										var masterProcessInputValue = searchFilterData[masterProcessInput].value;
										if (Util.arithmeticOperatorConversion(masterProcessInputValue, condition[this.prefix + 'Value__c'], condition[this.prefix + 'Operator__c'])) numPass++;
									}
								} catch (err) {
									_didIteratorError7 = true;
									_iteratorError7 = err;
								} finally {
									try {
										if (!_iteratorNormalCompletion7 && _iterator7.return) {
											_iterator7.return();
										}
									} finally {
										if (_didIteratorError7) {
											throw _iteratorError7;
										}
									}
								}

								if (input.record[this.prefix + 'ConditionsMet__c'] === 'All') searchFilterData[input.record.Id].hidden = !(numPass === input.conditions.length);else searchFilterData[input.record.Id].hidden = !(numPass > 0);
							}
						} catch (err) {
							_didIteratorError6 = true;
							_iteratorError6 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion6 && _iterator6.return) {
									_iterator6.return();
								}
							} finally {
								if (_didIteratorError6) {
									throw _iteratorError6;
								}
							}
						}

						this.searchFilterData = searchFilterData;
						return searchFilterData;
					}
				}, {
					key: 'runOnLoad',
					value: function runOnLoad() {
						var Ids = [];
						var _iteratorNormalCompletion8 = true;
						var _didIteratorError8 = false;
						var _iteratorError8 = undefined;

						try {
							for (var _iterator8 = this.searchModel.quoteProcess.inputs[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {
								var input = _step8.value;

								Ids.push(input.record.Id);
							}
						} catch (err) {
							_didIteratorError8 = true;
							_iteratorError8 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion8 && _iterator8.return) {
									_iterator8.return();
								}
							} finally {
								if (_didIteratorError8) {
									throw _iteratorError8;
								}
							}
						}

						this.setDefaultFilterValues(Ids);
					}
				}, {
					key: 'isLookupType',
					value: function isLookupType(type) {
						return type === 'reference' || type === 'id';
					}
				}, {
					key: 'queryLookupFilterName',
					value: function queryLookupFilterName(id, tableName) {
						var name = new LookupNameMapper(tableName).getNameField();
						var _id = id ? '\'' + id + '\'' : null;
						return new ServiceClient().query(('SELECT Id, ' + name + ' FROM ' + tableName + ' WHERE Id = ').concat(_id));
					}
				}]);

				return Suggester;
			}());

			_export('Suggester', Suggester);
		}
	};
});

'use strict';

System.register('products/selection/routes/sb-product-lookup/ProductLookup.js', ['common/core/Page.js', 'common/layout/fields/FieldSetHandler.js', 'common/filter/searcher/Searcher.js', 'products/selection/filter/sb-suggester/Suggester.js', 'common/core/sb-page-container/PageContainer.js', 'products/localization/LocalizeFields.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, FieldSetHandler, Searcher, Suggester, PageContainer, LocalizeFields, ErrorFormatter, _createClass, ProductLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonLayoutFieldsFieldSetHandlerJs) {
			FieldSetHandler = _commonLayoutFieldsFieldSetHandlerJs.FieldSetHandler;
		}, function (_commonFilterSearcherSearcherJs) {
			Searcher = _commonFilterSearcherSearcherJs.Searcher;
		}, function (_productsSelectionFilterSbSuggesterSuggesterJs) {
			Suggester = _productsSelectionFilterSbSuggesterSuggesterJs.Suggester;
		}, function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}, function (_productsLocalizationLocalizeFieldsJs) {
			LocalizeFields = _productsLocalizationLocalizeFieldsJs.LocalizeFields;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductLookup', ProductLookup = function (_Page) {
				_inherits(ProductLookup, _Page);

				function ProductLookup() {
					_classCallCheck(this, ProductLookup);

					return _possibleConstructorReturn(this, (ProductLookup.__proto__ || Object.getPrototypeOf(ProductLookup)).apply(this, arguments));
				}

				_createClass(ProductLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-lookup';
						this.properties = Polymer.Base.extend({
							selectedProducts: {
								type: Object,
								value: {}
							},
							lineEditorModel: Object,
							redirectUrl: String,
							hiddenByGroup: {
								type: Object,
								value: {}
							},
							totalCount: String,
							hasTotalCount: Boolean,
							quote: Object,
							internal: {
								type: Boolean,
								value: false
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							},
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							error: {
								type: Array,
								value: []
							}
						}, Page.properties);
					}
				}, {
					key: 'modal',
					value: function modal() {
						if (!this.modalActive && this.hasQuoteProcess) {
							this.$.selectionSaver.save({ uid: this.quote.record.Id, model: { modalActive: true } });
							this.toggleClass('modaloverflow', true, this);
							this.$.modal.show = true;
						} else {
							if (!this.hasQuoteProcess) {
								this.toggleClass('panel-actions', false, this.$$('#gslayout'));
								this.toggleClass('panel-actions', true, this.$$('#pflayout'));
							}
							this.panelSuggester = this.suggester;
							this.panelGroupItems = this.groupItems;
						}
						this.refocus();
					}
				}, {
					key: 'searchModelChanged',
					value: function searchModelChanged() {
						this.handleAutoSelect();
						this.deSelectAll();
						this.setUsePagination();
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.preLoadObjects();
						this.handleClearSelected();
						this.handleScrollEvent();
						this.handleSelectButtonClickedServerResponseAndNavigation();
						this.handlePaginationChanged();
						this.$.lookupLayout.additionalFields = ['PricebookEntry.UnitPrice'];
						this.$.modal.addEventListener('sb-gs-modal-close', this.closeDialog.bind(this));
						this.$.drawer.$.drawer.addEventListener('transitionend', this.refocus.bind(this));
						this.$.modal.addEventListener('filter-item-value-changed', this.handleLabelChanged.bind(this));
						this.addEventListener('iron-deselect', this.handleDrawerClosed.bind(this));
					}
				}, {
					key: 'handleTransientCache',
					value: function handleTransientCache() {
						this.$.selectionReader.read({ uid: this.quote.record.Id }).then(function (response) {
							this.lastSubmit = response ? response.lastSubmit : null;
							this.modalActive = response ? response.modalActive : false;
							if (this.lastSubmit === 'gs') {
								this.suggester.runOnLoad();
								this.runSuggester();
							} else if (this.lastSubmit === 'pf') {
								this.searcher.runOnLoad(response.filterValues);
								this.runSearcher();
							}
						}.bind(this));
					}
				}, {
					key: 'handleProductsLoadServerResponse',
					value: function handleProductsLoadServerResponse() {
						this.$.qo.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
							this.quote = e.detail.value.quote;
							this.inputField = this.prefix + 'InputField__c';
							this.localizer = new LocalizeFields(this.prefix);
							var quoteProcessId = this.quote.record[this.prefix + 'QuoteProcessId__c'] ? this.quote.record[this.prefix + 'QuoteProcessId__c'] : null;
							this.hasQuoteProcess = quoteProcessId !== null;

							if (this.hasQuoteProcess === true) this.toggleClass('panel-actions', true, this.$$('#gslayout'));else this.toggleClass('panel-actions', true, this.$$('#pflayout'));
							if (this.ctx.params.aId) this.$.smLoadService.actionId = this.ctx.params.aId;
							this.$.smLoadService.processId = quoteProcessId;
							this.$.smLoadService.quote = this.$.smSelectService.quote = this.quote;
						}.bind(this));

						this.$.smLoadService.addEventListener('search-model-changed', function (e) {
							var searchModel = this.localizer.localizeSearchModel(e.detail.value);
							this.$.lookupLayout.groupByField = searchModel.productResultsGroupFieldName;
							this.$.lookupLayout.fieldPrefix = searchModel.targetObjectName + '.';
							this.quoteProcess = searchModel.quoteProcess;
							this.searchModel = searchModel;
							this.buildDelegator();
							this.handleTransientCache();
						}.bind(this));
					}
				}, {
					key: 'handleSelectButtonClickedServerResponseAndNavigation',
					value: function handleSelectButtonClickedServerResponseAndNavigation() {
						this.$.smSelectService.addEventListener('result-changed', function (e) {
							this.lineEditorModel.quote = e.detail.value.quote;
							if (e.detail.value.configuredProducts.length == 0) {
								this.handleNonConfigurableProducts(e);
							}
							if (e.detail.value.configuredProducts.length > 0) {
								this.handleConfigurableProducts(e);
							}
						}.bind(this));
					}
				}, {
					key: 'handleNonConfigurableProducts',
					value: function handleNonConfigurableProducts(e) {
						if (this.redirectUrl === 'LineEditor') {
							this.navigateToLineEditor();
						} else if (this.redirectUrl === 'ProductLookup') {
							this.$.smSelectService.quote = e.detail.value.quote;
							this.deSelectAll();
							this.navigateToSelf();
							this.spinner = false;
						}
					}
				}, {
					key: 'handleConfigurableProducts',
					value: function handleConfigurableProducts(e) {
						var queryParams = {};
						e.detail.value.selectedProducts = this.selectedProducts;
						var configProductIds = this.getConfigProductIds(e);
						queryParams.qId = e.detail.value.quote.record.Id;
						if (this.ctx.params.groupKey !== undefined) queryParams.groupKey = this.ctx.params.groupKey;
						if (this.ctx.params.aId !== undefined) queryParams.aId = this.ctx.params.aId;
						queryParams.pId = configProductIds;
						queryParams.redirectUrl = this.redirectUrl;
						queryParams.open = 0;
						this.nav('#', queryParams, ['product', 'pc'], false);
					}
				}, {
					key: 'handleLabelChanged',
					value: function handleLabelChanged(e) {
						if (this.searchFilterData) this.searchFilterData[e.detail.item].label = e.detail.value;
					}
				}, {
					key: 'buildDelegator',
					value: function buildDelegator() {
						if (this.hasQuoteProcess) {
							this.suggester = new Suggester(this.prefix, this.searchModel, this.quoteProcess);
						}
						if (!this.searcher) this.searcher = new Searcher(this.searchModel);
					}
				}, {
					key: 'handleValueChanged',
					value: function handleValueChanged() {
						if (this.internal) return;
						this.internal = true;
						this.updateSearchFilterData();
						this.internal = false;
					}
				}, {
					key: 'updateSearchFilterData',
					value: function updateSearchFilterData() {
						this.suggester.searchFilterData = this.searchFilterData;
						var searchFilterData = this.suggester.evaluateProcessInputConditions();
						this.searchFilterData = searchFilterData;
					}
				}, {
					key: 'toggleFilter',
					value: function toggleFilter() {
						this.$$('sb-page-header')._closeMenu();
						this.panelHeader = 'Product Filter';
						if (this.$$('.panel-actions').id === 'pflayout' || this.$.drawer.$.drawer.selected === 'main') this.$.drawer.$.drawer.togglePanel();
						this.toggleClass('panel-actions', false, this.$$('#gslayout'));
						this.toggleClass('panel-actions', true, this.$$('#pflayout'));
						this.refocus();
					}
				}, {
					key: 'toggleGuidedSelling',
					value: function toggleGuidedSelling() {
						this.$$('sb-page-header')._closeMenu();
						this.panelHeader = 'Guided Selling';
						if (this.$$('.panel-actions').id === 'gslayout' || this.$.drawer.$.drawer.selected === 'main') this.$.drawer.$.drawer.togglePanel();
						this.toggleClass('panel-actions', false, this.$$('#pflayout'));
						this.toggleClass('panel-actions', true, this.$$('#gslayout'));
						this.refocus();
					}
				}, {
					key: 'refocus',
					value: function refocus() {
						if (this.$.modal.show) this.$.modalGroup.focusFirstField();else if (this.$$('.panel-actions').id === 'gslayout') this.$.gs.focusFirstField();else if (this.$$('.panel-actions').id === 'pflayout') this.$.pf.focusFirstField();
					}
				}, {
					key: 'reverseFocus',
					value: function reverseFocus() {
						if (this.$.modal.show) this.$.suggest.focus();else if (this.$$('.panel-actions').id === 'gslayout') this.$.cleargs.focus();else if (this.$$('.panel-actions').id === 'pflayout') this.$.clearfilter.focus();
					}
				}, {
					key: 'closeDialog',
					value: function closeDialog() {
						this.toggleClass('modaloverflow', false, this);

						this.panelSuggester = this.suggester;
						if (!this.panelGroupItems) this.panelGroupItems = this.groupItems;
						this.$.modal.show = false;
					}
				}, {
					key: 'suggestClicked',
					value: function suggestClicked() {
						this.suggest = true;
						this.runSuggester();
					}
				}, {
					key: 'runSuggester',
					value: function runSuggester() {
						this.$$('#suggest').focus();
						this.saveCache();
						this.lastSubmit = 'gs';
						this.closeDialog();
						this.$.gs.runService();
						this.$.drawer.$.drawer.closeDrawer();
					}
				}, {
					key: 'runSearcher',
					value: function runSearcher() {
						this.$$('#submit').focus();
						this.saveCache();
						this.lastSubmit = 'pf';
						this.$.pf.actionId = this.ctx.params.aId;
						this.$.pf.runService();
						this.$.drawer.$.drawer.closeDrawer();
					}
				}, {
					key: 'saveCache',
					value: function saveCache() {
						this.$.selectionSaver.save({
							uid: this.quote.record.Id, model: {
								modalActive: true,
								lastSubmit: this.$$('.panel-actions').id.substring(0, 2),
								filterValues: this.searcher.searchFilterData
							}
						});
					}
				}, {
					key: 'handleScrollEvent',
					value: function handleScrollEvent() {
						this.previous = 0;
						var drawer = this.$$('#lookupLayout');
						drawer.addEventListener('scroll', function () {
							if (!this.usePagination || this.isMobileViewport() === false) return;
							var current = drawer.scrollTop;
							if (current < 0) return;
							var offset = drawer.offsetHeight;
							var scrollHeight = drawer.scrollHeight;
							if (current + offset >= scrollHeight) return;
							var direction = this.previous < current ? 'down' : 'up';
							this.previous = current;
							this.paginationBar = this.paginationBar || this.$$('sb-pagination');
							this.toggleClass('hide', direction === 'down', this.paginationBar);
						}.bind(this));
					}
				}, {
					key: 'removeFilter',
					value: function removeFilter() {
						this.$$('.actions').removeChild(this.$$('#fb'));
					}
				}, {
					key: 'getConfigProductIds',
					value: function getConfigProductIds(e) {
						var productIds = [];
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = e.detail.value.configuredProducts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var product = _step.value;

								productIds.push(product.record.Id);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return productIds.join(',');
					}
				}, {
					key: 'deSelectAll',
					value: function deSelectAll() {
						this.$.lookupLayout.deSelectAll();
					}
				}, {
					key: 'onSelect',
					value: function onSelect() {
						this.redirectUrl = 'LineEditor';
						if (this.selectedProducts && Object.keys(this.selectedProducts).length > 0) {
							this.spinner = true;
							if (this.quoteProcess) this.$.smSelectService.quoteProcess = this.suggester.getFilterContext();
							this.$.smSelectService.selectedProductList = this.getOrderedSelectedProducts();
						} else {
							this.navigateToLineEditor();
						}
					}
				}, {
					key: 'onSelectMore',
					value: function onSelectMore() {
						this.redirectUrl = 'ProductLookup';
						if (this.selectedProducts && Object.keys(this.selectedProducts).length > 0) {
							this.spinner = true;
							if (this.quoteProcess) this.$.smSelectService.quoteProcess = this.suggester.getFilterContext();
							this.$.smSelectService.selectedProductList = this.getOrderedSelectedProducts();
						} else {
							this.navigateToSelf();
						}
					}
				}, {
					key: 'getOrderedSelectedProducts',
					value: function getOrderedSelectedProducts() {
						var orderedSelectedProductIds = Object.keys(this.selectedProducts).sort(function (id1, id2) {
							return this.selectedProducts[id1].index - this.selectedProducts[id2].index;
						}.bind(this));

						var orderedSelectedProducts = [];
						var _iteratorNormalCompletion2 = true;
						var _didIteratorError2 = false;
						var _iteratorError2 = undefined;

						try {
							for (var _iterator2 = orderedSelectedProductIds[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
								var selectedProductId = _step2.value;

								delete this.selectedProducts[selectedProductId].record.UnitPrice;
								orderedSelectedProducts.push(this.selectedProducts[selectedProductId]);
							}
						} catch (err) {
							_didIteratorError2 = true;
							_iteratorError2 = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion2 && _iterator2.return) {
									_iterator2.return();
								}
							} finally {
								if (_didIteratorError2) {
									throw _iteratorError2;
								}
							}
						}

						return orderedSelectedProducts;
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.spinner = true;
						this.nav('#', { 'qId': this.quote.record.Id }, ['quote', 'le'], false);
					}
				}, {
					key: 'navigateToLineEditor',
					value: function navigateToLineEditor() {
						this.nav('#', { 'qId': this.quote.record.Id }, ['quote', 'le'], false);
					}
				}, {
					key: 'navigateToSelf',
					value: function navigateToSelf() {
						var actionIdQueryString = this.ctx.params.aId ? '&aId=' + this.ctx.params.aId : '';
						this.fire('iron-signal', {
							name: 'sb-navigation-changed', data: {
								url: '#', location: '#/product/lookup?qId=' + this.quote.record.Id + actionIdQueryString
							}
						});
						this.$.plSelectMore.blur();
					}
				}, {
					key: 'navToFavorites',
					value: function navToFavorites() {
						var params = { qId: this.quote.record.Id };
						if (this.ctx.params.groupKey !== undefined) params.groupKey = this.ctx.params.groupKey;
						if (this.ctx.params.aId !== undefined) params.aId = this.ctx.params.aId;
						this.nav('#', params, ['favorite', 'lookup'], false);
					}
				}, {
					key: 'handlePaginationChanged',
					value: function handlePaginationChanged() {
						this.addEventListener('pagination-changed', function (e) {
							if (this.lastSubmit === 'gs') this.$.gs.runService(null, null, e.detail.page);else this.$.pf.runService(null, null, e.detail.page);
						}.bind(this));
					}
				}, {
					key: 'setUsePagination',
					value: function setUsePagination() {
						if (!this.searchModel.resultLimit || this.searchModel.totalCount === undefined) return;

						this.hasTotalCount = true;
						this.resultLimit = this.searchModel.resultLimit;
						this.totalCount = this.searchModel.totalCount;
						this.usePagination = this.resultLimit < this.totalCount;
						this.pageIndex = undefined;
						this.pageIndex = 0;
					}
				}, {
					key: 'handleAutoSelect',
					value: function handleAutoSelect() {
						if (this.suggest && this.quoteProcess && this.quoteProcess.record[this.prefix + 'ProductAutoSelected__c'] && this.searchModel.results.length === 1) {
							var result = this.searchModel.results[0];
							this.selectedProducts[result.record.Product2Id] = {
								record: { Id: result.record.Product2Id, attributes: result.record.attributes, UnitPrice: result.record.UnitPrice },
								invalid: false
							};
							this.suggest = false;
							this.onSelect();
						}
					}
				}, {
					key: 'handleClearSelected',
					value: function handleClearSelected() {
						this.addEventListener('suggestion-loaded', function () {
							this.deSelectAll();
						}.bind(this));
					}
				}, {
					key: 'handleDrawerScroll',
					value: function handleDrawerScroll() {
						this.addEventListener('filter-drawer-scroll', function (e) {
							if (!this.usePagination || this.isMobileViewport() === false) return;
							var direction = e.detail.direction;
							this.paginationBar = this.paginationBar || this.$$('sb-pagination');
							this.toggleClass('hidden', direction === 'down', this.paginationBar);
						}.bind(this));
					}
				}, {
					key: 'handleDrawerClosed',
					value: function handleDrawerClosed() {
						if (this.$.drawer.$.drawer.selected === 'main') {
							this.fire('iron-signal', { name: 'sb-panel-closed' });
						}
					}
				}, {
					key: 'clearFilterFields',
					value: function clearFilterFields() {
						this.filterData = this.searcher.clearFields();
					}
				}, {
					key: 'clearGSFields',
					value: function clearGSFields() {
						var searchFilterData = JSON.parse(JSON.stringify(this.suggester.searchFilterData));
						for (var value in searchFilterData) {
							searchFilterData[value].value = null;
						}
						this.suggester.searchFilterData = searchFilterData;
						this.searchFilterData = this.suggester.evaluateProcessInputConditions();
					}
				}, {
					key: 'bindFilterEnterCallBacks',
					value: function bindFilterEnterCallBacks() {
						this.$.pf.enterCallback = this.runSearcher.bind(this);
						this.$.gs.enterCallback = this.runSuggester.bind(this);
						this.$.modalGroup.enterCallback = this.runSuggester.bind(this);
					}
				}, {
					key: 'preLoadObjects',
					value: function preLoadObjects() {
						this.lookupObjects = ['Product2', 'PricebookEntry', this.prefix + 'ProcessInput__c'];
					}
				}, {
					key: 'isMobileViewport',
					value: function isMobileViewport() {
						return this.viewport && this.viewport.isMobile();
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.error = new ErrorFormatter(this.errors).truncate();
						this.spinner = false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior, window.CommonBehaviors.LookupBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['searchModelChanged(searchModel)', 'modal(quote, modalActive)', 'handleValueChanged(searchFilterData.*)'];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}, {
					key: 'prefix',
					get: function get() {
						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}]);

				return ProductLookup;
			}(Page));

			_export('ProductLookup', ProductLookup);

			Polymer(ProductLookup);
		}
	};
});

'use strict';

System.register('subscriptions/selection/routes/sb-subscription-lookup/SubscriptionLookup.js', ['../../../../common/core/Page.js', 'common/layout/fields/FieldSetHandler.js', 'common/layout/tables/TableClassBuilder.js', 'common/filter/searcher/Searcher.js', 'common/data/format/ErrorFormatter.js'], function (_export, _context) {
	var Page, FieldSetHandler, TableClassBuilder, Searcher, ErrorFormatter, _createClass, SubscriptionLookup;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	function _possibleConstructorReturn(self, call) {
		if (!self) {
			throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
		}

		return call && (typeof call === "object" || typeof call === "function") ? call : self;
	}

	function _inherits(subClass, superClass) {
		if (typeof superClass !== "function" && superClass !== null) {
			throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
		}

		subClass.prototype = Object.create(superClass && superClass.prototype, {
			constructor: {
				value: subClass,
				enumerable: false,
				writable: true,
				configurable: true
			}
		});
		if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
	}

	return {
		setters: [function (_commonCorePageJs) {
			Page = _commonCorePageJs.Page;
		}, function (_commonLayoutFieldsFieldSetHandlerJs) {
			FieldSetHandler = _commonLayoutFieldsFieldSetHandlerJs.FieldSetHandler;
		}, function (_commonLayoutTablesTableClassBuilderJs) {
			TableClassBuilder = _commonLayoutTablesTableClassBuilderJs.TableClassBuilder;
		}, function (_commonFilterSearcherSearcherJs) {
			Searcher = _commonFilterSearcherSearcherJs.Searcher;
		}, function (_commonDataFormatErrorFormatterJs) {
			ErrorFormatter = _commonDataFormatErrorFormatterJs.ErrorFormatter;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('SubscriptionLookup', SubscriptionLookup = function (_Page) {
				_inherits(SubscriptionLookup, _Page);

				function SubscriptionLookup() {
					_classCallCheck(this, SubscriptionLookup);

					return _possibleConstructorReturn(this, (SubscriptionLookup.__proto__ || Object.getPrototypeOf(SubscriptionLookup)).apply(this, arguments));
				}

				_createClass(SubscriptionLookup, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-subscription-lookup';
						this.properties = Polymer.Base.extend({
							selectedProducts: {
								type: Object,
								value: {}
							},
							lineEditorModel: Object,
							totalCount: String,
							hasTotalCount: String,
							errors: {
								type: Array,
								value: [],
								notify: true
							},
							error: {
								type: Array,
								value: []
							}
						}, Page.properties);
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.preLoadObjects();
						this.handleSelectButtonClickedServerResponseAndNavigation();
					}
				}, {
					key: 'handleProductsLoadServerResponse',
					value: function handleProductsLoadServerResponse() {
						this.$.qo.addEventListener('line-editor-model-changed', function (e) {
							this.lineEditorModel = e.detail.value;
							this.quote = this.$.smLoadService.quote = this.$.smSelectService.quote = e.detail.value.quote;
						}.bind(this));

						this.$.smLoadService.addEventListener('search-model-changed', function (e) {
							this.searchModel = e.detail.value;
							this.primaryMobileColumn = this.searchModel.resultFieldNames[0];
							this.searcher = new Searcher(this.searchModel);
							this.hasTotalCount = this.searchModel.totalCount > 0;
							this.totalCount = this.searchModel.totalCount;
						}.bind(this));
					}
				}, {
					key: 'handleSelectButtonClickedServerResponseAndNavigation',
					value: function handleSelectButtonClickedServerResponseAndNavigation() {
						this.$.smSelectService.addEventListener('result-changed', function (e) {
							this.lineEditorModel.quote = e.detail.value;
							this.navigateToLineEditor();
						}.bind(this));
					}
				}, {
					key: 'toggleFilter',
					value: function toggleFilter() {
						this.$$('sb-page-header')._closeMenu();
						this.$.drawer.$.drawer.togglePanel();
					}
				}, {
					key: 'removeFilter',
					value: function removeFilter() {
						this.$$('.actions').removeChild(this.$$('#fb'));
					}
				}, {
					key: 'getConfigProductIds',
					value: function getConfigProductIds(e) {
						var productIds = [];
						var _iteratorNormalCompletion = true;
						var _didIteratorError = false;
						var _iteratorError = undefined;

						try {
							for (var _iterator = e.detail.value.configuredProducts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
								var product = _step.value;

								productIds.push(product.record.Id);
							}
						} catch (err) {
							_didIteratorError = true;
							_iteratorError = err;
						} finally {
							try {
								if (!_iteratorNormalCompletion && _iterator.return) {
									_iterator.return();
								}
							} finally {
								if (_didIteratorError) {
									throw _iteratorError;
								}
							}
						}

						return productIds.join(',');
					}
				}, {
					key: 'deSelectAll',
					value: function deSelectAll() {
						this.$.lookupLayout.deSelectAll();
					}
				}, {
					key: 'onSelect',
					value: function onSelect() {
						this.spinner = true;
						if (this.selectedProducts && Object.keys(this.selectedProducts).length > 0) this.$.smSelectService.selectedProducts = this.selectedProducts;else this.navigateToLineEditor();
					}
				}, {
					key: 'onCancel',
					value: function onCancel() {
						this.spinner = true;
						this.nav('#', { 'qId': this.lineEditorModel.quote.record.Id }, ['quote', 'le'], false);
					}
				}, {
					key: 'navigateToLineEditor',
					value: function navigateToLineEditor() {
						this.nav('#', { 'qId': this.lineEditorModel.quote.record.Id }, ['quote', 'le'], false);
					}
				}, {
					key: 'runSearcher',
					value: function runSearcher() {
						this.$$('#submit').focus();
						this.$.sf.runService();
						this.$.drawer.$.drawer.closeDrawer();
					}
				}, {
					key: 'preLoadObjects',
					value: function preLoadObjects() {
						this.subscriptionLookupObjects = [this.prefix + 'Subscription__c', 'Contract'];
					}
				}, {
					key: 'bindFilterEnterCallBacks',
					value: function bindFilterEnterCallBacks() {
						this.$.sf.enterCallback = this.runSearcher.bind(this);
					}
				}, {
					key: 'clearFilterFields',
					value: function clearFilterFields() {
						this.filterData = this.searcher.clearFields();
					}
				}, {
					key: 'clearStackTrace',
					value: function clearStackTrace() {
						if (!this.errors[0]) return;
						this.error = new ErrorFormatter(this.errors).truncate();
						this.spinner = false;
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [sb.common.core.Page, window.CommonBehaviors.DeviceBehavior, window.CommonBehaviors.LookupBehavior];
					}
				}, {
					key: 'listeners',
					get: function get() {
						return {
							'errors-changed': 'clearStackTrace'
						};
					}
				}, {
					key: 'prefix',
					get: function get() {
						return this.app.org.prefix ? this.app.org.prefix + '__' : '';
					}
				}]);

				return SubscriptionLookup;
			}(Page));

			_export('SubscriptionLookup', SubscriptionLookup);

			Polymer(SubscriptionLookup);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-le-summary-row/sb-le-summary-cell/LESummaryCell.js', [], function (_export, _context) {
	var _createClass, LESummaryCell, cache;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('LESummaryCell', LESummaryCell = function () {
				function LESummaryCell() {
					_classCallCheck(this, LESummaryCell);
				}

				_createClass(LESummaryCell, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-le-summary-cell';
						this.properties = {
							item: String,
							summaries: Object,
							editorModel: Object
						};
					}
				}, {
					key: 'observer',
					value: function observer() {
						var md = this.editorModel.md.fieldsMap[this.editorModel.data.quoteLineObjectName];

						var lc = cache[this.item];
						if (!lc) {
							cache[this.item] = this.item.toLowerCase();
							lc = cache[this.item];
						}
						if (this.summaries && md[this.item]) {
							md[this.item].CurrencyIsoCode = this.editorModel.quoteModel.quoteVO.record.CurrencyIsoCode;
							this.$.field.value = this.summaries[lc];
							this.$.field.md = md[this.item];
						}
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['observer(summaries, editorModel)'];
					}
				}]);

				return LESummaryCell;
			}());

			_export('LESummaryCell', LESummaryCell);

			cache = {};


			Polymer(LESummaryCell);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-line-editor-tabs/sb-group-tabs/GroupTabs.js', [], function (_export, _context) {
	var _createClass, GroupTabs;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('GroupTabs', GroupTabs = function () {
				function GroupTabs() {
					_classCallCheck(this, GroupTabs);
				}

				_createClass(GroupTabs, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-group-tabs';

						this.properties = {
							isGroupFieldPage: {
								type: Boolean,
								computed: '_setIsGroupFieldPage(pageType)'
							},
							isSegmentedLinesPage: {
								type: Boolean,
								computed: '_setIsSegmentedLinesPage(pageType)'
							},
							isStandardLinesPage: {
								type: Boolean,
								computed: '_setIsStandardLinesPage(pageType)'
							},
							editorModel: {
								notify: true,
								type: Object
							}
						};
					}
				}, {
					key: 'buildPage',
					value: function buildPage() {
						if (!this.groupModel) {
							return;
						}
						this.pageType = this.attributes.label.value;
						this.groupObjectName = this.groupModel.groupObjectName;
						if (this.groupModel.groupMDQTabs) {
							this.tabs = this.groupModel.groupMDQTabs;
						}
						this.hideTabs = this.tabs ? this.tabs.length == 1 && this.tabs[0].key != 'Custom' : false;
					}
				}, {
					key: '_setIsGroupFieldPage',
					value: function _setIsGroupFieldPage(pageType) {
						return pageType === "details";
					}
				}, {
					key: '_setIsStandardLinesPage',
					value: function _setIsStandardLinesPage(pageType) {
						return pageType === "standard";
					}
				}, {
					key: '_setIsSegmentedLinesPage',
					value: function _setIsSegmentedLinesPage(pageType) {
						return pageType === "segmented";
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildPage(groupModel)'];
					}
				}]);

				return GroupTabs;
			}());

			_export('GroupTabs', GroupTabs);

			Polymer(GroupTabs);
		}
	};
});

'use strict';

System.register('quotes/layout/sb-line-editor-tabs/sb-quote-tabs/QuoteTabs.js', ['common/core/sb-page-container/PageContainer.js'], function (_export, _context) {
	var PageContainer, _createClass, QuoteTabs;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonCoreSbPageContainerPageContainerJs) {
			PageContainer = _commonCoreSbPageContainerPageContainerJs.PageContainer;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('QuoteTabs', QuoteTabs = function () {
				function QuoteTabs() {
					_classCallCheck(this, QuoteTabs);
				}

				_createClass(QuoteTabs, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-quote-tabs';

						this.properties = {
							isQuoteFieldPage: {
								type: Boolean,
								computed: '_setIsQuoteFieldPage(pageType)'
							},
							isGroupsPage: {
								type: Boolean,
								computed: '_setIsGroupsPage(pageType)'
							},
							isSegmentedLinesPage: {
								type: Boolean,
								computed: '_setIsSegmentedLinesPage(pageType)'
							},
							isStandardLinesPage: {
								type: Boolean,
								computed: '_setIsStandardLinesPage(pageType)'
							},
							editorModel: {
								notify: true,
								type: Object
							},
							groupModels: {
								notify: true,
								type: Object
							},
							viewport: {
								type: Object,
								value: function value() {
									return PageContainer.getViewport();
								}
							}
						};
					}
				}, {
					key: '_groupModelsChanged',
					value: function _groupModelsChanged(e) {
						if (this.groupModels.length == 1 && e.path != 'groupModels' && !this.groupModels[0].quoteModel.grouped) {
							var parts = e.path.split('.');
							var path = parts.splice(2, parts.length).join('.');
							this.set('groupModel.' + path, e.value);
						}
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.handleResize();
					}
				}, {
					key: 'attached',
					value: function attached() {
						this.resize();
					}
				}, {
					key: 'buildPage',
					value: function buildPage() {
						if (!this.groupModels) return;

						this.pageType = this.attributes.label.value;
						if (this.pageType != 'details' && this.pageType != 'groups') {
							this.groupModel = this.groupModels[0];
							this.quoteModel = this.groupModel.quoteModel;
						}
						if (this.pageType == 'segmented' && this.groupModel.quoteMDQTabs) {
							this.segmentedTabs = this.groupModel.quoteMDQTabs;
						}

						this.hideTabs = this.segmentedTabs ? this.segmentedTabs.length == 1 && this.segmentedTabs[0].key != 'Custom' : false;
						this.resize();
					}
				}, {
					key: 'viewportChanged',
					value: function viewportChanged(e) {
						this.viewport = e.detail.viewport;
					}
				}, {
					key: 'handleResize',
					value: function handleResize() {
						window.addEventListener('resize', function (e) {
							this.resize();
						}.bind(this));
					}
				}, {
					key: 'resize',
					value: function resize() {
						if (this.domHost) {
							var tabHeight = this.domHost.tabs.length == 1 && this.domHost.tabs[0].key != 'Custom' ? 0 : 43;
							this.layoutHeight = this.domHost.getBoundingClientRect().height - tabHeight + 'px';
							Polymer.dom(this).parentNode.style.height = this.layoutHeight;
						}
					}
				}, {
					key: '_setIsQuoteFieldPage',
					value: function _setIsQuoteFieldPage(pageType) {
						return pageType === "details";
					}
				}, {
					key: '_setIsGroupsPage',
					value: function _setIsGroupsPage(pageType) {
						return pageType === "groups";
					}
				}, {
					key: '_setIsStandardLinesPage',
					value: function _setIsStandardLinesPage(pageType) {
						return pageType === "standard";
					}
				}, {
					key: '_setIsSegmentedLinesPage',
					value: function _setIsSegmentedLinesPage(pageType) {
						return pageType === "segmented";
					}
				}, {
					key: 'behaviors',
					get: function get() {
						return [window.CommonBehaviors.DeviceBehavior];
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['buildPage(groupModels)', '_groupModelsChanged(groupModels.*)'];
					}
				}]);

				return QuoteTabs;
			}());

			_export('QuoteTabs', QuoteTabs);

			Polymer(QuoteTabs);
		}
	};
});

'use strict';

System.register('products/config/routes/services/sb-pc-option-save/OptionSaver.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, OptionSaver;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OptionSaver', OptionSaver = function () {
				function OptionSaver() {
					_classCallCheck(this, OptionSaver);
				}

				_createClass(OptionSaver, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-pc-option-save';
						this.properties = {
							quote: Object,
							products: Array,
							configuration: Object,
							upgradeAssetId: String,
							groupKey: {
								type: Number,
								value: -1
							},
							error: {
								type: Array,
								notify: true
							},
							psmResponse: {
								type: String,
								notify: true
							},
							background: {
								type: Boolean,
								value: true
							},
							cache: String };
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.service.addEventListener('response-changed', function (e) {
							this.psmResponse = e.detail.value;
						}.bind(this));
						this.$.service.addEventListener('error-changed', function (e) {
							if (e.detail.value) {
								if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
							}
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'update',
					value: function update() {
						if (this.cache !== undefined) this.$.service.uid = this.quote.record.Id.substring(0, 15);
						this.$.service.warningCallback = function (e) {
							var messages = e.detail.value.validationMessages;
							console.log(messages);
						};

						var builder = new DataBuilder().addQuote('quote', this.quote);
						builder.addObject('products', this.products);
						if (this.groupKey != null && this.groupKey >= 0) builder.add('groupKey', this.groupKey);

						this.$.service.model = builder.build();
					}
				}, {
					key: 'updateConfiguration',
					value: function updateConfiguration() {
						if (this.cache !== undefined) this.$.service.uid = this.quote.record.Id.substring(0, 15);
						this.$.service.warningCallback = function (e) {
							var messages = e.detail.value.validationMessages;
							console.log(messages);
						};
						this.$.service.model = new DataBuilder().addQuote('quote', this.quote).addObject('configuration', this.configuration).add('upgradeAssetId', null).build();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['update(quote, products)', 'updateConfiguration(quote, configuration)'];
					}
				}]);

				return OptionSaver;
			}());

			_export('OptionSaver', OptionSaver);

			Polymer(OptionSaver);
		}
	};
});

'use strict';

System.register('products/config/routes/services/sb-pc-option-configure/OptionConfigurator.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, OptionConfigurator;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('OptionConfigurator', OptionConfigurator = function () {
				function OptionConfigurator() {
					_classCallCheck(this, OptionConfigurator);
				}

				_createClass(OptionConfigurator, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-pc-option-configure';
						this.properties = {
							quote: Object,
							product: Object,
							optionId: String,
							ignoreCache: {
								type: Boolean,
								value: false
							},
							configuration: Object,
							error: {
								type: Array,
								notify: true
							},
							optionConfiguratorResponse: {
								type: String,
								notify: true
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						var service = this.$.service;
						service.addEventListener('response-changed', function (e) {
							this.optionConfiguratorResponse = e.detail.value;
						}.bind(this));
						service.addEventListener('error-changed', function (e) {
							if (e.detail.value) {
								if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
							}
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'load',
					value: function load() {
						this.$.service.uid = this.optionId;
						this.$.service.ignoreCache = this.ignoreCache;
						this.$.service.context = new DataBuilder().addQuote('quote', this.quote).add('optionId', this.optionId).add('featureOptionalSKUs', []).addObject('configuration', this.configuration).addObject('parentProduct', this.serverProduct).build();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['load(quote, product, optionId, ignoreCache)'];
					}
				}, {
					key: 'serverProduct',
					get: function get() {
						var serverProduct = {};
						serverProduct.configurationAttributes = this.product.configurationAttributes;
						serverProduct.inheritedConfigurationAttributes = this.product.inheritedConfigurationAttributes;
						if (this.product.configuration === undefined) return serverProduct;

						serverProduct.configuration = {
							configurationData: this.product.configuration.configurationData,
							inheritedConfigurationData: this.product.configuration.inheritedConfigurationData
						};

						return serverProduct;
					}
				}]);

				return OptionConfigurator;
			}());

			_export('OptionConfigurator', OptionConfigurator);

			Polymer(OptionConfigurator);
		}
	};
});

'use strict';

System.register('products/config/routes/services/sb-pc-product-load/ProductLoader.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, ProductLoader;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductLoader', ProductLoader = function () {
				function ProductLoader() {
					_classCallCheck(this, ProductLoader);
				}

				_createClass(ProductLoader, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-pc-product-load';
						this.properties = {
							productIds: {
								type: String,
								value: ''
							},
							lineKey: {
								type: Number,
								value: -1
							},
							featureOptionIds: {
								type: Array,
								value: null
							},
							groupKey: {
								type: Number,
								value: -1
							},
							fieldSet: {
								type: String,
								value: null
							},
							quote: Object,
							product: {
								type: Object,
								notify: true
							},
							error: {
								type: Array,
								notify: true
							},
							productLoadModel: {
								type: Object,
								notify: true
							},
							ignoreCache: {
								type: Boolean,
								value: false
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.service.addEventListener('response-changed', function (e) {
							this.featureOptionIds = null;
							this.productLoadModel = e.detail && e.detail.value ? e.detail.value : null;
						}.bind(this));
						this.$.service.addEventListener('error-changed', function (e) {
							if (e.detail.value) {
								if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
							}
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'load',
					value: function load() {
						if (this.lineKey != null && this.lineKey >= 0 && this.lineKey > this.quote.nextKey) return this.productLoadModel = { returnToQuote: 'The quote line you are attempting to reconfigure does not exist. Please add the product again to configure it.' };

						var products = [];
						var pIds = this.productIds.split(',');
						pIds.forEach(function (pId) {
							products.push({ record: { Id: pId } });
						});
						this.$.service.context = undefined;
						this.$.service.uid = this.featureOptionIds ? 'dynamic' : this.quote.record.Id.substring(0, 15);
						this.$.service.ignoreCache = this.ignoreCache;

						var builder = new DataBuilder().addQuote('quote', this.quote);

						if (this.lineKey != null && this.lineKey >= 0) builder.add('lineKey', this.lineKey);else if (this.featureOptionIds != null) builder.add('featureOptionIds', this.featureOptionIds).add('fieldSet', this.fieldSet);else builder.addObject('products', products);

						if (this.groupKey != null && this.groupKey >= 0) builder.add('groupKey', this.groupKey);

						this.$.service.context = builder.build();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['load(quote, productIds, lineKey, ignoreCache)'];
					}
				}]);

				return ProductLoader;
			}());

			_export('ProductLoader', ProductLoader);

			Polymer(ProductLoader);
		}
	};
});

'use strict';

System.register('products/config/routes/services/sb-product-rules-invoke/ProductRulesInvoker.js', ['common/data/format/DataBuilder.js'], function (_export, _context) {
	var DataBuilder, _createClass, ProductRulesInvoker;

	function _classCallCheck(instance, Constructor) {
		if (!(instance instanceof Constructor)) {
			throw new TypeError("Cannot call a class as a function");
		}
	}

	return {
		setters: [function (_commonDataFormatDataBuilderJs) {
			DataBuilder = _commonDataFormatDataBuilderJs.DataBuilder;
		}],
		execute: function () {
			_createClass = function () {
				function defineProperties(target, props) {
					for (var i = 0; i < props.length; i++) {
						var descriptor = props[i];
						descriptor.enumerable = descriptor.enumerable || false;
						descriptor.configurable = true;
						if ("value" in descriptor) descriptor.writable = true;
						Object.defineProperty(target, descriptor.key, descriptor);
					}
				}

				return function (Constructor, protoProps, staticProps) {
					if (protoProps) defineProperties(Constructor.prototype, protoProps);
					if (staticProps) defineProperties(Constructor, staticProps);
					return Constructor;
				};
			}();

			_export('ProductRulesInvoker', ProductRulesInvoker = function () {
				function ProductRulesInvoker() {
					_classCallCheck(this, ProductRulesInvoker);
				}

				_createClass(ProductRulesInvoker, [{
					key: 'beforeRegister',
					value: function beforeRegister() {
						this.is = 'sb-product-rules-invoke';
						this.properties = {
							quote: Object,
							product: Object,
							upgradeAssetId: {
								type: String,
								value: null
							},
							error: {
								type: Array,
								notify: true
							},
							configResponse: {
								type: String,
								notify: true
							}
						};
					}
				}, {
					key: 'ready',
					value: function ready() {
						this.$.service.addEventListener('response-changed', function (e) {
							this.configResponse = e.detail.value;
						}.bind(this));
						this.$.service.addEventListener('error-changed', function (e) {
							if (e.detail.value) {
								if (e.detail.value.validations) this.error = e.detail.value.validations;else this.error = [e.detail.value.message];
							}
							console.log(e.detail);
						}.bind(this));
					}
				}, {
					key: 'update',
					value: function update() {
						this.product.configuration.configuredProductKey = this.product.productKey || this.product.configuration.configuredProductId;
						this.$.service.model = new DataBuilder().addQuote('quote', this.quote, true).addObject('configuration', this.product.configuration).add('upgradeAssetId', this.upgradeAssetId).build();
					}
				}, {
					key: 'observers',
					get: function get() {
						return ['update(quote, product)'];
					}
				}]);

				return ProductRulesInvoker;
			}());

			_export('ProductRulesInvoker', ProductRulesInvoker);

			Polymer(ProductRulesInvoker);
		}
	};
});
//# sourceMappingURL=../resource/1491418528400/SBQQ__sb_app_map